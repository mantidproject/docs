<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CalculateFlatBackground v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.6.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="CalculateGammaBackground v1" href="CalculateGammaBackground-v1.html" />
    <link rel="prev" title="CalculateEfficiency v1" href="CalculateEfficiency-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.6</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="calculateflatbackground-v1">
<span id="algm-calculateflatbackground"></span><span id="algm-calculateflatbackground-v1"></span><h1>CalculateFlatBackground v1<a class="headerlink" href="#calculateflatbackground-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/CalculateFlatBackground-v1_dlg.png"><img alt="../_images/CalculateFlatBackground-v1_dlg.png" class="screenshot" src="../_images/CalculateFlatBackground-v1_dlg.png" style="width: 252px;" /></a>
<p class="caption"><strong>CalculateFlatBackground</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#usage" id="id4">Usage</a></li>
<li><a class="reference internal" href="#source" id="id5">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Finds a constant value fit to an appropriate range of each desired spectrum and subtracts that value from the entire spectrum.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="2%" />
<col width="12%" />
<col width="6%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>The input workspace must either have constant width bins or is a distribution workspace. It is also assumed that all spectra have the same X bin boundaries</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Name to use for the output workspace.</td>
</tr>
<tr class="row-even"><td>StartX</td>
<td>Input</td>
<td>number</td>
<td><em>Mandatory</em></td>
<td>The X value at which to start the background fit</td>
</tr>
<tr class="row-odd"><td>EndX</td>
<td>Input</td>
<td>number</td>
<td><em>Mandatory</em></td>
<td>The X value at which to end the background fit</td>
</tr>
<tr class="row-even"><td>WorkspaceIndexList</td>
<td>Input</td>
<td>int list</td>
<td>&nbsp;</td>
<td>Indices of the spectra that will have their background removed default: modify all spectra</td>
</tr>
<tr class="row-odd"><td>Mode</td>
<td>Input</td>
<td>string</td>
<td>Linear Fit</td>
<td>The background count rate is estimated either by taking a mean or doing a linear fit (default: Linear Fit). Allowed values: [&#8216;Linear Fit&#8217;, &#8216;Mean&#8217;]</td>
</tr>
<tr class="row-even"><td>OutputMode</td>
<td>Input</td>
<td>string</td>
<td>Subtract Background</td>
<td>Once the background has been determined it can either be subtracted from  the InputWorkspace and returned or just returned (default: Subtract Background). Allowed values: [&#8216;Subtract Background&#8217;, &#8216;Return Background&#8217;]</td>
</tr>
<tr class="row-odd"><td>SkipMonitors</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>By default, the algorithm calculates and removes background from monitors in the same way as from normal detectors If this property is set to true, background is not calculated/removed from monitors.</td>
</tr>
<tr class="row-even"><td>NullifyNegativeValues</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>When background is subtracted, signals in some time channels may become negative. If this option is true, signal in such bins is nullified and the module of the removed signalis added to the error. If false, the signal and errors are left unchanged</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm takes a list of spectra and for each spectrum calculates
an average count rate in the given region, usually a region when there
are only background neutrons. This count rate is then subtracted from
the counts in all the spectrum&#8217;s bins. However, no bin will take a
negative value as bins with count rates less than the background are set
to zero (and their error is set to the backgound value).</p>
<p>The average background count rate is estimated in one of two ways. When
<em>Mode</em> is set to &#8220;Mean&#8221; it is the sum of the values in the bins in the
background region divided by the width of the X range. Selecting &#8220;Linear
Fit&#8221; sets the background value to the height in the centre of the
background region of a line of best fit through that region.</p>
<p>The error on the background value is only calculated when &#8220;Mean&#8221; is
used. It is the errors in all the bins in the background region summed
in quadrature divided by the number of bins. This background error value
is added in quadrature to the errors in each bin.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id4">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - Subtracting background using Linear Fit:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">]</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">CalculateFlatBackground</span><span class="p">(</span><span class="s">&#39;input&#39;</span><span class="p">,</span>
                                 <span class="n">StartX</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                 <span class="n">EndX</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                 <span class="n">Mode</span><span class="o">=</span><span class="s">&#39;Linear Fit&#39;</span><span class="p">,</span>
                                 <span class="n">OutputMode</span><span class="o">=</span><span class="s">&#39;Subtract Background&#39;</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&#39;Values with subtracted background:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Values with subtracted background: [ 2.  0.  0.  0.  6.  0.]
</pre></div>
</div>
<p><strong>Example - Returning background using Mean:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">]</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">CalculateFlatBackground</span><span class="p">(</span><span class="s">&#39;input&#39;</span><span class="p">,</span>
                                 <span class="n">StartX</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">EndX</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                 <span class="n">Mode</span><span class="o">=</span><span class="s">&#39;Mean&#39;</span><span class="p">,</span>
                                 <span class="n">OutputMode</span><span class="o">=</span><span class="s">&#39;Return Background&#39;</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&#39;Calculated Mean background:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Calculated Mean background: [ 3.  3.  3.  3.  3.]
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/SANS.html">SANS</a> | <a class="reference external" href="categories/CorrectionFunctions/BackgroundCorrections.html">CorrectionFunctions\BackgroundCorrections</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id5">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/928349c406ed0cdd1d18d429ed0a1a931814016c/Framework/Algorithms/src/CalculateFlatBackground.cpp">CalculateFlatBackground.cpp</a></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/928349c406ed0cdd1d18d429ed0a1a931814016c/Framework/Algorithms/inc/MantidAlgorithms/CalculateFlatBackground.h">CalculateFlatBackground.h</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="CalculateEfficiency-v1.html" title="Previous Chapter: CalculateEfficiency v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; CalculateEfficie...</span>
    </a>
  </li>
  <li>
    <a href="CalculateGammaBackground-v1.html" title="Next Chapter: CalculateGammaBackground v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">CalculateGammaBa... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>