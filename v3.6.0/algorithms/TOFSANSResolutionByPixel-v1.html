<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>TOFSANSResolutionByPixel v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.6.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="TOFTOFConvertTofToDeltaE v1" href="TOFTOFConvertTofToDeltaE-v1.html" />
    <link rel="prev" title="TOFSANSResolution v1" href="TOFSANSResolution-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.6</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="tofsansresolutionbypixel-v1">
<span id="algm-tofsansresolutionbypixel"></span><span id="algm-tofsansresolutionbypixel-v1"></span><h1>TOFSANSResolutionByPixel v1<a class="headerlink" href="#tofsansresolutionbypixel-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/TOFSANSResolutionByPixel-v1_dlg.png"><img alt="../_images/TOFSANSResolutionByPixel-v1_dlg.png" class="screenshot" src="../_images/TOFSANSResolutionByPixel-v1_dlg.png" style="width: 253px;" /></a>
<p class="caption"><strong>TOFSANSResolutionByPixel</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#source" id="id4">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Calculate the Q resolution for TOF SANS data for each pixel.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="4%" />
<col width="25%" />
<col width="7%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Name the workspace to calculate the resolution for, for each pixel and wavelength</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><em>Workspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Name of the newly created workspace which contains the Q resolution.</td>
</tr>
<tr class="row-even"><td>DeltaR</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Virtual ring width on the detector (mm).</td>
</tr>
<tr class="row-odd"><td>SampleApertureRadius</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Sample aperture radius, R2 (mm).</td>
</tr>
<tr class="row-even"><td>SourceApertureRadius</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Source aperture radius, R1 (mm).</td>
</tr>
<tr class="row-odd"><td>SigmaModerator</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Moderator time spread (microseconds) as afunction of wavelength (Angstroms).</td>
</tr>
<tr class="row-even"><td>CollimationLength</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Collimation length (m)</td>
</tr>
<tr class="row-odd"><td>AccountForGravity</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether to correct for the effects of gravity</td>
</tr>
<tr class="row-even"><td>ExtraLength</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Additional length for gravity correction.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Calculates the Q-resolution per pixel according to Mildner and Carpenter equation</p>
<div class="math">
<p><img src="../_images/math/38621912e3f207830aa33f2a9938503a88d42475.png" alt="(\sigma_Q )^2 = \frac{4\pi^2}{12\lambda^2} [ 3(\frac{R_1}{L_1})^2 + 3(\frac{R_2}{L_3})^2 + (\frac{\Delta R}{L_2})^2 ] + Q^2(\frac{\sigma_{\lambda}}{\lambda})^2"/></p>
</div><p>where <img class="math" src="../_images/math/a676c30537141d9883c5e2e994a394d846a5eef1.png" alt="L1" style="vertical-align: -1px"/> and <img class="math" src="../_images/math/f291c4c07c8b6388124c11f338c68097ad00abef.png" alt="L2" style="vertical-align: 0px"/>  are the collimation length and sample-to-detector distance respectively and</p>
<div class="math">
<p><img src="../_images/math/d811c3ef81799ed470c78f55af9ccce17df45a75.png" alt="\frac{1}{L_3} = \frac{1}{L_1} + \frac{1}{L_2}"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/fc551737ff98bec870bec0667a61b08f0cb9e930.png" alt="(\sigma_{\lambda})^2 = (\Delta \lambda )^2 / 12 + (\sigma_{moderator})^2"/></p>
</div><p>where <img class="math" src="../_images/math/7865f7d7aee1d2916b5ec17ba6b69a7349d5d7b1.png" alt="\sigma_{\lambda}" style="vertical-align: -3px"/> is the overall effective standard deviation in wavelength.
<img class="math" src="../_images/math/9874862989e02dcb11aa4bd866efe74c00e399bf.png" alt="\Delta \lambda" style="vertical-align: 0px"/> values are found from the wavelength binning of the InputWorkspace,
<img class="math" src="../_images/math/6452aa3f7dbf37ae027edca3bec3820cc1cd892c.png" alt="\sigma_{moderator}" style="vertical-align: -3px"/> is the moderator time spread (the variation in time for the moderator
to emit neutrons of a given wavelength). Note that <img class="math" src="../_images/math/9874862989e02dcb11aa4bd866efe74c00e399bf.png" alt="\Delta \lambda" style="vertical-align: 0px"/> may be imposed
by wavelength steps set elsewhere in Mantid which should be at least as large as the
equivalent time bins used in the original histogram data collection. For event mode data
<img class="math" src="../_images/math/9874862989e02dcb11aa4bd866efe74c00e399bf.png" alt="\Delta \lambda" style="vertical-align: 0px"/> is in theory very small, but in practice a histogram in
time has to be generated (perhaps using monitor time bins or specifically set
event-time-bins), before a rebinning into user provided wavelength steps in InputWorkspace.
Again the latter steps should be the largest.</p>
<p>Q values needed here are calculated in the same way as for Q1D, including correction
for gravity for which detector coordinates are assumed centred at zero wavelength.</p>
<p><img class="math" src="../_images/math/6ff1550a097c4755557df3f0be2555f36664efe0.png" alt="\sigma_Q" style="vertical-align: -6px"/> is returned as the y-values of the InputWorkspace, and the
remaining variables in the main equation above are related to parameters of this
algorithm as follows:</p>
<ul class="simple">
<li><img class="math" src="../_images/math/09ceea1a346c9ac46c69a8c42113674864e3cd12.png" alt="R_1" style="vertical-align: -4px"/> equals SourceApertureRadius</li>
<li><img class="math" src="../_images/math/7b1bc18872160b9fbdb4a54a43cf4b62fa2ea36b.png" alt="R_2" style="vertical-align: -3px"/> equals SampleApertureRadius</li>
<li><img class="math" src="../_images/math/fc0a89fdfebf3a21f2d0d1031a76df67e9b077a4.png" alt="\Delta R" style="vertical-align: 0px"/> equals DeltaR</li>
<li><img class="math" src="../_images/math/6452aa3f7dbf37ae027edca3bec3820cc1cd892c.png" alt="\sigma_{moderator}" style="vertical-align: -3px"/> equals SigmaModerator</li>
<li><img class="math" src="../_images/math/9ae12a63799e1748fe4520baec03d68176d7ac9b.png" alt="\L_1" style="vertical-align: -4px"/> equals CollimationLength</li>
</ul>
<p><img class="math" src="../_images/math/412c0294db757d8807fe8fc2975ab586bb9042d8.png" alt="\lambda" style="vertical-align: 0px"/> in the equation is the midpoint of wavelength
histogram bin values of InputWorkspace.</p>
<p>Collimation length <img class="math" src="../_images/math/64501d33ba28bc7129b6ef952baecb9103fb5377.png" alt="L_1" style="vertical-align: -4px"/> in metres in the equation here is the distance between the
first beam defining pinhole (Radius <img class="math" src="../_images/math/09ceea1a346c9ac46c69a8c42113674864e3cd12.png" alt="R_1" style="vertical-align: -4px"/>) and the sample aperture (radius <img class="math" src="../_images/math/7b1bc18872160b9fbdb4a54a43cf4b62fa2ea36b.png" alt="R_2" style="vertical-align: -3px"/>).
(Beware that <img class="math" src="../_images/math/64501d33ba28bc7129b6ef952baecb9103fb5377.png" alt="L_1" style="vertical-align: -4px"/> is more often the moderator to sample distance.)</p>
<p>For rectangular collimation apertures, size H x W, Mildner &amp; Carpenter say to
use <img class="math" src="../_images/math/800ba1e1b66569a42332aa2601277f531eb9d072.png" alt="R = \sqrt{( H^2 +W^2)/6 }" style="vertical-align: -6px"/>. Note that we are assuming isotropically averaged,
scalar <img class="math" src="../_images/math/f59dd7fde255c3f2d4d4d2f0631914aa7604d031.png" alt="Q" style="vertical-align: -4px"/>, and making some small angle approximations. Results on higher angle detectors
may not be accurate. For data reduction sliced in different directions on the detector
(e.g. GISANS) adjust the calling parameters to suit the collimation in that direction.</p>
<p>Note that <img class="math" src="../_images/math/d682e66b656d96f8941516a7ad2b2f64331a1c93.png" alt="\Delta" style="vertical-align: 0px"/> is the full width of a rectangular distribution in radius or wavelength,
for which the standard deviation is <img class="math" src="../_images/math/605a17e415c37241a14c735dc336aa432e447ad9.png" alt="\sigma=\Delta/\sqrt{12}" style="vertical-align: -5px"/>. For a Gaussian distribution
the FWHM (full width at half maximum) is <img class="math" src="../_images/math/0ac9aea1cb71542a3a0288ab42db6164daec0174.png" alt="\sqrt{8\ln{2}}\sigma=2.35482\sigma" style="vertical-align: -2px"/>. For an exponential decay
<img class="math" src="../_images/math/2f6c4fe4ea1673f9164037dc676d79585fdcd9ad.png" alt="e^{-t/\tau}" style="vertical-align: 0px"/>, the standard deviation (and the mean) is <img class="math" src="../_images/math/b79a01e33f913a8a3fe481a0620182003a0d9c3c.png" alt="\tau" style="vertical-align: 0px"/>. For non-rectangular
distributions these equations allow the equivalent <img class="math" src="../_images/math/d682e66b656d96f8941516a7ad2b2f64331a1c93.png" alt="\Delta" style="vertical-align: 0px"/> to be entered as <img class="math" src="../_images/math/83de882ef68d6b310e04ba38288374ea5e2ab6a6.png" alt="\Delta=\sqrt{12}\sigma" style="vertical-align: -3px"/>.</p>
<p>This version of the algorithm neglects wavelength-dependent detector detection depth effects.</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/SANS.html">SANS</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id4">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/928349c406ed0cdd1d18d429ed0a1a931814016c/Framework/Algorithms/src/TOFSANSResolutionByPixel.cpp">TOFSANSResolutionByPixel.cpp</a></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/928349c406ed0cdd1d18d429ed0a1a931814016c/Framework/Algorithms/inc/MantidAlgorithms/TOFSANSResolutionByPixel.h">TOFSANSResolutionByPixel.h</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="TOFSANSResolution-v1.html" title="Previous Chapter: TOFSANSResolution v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; TOFSANSResolutio...</span>
    </a>
  </li>
  <li>
    <a href="TOFTOFConvertTofToDeltaE-v1.html" title="Next Chapter: TOFTOFConvertTofToDeltaE v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">TOFTOFConvertTof... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>