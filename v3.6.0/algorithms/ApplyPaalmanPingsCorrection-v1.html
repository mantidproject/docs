<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ApplyPaalmanPingsCorrection v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.6.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="ApplyTransmissionCorrection v1" href="ApplyTransmissionCorrection-v1.html" />
    <link rel="prev" title="ApplyDetailedBalance v1" href="ApplyDetailedBalance-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.6</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="applypaalmanpingscorrection-v1">
<span id="algm-applypaalmanpingscorrection"></span><span id="algm-applypaalmanpingscorrection-v1"></span><h1>ApplyPaalmanPingsCorrection v1<a class="headerlink" href="#applypaalmanpingscorrection-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/ApplyPaalmanPingsCorrection-v1_dlg.png"><img alt="../_images/ApplyPaalmanPingsCorrection-v1_dlg.png" class="screenshot" src="../_images/ApplyPaalmanPingsCorrection-v1_dlg.png" style="width: 345px;" /></a>
<p class="caption"><strong>ApplyPaalmanPingsCorrection</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#workflow" id="id4">Workflow</a><ul>
<li><a class="reference internal" href="#container-scale-only" id="id5">Container Scale Only</a></li>
<li><a class="reference internal" href="#sample-corrections-only" id="id6">Sample Corrections Only</a></li>
<li><a class="reference internal" href="#full-corrections" id="id7">Full Corrections</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id8">Usage</a></li>
<li><a class="reference internal" href="#source" id="id9">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Applies a calculated absorption correction in the Paalman and Pings factor style.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="6%" />
<col width="33%" />
<col width="10%" />
<col width="34%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>SampleWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Name for the input Sample workspace.</td>
</tr>
<tr class="row-odd"><td>CorrectionsWorkspace</td>
<td>Input</td>
<td>WorkspaceGroup</td>
<td>&nbsp;</td>
<td>Name for the input Corrections workspace.</td>
</tr>
<tr class="row-even"><td>CanWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td>&nbsp;</td>
<td>Name for the input Can workspace.</td>
</tr>
<tr class="row-odd"><td>CanScaleFactor</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Factor to scale the can data</td>
</tr>
<tr class="row-even"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>The output corrections workspace.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Applies absorption corrections calculated in the Paalman &amp; Pings absorption
factor format: <img class="math" src="../_images/math/1967529dd2c5f21c2b37fb011d28fe0b10c5997d.png" alt="A_{s,s}" style="vertical-align: -6px"/> (correction factor for scattering and absorption
in sample), <img class="math" src="../_images/math/bc7f9902ac1113c44915d9134a7bbb305f1e8748.png" alt="A_{s,sc}" style="vertical-align: -6px"/> (scattering in sample and absorption in sample and
container), <img class="math" src="../_images/math/2cc4bcf3bef41d04fcd0a671e9b592ede5bfa80b.png" alt="A_{c,sc}" style="vertical-align: -6px"/> (scattering in container and absorption in sample
and container) and  <img class="math" src="../_images/math/875ffb4fd8f1f64905cd9caf7910615c1c03ff6b.png" alt="A_{c,c}" style="vertical-align: -6px"/> (scattering and absorption in container).</p>
<p>This algorithm can be used to apply absorption corrections calculated with
either the <a class="reference internal" href="CylinderPaalmanPingsCorrection-v2.html#algm-cylinderpaalmanpingscorrection"><em>CylinderPaalmanPingsCorrection v2</em></a> and
<a class="reference internal" href="FlatPlatePaalmanPingsCorrection-v1.html#algm-flatplatepaalmanpingscorrection"><em>FlatPlatePaalmanPingsCorrection v1</em></a> algorithms as well as the legacy
indirect calculate correcteions routine, providing that the sample and container
are first converted to wavelength and the corrections are interpolated to match
the sample as demonstrated in the example below.</p>
</div>
<div class="section" id="workflow">
<h2><a class="toc-backref" href="#id4">Workflow</a><a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<p>Depending on the input workspaces provided to the algorithm it may operate in
one of three ways, each of which is described on a separate workflow diagram.</p>
<div class="section" id="container-scale-only">
<h3><a class="toc-backref" href="#id5">Container Scale Only</a><a class="headerlink" href="#container-scale-only" title="Permalink to this headline">¶</a></h3>
<p>In the case where only a container workspace and no correction factors are
provided.</p>
<img alt="../_images/ApplyPaalmanPingsCorrection-v1_canscaleonly_wkflw.png" src="../_images/ApplyPaalmanPingsCorrection-v1_canscaleonly_wkflw.png" />
</div>
<div class="section" id="sample-corrections-only">
<h3><a class="toc-backref" href="#id6">Sample Corrections Only</a><a class="headerlink" href="#sample-corrections-only" title="Permalink to this headline">¶</a></h3>
<p>In the case where only correction factors and no container workspace is
provided.</p>
<img alt="../_images/ApplyPaalmanPingsCorrection-v1_samplecorrectiononly_wkflw.png" src="../_images/ApplyPaalmanPingsCorrection-v1_samplecorrectiononly_wkflw.png" />
</div>
<div class="section" id="full-corrections">
<h3><a class="toc-backref" href="#id7">Full Corrections</a><a class="headerlink" href="#full-corrections" title="Permalink to this headline">¶</a></h3>
<p>In the case where both a container workspace and correction factors are
provided.</p>
<img alt="../_images/ApplyPaalmanPingsCorrection-v1_fullcorrection_wkflw.png" src="../_images/ApplyPaalmanPingsCorrection-v1_fullcorrection_wkflw.png" />
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id8">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example: using with legacy indirect corrections data</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Load the sample and can</span>
<span class="n">sample_ws</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s">&#39;irs26176_graphite002_red.nxs&#39;</span><span class="p">)</span>
<span class="n">can_ws</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s">&#39;irs26173_graphite002_red.nxs&#39;</span><span class="p">)</span>

<span class="c"># Convert sample and container workspaces to wavelength</span>
<span class="n">sample_ws</span> <span class="o">=</span> <span class="n">ConvertUnits</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">sample_ws</span><span class="p">,</span>
                         <span class="n">Target</span><span class="o">=</span><span class="s">&#39;Wavelength&#39;</span><span class="p">,</span>
                         <span class="n">EMode</span><span class="o">=</span><span class="s">&#39;Indirect&#39;</span><span class="p">,</span>
                         <span class="n">EFixed</span><span class="o">=</span><span class="mf">1.845</span><span class="p">)</span>
<span class="n">can_ws</span> <span class="o">=</span> <span class="n">ConvertUnits</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">can_ws</span><span class="p">,</span>
                      <span class="n">Target</span><span class="o">=</span><span class="s">&#39;Wavelength&#39;</span><span class="p">,</span>
                      <span class="n">EMode</span><span class="o">=</span><span class="s">&#39;Indirect&#39;</span><span class="p">,</span>
                      <span class="n">EFixed</span><span class="o">=</span><span class="mf">1.845</span><span class="p">)</span>

<span class="c"># Load the corrections workspace</span>
<span class="n">corrections_ws</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s">&#39;irs26176_graphite002_cyl_Abs.nxs&#39;</span><span class="p">)</span>

<span class="c"># Interpolate each of the correction factor workspaces to match the</span>
<span class="c"># binning of the smaple</span>
<span class="c"># Required to use corrections from the old indirect calculate</span>
<span class="c"># corrections routines</span>
<span class="k">for</span> <span class="n">factor_ws</span> <span class="ow">in</span> <span class="n">corrections_ws</span><span class="p">:</span>
    <span class="n">SplineInterpolation</span><span class="p">(</span><span class="n">WorkspaceToMatch</span><span class="o">=</span><span class="n">sample_ws</span><span class="p">,</span>
                        <span class="n">WorkspaceToInterpolate</span><span class="o">=</span><span class="n">factor_ws</span><span class="p">,</span>
                        <span class="n">OutputWorkspace</span><span class="o">=</span><span class="n">factor_ws</span><span class="p">,</span>
                        <span class="n">OutputWorkspaceDeriv</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>

<span class="n">corr</span> <span class="o">=</span> <span class="n">ApplyPaalmanPingsCorrection</span><span class="p">(</span><span class="n">SampleWorkspace</span><span class="o">=</span><span class="n">sample_ws</span><span class="p">,</span>
                                   <span class="n">CorrectionsWorkspace</span><span class="o">=</span><span class="n">corrections_ws</span><span class="p">,</span>
                                   <span class="n">CanWorkspace</span><span class="o">=</span><span class="n">can_ws</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&#39;Corrected workspace has </span><span class="si">%d</span><span class="s"> spectra over </span><span class="si">%d</span><span class="s"> bins&#39;</span> <span class="o">%</span> <span class="p">(</span>
      <span class="n">corr</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">(),</span> <span class="n">corr</span><span class="o">.</span><span class="n">blocksize</span><span class="p">())</span>

<span class="k">print</span> <span class="s">&#39;Type of correction applied: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span>
      <span class="n">corr</span><span class="o">.</span><span class="n">getRun</span><span class="p">()[</span><span class="s">&#39;corrections_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Corrected workspace has 10 spectra over 1905 bins
Type of correction applied: sample_and_can_corrections
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Workflow/MIDAS.html">Workflow\MIDAS</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id9">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/928349c406ed0cdd1d18d429ed0a1a931814016c/Framework/PythonInterface/plugins/algorithms/WorkflowAlgorithms/ApplyPaalmanPingsCorrection.py">ApplyPaalmanPingsCorrection.py</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ApplyDetailedBalance-v1.html" title="Previous Chapter: ApplyDetailedBalance v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; ApplyDetailedBal...</span>
    </a>
  </li>
  <li>
    <a href="ApplyTransmissionCorrection-v1.html" title="Next Chapter: ApplyTransmissionCorrection v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">ApplyTransmissio... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>