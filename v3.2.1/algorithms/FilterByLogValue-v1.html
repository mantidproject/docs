<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>FilterByLogValue v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="FilterByTime v1" href="FilterByTime-v1.html" />
    <link rel="prev" title="FilterBadPulses v1" href="FilterBadPulses-v1.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.2</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="filterbylogvalue-v1">
<span id="algm-filterbylogvalue"></span><span id="algm-filterbylogvalue-v1"></span><h1>FilterByLogValue v1<a class="headerlink" href="#filterbylogvalue-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/FilterByLogValue-v1_dlg.png"><img alt="../_images/FilterByLogValue-v1_dlg.png" class="screenshot" src="../_images/FilterByLogValue-v1_dlg.png" style="width: 278px;" /></a>
<p class="caption"><strong>FilterByLogValue</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a><ul>
<li><a class="reference internal" href="#pulsefilter-e-g-for-veto-pulses" id="id4">PulseFilter (e.g. for Veto Pulses)</a></li>
<li><a class="reference internal" href="#comparing-with-other-event-filtering-algorithms" id="id5">Comparing with other event filtering algorithms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id6">Usage</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Filter out events from an EventWorkspace based on a sample log value satisfying filter criteria.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="2%" />
<col width="4%" />
<col width="3%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td>EventWorkspace</td>
<td>Mandatory</td>
<td>An input event workspace</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td>EventWorkspace</td>
<td>&nbsp;</td>
<td>The name to use for the output workspace</td>
</tr>
<tr class="row-even"><td>LogName</td>
<td>Input</td>
<td>string</td>
<td>Mandatory</td>
<td>Name of the sample log to use to filter. For example, the pulse charge is recorded in &#8216;ProtonCharge&#8217;.</td>
</tr>
<tr class="row-odd"><td>MinimumValue</td>
<td>Input</td>
<td>number</td>
<td>Optional</td>
<td>Minimum log value for which to keep events.</td>
</tr>
<tr class="row-even"><td>MaximumValue</td>
<td>Input</td>
<td>number</td>
<td>Optional</td>
<td>Maximum log value for which to keep events.</td>
</tr>
<tr class="row-odd"><td>TimeTolerance</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Tolerance, in seconds, for the event times to keep. A good value is 1/2 your measurement interval.  For a single log value at time T, all events between T+-Tolerance are kept. If there are several consecutive log values matching the filter, events between T1-Tolerance and T2+Tolerance are kept.</td>
</tr>
<tr class="row-even"><td>LogBoundary</td>
<td>Input</td>
<td>string</td>
<td>Centre</td>
<td>How to treat log values as being measured in the centre of the time, or beginning (left) boundary</td>
</tr>
<tr class="row-odd"><td>PulseFilter</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Optional. Filter out a notch of time for each entry in the sample log named. A notch of width 2*TimeTolerance is centered at each log time. The value of the log is NOT used.This is used, for example, to filter out veto pulses.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Filters out events using the entries in the Sample Logs.</p>
<p>Sample logs consist of a series of pairs. The first step in filtering is
to generate a list of start-stop time intervals that will be kept, using
those logs.</p>
<ul class="simple">
<li>Each log value is compared to the min/max value filters to determine
whether it is &#8220;good&#8221; or not.<ul>
<li>For a single log value that satisfies the criteria at time T, all
events between T+-Tolerance (LogBoundary=Centre), or T and
T+Tolerance (LogBoundary=Left) are kept.</li>
<li>If there are several consecutive log values matching the filter,
events between T1-Tolerance and T2+Tolerance, where T2 is the last
&#8220;good&#8221; value (LogBoundary=Centre), or T1 and T2, where T2 is the
first &#8220;bad&#8221; value (LogBoundary=Left) are kept.</li>
</ul>
</li>
<li>The filter is then applied to all events in all spectra. Any events
with pulse times outside of any &#8220;good&#8221; time ranges are removed.</li>
</ul>
<p>There is no interpolation of log values between the discrete sample log
times at this time. However, the log value is assumed to be constant at
times before its first point and after its last. For example, if the
first temperature measurement was at time=10 seconds and a temperature
within the acceptable range, then all events between 0 and 10 seconds
will be included also. If a log has a single point in time, then that
log value is assumed to be constant for all time and if it falls within
the range, then all events will be kept.</p>
<div class="section" id="pulsefilter-e-g-for-veto-pulses">
<h3><a class="toc-backref" href="#id4">PulseFilter (e.g. for Veto Pulses)</a><a class="headerlink" href="#pulsefilter-e-g-for-veto-pulses" title="Permalink to this headline">¶</a></h3>
<p>If you select PulseFilter, then events will be filtered OUT in notches
around each time in the selected sample log, and the MinValue/MaxValue
parameters are ignored. For example:</p>
<ul class="simple">
<li>If you have 3 entries at times:<ul>
<li>10, 20, 30 seconds.</li>
<li>A TimeTolerance of 1 second.</li>
</ul>
</li>
<li>Then the events at the following times will be EXCLUDED from the
output:<ul>
<li>9-11; 19-21; 29-30 seconds.</li>
</ul>
</li>
</ul>
<p>The typical use for this is to filter out &#8220;veto&#8221; pulses from a SNS event
nexus file. Some of these files have a sample log called
&#8220;veto_pulse_time&#8221; that only contains times of the pulses to be
rejected. For example, this call will filter out veto pulses:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ws</span> <span class="o">=</span> <span class="n">FilterByLogValue</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">LogName</span><span class="o">=</span><span class="s">&quot;veto_pulse_time&quot;</span><span class="p">,</span> <span class="n">PulseFilter</span><span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="comparing-with-other-event-filtering-algorithms">
<h3><a class="toc-backref" href="#id5">Comparing with other event filtering algorithms</a><a class="headerlink" href="#comparing-with-other-event-filtering-algorithms" title="Permalink to this headline">¶</a></h3>
<p>Wiki page <a class="reference external" href="http://www.mantidproject.org/EventFiltering">EventFiltering</a> has a detailed
introduction on event filtering in MantidPlot.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id6">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - Filtering by a simple time series Log</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="s">&quot;Event&quot;</span><span class="p">,</span><span class="n">BankPixelWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">AddTimeSeriesLog</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Name</span><span class="o">=</span><span class="s">&quot;proton_charge&quot;</span><span class="p">,</span> <span class="n">Time</span><span class="o">=</span><span class="s">&quot;2010-01-01T00:00:00&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">AddTimeSeriesLog</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Name</span><span class="o">=</span><span class="s">&quot;proton_charge&quot;</span><span class="p">,</span> <span class="n">Time</span><span class="o">=</span><span class="s">&quot;2010-01-01T00:10:00&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">AddTimeSeriesLog</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Name</span><span class="o">=</span><span class="s">&quot;proton_charge&quot;</span><span class="p">,</span> <span class="n">Time</span><span class="o">=</span><span class="s">&quot;2010-01-01T00:20:00&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">AddTimeSeriesLog</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Name</span><span class="o">=</span><span class="s">&quot;proton_charge&quot;</span><span class="p">,</span> <span class="n">Time</span><span class="o">=</span><span class="s">&quot;2010-01-01T00:30:00&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">AddTimeSeriesLog</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Name</span><span class="o">=</span><span class="s">&quot;proton_charge&quot;</span><span class="p">,</span> <span class="n">Time</span><span class="o">=</span><span class="s">&quot;2010-01-01T00:40:00&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">AddTimeSeriesLog</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Name</span><span class="o">=</span><span class="s">&quot;proton_charge&quot;</span><span class="p">,</span> <span class="n">Time</span><span class="o">=</span><span class="s">&quot;2010-01-01T00:50:00&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;The unfiltered workspace </span><span class="si">%s</span><span class="s"> has </span><span class="si">%i</span><span class="s"> events and a peak value of </span><span class="si">%.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberEvents</span><span class="p">(),</span><span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">50</span><span class="p">])</span>

<span class="n">wsOut</span> <span class="o">=</span> <span class="n">FilterByLogValue</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="s">&quot;proton_charge&quot;</span><span class="p">,</span><span class="n">MinimumValue</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">MaximumValue</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;The filtered workspace </span><span class="si">%s</span><span class="s"> has </span><span class="si">%i</span><span class="s"> events and a peak value of </span><span class="si">%.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wsOut</span><span class="p">,</span> <span class="n">wsOut</span><span class="o">.</span><span class="n">getNumberEvents</span><span class="p">(),</span><span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">50</span><span class="p">])</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>The unfiltered workspace ws has 8000 events and a peak value of 1030.00
The filtered workspace wsOut has 4058 events and a peak value of 502.00
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Events.html">Events</a> | <a class="reference external" href="categories/EventFiltering.html">EventFiltering</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014, Mantid.<br/>
    </p>
  </div>
</footer>
  </body>
</html>