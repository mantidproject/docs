<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>CorelliCrossCorrelate v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CorrectKiKf v1" href="CorrectKiKf-v1.html" />
    <link rel="prev" title="CopySample v1" href="CopySample-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>5.1</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="corellicrosscorrelate-v1">
<span id="algm-corellicrosscorrelate"></span><span id="algm-corellicrosscorrelate-v1"></span><h1>CorelliCrossCorrelate v1<a class="headerlink" href="#corellicrosscorrelate-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/CorelliCrossCorrelate-v1_dlg.png"><img alt="../_images/CorelliCrossCorrelate-v1_dlg.png" class="screenshot" src="../_images/CorelliCrossCorrelate-v1_dlg.png" style="width: 366px;" /></a>
<p class="caption"><span class="caption-text"><strong>CorelliCrossCorrelate</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id3">Properties</a></li>
<li><a class="reference internal" href="#description" id="id4">Description</a></li>
<li><a class="reference internal" href="#usage" id="id5">Usage</a></li>
<li><a class="reference internal" href="#source" id="id6">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Cross-correlation calculation for the elastic signal from Corelli.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id3">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="5%" />
<col width="30%" />
<col width="9%" />
<col width="42%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/EventWorkspace.html#eventworkspace"><span class="std std-ref">EventWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>An input workspace.</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/EventWorkspace.html#eventworkspace"><span class="std std-ref">EventWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>An output workspace.</td>
</tr>
<tr class="row-even"><td>TimingOffset</td>
<td>Input</td>
<td>number</td>
<td><em>Mandatory</em></td>
<td>Correlation chopper TDC timing offset in nanoseconds.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id4">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The algorithm calculates the elastic signal for the Corelli diffractometer. This is done by calculating the cross-correlation with the correlation chopper. The correlation chopper modulates the incident neutron beam with a pseudo-random sequence. The calculated signal is applied the each event in the form of a weight.</p>
<p>The weights that the events are scaled by are <img class="math" src="../_images/math/2176dbf491b1640d3e13825ce5571de922e61a33.png" alt="1" style="vertical-align: -1px"/> for transparent and <img class="math" src="../_images/math/a7b88ab3f1f1c9bb06a3b67f1e33ff2d285f11b5.png" alt="\frac{-c}{1-c}" style="vertical-align: -7px"/> for absorbing, where <img class="math" src="../_images/math/5f284c9713b9515a4975ac98a8bc88f1749aa7aa.png" alt="c" style="vertical-align: 0px"/> is the duty cycle (<img class="math" src="../_images/math/1d75b182554097a6ba9dc89980b1b1d08383cceb.png" alt="c\approx0.498475" style="vertical-align: -1px"/>).</p>
<p>The algorithm requires the timing offset of the TDC signal from the correlation chopper to run. The timing offset is dependent on the frequency of the chopper and should not change if the frequency has not changed.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id5">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - CorelliCrossCorrelate</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Load a Corelli data file.</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s1">&#39;CORELLI_2100&#39;</span><span class="p">)</span>

<span class="c1"># You will need to load the instrument if the one in the NeXus file doesn&#39;t contain the chopper sequence.</span>
<span class="n">LoadInstrument</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">InstrumentName</span><span class="o">=</span><span class="s1">&#39;CORELLI&#39;</span><span class="p">,</span> <span class="n">RewriteSpectraMap</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Run the cross-correlation. This is using a TDC timing offset of 56000ns.</span>
<span class="n">wsOut</span> <span class="o">=</span> <span class="n">CorelliCrossCorrelate</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="mi">56000</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The detector 172305 has </span><span class="si">{}</span><span class="s1"> events.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">172305</span><span class="p">)</span><span class="o">.</span><span class="n">getNumberEvents</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The event weights before cross-correlation are </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">172305</span><span class="p">)</span><span class="o">.</span><span class="n">getWeights</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The event weights after  cross-correlation are </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsOut</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">172305</span><span class="p">)</span><span class="o">.</span><span class="n">getWeights</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>The detector 172305 has 3 events.
The event weights before cross-correlation are [ 1.  1.  1.]
The event weights after  cross-correlation are [-0.99391854  1.          1.        ]
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Diffraction/Calibration.html">Diffraction\Calibration</a> | <a class="reference external" href="categories/Events.html">Events</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id6">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/4bf80a7e778829043647a0f1f1511c68ec66963d/Framework/Algorithms/inc/MantidAlgorithms/CorelliCrossCorrelate.h">CorelliCrossCorrelate.h</a> <em>(last modified: 2020-03-20)</em></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/4bf80a7e778829043647a0f1f1511c68ec66963d/Framework/Algorithms/src/CorelliCrossCorrelate.cpp">CorelliCrossCorrelate.cpp</a> <em>(last modified: 2020-04-07)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="CopySample-v1.html" title="Previous Chapter: CopySample v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; CopySample v1</span>
    </a>
  </li>
  <li>
    <a href="CorrectKiKf-v1.html" title="Next Chapter: CorrectKiKf v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">CorrectKiKf v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2020-09-29.<br/>
    </p>
  </div>
</footer>
  </body>
</html>