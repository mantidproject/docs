<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>FFTSmooth v2</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FakeISISEventDAE v1" href="FakeISISEventDAE-v1.html" />
    <link rel="prev" title="FFTSmooth v1" href="FFTSmooth-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>5.1</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="fftsmooth-v2">
<span id="algm-fftsmooth"></span><span id="algm-fftsmooth-v2"></span><h1>FFTSmooth v2<a class="headerlink" href="#fftsmooth-v2" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id2">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/FFTSmooth-v2_dlg.png"><img alt="../_images/FFTSmooth-v2_dlg.png" class="screenshot" src="../_images/FFTSmooth-v2_dlg.png" style="width: 285px;" /></a>
<p class="caption"><span class="caption-text"><strong>FFTSmooth</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id3">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id4">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id5">Properties</a></li>
<li><a class="reference internal" href="#description" id="id6">Description</a><ul>
<li><a class="reference internal" href="#zeroing" id="id7">Zeroing</a></li>
<li><a class="reference internal" href="#butterworth" id="id8">Butterworth</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id9">Usage</a></li>
<li><a class="reference internal" href="#id1" id="id10">Usage</a></li>
<li><a class="reference internal" href="#source" id="id11">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id3">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Performs smoothing of a spectrum using various filters.</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id4">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="FFT-v1.html#algm-fft"><span class="std std-ref">FFT</span></a>, <a class="reference internal" href="WienerSmooth-v1.html#algm-wienersmooth"><span class="std std-ref">WienerSmooth</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id5">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="2%" />
<col width="11%" />
<col width="3%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>The name of the input workspace.</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>The name of the output workspace.</td>
</tr>
<tr class="row-even"><td>WorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Workspace index for smoothing</td>
</tr>
<tr class="row-odd"><td>Filter</td>
<td>Input</td>
<td>string</td>
<td>Zeroing</td>
<td>The type of the applied filter. Allowed values: [‘Zeroing’, ‘Butterworth’]</td>
</tr>
<tr class="row-even"><td>Params</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>The filter parameters: For Zeroing, 1 parameter: ‘n’ - an integer greater than 1 meaning that the Fourier coefficients with frequencies outside the 1/n of the original range will be set to zero. For Butterworth, 2 parameters: ‘n’ and ‘order’, giving the 1/n truncation and the smoothing order.</td>
</tr>
<tr class="row-odd"><td>IgnoreXBins</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Ignores the requirement that X bins be linear and of the same size. Set this to true if you are using log binning. The output X axis will be the same as the input either way.</td>
</tr>
<tr class="row-even"><td>AllSpectra</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Smooth all spectra</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id6">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>FFTSmooth uses the FFT algorithm to create a Fourier transform of a
spectrum, applies a filter to it and transforms it back. The filters
remove higher frequencies from the spectrum which reduces the noise.</p>
<p>The second version of the FFTSmooth algorithm has two filters:</p>
<div class="section" id="zeroing">
<h3><a class="toc-backref" href="#id7">Zeroing</a><a class="headerlink" href="#zeroing" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Filter: “Zeroing”</li>
<li>Params: “n” - an integer greater than 1 meaning that the Fourier
coefficients with frequencies outside the 1/n of the original range
will be set to zero.</li>
</ul>
</div>
<div class="section" id="butterworth">
<h3><a class="toc-backref" href="#id8">Butterworth</a><a class="headerlink" href="#butterworth" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Filter: “Butterworth”</p>
</li>
<li><p class="first">Params: A string containing two positive integer parameters separated
by a comma, such as 20,2.</p>
<p>“n”- the first integer, specifies the cutoff frequency for the filter,
in the same way as for the “Zeroing” filter. That is, the cutoff is at
m/n where m is the original range. “n” is required to be strictly more
than 1.</p>
<p>“order”- the second integer, specifies the order of the filter. For low
order values, such as 1 or 2, the Butterworth filter will smooth the
data without the strong “ringing” artifacts produced by the abrupt
cutoff of the “Zeroing” filter. As the order parameter is increased, the
action of the “Butterworth” filter will approach the action of the
“Zeroing” filter.</p>
</li>
</ul>
<p>For both filter types, the resulting spectrum has the same size as the
original one.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id9">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example: Zeroing with Params=2</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="s2">&quot;Multiple Peaks&quot;</span><span class="p">,</span><span class="n">XMax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">BinWidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">BankPixelWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumBanks</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#add a bit of predictable noise</span>
<span class="n">noiseAmp</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">noiseArray</span><span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()):</span>
    <span class="n">noiseAmp</span> <span class="o">=</span> <span class="o">-</span><span class="n">noiseAmp</span>
    <span class="n">noiseArray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">noiseAmp</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()):</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">setY</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">noiseArray</span><span class="p">)</span>


<span class="n">wsSmooth</span> <span class="o">=</span> <span class="n">FFTSmooth</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Params</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bin Orig  Smoothed&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">  </span><span class="si">{:.2f}</span><span class="s2">  </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">i</span><span class="p">],</span> <span class="n">wsSmooth</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
<div class="figure align-right">
<a class="reference internal image-reference" href="../_images/FFTSmoothZeroing.png"><img alt="../_images/FFTSmoothZeroing.png" src="../_images/FFTSmoothZeroing.png" style="height: 280px;" /></a>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>bin Orig  Smoothed
0  0.20  0.30
10  0.20  0.30
20  0.37  0.47
30  10.20  10.30
40  0.37  0.47
50  0.20  0.30
60  8.20  8.30
70  0.20  0.30
80  0.20  0.30
90  0.20  0.30
</pre></div>
</div>
<p><strong>Example: Using the  Butterworth filter</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="s2">&quot;Multiple Peaks&quot;</span><span class="p">,</span><span class="n">XMax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">BinWidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">BankPixelWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumBanks</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1">#add a bit of predictable noise</span>
<span class="n">noiseAmp</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">noiseArray</span><span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()):</span>
    <span class="n">noiseAmp</span> <span class="o">=</span> <span class="o">-</span><span class="n">noiseAmp</span>
    <span class="n">noiseArray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">noiseAmp</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()):</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">setY</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">noiseArray</span><span class="p">)</span>


<span class="n">wsButter2_2</span> <span class="o">=</span> <span class="n">FFTSmooth</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="s2">&quot;Butterworth&quot;</span><span class="p">,</span> <span class="n">Params</span><span class="o">=</span><span class="s1">&#39;2,2&#39;</span><span class="p">,</span> <span class="n">AllSpectra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">wsButter5_2</span> <span class="o">=</span> <span class="n">FFTSmooth</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="s2">&quot;Butterworth&quot;</span><span class="p">,</span> <span class="n">Params</span><span class="o">=</span><span class="s1">&#39;5,2&#39;</span><span class="p">,</span> <span class="n">AllSpectra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">wsButter20_2</span> <span class="o">=</span> <span class="n">FFTSmooth</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="s2">&quot;Butterworth&quot;</span><span class="p">,</span> <span class="n">Params</span><span class="o">=</span><span class="s1">&#39;20,2&#39;</span><span class="p">,</span> <span class="n">AllSpectra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bin Orig  2_2   5_2   20_2&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">  </span><span class="si">{:.2f}</span><span class="s2">  </span><span class="si">{:.2f}</span><span class="s2">  </span><span class="si">{:.2f}</span><span class="s2">  </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">i</span><span class="p">],</span> <span class="n">wsButter2_2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">i</span><span class="p">],</span> <span class="n">wsButter5_2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">i</span><span class="p">],</span> <span class="n">wsButter20_2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
<div class="figure align-right">
<a class="reference internal image-reference" href="../_images/FFTSmoothZeroingButter.png"><img alt="../_images/FFTSmoothZeroingButter.png" src="../_images/FFTSmoothZeroingButter.png" style="height: 280px;" /></a>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>bin Orig  2_2   5_2   20_2
0  0.20  0.29  0.30  -0.05
10  0.20  0.29  0.30  0.44
20  0.37  0.46  0.43  2.49
30  10.20  10.26  9.59  4.58
40  0.37  0.46  0.43  2.63
50  0.20  0.29  0.16  1.77
60  8.20  8.20  7.05  2.74
70  0.20  0.29  0.16  1.48
80  0.20  0.29  0.30  0.39
90  0.20  0.29  0.30  0.20
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id10">Usage</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Create a workspace</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>

<span class="c1"># Apply the Butterworth filter to all spectra</span>
<span class="n">smooth</span> <span class="o">=</span> <span class="n">FFTSmooth</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="s1">&#39;Butterworth&#39;</span><span class="p">,</span> <span class="n">Params</span><span class="o">=</span><span class="s1">&#39;5,2&#39;</span><span class="p">,</span> <span class="n">AllSpectra</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Arithmetic/FFT.html">Arithmetic\FFT</a> | <a class="reference external" href="categories/Transforms/Smoothing.html">Transforms\Smoothing</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id11">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/4bf80a7e778829043647a0f1f1511c68ec66963d/Framework/Algorithms/inc/MantidAlgorithms/FFTSmooth2.h">FFTSmooth2.h</a> <em>(last modified: 2020-03-20)</em></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/4bf80a7e778829043647a0f1f1511c68ec66963d/Framework/Algorithms/src/FFTSmooth2.cpp">FFTSmooth2.cpp</a> <em>(last modified: 2020-04-07)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="FFTSmooth-v1.html" title="Previous Chapter: FFTSmooth v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; FFTSmooth v1</span>
    </a>
  </li>
  <li>
    <a href="FakeISISEventDAE-v1.html" title="Next Chapter: FakeISISEventDAE v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">FakeISISEventDAE v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2020-09-29.<br/>
    </p>
  </div>
</footer>
  </body>
</html>