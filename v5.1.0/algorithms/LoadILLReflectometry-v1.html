<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>LoadILLReflectometry v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LoadILLSANS v1" href="LoadILLSANS-v1.html" />
    <link rel="prev" title="LoadILLPolarizedDiffraction v1" href="LoadILLPolarizedDiffraction-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>5.1</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="loadillreflectometry-v1">
<span id="algm-loadillreflectometry"></span><span id="algm-loadillreflectometry-v1"></span><h1>LoadILLReflectometry v1<a class="headerlink" href="#loadillreflectometry-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/LoadILLReflectometry-v1_dlg.png"><img alt="../_images/LoadILLReflectometry-v1_dlg.png" class="screenshot" src="../_images/LoadILLReflectometry-v1_dlg.png" style="width: 332px;" /></a>
<p class="caption"><span class="caption-text"><strong>LoadILLReflectometry</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a></li>
<li><a class="reference internal" href="#time-of-flight-axis" id="id6">Time of flight axis</a></li>
<li><a class="reference internal" href="#measurement" id="id7">Measurement</a></li>
<li><a class="reference internal" href="#usage" id="id8">Usage</a></li>
<li><a class="reference internal" href="#source" id="id9">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Loads an ILL reflectometry Nexus file (instrument D17 or FIGARO).</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="LoadNexus-v1.html#algm-loadnexus"><span class="std std-ref">LoadNexus</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="3%" />
<col width="19%" />
<col width="6%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Filename</td>
<td>Input</td>
<td>string</td>
<td><em>Mandatory</em></td>
<td>Name of the Nexus file to load. Allowed extensions: [‘.nxs’]</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>Name of the output workspace</td>
</tr>
<tr class="row-even"><td>ForegroundPeakCentre</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>Foreground peak position in fractional workspace index (if not given the peak is searched for and fitted).</td>
</tr>
<tr class="row-odd"><td>DetectorCentreFractionalIndex</td>
<td>Input</td>
<td>number</td>
<td>127.5</td>
<td>The fractional workspace index of the geometric centre of the detector at incident beam axis (127.5 for D17 and Figaro).</td>
</tr>
<tr class="row-even"><td>Measurement</td>
<td>Input</td>
<td>string</td>
<td>DirectBeam</td>
<td>Load as direct or reflected beam. Allowed values: [‘DirectBeam’, ‘ReflectedBeam’]</td>
</tr>
<tr class="row-odd"><td>BraggAngle</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>The bragg angle necessary for reflected beam.</td>
</tr>
<tr class="row-even"><td>FitStartWorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Start workspace index used for peak fitting.</td>
</tr>
<tr class="row-odd"><td>FitEndWorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td>255</td>
<td>End workspace index used for peak fitting.</td>
</tr>
<tr class="row-even"><td>FitRangeLower</td>
<td>Input</td>
<td>number</td>
<td>-1</td>
<td>Minimum wavelength used for peak fitting.</td>
</tr>
<tr class="row-odd"><td>FitRangeUpper</td>
<td>Input</td>
<td>number</td>
<td>-1</td>
<td>Maximum wavelength used for peak fitting.</td>
</tr>
<tr class="row-even"><td>XUnit</td>
<td>Input</td>
<td>string</td>
<td>Wavelength</td>
<td>X unit of the OutputWorkspace. Allowed values: [‘Wavelength’, ‘TimeOfFlight’]</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Loads data of a Nexus file obtained from an ILL reflectometry instrument <a class="reference external" href="https://www.ill.eu/instruments-support/instruments-groups/instruments/d17/description/instrument-layout/">D17</a> or <a class="reference external" href="https://www.ill.eu/instruments-support/instruments-groups/instruments/figaro/description/instrument-layout/">FIGARO</a> into a <a class="reference external" href="http://www.mantidproject.org/Workspace2D">Workspace2D</a>.
Both time-of-flight and monochromatic instrument configurations are supported.
In general, this loader reads detector and monitor counts and adds x-axis and error values.
The output workspace contains histogram data.
The x-axis can have units in time-of-flight or wavelength with non-varying and varying bins, respectively.
The conversion to wavelength uses the algorithm <a class="reference internal" href="ConvertUnits-v1.html#algm-convertunits"><span class="std std-ref">ConvertUnits v1</span></a>.
Detector indices and spectrum numbers start with zero like workspace indices.</p>
</div>
<div class="section" id="time-of-flight-axis">
<h2><a class="toc-backref" href="#id6">Time of flight axis</a><a class="headerlink" href="#time-of-flight-axis" title="Permalink to this headline">¶</a></h2>
<p>The chopper values are used for computing the time-of-flight values for the bin edges <img class="math" src="../_images/math/c2f01810eef41c68678f5efa3d9ca634ff6785da.png" alt="x_i" style="vertical-align: -3px"/> by the following equation:</p>
<div class="math">
<p><img src="../_images/math/02f1104166abc9accfd8e393a9d01f47c95e00a6.png" alt="x_{i} = \left( i + 0.5 \right) w_{\mathrm{channel}} + \Delta_{t, \mathrm{tof}} -  60^{\circ} \cdot \frac{ p_{\mathrm{off}} - 45^{\circ} + \Omega_{c2} - \Omega_{c1} + \Delta_{\mathrm{open}} }{ 2 \cdot 360^{\circ} \cdot v_{c1} } \cdot 10^{6},"/></p>
</div><p>with the following variables: channel width <img class="math" src="../_images/math/81607fa58e8c52f8cb645b37d26436c1ad78e867.png" alt="w_{\mathrm{channel}}" style="vertical-align: -4px"/>, time-of-flight delay <img class="math" src="../_images/math/2b3ae7cc9d6b8fda645afa71a1f23c57b3860b26.png" alt="\Delta_{t, \mathrm{tof}}" style="vertical-align: -6px"/>, offset <img class="math" src="../_images/math/0786332075672b815072940746f37437422c62bb.png" alt="p_{\mathrm{off}}" style="vertical-align: -4px"/>, phase of second chopper <img class="math" src="../_images/math/7f8b2012eebf6e5d56c278c4bbcd5457db8240d7.png" alt="\Omega_{c2}" style="vertical-align: -3px"/>, phase of first chopper <img class="math" src="../_images/math/9736da405fac291e793f287eb55af9b176c90108.png" alt="\Omega_{c1}" style="vertical-align: -4px"/>, open offset <img class="math" src="../_images/math/67e9fd54514c4b05a241261cb6aec28100f87f73.png" alt="\Delta_{\mathrm{open}}" style="vertical-align: -6px"/> and velocity of first chopper <img class="math" src="../_images/math/c7db1b84cfaf36cf208ef7f32e81ca113a8eff66.png" alt="v_{c1}" style="vertical-align: -4px"/>.</p>
</div>
<div class="section" id="measurement">
<h2><a class="toc-backref" href="#id7">Measurement</a><a class="headerlink" href="#measurement" title="Permalink to this headline">¶</a></h2>
<p>The loader can load both types of data: direct and reflected beam.
In both cases the foreground centre will be fitted.
In case of direct beam, the detector will be rotated around the sample such that the fractional workspace index of the foreground centre will appear at 0 scattering angle.
In case of reflected beam, <strong>BraggAngle</strong> is mandatory, and the detector will be driven such that the foreground centre will appear at <strong>2*BraggAngle</strong>.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id8">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path. In Mantid this is done using <a class="reference external" href="http://www.mantidproject.org/ManageUserDirectories">Manage User Directories</a>.</p>
</div>
<p><strong>Example - ReflectedBeam:</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="c1"># Load ILL d17 data file (TOF mode) into a workspace 2D using a user-defined angle of 5.5 degrees:</span>
<span class="n">ws2</span> <span class="o">=</span> <span class="n">LoadILLReflectometry</span><span class="p">(</span><span class="s1">&#39;ILL/D17/317370.nxs&#39;</span><span class="p">,</span> <span class="n">Measurement</span><span class="o">=</span><span class="s1">&#39;ReflectedBeam&#39;</span><span class="p">,</span> <span class="n">BraggAngle</span><span class="o">=</span><span class="mf">5.5</span><span class="p">)</span>
<span class="n">detId</span> <span class="o">=</span> <span class="mi">202</span> <span class="c1"># the foreground centre is around 202</span>
<span class="n">det</span> <span class="o">=</span> <span class="n">ws2</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="n">detId</span><span class="p">)</span>
<span class="n">angleDet</span> <span class="o">=</span> <span class="n">ws2</span><span class="o">.</span><span class="n">detectorTwoTheta</span><span class="p">(</span><span class="n">det</span><span class="p">)</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">180</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pixel at detector ID </span><span class="si">{}</span><span class="s2"> was rotated to </span><span class="si">{:.1f}</span><span class="s2"> degrees.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">detId</span><span class="p">,</span> <span class="n">angleDet</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Pixel at detector ID 202 was rotated to 11.0 degrees.
</pre></div>
</div>
<p><strong>Example - Direct Beam</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">directBeamWS</span> <span class="o">=</span> <span class="n">LoadILLReflectometry</span><span class="p">(</span><span class="s1">&#39;ILL/D17/317369.nxs&#39;</span><span class="p">)</span>
<span class="n">detId</span> <span class="o">=</span> <span class="mi">202</span> <span class="c1"># the foreground centre is around 202</span>
<span class="n">det</span> <span class="o">=</span> <span class="n">directBeamWS</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="n">detId</span><span class="p">)</span>
<span class="n">angleDet</span> <span class="o">=</span> <span class="n">directBeamWS</span><span class="o">.</span><span class="n">detectorTwoTheta</span><span class="p">(</span><span class="n">det</span><span class="p">)</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">180</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pixel at detector ID </span><span class="si">{}</span><span class="s2"> was rotated to </span><span class="si">{:.1f}</span><span class="s2"> degrees.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">detId</span><span class="p">,</span> <span class="n">angleDet</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Pixel at detector ID 202 was rotated to 0.0 degrees.
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/DataHandling/Nexus.html">DataHandling\Nexus</a> | <a class="reference external" href="categories/ILL/Reflectometry.html">ILL\Reflectometry</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id9">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/4bf80a7e778829043647a0f1f1511c68ec66963d/Framework/DataHandling/inc/MantidDataHandling/LoadILLReflectometry.h">LoadILLReflectometry.h</a> <em>(last modified: 2020-09-16)</em></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/4bf80a7e778829043647a0f1f1511c68ec66963d/Framework/DataHandling/src/LoadILLReflectometry.cpp">LoadILLReflectometry.cpp</a> <em>(last modified: 2020-09-16)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="LoadILLPolarizedDiffraction-v1.html" title="Previous Chapter: LoadILLPolarizedDiffraction v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; LoadILLPolari...</span>
    </a>
  </li>
  <li>
    <a href="LoadILLSANS-v1.html" title="Next Chapter: LoadILLSANS v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">LoadILLSANS v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2020-09-29.<br/>
    </p>
  </div>
</footer>
  </body>
</html>