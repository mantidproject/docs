<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>DetectorDiagnostic v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.6.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="DetectorEfficiencyCor v1" href="DetectorEfficiencyCor-v1.html" />
    <link rel="prev" title="DeleteWorkspace v1" href="DeleteWorkspace-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.6</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="detectordiagnostic-v1">
<span id="algm-detectordiagnostic"></span><span id="algm-detectordiagnostic-v1"></span><h1>DetectorDiagnostic v1<a class="headerlink" href="#detectordiagnostic-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/DetectorDiagnostic-v1_dlg.png"><img alt="../_images/DetectorDiagnostic-v1_dlg.png" class="screenshot" src="../_images/DetectorDiagnostic-v1_dlg.png" style="width: 264px;" /></a>
<p class="caption"><strong>DetectorDiagnostic</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a><ul>
<li><a class="reference internal" href="#workflow" id="id4">Workflow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#source" id="id5">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Identifies histograms and their detectors that have total numbers of counts over a user defined maximum or less than the user define minimum.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="3%" />
<col width="16%" />
<col width="5%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Name of the integrated detector vanadium (white beam) workspace.</td>
</tr>
<tr class="row-odd"><td>HardMaskWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td>&nbsp;</td>
<td>A hard mask to apply to the inputworkspace</td>
</tr>
<tr class="row-even"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>A MaskWorkspace containing the masked spectra as zeroes and ones.</td>
</tr>
<tr class="row-odd"><td>StartWorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>The index number of the first spectrum to include in the calculation (default 0)</td>
</tr>
<tr class="row-even"><td>EndWorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>The index number of the last spectrum to include in the calculation (default the last histogram)</td>
</tr>
<tr class="row-odd"><td>RangeLower</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>No bin with a boundary at an x value less than this will be used in the summation that decides if a detector is &#8216;bad&#8217; (default: the start of each histogram)</td>
</tr>
<tr class="row-even"><td>RangeUpper</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>No bin with a boundary at an x value higher than this value will be used in the summation that decides if a detector is &#8216;bad&#8217; (default: the end of each histogram)</td>
</tr>
<tr class="row-odd"><td>LowThreshold</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Spectra whose total number of counts are equal to or below this value will be marked bad (default 0)</td>
</tr>
<tr class="row-even"><td>HighThreshold</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>Spectra whose total number of counts are equal to or above this value will be marked bad (default off)</td>
</tr>
<tr class="row-odd"><td>LevelsUp</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Levels above pixel that will be used to compute the median. If no level is specified, or 0, the median is over the whole instrument.</td>
</tr>
<tr class="row-even"><td>SignificanceTest</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Error criterion as a multiple of error bar i.e. to fail the test, the magnitude of the difference with respect to the median value must also exceed this number of error bars</td>
</tr>
<tr class="row-odd"><td>LowThresholdFraction</td>
<td>Input</td>
<td>number</td>
<td>0.1</td>
<td>Lower acceptable bound as fraction of median value</td>
</tr>
<tr class="row-even"><td>HighThresholdFraction</td>
<td>Input</td>
<td>number</td>
<td>1.5</td>
<td>Upper acceptable bound as fraction of median value</td>
</tr>
<tr class="row-odd"><td>LowOutlier</td>
<td>Input</td>
<td>number</td>
<td>0.01</td>
<td>Lower bound defining outliers as fraction of median value</td>
</tr>
<tr class="row-even"><td>HighOutlier</td>
<td>Input</td>
<td>number</td>
<td>100</td>
<td>Upper bound defining outliers as fraction of median value</td>
</tr>
<tr class="row-odd"><td>CorrectForSolidAngle</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Flag to correct for solid angle efficiency. False by default.</td>
</tr>
<tr class="row-even"><td>ExcludeZeroesFromMedian</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>If false (default) zeroes will be included in the median calculation, otherwise they will not be included but they will be left unmasked</td>
</tr>
<tr class="row-odd"><td>DetVanCompare</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td>&nbsp;</td>
<td>Name of a matching second detector vanadium run from the same instrument. It must be treated in the same manner as the input detector vanadium.</td>
</tr>
<tr class="row-even"><td>DetVanRatioVariation</td>
<td>Input</td>
<td>number</td>
<td>1.1</td>
<td>Identify spectra whose total number of counts has changed by more than this factor of the median change between the two input workspaces</td>
</tr>
<tr class="row-odd"><td>SampleTotalCountsWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td>&nbsp;</td>
<td>A sample workspace integrated over the full axis range.</td>
</tr>
<tr class="row-even"><td>SampleBackgroundWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td>&nbsp;</td>
<td>A sample workspace integrated over the background region.</td>
</tr>
<tr class="row-odd"><td>SampleBkgLowAcceptanceFactor</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Low threshold for the background check MedianDetectorTest.</td>
</tr>
<tr class="row-even"><td>SampleBkgHighAcceptanceFactor</td>
<td>Input</td>
<td>number</td>
<td>5</td>
<td>High threshold for the background check MedianDetectorTest.</td>
</tr>
<tr class="row-odd"><td>SampleBkgSignificanceTest</td>
<td>Input</td>
<td>number</td>
<td>3.3</td>
<td>Error criterion as a multiple of error bar i.e. to fail the test, the magnitude of the difference with respect to the median value must also exceed this number of error bars</td>
</tr>
<tr class="row-even"><td>SampleCorrectForSolidAngle</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Flag to correct for solid angle efficiency for background check MedianDetectorTest. False by default.</td>
</tr>
<tr class="row-odd"><td>SampleWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td>&nbsp;</td>
<td>A sample workspace. This is used in the PSD Bleed calculation.</td>
</tr>
<tr class="row-even"><td>MaxTubeFramerate</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>The maximum rate allowed for a tube in counts/us/frame.</td>
</tr>
<tr class="row-odd"><td>NIgnoredCentralPixels</td>
<td>Input</td>
<td>number</td>
<td>80</td>
<td>The number of pixels about the centre to ignore.</td>
</tr>
<tr class="row-even"><td>NumberOfFailures</td>
<td>Output</td>
<td>number</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm is a C++ replacement for the Python diagnostics.diagnose
function located in the scripts/inelastic directory. The algorithm
expects processed workspaces as input just as the other function did.
The main functionality of the algorithm is to determine issues with
detector vanadium runs and mask out bad pixels. The algorithms that are
run on the detector vanadium are <a class="reference internal" href="FindDetectorsOutsideLimits-v1.html#algm-finddetectorsoutsidelimits"><em>FindDetectorsOutsideLimits v1</em></a> and
<a class="reference internal" href="MedianDetectorTest-v1.html#algm-mediandetectortest"><em>MedianDetectorTest v1</em></a>. It also performs a second set of diagnostics on
another detector vanadium run and <a class="reference internal" href="DetectorEfficiencyVariation-v1.html#algm-detectorefficiencyvariation"><em>DetectorEfficiencyVariation v1</em></a> on the
two. The algorithm also checks processed sample workspaces (total counts
and background) for bad pixels as well. The total counts workspace is
tested with <a class="reference internal" href="FindDetectorsOutsideLimits-v1.html#algm-finddetectorsoutsidelimits"><em>FindDetectorsOutsideLimits v1</em></a>. The background workspace is run
through <a class="reference internal" href="MedianDetectorTest-v1.html#algm-mediandetectortest"><em>MedianDetectorTest v1</em></a>. A processed sample workspace can be given
to perform and <a class="reference internal" href="CreatePSDBleedMask-v1.html#algm-createpsdbleedmask"><em>CreatePSDBleedMask v1</em></a> will be run on it.</p>
<div class="section" id="workflow">
<h3><a class="toc-backref" href="#id4">Workflow</a><a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h3>
<p>Parameters for the child algorithms are not shown due to the sheer number.
They are passed onto child algorithms that under the same name, except</p>
<ul class="simple">
<li>LowThreshold and HighThresold are not passed onto <a class="reference internal" href="FindDetectorsOutsideLimits-v1.html#algm-finddetectorsoutsidelimits"><em>FindDetectorsOutsideLimits v1</em></a>, but are set as 1.0e-10 and 1.0e100 respectively.</li>
<li>LowOutLier, HighOutlier and ExcludeZeroesFromMedian are not passed onto <a class="reference internal" href="MedianDetectorTest-v1.html#algm-mediandetectortest"><em>MedianDetectorTest v1</em></a>, but are set as 0.0, 1.0e100 and true respectively.</li>
<li>DetVanRatioVariation is passed onto <a class="reference internal" href="DetectorEfficiencyVariation-v1.html#algm-detectorefficiencyvariation"><em>DetectorEfficiencyVariation v1</em></a> as Variation.</li>
<li>SampleBkgLowAcceptanceFactor, SampleBkgHighAcceptanceFactor, SampleBkgSignificanceTest and SampleCorrectForSolidAngle are passed onto <a class="reference internal" href="MedianDetectorTest-v1.html#algm-mediandetectortest"><em>MedianDetectorTest v1</em></a> as LowThreshold, HighThreshold, SignicanceTest and CorrectForSolidAngle respectively.</li>
</ul>
<p>Numerous uses of <a class="reference internal" href="MaskDetectors-v1.html#algm-maskdetectors"><em>MaskDetectors v1</em></a> are not shown and can be taken be be executed whenever appropriate.
Also the output property NumberOfFailures from the executed child algorithms are added together
to form the NumberOfFailures output by the main algorithm.</p>
<img alt="../_images/DetectorDiagnostic-v1_wkflw.png" src="../_images/DetectorDiagnostic-v1_wkflw.png" />
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Diagnostics.html">Diagnostics</a> | <a class="reference external" href="categories/Workflow/Diagnostics.html">Workflow\Diagnostics</a></p>
</div>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id5">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/939e6b7103a9dafe3e7e23581d47d06fd4669ecd/Framework/Algorithms/src/DetectorDiagnostic.cpp">DetectorDiagnostic.cpp</a></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/939e6b7103a9dafe3e7e23581d47d06fd4669ecd/Framework/Algorithms/inc/MantidAlgorithms/DetectorDiagnostic.h">DetectorDiagnostic.h</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="DeleteWorkspace-v1.html" title="Previous Chapter: DeleteWorkspace v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; DeleteWorkspace ...</span>
    </a>
  </li>
  <li>
    <a href="DetectorEfficiencyCor-v1.html" title="Next Chapter: DetectorEfficiencyCor v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">DetectorEfficien... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>