<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>WienerSmooth v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.6.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="XorMD v1" href="XorMD-v1.html" />
    <link rel="prev" title="WeightedMeanOfWorkspace v1" href="WeightedMeanOfWorkspace-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.6</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="wienersmooth-v1">
<span id="algm-wienersmooth"></span><span id="algm-wienersmooth-v1"></span><h1>WienerSmooth v1<a class="headerlink" href="#wienersmooth-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/WienerSmooth-v1_dlg.png"><img alt="../_images/WienerSmooth-v1_dlg.png" class="screenshot" src="../_images/WienerSmooth-v1_dlg.png" style="width: 399px;" /></a>
<p class="caption"><strong>WienerSmooth</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#usage" id="id4">Usage</a></li>
<li><a class="reference internal" href="#source" id="id5">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Smooth spectra using Wiener filter.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="5%" />
<col width="27%" />
<col width="8%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>An input workspace.</td>
</tr>
<tr class="row-odd"><td>WorkspaceIndexList</td>
<td>Input</td>
<td>int list</td>
<td>&nbsp;</td>
<td>Workspace indices for spectra to process. If empty smooth all spectra.</td>
</tr>
<tr class="row-even"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>An output workspace.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm smooths the data in a workspace using the Wiener filter method.
The fiter is a function which if convolved with an input minimizes the noise in the output.</p>
<div class="math">
<p><img src="../_images/math/9fe0d6fffd5aa13da817a7e8ec0dde567f7d1be8.png" alt="s_o(t) = \int_{-\infty}^\infty s_i(\tau) w(t-\tau) d\tau"/></p>
</div><p>For more detail see Wikipedia article <a class="reference external" href="http://en.wikipedia.org/wiki/Wiener_filter">http://en.wikipedia.org/wiki/Wiener_filter</a>.</p>
<p>WienerSmooth uses the power spectrum of the input signal <img class="math" src="../_images/math/0e4f2adbaa7818857e80844a28cf835b5c73b2d1.png" alt="s_i" style="vertical-align: -3px"/> to build the filter
<img class="math" src="../_images/math/eb4f9d72c2b551d80b058419512462f43a452f8d.png" alt="W(\nu)=\int_{-\infty}^\infty w(t)e^{-2\pi it\nu} dt" style="vertical-align: -6px"/></p>
<p>First the noise level is estimated from the higher frequencies of the power spectrum.
Then the fiter function is constructed out of three pieces. Ther first piece is at the
lower frequencies where the power spectrum is well above the noise. At this region the
the filter function is calculated with the formula:</p>
<div class="math">
<p><img src="../_images/math/dfc521684a1d6ebedb33eac4383937d20e2481df.png" alt="W(\nu) = \frac{1}{1+N/P(\nu)},"/></p>
</div><p>where <img class="math" src="../_images/math/96c4ea291d9319696ce7ce2bbcfa58d0f4ff0d1c.png" alt="P(\nu)" style="vertical-align: -4px"/> is the power spectrum and <img class="math" src="../_images/math/8c45b38d633fb6de83fc7087c4db116a5565752a.png" alt="N" style="vertical-align: 0px"/> is the noise. The higher the
power spectrum the closer the filter function to 1.</p>
<p>At the medium frequency range where the power spectrum is getting closer to the noise
the filter is described with a piece of a sigmoid decreasing to about the noise level.
After that all values are set to zero.</p>
<p>In this example the black curve is the input data and the red one is the result of smoothing.</p>
<div class="figure">
<img alt="../_images/WienerSmooth.png" src="../_images/WienerSmooth.png" />
</div>
<p>The image below shows the Wiener filter function used (red) along with the power spectrum of the data
(black).</p>
<div class="figure">
<img alt="../_images/WienerSmoothFilter.png" src="../_images/WienerSmoothFilter.png" />
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id4">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - Smooth noisy data</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c"># Define a function</span>
<span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">/</span><span class="mi">10</span>

<span class="c"># Create a workspace with noisy data.</span>

<span class="c"># Size of the data set</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">200</span>

<span class="c"># Define the x-values</span>
<span class="n">interval</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>

<span class="c"># Define the y-values as a function fun(x) + random noise</span>
<span class="n">noise</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>  <span class="n">random</span><span class="o">.</span><span class="n">normalvariate</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">noise</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>

<span class="c"># Create a workspace</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="c"># Smooth the data using the Wiener filter</span>
<span class="n">smooth</span> <span class="o">=</span> <span class="n">WienerSmooth</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Arithmetic/FFT.html">Arithmetic\FFT</a> | <a class="reference external" href="categories/Transforms/Smoothing.html">Transforms\Smoothing</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id5">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/939e6b7103a9dafe3e7e23581d47d06fd4669ecd/Framework/Algorithms/src/WienerSmooth.cpp">WienerSmooth.cpp</a></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/939e6b7103a9dafe3e7e23581d47d06fd4669ecd/Framework/Algorithms/inc/MantidAlgorithms/WienerSmooth.h">WienerSmooth.h</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="WeightedMeanOfWorkspace-v1.html" title="Previous Chapter: WeightedMeanOfWorkspace v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; WeightedMeanOfWo...</span>
    </a>
  </li>
  <li>
    <a href="XorMD-v1.html" title="Next Chapter: XorMD v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">XorMD v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>