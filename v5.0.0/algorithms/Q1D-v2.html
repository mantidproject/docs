<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Q1D v2</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Q1DWeighted v1" href="Q1DWeighted-v1.html" />
    <link rel="prev" title="ProjectMD v1" href="ProjectMD-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>5.0</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="q1d-v2">
<span id="algm-q1d"></span><span id="algm-q1d-v2"></span><h1>Q1D v2<a class="headerlink" href="#q1d-v2" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id2">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/Q1D-v2_dlg.png"><img alt="../_images/Q1D-v2_dlg.png" class="screenshot" src="../_images/Q1D-v2_dlg.png" style="width: 314px;" /></a>
<p class="caption"><span class="caption-text"><strong>Q1D</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id3">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id4">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id5">Properties</a></li>
<li><a class="reference internal" href="#description" id="id6">Description</a><ul>
<li><a class="reference internal" href="#output-unit" id="id7">Output unit</a></li>
<li><a class="reference internal" href="#q-unit-conversion" id="id8">Q Unit Conversion</a></li>
<li><a class="reference internal" href="#normalizing-the-input-workspace" id="id9">Normalizing the input workspace</a></li>
<li><a class="reference internal" href="#resolution-and-cutoffs" id="id10">Resolution and Cutoffs</a></li>
<li><a class="reference internal" href="#examples" id="id11">Examples</a></li>
<li><a class="reference internal" href="#variations-on-applying-the-normalization" id="id12">Variations on applying the normalization</a></li>
<li><a class="reference internal" href="#references" id="id13">References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#previous-versions" id="id14">Previous Versions</a><ul>
<li><a class="reference internal" href="#version-1" id="id15">Version 1</a></li>
<li><a class="reference internal" href="#id1" id="id16">Properties</a></li>
</ul>
</li>
<li><a class="reference internal" href="#source" id="id17">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id3">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>SANS 1D reduction. Converts a workspace in wavelength into a workspace of momentum transfer, assuming elastic scattering</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id4">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="Q1DWeighted-v1.html#algm-q1dweighted"><span class="std std-ref">Q1DWeighted</span></a>, <a class="reference internal" href="Qxy-v1.html#algm-qxy"><span class="std std-ref">Qxy</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id5">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="2%" />
<col width="12%" />
<col width="3%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>DetBankWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>Particle counts as a function of wavelength</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>Name of the workspace that will contain the result of the calculation</td>
</tr>
<tr class="row-even"><td>OutputBinning</td>
<td>Input</td>
<td>dbl list</td>
<td><em>Mandatory</em></td>
<td>A comma separated list of first bin boundary, width, last bin boundary. Optionally this can be followed by a comma and more widths and last boundary pairs. Negative width values indicate logarithmic binning.</td>
</tr>
<tr class="row-odd"><td>PixelAdj</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td>&#160;</td>
<td>Scaling to apply to each spectrum. Must have the same number of spectra as the DetBankWorkspace</td>
</tr>
<tr class="row-even"><td>WavelengthAdj</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td>&#160;</td>
<td>Scaling to apply to each bin. Must have the same number of bins as the DetBankWorkspace</td>
</tr>
<tr class="row-odd"><td>WavePixelAdj</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td>&#160;</td>
<td>Scaling that depends on both pixel and wavelength together. Must have the same number of bins and spectra as the DetBankWorkspace.</td>
</tr>
<tr class="row-even"><td>AccountForGravity</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether to correct for the effects of gravity</td>
</tr>
<tr class="row-odd"><td>SolidAngleWeighting</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>If true, pixels will be weighted by their solid angle.</td>
</tr>
<tr class="row-even"><td>RadiusCut</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>To increase resolution some wavelengths are excluded within this distance from the beam center (mm). Note that RadiusCut  and WaveCut both need to be larger than 0 to affect  the effective cutoff. See the algorithm description for  a detailed explanation of the cutoff.</td>
</tr>
<tr class="row-odd"><td>WaveCut</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>To increase resolution by starting to remove some wavelengths below this threshold (angstrom).  Note that WaveCut  and RadiusCut both need to be larger than 0 to affect  on the effective cutoff. See the algorithm description for  a detailed explanation of the cutoff.</td>
</tr>
<tr class="row-even"><td>OutputParts</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Set to true to output two additional workspaces which will have the names OutputWorkspace_sumOfCounts OutputWorkspace_sumOfNormFactors. The division of _sumOfCounts and _sumOfNormFactors equals the workspace returned by the property OutputWorkspace (default is false).</td>
</tr>
<tr class="row-odd"><td>ExtraLength</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Additional length for gravity correction.</td>
</tr>
<tr class="row-even"><td>QResolution</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td>&#160;</td>
<td>Workspace to calculate the Q resolution.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id6">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<div class="section" id="output-unit">
<h3><a class="toc-backref" href="#id7">Output unit</a><a class="headerlink" href="#output-unit" title="Permalink to this headline">¶</a></h3>
<p>The unit of the output workspace is 1/cm. Assuming this algorithm is called with
the appropriate input correction workspaces, include accounting for absolute
scaling, the output is meant to represent a macroscopic cross section, hence the
reason the output unit is 1/cm.</p>
</div>
<div class="section" id="q-unit-conversion">
<h3><a class="toc-backref" href="#id8">Q Unit Conversion</a><a class="headerlink" href="#q-unit-conversion" title="Permalink to this headline">¶</a></h3>
<p>Section includes explanation for the effect of setting AccountForGravity to true.</p>
<p>The equation for <img class="math" src="../_images/math/f59dd7fde255c3f2d4d4d2f0631914aa7604d031.png" alt="Q" style="vertical-align: -4px"/> as a function of wavelength, <img class="math" src="../_images/math/412c0294db757d8807fe8fc2975ab586bb9042d8.png" alt="\lambda" style="vertical-align: 0px"/>,
and neglecting gravity, is</p>
<div class="math">
<p><img src="../_images/math/68c96d0b76674cd62a21e9ab4d51d5b43d42d5ef.png" alt="Q = \frac{4\pi}{\lambda} sin(\theta)"/></p>
</div><p>where <img class="math" src="../_images/math/504b0e6af53e29a0871abe88050d1fd72f5c833e.png" alt="2 \theta" style="vertical-align: 0px"/> is the particle’s angle of deflection. If a
particle’s measured deflection over the sample to the detector (pixel)
distance, <img class="math" src="../_images/math/759f02400705d52108cf148140feb3d28d9ba7fa.png" alt="L_2" style="vertical-align: -3px"/>, is <img class="math" src="../_images/math/86e784d473f5fc5713b6ad4bea7af624b76966c2.png" alt="x" style="vertical-align: 0px"/> along the x-axis and <img class="math" src="../_images/math/95ca3c6a1fbeaaafe5800c3269c4c9c2cf2e5406.png" alt="y" style="vertical-align: -4px"/> along
the y-axis then <img class="math" src="../_images/math/1a9b85a9218a3358278a57e3f68189b5176af0fc.png" alt="\theta" style="vertical-align: 0px"/> is</p>
<div class="math">
<p><img src="../_images/math/4202df8f6bb59e2bcfb429e8da25786280a8067c.png" alt="\theta = \frac{1}{2} arcsin\left (\frac{\sqrt{x^2+y^2}}{L_2} \right )"/></p>
</div><p>Including gravity adds another term to this equation which becomes:</p>
<div class="math">
<p><img src="../_images/math/4f8d1c371596b056448d2dc014299eb31ae6c32b.png" alt="\theta = \frac{1}{2} arcsin\left (\frac{ \sqrt{x^2+\left (y+\frac{gm^2}{2h^2} \lambda^2 L_2^2 \right)^2}}{L_2} \right )"/></p>
</div><p>where <img class="math" src="../_images/math/47e031122c1df8bef662b93f6a2c0751959a98d1.png" alt="m" style="vertical-align: 0px"/> is the particle’s mass, <img class="math" src="../_images/math/7795702d988f40729f46dbf781ece35f9a9bd1f2.png" alt="g" style="vertical-align: -4px"/> is the acceleration
due to gravity and <img class="math" src="../_images/math/9cd0d4269389ccc2c3fc96c538e266229f00bd9f.png" alt="h" style="vertical-align: 0px"/> is <a class="reference external" href="http://en.wikipedia.org/wiki/Planks_constant">plank’s
constant</a> (this assumes
neutrons are all travelling in horizontal at sample, and that
<img class="math" src="../_images/math/65d7046ab14fec5c383b5ec4148d945530320415.png" alt="x=y=0" style="vertical-align: -4px"/> would be beam centre at <img class="math" src="../_images/math/40065e34457c97897690299348ba0e4c25d6454d.png" alt="\lambda = 0" style="vertical-align: 0px"/>).</p>
</div>
<div class="section" id="normalizing-the-input-workspace">
<h3><a class="toc-backref" href="#id9">Normalizing the input workspace</a><a class="headerlink" href="#normalizing-the-input-workspace" title="Permalink to this headline">¶</a></h3>
<p>This section describes the normalisation/scaling/correction of the input
workspace using PixelAdj, WavelengthAdj and WavePixelAdj.</p>
<p>This <a class="reference internal" href="../concepts/Algorithm.html#algorithm"><span class="std std-ref">algorithm</span></a> takes as input a workspace of neutron
counts against <a class="reference internal" href="../concepts/UnitFactory.html#unit-factory"><span class="std std-ref">wavelength</span></a> and creates a workspace of cross
section against Q. The output Q bins boundaries are defined by setting
the property OutputBinning.</p>
<p>Below is the formula used to calculate the cross section, here denoted
<img class="math" src="../_images/math/9c09970cdbafc71c6025aaabd25e56c06514fd7d.png" alt="P_I(Q)" style="vertical-align: -4px"/>, for one bin in the output workspace whose bin number is
denoted by I, when the input workspace has just one detector. Each bin
is calculated from the sum of all input wavelength bins, n, that
evaluate to the same Q using the formula for Q at the top of this page.
In equations this relationship between the input bins and the output
bins is represented by <img class="math" src="../_images/math/7fbbb1eafdb16ef1842ebbb9548f9e7f2f2b3acc.png" alt="n \supset I" style="vertical-align: -1px"/> and an example of a set of
two bins is shown diagrammatically below.  (Each Q bin contains the sum
of many, one, or no wavelength bins.)</p>
<div class="figure">
<img alt="DgsAbsoluteUnitsReductionWorkflow.png" src="../_images/Wav_Q_bins.png" />
</div>
<p>In the equation the number of counts in the input spectrum number is
denoted by <img class="math" src="../_images/math/5887d2c09997368b4ca3cf6aac127bf995abeae7.png" alt="S(n)" style="vertical-align: -4px"/>, <img class="math" src="../_images/math/5ceea9e5d1a536d47e5b9b3680791957f8445d9c.png" alt="N(n)" style="vertical-align: -4px"/> is the wavelength dependent
correction and <img class="math" src="../_images/math/d4cfc14beb4d8d6657e154924661ed5861ba02ed.png" alt="\Omega" style="vertical-align: 0px"/> is the <a class="reference internal" href="SolidAngle-v1.html#algm-solidangle"><span class="std std-ref">solid angle</span></a> of the
detector</p>
<div class="math">
<p><img src="../_images/math/e68de7cfb6cf8ef4d56003ae373dea2abdd2382d.png" alt="P_I(Q) = \frac{ \sum_{n \supset I} S(n)}{\Omega\sum_{n \supset I}N(n)}"/></p>
</div><p>The wavelength dependent correction is supplied to the algorithm through
the WavelengthAdj property and this workspace must have the same
wavelength binning as the input workspace and should be equal to the
following:</p>
<div class="math">
<p><img src="../_images/math/ae639e4b85771bcadf7119e8633f13e6a5a64c6b.png" alt="N(n) = M(n)\eta(n)T(n)"/></p>
</div><p>where <img class="math" src="../_images/math/b6e6bf2d998d1a33904141106a453324f9c97b35.png" alt="M" style="vertical-align: 0px"/>, <img class="math" src="../_images/math/dc1f0f7986b8100c57705a5689e74aad25a9aa2f.png" alt="\eta" style="vertical-align: -4px"/> and <img class="math" src="../_images/math/5830b1441ec19bff0c7f338ee28ccd12654c1f69.png" alt="T" style="vertical-align: 0px"/> are the monitor counts,
detector efficiency and transmission fraction respectively.</p>
<p>Normally there will be many spectra each from a different pixel with a
row number <img class="math" src="../_images/math/4cc7324e0d6c8c591e4d865a21144bda81fd3011.png" alt="i" style="vertical-align: 0px"/> and column number <img class="math" src="../_images/math/c18271eddf460603079ed91e4dc4af329a59eab2.png" alt="j" style="vertical-align: -4px"/>. Because the value of
<img class="math" src="../_images/math/1a9b85a9218a3358278a57e3f68189b5176af0fc.png" alt="\theta" style="vertical-align: 0px"/> varies between pixels corresponding input bins (n) from
different input spectra can contribute to different output bins (I) i.e.
<img class="math" src="../_images/math/7fbbb1eafdb16ef1842ebbb9548f9e7f2f2b3acc.png" alt="n \supset I" style="vertical-align: -1px"/> will be different for different pixels. For multiple
spectra the sum for each output bin will be over the set of input bins
in each pixel that have the correct Q, that is
<img class="math" src="../_images/math/0dac450565a726747f92fb1e054ce158dff61623.png" alt="\{i, j, n\} \supset \{I\}" style="vertical-align: -5px"/> while <img class="math" src="../_images/math/14a35c7cd220f41d0766bd367f88c3f247c8d63c.png" alt="\Omega_{i j}" style="vertical-align: -6px"/> is detector
dependent:</p>
<div class="math">
<p><img src="../_images/math/98dd20188ec8e807182ac18ab94bb21e06b7f5a0.png" alt="P_I(Q) = \frac{\sum_{\{i, j, n\} \supset \{I\}} S(i,j,n)}{\sum_{\{i, j, n\} \supset \{I\}}M(n)\eta(n)T(n)\Omega_{i j}F_{i j}}"/></p>
</div><p>where <img class="math" src="../_images/math/68b0fc4683e0c8842b3a6cc6920f022f1c0db3fa.png" alt="F" style="vertical-align: 0px"/> is the detector dependent (e.g. flood) scaling specified
by the PixelAdj property, and where a <img class="math" src="../_images/math/412c0294db757d8807fe8fc2975ab586bb9042d8.png" alt="\lambda" style="vertical-align: 0px"/> bin <img class="math" src="../_images/math/3492c6d4b042ddb93d57b7a5aa9532131d9af611.png" alt="n" style="vertical-align: 0px"/>
spans more than one <img class="math" src="../_images/math/f59dd7fde255c3f2d4d4d2f0631914aa7604d031.png" alt="Q" style="vertical-align: -4px"/> bin <img class="math" src="../_images/math/8cbabf0be514c984d6ec320163dd139dc67e0d12.png" alt="I" style="vertical-align: 0px"/>, it is split assuming a
uniform distribution of the counts in <img class="math" src="../_images/math/412c0294db757d8807fe8fc2975ab586bb9042d8.png" alt="\lambda" style="vertical-align: 0px"/>. The normalization
takes any <a class="reference internal" href="MaskBins-v1.html#algm-maskbins"><span class="std std-ref">bin masking</span></a> into account.</p>
<p>Some corrections will be both pixel and wavelength dependent, for example an
angle transmission correction. Such corrections can be taken into account by
specifying WavePixelAdj.</p>
</div>
<div class="section" id="resolution-and-cutoffs">
<h3><a class="toc-backref" href="#id10">Resolution and Cutoffs</a><a class="headerlink" href="#resolution-and-cutoffs" title="Permalink to this headline">¶</a></h3>
<p>There are two sources of uncertainty in the intensity: the statistical
(counting) error and the finite size of the bins, i.e. both time bins
and the spatial extent of the detectors (pixels). The first error is
reducible by increasing the length of the experiment or bin sizes while
the second reduces with smaller bin sizes. The first is represented by
the errors on the output workspace but the second is not included in the
error calculation although it increases uncertainties and degrades the
effective resolution of the data none the less. This algorithm allows
the resolution to be improved by removing the bins with the worst
resolution.</p>
<p>Normally the bins that give the worst resolution are those near the beam
center and with short wavelengths. When the optional properties
<img class="math" src="../_images/math/634041c5f498962e52ad92d2bcd9ef4d8f3b33f4.png" alt="RadiusCut" style="vertical-align: 0px"/> and <img class="math" src="../_images/math/b01cf909d38d58c73021aa4e12ea37acb238a365.png" alt="WaveCut" style="vertical-align: 0px"/> are set bins from this region of
the input workspace are removed from the intensity calculation (both
from the numerator and denominator). For a pixel at distance R from the
beam center the wavelength cutoff, <img class="math" src="../_images/math/7d31d94ff8f2017d85c2c9e5440e8dd3f1aa0f73.png" alt="W_{low}" style="vertical-align: -3px"/>, is defined by the
input properties <img class="math" src="../_images/math/634041c5f498962e52ad92d2bcd9ef4d8f3b33f4.png" alt="RadiusCut" style="vertical-align: 0px"/> and <img class="math" src="../_images/math/b01cf909d38d58c73021aa4e12ea37acb238a365.png" alt="WaveCut" style="vertical-align: 0px"/> as:</p>
<div class="math">
<p><img src="../_images/math/86fe8997b3ff56e40bec9c66c06427be8f2630b7.png" alt="W_{low} = \frac{WaveCut (RadiusCut-R)}{RadiusCut}"/></p>
</div><p>The bin that contains the wavelength <img class="math" src="../_images/math/7d31d94ff8f2017d85c2c9e5440e8dd3f1aa0f73.png" alt="W_{low}" style="vertical-align: -3px"/> and all lower
indices are excluded from the summations for that detector pixel.</p>
<p>From the equation it is possible to see that for pixels in
<img class="math" src="../_images/math/1ff15d908b83757cb0be69762263472efca3e5ba.png" alt="R &gt; RadiusCut" style="vertical-align: 0px"/> all (positive) wavelengths are included. Also
substituting <img class="math" src="../_images/math/c8421d0100f126bc29342c8a0027d3324ba733d9.png" alt="WaveCut = W_{low}" style="vertical-align: -3px"/> we have that <img class="math" src="../_images/math/11e2416582426e0a7b592db95fac90bd71619fee.png" alt="R = 0" style="vertical-align: 0px"/> and
hence all detectors contribute at wavelengths above <img class="math" src="../_images/math/b01cf909d38d58c73021aa4e12ea37acb238a365.png" alt="WaveCut" style="vertical-align: 0px"/>.</p>
<p>Practically, it is more likely to be necessary to implement
<img class="math" src="../_images/math/634041c5f498962e52ad92d2bcd9ef4d8f3b33f4.png" alt="RadiusCut" style="vertical-align: 0px"/> and <img class="math" src="../_images/math/b01cf909d38d58c73021aa4e12ea37acb238a365.png" alt="WaveCut" style="vertical-align: 0px"/> in situations where the scattering
near to the beamstop is weak and ‘contaminated’ by short wavelength
scatter. This might arise, for example, when running at long
sample-detector distances, or at short sample-detector distances with
large diameter beams, or where the sample generates Bragg peaks at
low-Q. The best recourse is to check the wavelength overlap. If it is
not too bad it may be possible to improve the data presentation simply
by altering <img class="math" src="../_images/math/1690ed908220ca60c0b1c3fab87771a4af034c17.png" alt="Q{min}" style="vertical-align: -4px"/> and the binning scheme.</p>
</div>
<div class="section" id="examples">
<h3><a class="toc-backref" href="#id11">Examples</a><a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>For an example of how Q1D is used see
<a class="reference external" href="http://www.mantidproject.org/SANS_ISIS_Data_Reduction">ISIS SANS data reduction</a>.</p>
<p><strong>References</strong></p>
<p><a class="reference external" href="http://scripts.iucr.org/cgi-bin/paper?gk0158">R.P. Hjelm Jr. *J. Appl. Cryst.* (1988), 21,
618-628</a>.</p>
<p><a class="reference external" href="http://scripts.iucr.org/cgi-bin/paper?gk0573">P.A. Seeger &amp; R.P. Hjelm Jr. *J. Appl. Cryst.* (1991), 24,
467-478</a>.</p>
</div>
<div class="section" id="variations-on-applying-the-normalization">
<h3><a class="toc-backref" href="#id12">Variations on applying the normalization</a><a class="headerlink" href="#variations-on-applying-the-normalization" title="Permalink to this headline">¶</a></h3>
<p>It is possible to divide the input workspace by the WavelenghAdj and
PixelAdj workspaces prior to calling this algorithm. The results will be
same as if these workspaces were passed to Q1D instead when there are
high numbers of particle counts. However, in this scheme the
probabilities tend to converge on the true high count probabablities
more slowly with increasing number of counts and so the result is less
accuate.</p>
<p>Depending on the input and output bins there could be a significant
difference in CPU time required by these two methods.</p>
</div>
<div class="section" id="references">
<h3><a class="toc-backref" href="#id13">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h3>
<p>Calculation of Q is from Seeger, P. A. and Hjelm, R. P. Jr, “Small-Angle
Neutron Scattering at Pulsed Spallation Sources” (1991) <a class="reference external" href="http://dx.doi.org/10.1107/S0021889891004764">J. Appl 24
467-478</a></p>
</div>
</div>
<div class="section" id="previous-versions">
<h2><a class="toc-backref" href="#id14">Previous Versions</a><a class="headerlink" href="#previous-versions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="version-1">
<h3><a class="toc-backref" href="#id15">Version 1</a><a class="headerlink" href="#version-1" title="Permalink to this headline">¶</a></h3>
<p>Before July 2011 the intensity was calculated with an equation like the
following:</p>
<div class="math">
<p><img src="../_images/math/8525db64ecbdfb9361f564b185c546005a8470ae.png" alt="P_I(Q) = \frac{ \sum_{\{i, j, n\} \supset \{I\}}G(i,j,n) }{ \sum_{\{i, j, n\} \supset \{I\}} \Omega_{i j} }"/></p>
</div><p>where G is the input workspace normally related to the raw counts
workspace as:</p>
<div class="math">
<p><img src="../_images/math/3545c8bd9fcb9923063bf4afaeb59a2167bbaf3c.png" alt="G(i,j,n) = S(i,j,n)/(M(n)\eta(n)T(n)F_{i j})"/></p>
</div><p>That is the normalization was performed before the Q calculation which
gives the same probilities at high numbers of particles counts but
weighted noisy, low count data too highly, giving more noise in
<img class="math" src="../_images/math/9c09970cdbafc71c6025aaabd25e56c06514fd7d.png" alt="P_I(Q)" style="vertical-align: -4px"/>.</p>
<p>The error was calculation did not include the errors due the
normalization or any corrections.</p>
</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id16">Properties</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="9%" />
<col width="6%" />
<col width="8%" />
<col width="6%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Order</th>
<th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>InputWorkspace</td>
<td>Input</td>
<td>MatrixWorkspace</td>
<td>Mandatory</td>
<td>The (partly) corrected data in units of wavelength.</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>InputForErrors</td>
<td>Input</td>
<td>MatrixWorkspace</td>
<td>Mandatory</td>
<td>The workspace containing the counts to use for the error calculation. Must also be in units of wavelength and have matching bins to the InputWorkspace.</td>
</tr>
<tr class="row-even"><td>3</td>
<td>OutputWorkspace</td>
<td>Output</td>
<td>MatrixWorkspace</td>
<td>Mandatory</td>
<td>The workspace name under which to store the result histogram.</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>OutputBinning</td>
<td>Input</td>
<td>String</td>
<td>Mandatory</td>
<td>The bin parameters to use for the final result (in the format used by the <a class="reference internal" href="Rebin-v1.html#algm-rebin"><span class="std std-ref">Rebin v1</span></a> algorithm).</td>
</tr>
<tr class="row-even"><td>5</td>
<td>AccountForGravity</td>
<td>Input</td>
<td>Boolean</td>
<td>False</td>
<td>Whether to correct for the effects of gravity.</td>
</tr>
</tbody>
</table>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/SANS.html">SANS</a></p>
</div>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id17">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a412251b161c30a0be7a42eaf858d03199961661/Framework/Algorithms/inc/MantidAlgorithms/Q1D2.h">Q1D2.h</a> <em>(last modified: 2018-10-05)</em></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a412251b161c30a0be7a42eaf858d03199961661/Framework/Algorithms/src/Q1D2.cpp">Q1D2.cpp</a> <em>(last modified: 2019-07-17)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ProjectMD-v1.html" title="Previous Chapter: ProjectMD v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; ProjectMD v1</span>
    </a>
  </li>
  <li>
    <a href="Q1DWeighted-v1.html" title="Next Chapter: Q1DWeighted v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Q1DWeighted v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2020-03-14.<br/>
    </p>
  </div>
</footer>
  </body>
</html>