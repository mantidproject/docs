<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>MatchAndMergeWorkspaces v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MatchPeaks v1" href="MatchPeaks-v1.html" />
    <link rel="prev" title="MaskWorkspaceToCalFile v1" href="MaskWorkspaceToCalFile-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>5.0</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="matchandmergeworkspaces-v1">
<span id="algm-matchandmergeworkspaces"></span><span id="algm-matchandmergeworkspaces-v1"></span><h1>MatchAndMergeWorkspaces v1<a class="headerlink" href="#matchandmergeworkspaces-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/MatchAndMergeWorkspaces-v1_dlg.png"><img alt="../_images/MatchAndMergeWorkspaces-v1_dlg.png" class="screenshot" src="../_images/MatchAndMergeWorkspaces-v1_dlg.png" style="width: 274px;" /></a>
<p class="caption"><span class="caption-text"><strong>MatchAndMergeWorkspaces</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id3">Properties</a></li>
<li><a class="reference internal" href="#description" id="id4">Description</a></li>
<li><a class="reference internal" href="#usage" id="id5">Usage</a><ul>
<li><a class="reference internal" href="#workflow" id="id6">Workflow</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Merges a group workspace using weighting from a set of range limits for each workspace.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id3">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="5%" />
<col width="21%" />
<col width="9%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspaces</td>
<td>Input</td>
<td>str list</td>
<td><em>Mandatory</em></td>
<td>List of workspaces or group workspace containing workspaces to be merged.</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></td>
<td><em>Mandatory</em></td>
<td>The merged workspace.</td>
</tr>
<tr class="row-even"><td>XMin</td>
<td>Input</td>
<td>dbl list</td>
<td>&#160;</td>
<td>Array of minimum X values for each workspace.</td>
</tr>
<tr class="row-odd"><td>XMax</td>
<td>Input</td>
<td>dbl list</td>
<td>&#160;</td>
<td>Array of maximum X values for each workspace.</td>
</tr>
<tr class="row-even"><td>CalculateScale</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Calculate scale factor when matching spectra.</td>
</tr>
<tr class="row-odd"><td>CalculateOffset</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Calculate vertical shift when matching spectra.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id4">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This is a workflow algorithm that merges down a workspace, workspace
group, or list of workspaces, <cite>MatchSpectra &lt;algm-MatchSpectra&gt;</cite>
and sums the spectra using weighted mean from ranges for each
spectra. For each workspace an XMin and XMax is supplied, the
workspace is then cropped to that range and all workspaces are
Rebinned to have common bin edges. The output is the mean value
for each bin for all workspaces with a value in that bin.
This is done by executing several sub-algorithms as
listed below.</p>
<ol class="arabic simple">
<li><a class="reference internal" href="Rebin-v1.html#algm-rebin"><span class="std std-ref">Rebin v1</span></a> To rebin all spectra to have common bins.</li>
<li><a class="reference internal" href="ConjoinWorkspaces-v1.html#algm-conjoinworkspaces"><span class="std std-ref">ConjoinWorkspaces v1</span></a> repeated for every workspaces in the workspace group.</li>
<li><a class="reference internal" href="MatchSpectra-v1.html#algm-matchspectra"><span class="std std-ref">MatchSpectra v1</span></a> Matched against the spectra with the largest original x range.</li>
<li><a class="reference internal" href="CropWorkspaceRagged-v1.html#algm-cropworkspaceragged"><span class="std std-ref">CropWorkspaceRagged v1</span></a> to cut spectra to match the X limits given.</li>
<li><a class="reference internal" href="Rebin-v1.html#algm-rebin"><span class="std std-ref">Rebin v1</span></a> To rebin all spectra to have common bins.</li>
<li><a class="reference internal" href="SumSpectra-v1.html#algm-sumspectra"><span class="std std-ref">SumSpectra v1</span></a> using <cite>WeightedSum=True</cite> and <cite>MultiplyBySpectra=False</cite>.</li>
</ol>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id5">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mantid.simpleapi</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">isis_powder</span> <span class="kn">import</span> <span class="n">polaris</span><span class="p">,</span> <span class="n">SampleDetails</span>
<span class="n">config_file_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;C:/Users/wey38795/Documents/polaris-calculate-pdf/polaris_config_example.yaml&quot;</span>
<span class="n">polaris</span> <span class="o">=</span> <span class="n">polaris</span><span class="o">.</span><span class="n">Polaris</span><span class="p">(</span><span class="n">config_file</span><span class="o">=</span><span class="n">config_file_path</span><span class="p">,</span> <span class="n">user_name</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;PDF&quot;</span><span class="p">)</span>

<span class="n">sample_details</span> <span class="o">=</span> <span class="n">SampleDetails</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.2985</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;cylinder&#39;</span><span class="p">)</span>
<span class="n">sample_details</span><span class="o">.</span><span class="n">set_material</span><span class="p">(</span><span class="n">chemical_formula</span><span class="o">=</span><span class="s1">&#39;Si&#39;</span><span class="p">)</span>
<span class="n">polaris</span><span class="o">.</span><span class="n">set_sample_details</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">sample_details</span><span class="p">)</span>

<span class="n">polaris</span><span class="o">.</span><span class="n">create_vanadium</span><span class="p">(</span><span class="n">first_cycle_run_no</span><span class="o">=</span><span class="s2">&quot;98532&quot;</span><span class="p">,</span>
                        <span class="n">multiple_scattering</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">polaris</span><span class="o">.</span><span class="n">focus</span><span class="p">(</span><span class="n">run_number</span><span class="o">=</span><span class="s2">&quot;98533&quot;</span><span class="p">,</span> <span class="n">input_mode</span><span class="o">=</span><span class="s1">&#39;Summed&#39;</span><span class="p">)</span>

<span class="n">polaris</span><span class="o">.</span><span class="n">create_total_scattering_pdf</span><span class="p">(</span><span class="n">run_number</span><span class="o">=</span><span class="s2">&quot;98533&quot;</span><span class="p">,</span> <span class="n">merge_banks</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">x_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="n">merged_ws</span> <span class="o">=</span> <span class="n">MatchAndMergeWorkspaces</span><span class="p">(</span><span class="n">WorkspaceGroup</span><span class="o">=</span><span class="s1">&#39;focused_ws&#39;</span><span class="p">,</span> <span class="n">XMin</span><span class="o">=</span><span class="n">x_min</span><span class="p">,</span> <span class="n">XMax</span><span class="o">=</span><span class="n">x_max</span><span class="p">,</span> <span class="n">CalculateScale</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="s1">&#39;mantid&#39;</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">merged_ws</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>This will produce a plot that looks like this:</p>
<div class="figure">
<img alt="../_images/MatchAndMergeWorkspaces.png" src="../_images/MatchAndMergeWorkspaces.png" />
</div>
<div class="section" id="workflow">
<h3><a class="toc-backref" href="#id6">Workflow</a><a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/MatchAndMergeWorkspaces-v1_wkflw.png" src="../_images/MatchAndMergeWorkspaces-v1_wkflw.png" />
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="MaskWorkspaceToCalFile-v1.html" title="Previous Chapter: MaskWorkspaceToCalFile v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; MaskWorkspace...</span>
    </a>
  </li>
  <li>
    <a href="MatchPeaks-v1.html" title="Next Chapter: MatchPeaks v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">MatchPeaks v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2020-03-14.<br/>
    </p>
  </div>
</footer>
  </body>
</html>