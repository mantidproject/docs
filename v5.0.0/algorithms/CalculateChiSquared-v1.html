<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>CalculateChiSquared v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CalculateCostFunction v1" href="CalculateCostFunction-v1.html" />
    <link rel="prev" title="CalculateCarpenterSampleCorrection v1" href="CalculateCarpenterSampleCorrection-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>5.0</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="calculatechisquared-v1">
<span id="algm-calculatechisquared"></span><span id="algm-calculatechisquared-v1"></span><h1>CalculateChiSquared v1<a class="headerlink" href="#calculatechisquared-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/CalculateChiSquared-v1_dlg.png"><img alt="../_images/CalculateChiSquared-v1_dlg.png" class="screenshot" src="../_images/CalculateChiSquared-v1_dlg.png" style="width: 253px;" /></a>
<p class="caption"><span class="caption-text"><strong>CalculateChiSquared</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a><ul>
<li><a class="reference internal" href="#parameter-errors" id="id6">Parameter errors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id7">Usage</a></li>
<li><a class="reference internal" href="#source" id="id8">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Calculate chi squared for a function and a data set in a workspace.</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="CalculateCostFunction-v1.html#algm-calculatecostfunction"><span class="std std-ref">CalculateCostFunction</span></a>, <a class="reference internal" href="Fit-v1.html#algm-fit"><span class="std std-ref">Fit</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="1%" />
<col width="6%" />
<col width="2%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Function</td>
<td>InOut</td>
<td>Function</td>
<td><em>Mandatory</em></td>
<td>Parameters defining the fitting function and its initial values</td>
</tr>
<tr class="row-odd"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></td>
<td><em>Mandatory</em></td>
<td>Name of the input Workspace</td>
</tr>
<tr class="row-even"><td>IgnoreInvalidData</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Flag to ignore infinities, NaNs and data with zero errors.</td>
</tr>
<tr class="row-odd"><td>DomainType</td>
<td>Input</td>
<td>string</td>
<td>Simple</td>
<td>The type of function domain to use: Simple, Sequential, or Parallel. Allowed values: [‘Simple’, ‘Sequential’, ‘Parallel’]</td>
</tr>
<tr class="row-even"><td>EvaluationType</td>
<td>Input</td>
<td>string</td>
<td>CentrePoint</td>
<td>The way the function is evaluated on histogram data sets. If value is “CentrePoint” then function is evaluated at centre of each bin. If it is “Histogram” then function is integrated within the bin and the integrals returned. Allowed values: [‘CentrePoint’, ‘Histogram’]</td>
</tr>
<tr class="row-odd"><td>PeakRadius</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>A value of the peak radius the peak functions should use. A peak radius defines an interval on the x axis around the centre of the peak where its values are calculated. Values outside the interval are not calculated and assumed zeros.Numerically the radius is a whole number of peak widths (FWHM) that fit into the interval on each side from the centre. The default value of 0 means the whole x axis.</td>
</tr>
<tr class="row-even"><td>ChiSquared</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Output value of chi squared.</td>
</tr>
<tr class="row-odd"><td>ChiSquaredDividedByDOF</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Output value of chi squared divided by the number of degrees of freedom (NofData - nOfParams).</td>
</tr>
<tr class="row-even"><td>ChiSquaredDividedByNData</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Output value of chi squared divided by the number of data points).</td>
</tr>
<tr class="row-odd"><td>ChiSquaredWeighted</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Output value of weighted chi squared.</td>
</tr>
<tr class="row-even"><td>ChiSquaredWeightedDividedByDOF</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Output value of weighted chi squared divided by the number of degrees of freedom (NofData - nOfParams).</td>
</tr>
<tr class="row-odd"><td>ChiSquaredWeightedDividedByNData</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Output value of weighted chi squared divided by the number of  data points).</td>
</tr>
<tr class="row-even"><td>Output</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>A base name for output workspaces.</td>
</tr>
<tr class="row-odd"><td>Weighted</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Option to use the weighted chi squared in error estimation. Default is false.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Calculates a measure of the goodness of a fit in four ways.</p>
<p>The ChiSquared property returns the sum of squares of differences between the calculated and measured values:</p>
<p><img class="math" src="../_images/math/c232003d91402b1e495b161f7d37241f8a4873bf.png" alt="\chi_{1}^{2} = \sum_{i} (y_i - f_i)^2" style="vertical-align: -6px"/></p>
<p>where <img class="math" src="../_images/math/62117283dadeb1279e6cde69c9ec465cf07ecdf1.png" alt="y_i" style="vertical-align: -4px"/> and <img class="math" src="../_images/math/b78c42193a7fc77d1800c8995d91ae425fd2849d.png" alt="f_i" style="vertical-align: -4px"/> are the measured and calculated values at i-th point.</p>
<p>The ChiSquaredDividedByDOF is ChiSquared divided by the number of degrees of freedom (DOF):</p>
<p><img class="math" src="../_images/math/c5acdb8781f5e7dddc5552a83e8b369ddbd410b7.png" alt="\chi_{2}^{2} = \frac{1}{DOF}\sum_{i} (y_i - f_i)^2" style="vertical-align: -6px"/></p>
<p><img class="math" src="../_images/math/cd6e3f7d912315dbf34f7fc5aa1ed1d8a1a30688.png" alt="DOF = N_d - N_p" style="vertical-align: -6px"/> where <img class="math" src="../_images/math/aef386c8243d143d71fc890e1a4758f63c73fb0f.png" alt="N_d" style="vertical-align: -3px"/> is the number of data points used in fitting and <img class="math" src="../_images/math/5e5bd5d2589c3ad6543a61a2a8cb97d7902f5267.png" alt="N_p" style="vertical-align: -6px"/>
is the number of free (not fixed or tied) parameters of the function.</p>
<p>The ChiSquaredWeighted property sums the squares of the differences divided by the data errors:</p>
<p><img class="math" src="../_images/math/6e0540880063afcc59ae777cb0b1226d025a04fa.png" alt="\chi_{3}^{2} = \sum_{i} \left(\frac{y_i - f_i}{\sigma_i}\right)^2" style="vertical-align: -13px"/></p>
<p>Finally, ChiSquaredWeightedDividedByDOF is</p>
<p><img class="math" src="../_images/math/0b289b5e3ece5b87b451c513f7017866aa74ff04.png" alt="\chi_{4}^{2} = \chi_{3}^{2} / DOF" style="vertical-align: -5px"/></p>
<div class="section" id="parameter-errors">
<h3><a class="toc-backref" href="#id6">Parameter errors</a><a class="headerlink" href="#parameter-errors" title="Permalink to this headline">¶</a></h3>
<p>Setting the Output property to a non-empty string makes the algorithm explore the surface of the <img class="math" src="../_images/math/6f537fe37953fc67191a36899f4a277390acd1ce.png" alt="\chi^{2}" style="vertical-align: -4px"/>
around its minimum and estimate the standard deviations for the parameters. The value of the property is a base name
for two output table workspaces: ‘&lt;Output&gt;_errors’ and ‘&lt;Output&gt;_pdf’. The former workspace contains parameter error
estimates and the latter shows <img class="math" src="../_images/math/6f537fe37953fc67191a36899f4a277390acd1ce.png" alt="\chi^{2}" style="vertical-align: -4px"/>‘s 1d slices along each parameter (keeping all other fixed).</p>
<p>The error table has the following columns:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Column</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Parameter</td>
<td>Parameter name</td>
</tr>
<tr class="row-odd"><td>Value</td>
<td>Parameter value passed with the Function property</td>
</tr>
<tr class="row-even"><td>Value at Min</td>
<td>The minimum point of the 1d slice of the <img class="math" src="../_images/math/6f537fe37953fc67191a36899f4a277390acd1ce.png" alt="\chi^{2}" style="vertical-align: -4px"/>. If the Function is at the minimum then
Value at Min should be equal to Value.</td>
</tr>
<tr class="row-odd"><td>Left Error</td>
<td>The negative deviation from the minimum point equivalent to <img class="math" src="../_images/math/7ff4ce645aec93937f1d9ef0beb2d70ce1ed09f7.png" alt="1\sigma" style="vertical-align: -1px"/>. Estimated from analisys
of the surface.</td>
</tr>
<tr class="row-even"><td>Right Error</td>
<td>The positive deviation from the minimum point equivalent to <img class="math" src="../_images/math/7ff4ce645aec93937f1d9ef0beb2d70ce1ed09f7.png" alt="1\sigma" style="vertical-align: -1px"/>. Estimated from analisys
of the surface.</td>
</tr>
<tr class="row-odd"><td>Quadratic Error</td>
<td><img class="math" src="../_images/math/7ff4ce645aec93937f1d9ef0beb2d70ce1ed09f7.png" alt="1\sigma" style="vertical-align: -1px"/> standard deviation in the quadratic approximation of the surface.</td>
</tr>
<tr class="row-even"><td>Chi2 Min</td>
<td>The value of <img class="math" src="../_images/math/6f537fe37953fc67191a36899f4a277390acd1ce.png" alt="\chi^{2}" style="vertical-align: -4px"/> at the minimum relative to the test point.</td>
</tr>
</tbody>
</table>
<p>The pdf table contains slices of the <img class="math" src="../_images/math/6f537fe37953fc67191a36899f4a277390acd1ce.png" alt="\chi^{2}" style="vertical-align: -4px"/> along each parameter. It has 3 column per parameter. The first column of the 3
is the parameter values, the second has the <img class="math" src="../_images/math/6f537fe37953fc67191a36899f4a277390acd1ce.png" alt="\chi^{2}" style="vertical-align: -4px"/> and the third is the probability density function normalised to
have 1 at the maximum.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id7">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example 1</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Create a data set</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">DataY</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">DataE</span><span class="o">=</span><span class="n">e</span><span class="p">)</span>

<span class="c1"># Define a function</span>
<span class="n">func</span> <span class="o">=</span> <span class="s1">&#39;name=LinearBackground,A0=1.1,A1=1.9&#39;</span>

<span class="c1"># Calculate the chi squared</span>
<span class="n">chi2</span><span class="p">,</span><span class="n">chi2dof</span><span class="p">,</span><span class="n">chi2ndata</span><span class="p">,</span><span class="n">chi2W</span><span class="p">,</span><span class="n">chi2Wdof</span><span class="p">,</span><span class="n">chi2Wndata</span> <span class="o">=</span> <span class="n">CalculateChiSquared</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="n">ws</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared is </span><span class="si">{:.13f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared / DOF is </span><span class="si">{:.14f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2dof</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared / NDATA is </span><span class="si">{:.14f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2ndata</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared weighted is </span><span class="si">{:.11f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2W</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared weighted / DOF is </span><span class="si">{:.14f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2Wdof</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared weighted / NDATA is </span><span class="si">{:.12f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2Wndata</span><span class="p">))</span>

<span class="c1"># Define a function that models the data exactly</span>
<span class="n">func</span> <span class="o">=</span> <span class="s1">&#39;name=LinearBackground,A0=1.0,A1=2.0&#39;</span>

<span class="c1"># Calculate the chi squared</span>
<span class="n">chi2</span><span class="p">,</span><span class="n">chi2dof</span><span class="p">,</span><span class="n">chi2ndata</span><span class="p">,</span><span class="n">chi2W</span><span class="p">,</span><span class="n">chi2Wdof</span><span class="p">,</span><span class="n">chi2Wndata</span> <span class="o">=</span> <span class="n">CalculateChiSquared</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="n">ws</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared / DOF is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2dof</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared / NDATA is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2ndata</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared weighted is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2W</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared weighted / DOF is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2Wdof</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared weighted / NDATA is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2Wndata</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Chi squared is 0.0351851851852
Chi squared / DOF is 0.00439814814815
Chi squared / NDATA is 0.00351851851852
Chi squared weighted is 0.02660287840
Chi squared weighted / DOF is 0.00332535979971
Chi squared weighted / NDATA is 0.002660287840
Chi squared is 0.0
Chi squared / DOF is 0.0
Chi squared / NDATA is 0.0
Chi squared weighted is 0.0
Chi squared weighted / DOF is 0.0
Chi squared weighted / NDATA is 0.0
</pre></div>
</div>
<p><strong>Example 2</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># Create a workspace and fill it with some gaussian data and some noise</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>

<span class="c1"># Gefine a Gaussian with exactly the same parameters that were used to</span>
<span class="c1"># generate the data</span>
<span class="n">fun_t</span> <span class="o">=</span> <span class="s1">&#39;name=Gaussian,Height=</span><span class="si">%s</span><span class="s1">,PeakCentre=</span><span class="si">%s</span><span class="s1">,Sigma=</span><span class="si">%s</span><span class="s1">&#39;</span>
<span class="n">fun</span> <span class="o">=</span> <span class="n">fun_t</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Test the chi squared.</span>
<span class="n">CalculateChiSquared</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="n">ws</span><span class="p">,</span><span class="n">Output</span><span class="o">=</span><span class="s1">&#39;Test0&#39;</span><span class="p">)</span>
<span class="c1"># Check the Test0_errors table and see that the parameters are not at minimum</span>

<span class="c1"># Fit the function</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="n">ws</span><span class="p">,</span><span class="n">Output</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
<span class="c1"># res[3] is a table with the fitted parameters</span>
<span class="n">nParams</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nParams</span><span class="p">)]</span>
<span class="c1"># Build a new function and populate it with the fitted parameters</span>
<span class="n">fun</span> <span class="o">=</span> <span class="n">fun_t</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="c1"># Test the chi squared.</span>
<span class="n">CalculateChiSquared</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="n">ws</span><span class="p">,</span><span class="n">Output</span><span class="o">=</span><span class="s1">&#39;Test1&#39;</span><span class="p">)</span>
<span class="c1"># Check the Test1_errors table and see that the parameters are at minimum now</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Optimization.html">Optimization</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id8">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a412251b161c30a0be7a42eaf858d03199961661/Framework/CurveFitting/inc/MantidCurveFitting/Algorithms/CalculateChiSquared.h">CalculateChiSquared.h</a> <em>(last modified: 2018-10-05)</em></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a412251b161c30a0be7a42eaf858d03199961661/Framework/CurveFitting/src/Algorithms/CalculateChiSquared.cpp">CalculateChiSquared.cpp</a> <em>(last modified: 2019-11-08)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="CalculateCarpenterSampleCorrection-v1.html" title="Previous Chapter: CalculateCarpenterSampleCorrection v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; CalculateCarp...</span>
    </a>
  </li>
  <li>
    <a href="CalculateCostFunction-v1.html" title="Next Chapter: CalculateCostFunction v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">CalculateCost... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2020-03-14.<br/>
    </p>
  </div>
</footer>
  </body>
</html>