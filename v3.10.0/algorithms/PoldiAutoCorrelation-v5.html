<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PoldiAutoCorrelation v5</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.10.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="PoldiCreatePeaksFromCell v1" href="PoldiCreatePeaksFromCell-v1.html" />
    <link rel="prev" title="PoldiAnalyseResiduals v1" href="PoldiAnalyseResiduals-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.10</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="poldiautocorrelation-v5">
<span id="algm-poldiautocorrelation"></span><span id="algm-poldiautocorrelation-v5"></span><h1>PoldiAutoCorrelation v5<a class="headerlink" href="#poldiautocorrelation-v5" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/PoldiAutoCorrelation-v5_dlg.png"><img alt="../_images/PoldiAutoCorrelation-v5_dlg.png" class="screenshot" src="../_images/PoldiAutoCorrelation-v5_dlg.png" style="width: 334px;" /></a>
<p class="caption"><strong>PoldiAutoCorrelation</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#usage" id="id4">Usage</a></li>
<li><a class="reference internal" href="#source" id="id5">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Performs correlation analysis of POLDI 2D-data.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="6%" />
<col width="27%" />
<col width="10%" />
<col width="44%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>InOut</td>
<td><a class="reference internal" href="../concepts/Workspace2D.html#workspace2d"><em>Workspace2D</em></a></td>
<td><em>Mandatory</em></td>
<td>Input workspace containing raw POLDI data.</td>
</tr>
<tr class="row-odd"><td>wlenmin</td>
<td>Input</td>
<td>number</td>
<td>1.1</td>
<td>Minimum wavelength considered</td>
</tr>
<tr class="row-even"><td>wlenmax</td>
<td>Input</td>
<td>number</td>
<td>5</td>
<td>Maximum wavelength considered</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/Workspace2D.html#workspace2d"><em>Workspace2D</em></a></td>
<td>&nbsp;</td>
<td>Output workspace containing the correlation spectrum.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<div class="figure align-right" style="width: 10cm">
<img alt="Raw POLDI data for Silicon powder standard (simulated)." src="../_images/PoldiAutoCorrelation_Si_2D.png" />
<p class="caption">Raw POLDI data for Silicon powder standard. The spectrum is simulated.</p>
</div>
<p>PoldiAutoCorrelation is a core part of the POLDI data analysis process. It takes a 2D-spectrum from POLDI as input, with arrival time <img class="math" src="../_images/math/1c830742422ece3ed035f2cb703543f1e53245f2.png" alt="t" style="vertical-align: 0px"/> as x-axis and scattering angle <img class="math" src="../_images/math/8e9bb7fd3766daf063d69d9836ac5185a40a45a7.png" alt="2\theta" style="vertical-align: 0px"/> as y-axis. In Mantid, the data is represented by a MatrixWorkspace, which contains one spectrum for each <img class="math" src="../_images/math/8e9bb7fd3766daf063d69d9836ac5185a40a45a7.png" alt="2\theta" style="vertical-align: 0px"/>-value of the detector, each containing usually 500 time-bins.</p>
<p>Without any <em>a-priori</em> information about the sample, a correlation spectrum is calculated, where <em>correlation counts</em> are plotted against <img class="math" src="../_images/math/f59dd7fde255c3f2d4d4d2f0631914aa7604d031.png" alt="Q" style="vertical-align: -4px"/>. Bragg-reflections will appear in this correlation spectrum as well defined peaks, surrounded by a dip which depends on the height of the peak. These spectra may be indexed like powder diffraction diagrams and the extracted peak profile information (location, intensity, FWHM) can be used as starting point for subsequent fits of the raw 2D data. For analysis of the correlaton spectrum, <a class="reference internal" href="PoldiPeakSearch-v1.html#algm-poldipeaksearch"><em>PoldiPeakSearch v1</em></a> and <a class="reference internal" href="PoldiFitPeaks1D-v2.html#algm-poldifitpeaks1d"><em>PoldiFitPeaks1D v2</em></a> can be used.</p>
<div class="figure align-right" style="width: 10cm">
<img alt="Correlation spectrum of Silicon powder standard." src="../_images/PoldiAutoCorrelation_Si_1D.png" />
<p class="caption">Correlation spectrum of Silicon powder standard.</p>
</div>
<p>A full description of the procedure goes beyond the scope of this documentation. Detailed information about this procedure is available on the <a class="reference external" href="http://www.psi.ch/sinq/poldi">POLDI website</a> and more specifically in the paper describing the pulse overlap concept (U. Stuhr, Nuclear Instruments and Methods in Physics Research A 545, S. 319, 2005).</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id4">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path. In MantidPlot this is done using <a class="reference external" href="http://www.mantidproject.org/ManageUserDirectories">Manage User Directories</a>.</p>
</div>
<p>PoldiAutoCorrelation operates on a MatrixWorkspace with a valid POLDI instrument definition. The following short example demonstrates how to use the algorithm, processing data obtained from recording the spectrum of a Silicon standard material (powder).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Load data file with Si spectrum, this loads the HDF-data into a MatrixWorkspace named raw_6904</span>
<span class="n">raw_6904</span> <span class="o">=</span> <span class="n">LoadSINQFile</span><span class="p">(</span><span class="n">Filename</span> <span class="o">=</span> <span class="s">&quot;poldi2013n006904.hdf&quot;</span><span class="p">,</span> <span class="n">Instrument</span> <span class="o">=</span> <span class="s">&quot;POLDI&quot;</span><span class="p">)</span>

<span class="c"># Print the number of spectra in the workspace. It should be 400, one for each detector wire</span>
<span class="k">print</span> <span class="s">&quot;The workspace contains&quot;</span><span class="p">,</span> <span class="n">raw_6904</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">(),</span> <span class="s">&quot;spectra.&quot;</span>

<span class="c"># For most calculations, an instrument definition is needed, so it&#39;s loaded as well</span>
<span class="n">LoadInstrument</span><span class="p">(</span><span class="n">raw_6904</span><span class="p">,</span> <span class="n">InstrumentName</span> <span class="o">=</span> <span class="s">&quot;POLDI&quot;</span><span class="p">,</span> <span class="n">RewriteSpectraMap</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># Call the actual algorithm.</span>
<span class="n">correlated_6904</span> <span class="o">=</span> <span class="n">PoldiAutoCorrelation</span><span class="p">(</span><span class="n">raw_6904</span><span class="p">)</span>

<span class="c"># The first spectrum contains the correlation data. In this case there should be 5531 bins.</span>
<span class="c"># On other data or different wavelength limits, this number will be different.</span>
<span class="k">print</span> <span class="s">&quot;The correlation spectrum has&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">correlated_6904</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="s">&quot;data points.&quot;</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>The workspace contains 400 spectra.
The correlation spectrum has 5531 data points.
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/SINQ/Poldi.html">SINQ\Poldi</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id5">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/0e727092bfa714fd0d7f12ee4b2c3bb864e1ef06/Framework/SINQ/src/PoldiAutoCorrelation5.cpp">PoldiAutoCorrelation5.cpp</a></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/0e727092bfa714fd0d7f12ee4b2c3bb864e1ef06/Framework/SINQ/inc/MantidSINQ/PoldiAutoCorrelation5.h">PoldiAutoCorrelation5.h</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="PoldiAnalyseResiduals-v1.html" title="Previous Chapter: PoldiAnalyseResiduals v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; PoldiAnalyseResi...</span>
    </a>
  </li>
  <li>
    <a href="PoldiCreatePeaksFromCell-v1.html" title="Next Chapter: PoldiCreatePeaksFromCell v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">PoldiCreatePeaks... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>