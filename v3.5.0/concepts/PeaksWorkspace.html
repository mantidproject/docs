<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Peaks Workspace</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="up" title="Concepts" href="index.html" />
    <link rel="next" title="Plugin" href="Plugin.html" />
    <link rel="prev" title="Nexus File" href="NexusFile.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="peaks-workspace">
<span id="peaksworkspace"></span><h1>Peaks Workspace<a class="headerlink" href="#peaks-workspace" title="Permalink to this headline">¶</a></h1>
<p>The PeaksWorkspace is a special Workspace that holds a list of single crystal Peak objects.</p>
<div class="section" id="creating-a-peaksworkspace">
<h2>Creating a PeaksWorkspace<a class="headerlink" href="#creating-a-peaksworkspace" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../algorithms/FindPeaksMD-v1.html#algm-findpeaksmd"><em>FindPeaksMD</em></a> will find peaks in reciprocal space in a <a class="reference internal" href="MDWorkspace.html#mdworkspace"><em>MDWorkspace</em></a>.</li>
<li><a class="reference internal" href="../algorithms/FindSXPeaks-v1.html#algm-findsxpeaks"><em>FindSXPeaks</em></a> will find peaks in detector space.</li>
<li><a class="reference internal" href="../algorithms/PredictPeaks-v1.html#algm-predictpeaks"><em>PredictPeaks</em></a> will predict peak positions in a workspace given a UB matrix.</li>
<li>The <a class="reference internal" href="../algorithms/LoadIsawPeaks-v1.html#algm-loadisawpeaks"><em>LoadIsawPeaks</em></a> algorithm will load a PeaksWorkspace from file.</li>
<li>The <a class="reference internal" href="../algorithms/SaveIsawPeaks-v1.html#algm-saveisawpeaks"><em>SaveIsawPeaks</em></a> algorithm will save a PeaksWorkspace to a file.</li>
<li><a class="reference internal" href="../algorithms/CreatePeaksWorkspace-v1.html#algm-createpeaksworkspace"><em>CreatePeaksWorkspace</em></a> will create an empty PeaksWorkspace that you can then edit.</li>
</ul>
</div>
<div class="section" id="viewing-a-peaksworkspace">
<h2>Viewing a PeaksWorkspace<a class="headerlink" href="#viewing-a-peaksworkspace" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Double-click a PeaksWorkspace to see the full list of data of each Peak object.</li>
<li>In MantidPlot, you can drag/drop a PeaksWorkspace from the list of workspaces onto the <a class="reference external" href="http://www.mantidproject.org/MantidPlot:_Instrument_View">Instrument View</a> . This will overlay the peaks onto the detector face.</li>
<li>Right-click a PeaksWorkspace and select the menu to show the peak positions in 3D in the <a class="reference external" href="http://www.mantidproject.org/VatesSimpleInterface_v2">VatesSimpleInterface</a></li>
<li>In paraview, you can load a .Peaks file loader plugin to view a PeaksWorkspace.</li>
<li><a class="reference external" href="http://www.mantidproject.org/PeaksViewer">PeaksViewer</a> in the <a class="reference external" href="http://www.mantidproject.org/SliceViewer">SliceViewer</a></li>
</ul>
</div>
<div class="section" id="the-peak-object">
<h2>The Peak Object<a class="headerlink" href="#the-peak-object" title="Permalink to this headline">¶</a></h2>
<p>Each peak object contains several pieces of information. Not all of them are necessary:</p>
<ul class="simple">
<li>Detector position and wavelength</li>
<li>Q position (calculated from the detector position/wavelength)</li>
<li>H K L indices (optional)</li>
<li>Goniometer rotation matrix (for finding Q in the sample frame)</li>
<li>Integrated intensity and error (optional)</li>
<li>Row/column of detector (only for <a class="reference internal" href="RectangularDetector.html#rectangulardetector"><em>RectangularDetectors</em></a> )</li>
<li>An integration shape (see below)</li>
</ul>
<div class="section" id="the-peak-shape">
<h3>The Peak Shape<a class="headerlink" href="#the-peak-shape" title="Permalink to this headline">¶</a></h3>
<p>Each Peak object contains a PeakShape. Only the integration algorithms which act on, and return PeaksWorkspaces set the shape of the peaks. The PeakShape is owned by the Peak, not the PeaksWorkspace, so when PeaksWorkspaces are split, or concatinated, the integration shapes are unaltered. Aside from the Null Peak Shape, each peak shape contains at least the following information.</p>
<ul class="simple">
<li>The algorithm used to perform the integration</li>
<li>The version of the algorithm used to perform the integration</li>
<li>The frame in which the integration has been performed</li>
</ul>
<p>Subtypes of PeakShape will then provide additional information. For example PeakShapeSpherical provides the radius as well as background inner, and background outer radius.</p>
</div>
</div>
<div class="section" id="using-peaksworkspaces-in-python">
<h2>Using PeaksWorkspaces in Python<a class="headerlink" href="#using-peaksworkspaces-in-python" title="Permalink to this headline">¶</a></h2>
<p>The PeaksWorkspace and Peak objects are exposed to python.</p>
<div class="section" id="peaksworkspace-python-interface">
<h3>PeaksWorkspace Python Interface<a class="headerlink" href="#peaksworkspace-python-interface" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pws</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s">&#39;name_of_peaks_workspace&#39;</span><span class="p">]</span>
<span class="n">pws</span><span class="o">.</span><span class="n">getNumberOfPeaks</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pws</span><span class="o">.</span><span class="n">getPeak</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">pws</span><span class="o">.</span><span class="n">removePeak</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="peak-python-interface">
<h3>Peak Python Interface<a class="headerlink" href="#peak-python-interface" title="Permalink to this headline">¶</a></h3>
<p>You can get a handle to an existing peak with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">p</span> <span class="o">=</span> <span class="n">pws</span><span class="o">.</span><span class="n">getPeak</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<p>Or you can create a new peak in this way:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">qlab</span> <span class="o">=</span> <span class="n">V3D</span><span class="p">(</span><span class="mf">1.23</span><span class="p">,</span> <span class="mf">3.45</span><span class="p">,</span> <span class="mf">2.22</span><span class="p">)</span> <span class="c"># Q in the lab frame of the peak</span>
<span class="n">detector_distance</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="c"># sample-detector distance in meters. Detector distances are optional. Calculated in not provided.</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pws</span><span class="o">.</span><span class="n">createPeak</span><span class="p">(</span><span class="n">qlab</span><span class="p">,</span> <span class="n">detector_distance</span><span class="p">)</span>
<span class="c"># The peak can later be added to the workspace</span>
<span class="n">pws</span><span class="o">.</span><span class="n">addPeak</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>Once you have a handle on a peak &#8220;p&#8221; you have several methods to query/modify its values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">hkl</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">getHKL</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">setHKL</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">getQSampleFrame</span><span class="p">()</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">getQLabFrame</span><span class="p">()</span>
<span class="n">detid</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">getDetectorID</span><span class="p">()</span>

<span class="n">p</span><span class="o">.</span><span class="n">setIntensity</span><span class="p">(</span><span class="mf">1000.0</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">setSigmaIntensity</span><span class="p">(</span><span class="mf">31.6</span><span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">getIntensity</span><span class="p">()</span>

<span class="n">wl</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">getWavelength</span><span class="p">()</span>
<span class="n">tof</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">getTOF</span><span class="p">()</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">getDSpacing</span><span class="p">()</span>
<span class="n">shape</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">getPeakShape</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Category</strong>: <a class="reference external" href="categories/Concepts.html">Concepts</a></p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="NexusFile.html" title="Previous Chapter: Nexus File"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Nexus File</span>
    </a>
  </li>
  <li>
    <a href="Plugin.html" title="Next Chapter: Plugin"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Plugin &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>