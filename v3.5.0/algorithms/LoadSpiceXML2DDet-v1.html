<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>LoadSpiceXML2DDet v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="LoadTOFRawNexus v1" href="LoadTOFRawNexus-v1.html" />
    <link rel="prev" title="LoadSpiceAscii v1" href="LoadSpiceAscii-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.5</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="loadspicexml2ddet-v1">
<span id="algm-loadspicexml2ddet"></span><span id="algm-loadspicexml2ddet-v1"></span><h1>LoadSpiceXML2DDet v1<a class="headerlink" href="#loadspicexml2ddet-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/LoadSpiceXML2DDet-v1_dlg.png"><img alt="../_images/LoadSpiceXML2DDet-v1_dlg.png" class="screenshot" src="../_images/LoadSpiceXML2DDet-v1_dlg.png" style="width: 283px;" /></a>
<p class="caption"><strong>LoadSpiceXML2DDet</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a><ul>
<li><a class="reference internal" href="#format-of-spice-xml-data-file" id="id4">Format of SPICE XML data file</a><ul>
<li><a class="reference internal" href="#counts-of-2d-detector" id="id5">Counts of 2D detector</a></li>
</ul>
</li>
<li><a class="reference internal" href="#output-worskpaces" id="id6">Output Worskpaces</a><ul>
<li><a class="reference internal" href="#matrixworskpace-with-instrument-loaded" id="id7">MatrixWorskpace with instrument loaded</a></li>
<li><a class="reference internal" href="#matrixworkspace-without-instrument-loaded" id="id8">MatrixWorkspace without instrument loaded</a></li>
</ul>
</li>
<li><a class="reference internal" href="#workflow" id="id9">Workflow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id10">Usage</a></li>
<li><a class="reference internal" href="#source" id="id11">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Load 2-dimensional detector data file in XML format from SPICE.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="2%" />
<col width="12%" />
<col width="3%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Filename</td>
<td>Input</td>
<td>string</td>
<td><em>Mandatory</em></td>
<td>XML file name for one scan including 2D detectors counts from SPICE. Allowed extensions: [&#8216;.xml&#8217;]</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Name of output matrix workspace. Output workspace will be an X by Y Workspace2D if instrument is not loaded.</td>
</tr>
<tr class="row-even"><td>DetectorLogName</td>
<td>Input</td>
<td>string</td>
<td>Detector</td>
<td>Log name for detector counts.</td>
</tr>
<tr class="row-odd"><td>DetectorGeometry</td>
<td>Input</td>
<td>unsigned int list</td>
<td>&nbsp;</td>
<td>A size-2 unsigned integer array [X, Y] for detector geometry. Such that the detector contains X x Y pixels.</td>
</tr>
<tr class="row-even"><td>LoadInstrument</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Flag to load instrument to output workspace. HFIR&#8217;s HB3A will be loaded if InstrumentFileName is not specified.</td>
</tr>
<tr class="row-odd"><td>InstrumentFilename</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>The filename (including its full or relative path) of an instrument definition file. The file extension must either be .xml or .XML when specifying an instrument definition file. Note Filename or InstrumentName must be specified but not both. Allowed extensions: [&#8216;.xml&#8217;]</td>
</tr>
<tr class="row-even"><td>SpiceTableWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><em>TableWorkspace</em></a></td>
<td>&nbsp;</td>
<td>Table workspace loaded from SPICE file by LoadSpiceAscii.</td>
</tr>
<tr class="row-odd"><td>PtNumber</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Pt. value for the row to get sample log from.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm is to import SPICE-generated XML file that
records data of one measurement by a (two-dimensional) Anger camera
and create a MatrixWorkspace to contain the detectors&#8217; counts, monitor counts
and other sample log data.</p>
<div class="section" id="format-of-spice-xml-data-file">
<h3><a class="toc-backref" href="#id4">Format of SPICE XML data file</a><a class="headerlink" href="#format-of-spice-xml-data-file" title="Permalink to this headline">¶</a></h3>
<p>The SPICE XML data file contains four sections under parent node <em>SPICErack</em>.
Each section contains child nodes for detailed information.</p>
<blockquote>
<div><ul class="simple">
<li>Header: instrument name, reactor power, experiment title and number, scan number and etc.</li>
<li>Motor_Position: positions of motor <em>m1</em>, <em>marc</em>, <em>2theta</em>, <em>chi</em>, <em>phi</em>, <em>omega</em> and etc.</li>
<li>Parameter_Positions: reading of sample environment devices, such as temperature at sample.</li>
<li>Counters: counting time, monitor counts, and <em>N x N</em> detectors&#8217; counts,</li>
</ul>
</div></blockquote>
<div class="section" id="counts-of-2d-detector">
<h4><a class="toc-backref" href="#id5">Counts of 2D detector</a><a class="headerlink" href="#counts-of-2d-detector" title="Permalink to this headline">¶</a></h4>
<p>Counts of an <img class="math" src="../_images/math/4f3d14039fb04e8494ac3382fe3ca81082d7af33.png" alt="n\times m" style="vertical-align: 0px"/> 2D detectors  are recorded in XML file as below:</p>
<div class="highlight-python"><div class="highlight"><pre>X(1,1)  X(1,2)  X(1,3) ... X(1,m)
.
.
.
X(n,1)  X(n,2) X(n,3) ... X(n,m)
</pre></div>
</div>
<p>And the (1,1) position is the bottom left corner of the Anger camera as seen from the sample position.</p>
</div>
</div>
<div class="section" id="output-worskpaces">
<h3><a class="toc-backref" href="#id6">Output Worskpaces</a><a class="headerlink" href="#output-worskpaces" title="Permalink to this headline">¶</a></h3>
<p>The output from this algorithm is a MatrixWorskpaces.</p>
<div class="section" id="matrixworskpace-with-instrument-loaded">
<h4><a class="toc-backref" href="#id7">MatrixWorskpace with instrument loaded</a><a class="headerlink" href="#matrixworskpace-with-instrument-loaded" title="Permalink to this headline">¶</a></h4>
<p>For a 2D detector with <img class="math" src="../_images/math/4f3d14039fb04e8494ac3382fe3ca81082d7af33.png" alt="n\times m" style="vertical-align: 0px"/> pixels, the output MatrixWorkspace
will have <img class="math" src="../_images/math/00c052f71fb79abf31dc3ae7fd34072de46c5ac6.png" alt="n \times m" style="vertical-align: 0px"/> spectrum.
Each spectrum has 1 data point corresponding to 1 detector&#8217;s count.</p>
<p>All experiment information, sample environment devices&#8217; readings and monitor counts,
which are recorded in XML files,
are converted to the properties in output MatrixWorkspace&#8217;s sample log.</p>
</div>
<div class="section" id="matrixworkspace-without-instrument-loaded">
<h4><a class="toc-backref" href="#id8">MatrixWorkspace without instrument loaded</a><a class="headerlink" href="#matrixworkspace-without-instrument-loaded" title="Permalink to this headline">¶</a></h4>
<p>For a 2D detector with <img class="math" src="../_images/math/4f3d14039fb04e8494ac3382fe3ca81082d7af33.png" alt="n\times m" style="vertical-align: 0px"/> pixels, the output MatrixWorkspace
will have <img class="math" src="../_images/math/3492c6d4b042ddb93d57b7a5aa9532131d9af611.png" alt="n" style="vertical-align: 0px"/> spectrum, each of which has a vector of length equal to <img class="math" src="../_images/math/47e031122c1df8bef662b93f6a2c0751959a98d1.png" alt="m" style="vertical-align: 0px"/>.
It can be mapped to the raw data as <img class="math" src="../_images/math/6227bcb882886fbe3031439ed032c5c652305aa1.png" alt="WS.readY(i)[j] = X(i+1,j+1)" style="vertical-align: -5px"/>.</p>
<p>All experiment information, sample environment devices&#8217; readings and monitor counts,
which are recorded in XML files,
are converted to the properties in output MatrixWorkspace&#8217;s sample log.</p>
</div>
</div>
<div class="section" id="workflow">
<h3><a class="toc-backref" href="#id9">Workflow</a><a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h3>
<p>Algorithm <em>LoadSpiceXML2DDet</em> is one of a series of algorithms that are implemented to
reduced HFIR HB3A data collected from Anger camera.
It will be called next to <em>LoadSpiceAscii</em> to load the detector&#8217;s reading.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id10">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - load a HB3A SPICE .xml file without loading instrument:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Load data by LoadSpiceXML2DDet()</span>
<span class="n">LoadSpiceXML2DDet</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">&#39;HB3A_exp355_scan0001_0522.xml&#39;</span><span class="p">,</span>
    <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s">&#39;s0001_0522&#39;</span><span class="p">,</span> <span class="n">DetectorGeometry</span><span class="o">=</span><span class="s">&#39;256,256&#39;</span><span class="p">,</span>
    <span class="n">LoadInstrument</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># Access output workspace and print out some result</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s">&quot;s0001_0522&quot;</span><span class="p">]</span>

<span class="k">print</span> <span class="s">&quot;Number of spectrum = </span><span class="si">%d</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="p">(</span><span class="mi">136</span><span class="p">,</span> <span class="mi">140</span><span class="p">),</span> <span class="p">(</span><span class="mi">143</span><span class="p">,</span> <span class="mi">140</span><span class="p">)]:</span>
    <span class="k">print</span> <span class="s">&quot;Y[</span><span class="si">%-3d</span><span class="s">, </span><span class="si">%-3d</span><span class="s">] = </span><span class="si">%.5f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="n">j</span><span class="p">])</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Number of spectrum = 256.
Y[0  , 0  ] = 0.00000
Y[255, 255] = 0.00000
Y[136, 140] = 1.00000
Y[143, 140] = 2.00000
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/DataHandling.html">DataHandling</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id11">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/613f181e9f72836daa8dfbef179177ec3655c251/Code/Mantid/Framework/DataHandling/src/LoadSpiceXML2DDet.cpp">LoadSpiceXML2DDet.cpp</a></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/613f181e9f72836daa8dfbef179177ec3655c251/Code/Mantid/Framework/DataHandling/inc/MantidDataHandling/LoadSpiceXML2DDet.h">LoadSpiceXML2DDet.h</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="LoadSpiceAscii-v1.html" title="Previous Chapter: LoadSpiceAscii v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; LoadSpiceAscii v...</span>
    </a>
  </li>
  <li>
    <a href="LoadTOFRawNexus-v1.html" title="Next Chapter: LoadTOFRawNexus v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">LoadTOFRawNexus ... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>