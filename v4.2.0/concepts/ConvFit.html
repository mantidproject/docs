<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Conv Fit</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '4.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="up" title="Concepts" href="index.html" />
    <link rel="next" title="Create an IDF" href="CreateanIDF.html" />
    <link rel="prev" title="ComponentInfo" href="ComponentInfo.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>4.2</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="conv-fit">
<span id="convfitconcept"></span><h1>Conv Fit<a class="headerlink" href="#conv-fit" title="Permalink to this headline">¶</a></h1>
<p>The measured data <img class="math" src="../_images/math/62eeaf9d91731a64c0b0cae683934749e9c96dab.png" alt="I(Q, \omega)" style="vertical-align: -4px"/> is proportional to the convolution of the
scattering law <img class="math" src="../_images/math/af385cf70e9aa29bed9ee6fc11c442d61c12f402.png" alt="S(Q, \omega)" style="vertical-align: -4px"/> with the resolution function <img class="math" src="../_images/math/ef8af6b1b14aa37d62c4d1b4872a9156b0345825.png" alt="R(Q,
\omega)" style="vertical-align: -4px"/> of the spectrometer via <img class="math" src="../_images/math/589024e6b7ed300d2110debdab12aa6cc3158193.png" alt="I(Q, \omega) = S(Q, \omega) ⊗  R(Q,
\omega)" style="vertical-align: -4px"/>. The traditional method of analysis has been to fit the measured
<img class="math" src="../_images/math/62eeaf9d91731a64c0b0cae683934749e9c96dab.png" alt="I(Q, \omega)" style="vertical-align: -4px"/> with an appropriate set of functions related to the form of
<img class="math" src="../_images/math/af385cf70e9aa29bed9ee6fc11c442d61c12f402.png" alt="S(Q, \omega)" style="vertical-align: -4px"/> predicted by theory.</p>
<ul class="simple">
<li>In quasielastic scattering the simplest form is when both the <img class="math" src="../_images/math/a541d552e98780191bbfcbce2f098e20c42e8abb.png" alt="S(Q,
\omega)" style="vertical-align: -4px"/> and the <img class="math" src="../_images/math/03926e75985df98d21e9d535fe2f533a621cadb4.png" alt="R(Q, \omega)" style="vertical-align: -4px"/> have the form of a Lorentzian - a
situation which is almost correct for reactor based backscattering
spectrometers such as IN10 &amp; IN16 at ILL. The convolution of two Lorentzians
is itself a Lorentzian so that the spectrum of the measured and resolution
data can both just be fitted with Lorentzians. The broadening of the sample
spectrum is then just the  difference of the two widths.</li>
<li>The next easiest case is when both <img class="math" src="../_images/math/af385cf70e9aa29bed9ee6fc11c442d61c12f402.png" alt="S(Q, \omega)" style="vertical-align: -4px"/> and <img class="math" src="../_images/math/ef8af6b1b14aa37d62c4d1b4872a9156b0345825.png" alt="R(Q,
\omega)" style="vertical-align: -4px"/> have a simple functional form and the convolution is also a function
containing the parameters of the <img class="math" src="../_images/math/af385cf70e9aa29bed9ee6fc11c442d61c12f402.png" alt="S(Q, \omega)" style="vertical-align: -4px"/> and R(Q,  omega) functions.
The convoluted function may then be fitted to the data to provide the
parameters. An example would be the case where the <img class="math" src="../_images/math/af385cf70e9aa29bed9ee6fc11c442d61c12f402.png" alt="S(Q, \omega)" style="vertical-align: -4px"/> is a
Lorentzian and the <img class="math" src="../_images/math/03926e75985df98d21e9d535fe2f533a621cadb4.png" alt="R(Q, \omega)" style="vertical-align: -4px"/> is a Gaussian.</li>
<li>For diffraction, the shape of the peak in time is a convolution of a Gaussian
with a decaying exponential and this function can be used to fit the Bragg
peaks.</li>
<li>The final case is where <img class="math" src="../_images/math/03926e75985df98d21e9d535fe2f533a621cadb4.png" alt="R(Q, \omega)" style="vertical-align: -4px"/> does not have a simple function
form so that the measured data has to be convoluted numerically with the
<img class="math" src="../_images/math/af385cf70e9aa29bed9ee6fc11c442d61c12f402.png" alt="S(Q, \omega)" style="vertical-align: -4px"/> function to provide an estimate of the sample scattering.
The result is least-squares fitted to the measured data to provide values for
the parameters in the <img class="math" src="../_images/math/af385cf70e9aa29bed9ee6fc11c442d61c12f402.png" alt="S(Q, \omega)" style="vertical-align: -4px"/> function.</li>
</ul>
<p>This latter form of peak fitting is provided by SWIFT. It employs a
least-squares algorithm which requires the derivatives of the fitting function
with respect to its parameters in order to be faster and more efficient than
those algorithms which calculate the derivatives numerically. To do this the
assumption is made that the derivative of a convolution is equal to the
convolution of the derivative-as the derivative and the convolution are
performed over different variables (function parameters and energy transfer
respectively) this should be correct. A flat background is subtracted from the
resolution data before the convolution is performed.</p>
<p>Four types of sample function are available for <img class="math" src="../_images/math/af385cf70e9aa29bed9ee6fc11c442d61c12f402.png" alt="S(Q, \omega)" style="vertical-align: -4px"/>:</p>
<dl class="docutils">
<dt>Quasielastic</dt>
<dd>This is the most common case and applies to both translational (diffusion) and
rotational modes, both of which have the form of a Lorentzian. The fitted
function is a set of Lorentzians centred at the origin in energy transfer.</dd>
<dt>Elastic</dt>
<dd>Comprising a central elastic peak together with a set of quasi-elastic
Lorentzians also centred at the origin. The elastic peak is taken to be the
un-broadened resolution function.</dd>
<dt>Shift</dt>
<dd>A central Lorentzian with pairs of energy shifted Lorentzians. This was
originally used for crystal field splitting data but more recently has been
applied to quantum tunnelling peaks. The fitting function assumes that the
peaks are symmetric about the origin in energy transfer both in position and
width. The widths of the central and side peaks may be different.</dd>
<dt>Polymer</dt>
<dd>A single quasi-elastic peak with 3 different forms of shape. The theory behind
this is described elsewhere [1,2]. Briefly, polymer theory predicts 3 forms
of the <img class="math" src="../_images/math/a66c759fb2d393072554227d08640ab32742af93.png" alt="I(Q,t)" style="vertical-align: -4px"/> in the form of <img class="math" src="../_images/math/47336f8ee2d2d54c35e4e14b0a8bdaa3fd404121.png" alt="exp(-at2/b)" style="vertical-align: -5px"/> where <img class="math" src="../_images/math/fdcf4bd764a50e69250d8e0a9e2212d63e8ecfe0.png" alt="b" style="vertical-align: 0px"/> can
be 2, 3 or 4. The Full Width Half-Maximum (FWHM) then has a Q-dependence
(power law) of the form <img class="math" src="../_images/math/3cdc55b86ab9c81825cfaaa932cf279304da8e0e.png" alt="Qb" style="vertical-align: -4px"/>. The <img class="math" src="../_images/math/a66c759fb2d393072554227d08640ab32742af93.png" alt="I(Q,t)" style="vertical-align: -4px"/> has been numerically
Fourier transformed into <img class="math" src="../_images/math/62eeaf9d91731a64c0b0cae683934749e9c96dab.png" alt="I(Q, \omega)" style="vertical-align: -4px"/> and the <img class="math" src="../_images/math/62eeaf9d91731a64c0b0cae683934749e9c96dab.png" alt="I(Q, \omega)" style="vertical-align: -4px"/>
have been fitted with functions of the form of a modified Lorentzian. These
latter functions are used in the energy fitting procedures.</dd>
</dl>
<p>References:</p>
<ol class="arabic simple">
<li>J S Higgins, R E Ghosh, W S Howells &amp; G Allen, <a class="reference external" href="http://dx.doi.org/10.1039/F29777300040">JCS Faraday II 73 40 (1977)</a></li>
<li>J S Higgins, G Allen, R E Ghosh, W S Howells &amp; B Farnoux, <a class="reference external" href="http://dx.doi.org/10.1016/0009-2614(77)80569-1">Chem Phys Lett 49 197 (1977)</a></li>
</ol>
<p><strong>Category</strong>: <a class="reference external" href="../api/python/mantid/api/categories/Concepts.html">Concepts</a></p>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ComponentInfo.html" title="Previous Chapter: ComponentInfo"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; ComponentInfo</span>
    </a>
  </li>
  <li>
    <a href="CreateanIDF.html" title="Next Chapter: Create an IDF"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Create an IDF &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2019-11-18.<br/>
    </p>
  </div>
</footer>
  </body>
</html>