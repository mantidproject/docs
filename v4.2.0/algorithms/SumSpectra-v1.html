<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SumSpectra v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '4.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="SwapWidths v1" href="SwapWidths-v1.html" />
    <link rel="prev" title="SumRowColumn v1" href="SumRowColumn-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>4.2</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="sumspectra-v1">
<span id="algm-sumspectra"></span><span id="algm-sumspectra-v1"></span><h1>SumSpectra v1<a class="headerlink" href="#sumspectra-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/SumSpectra-v1_dlg.png"><img alt="../_images/SumSpectra-v1_dlg.png" class="screenshot" src="../_images/SumSpectra-v1_dlg.png" style="width: 332px;" /></a>
<p class="caption"><strong>SumSpectra</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id2">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id3">Properties</a></li>
<li><a class="reference internal" href="#description" id="id4">Description</a></li>
<li><a class="reference internal" href="#usage" id="id5">Usage</a></li>
<li><a class="reference internal" href="#source" id="id6">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>The SumSpectra algorithm adds the data values in each time bin across a range of spectra; the output workspace has a single spectrum. If the input is an EventWorkspace, the output is also an EventWorkspace; otherwise it will be a Workspace2D.</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id2">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="SumNeighbours-v1.html#algm-sumneighbours"><em>SumNeighbours</em></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id3">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="2%" />
<col width="9%" />
<col width="3%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>The workspace containing the spectra to be summed.</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>The name of the workspace to be created as the output of the algorithm.  A workspace of this name will be created and stored in the Analysis Data Service.</td>
</tr>
<tr class="row-even"><td>StartWorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>The first Workspace index to be included in the summing</td>
</tr>
<tr class="row-odd"><td>EndWorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>The last Workspace index to be included in the summing</td>
</tr>
<tr class="row-even"><td>ListOfWorkspaceIndices</td>
<td>Input</td>
<td>int list</td>
<td>&nbsp;</td>
<td>A list of workspace indices as a string with ranges, for example: 5-10,15,20-23.  Optional: if not specified, then the Start/EndWorkspaceIndex fields are used alone. If specified, the range and the list are combined (without duplicating indices). For example, a range of 10 to 20 and a list &#8216;12,15,26,28&#8217; gives &#8216;10-20,26,28&#8217;.</td>
</tr>
<tr class="row-odd"><td>IncludeMonitors</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Whether to include monitor spectra in the summation.</td>
</tr>
<tr class="row-even"><td>WeightedSum</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Instead of the usual spectra sum, calculate the weighted sum. This has the form:  <img class="math" src="../_images/math/02fdddd4ac847c5c987182bd20be612cb44c4e2c.png" alt="nSpectra \times\Sigma(Signal_i/Error_i^2)/\Sigma(1/Error_i^2)" style="vertical-align: -5px"/>  This property is ignored for event workspace. The sums are defined for <img class="math" src="../_images/math/08a6f01a9eac2ad2cf4b57d57c0f469ccdc49486.png" alt="Error_i != 0" style="vertical-align: -3px"/> only, so the values with zero error are dropped from the summation. To estimate the number of dropped values see the description.</td>
</tr>
<tr class="row-odd"><td>RemoveSpecialValues</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>If enabled floating point special values such as NaN or Inf are removed before the spectra are summed.</td>
</tr>
<tr class="row-even"><td>MultiplyBySpectra</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>For unnormalized data one should multiply the weighted sum by the number of spectra contributing to the bin.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id4">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Takes a workspace as input and sums all of the spectra within it
maintaining the existing bin structure and units. Any masked spectra are
ignored. The result is stored as a new workspace containing a single
spectra.</p>
<p>If we define a the <img class="math" src="../_images/math/7305958a9a687813e5f414cdbb54ab0c876a4503.png" alt="i^{th}" style="vertical-align: 0px"/> spectrum with bins <img class="math" src="../_images/math/c18271eddf460603079ed91e4dc4af329a59eab2.png" alt="j" style="vertical-align: -4px"/>. The unweighted sum is just (<tt class="docutils literal"><span class="pre">WeightedSum=False</span></tt>)</p>
<div class="math">
<p><img src="../_images/math/37b4ba2edafd5b69c3c654418e6d50f9660fbd37.png" alt="Signal[j] = \displaystyle\Sigma_{i \in spectra} Signal_i[j]"/></p>
</div><p>The weighted sum (<tt class="docutils literal"><span class="pre">WeightedSum=True</span></tt> and <tt class="docutils literal"><span class="pre">MultiplyBySpectra=True</span></tt>, ignored for event workspaces), the sum is defined (skipping <img class="math" src="../_images/math/b0830290a296fbde378bee0bdae99c53119c5704.png" alt="Signal_i[j]" style="vertical-align: -5px"/> when <img class="math" src="../_images/math/3317f21fd73a388cc171eca99d5e7675b81145bb.png" alt="Error_i[j] == 0" style="vertical-align: -5px"/>),</p>
<div class="math">
<p><img src="../_images/math/a1e13adad69fe4575cb6e5d46315bf19c7839b84.png" alt="Signal[j] = NSpectra \times \displaystyle\Sigma_{i \in spectra} \left(\frac{Signal_i[j]}{Error_i^2[j]}\right) / \Sigma_{i \in spectra}\left(\frac{1}{Error_i^2[j]}\right)"/></p>
</div><p><img class="math" src="../_images/math/3c62d88222225fe65187e36a0d30fa768d6bcd5d.png" alt="NSpectra" style="vertical-align: -4px"/> is the number of spectra contributing to that bin. If the weights contributing to the sum are equal, these result in the same value. This should be used for unnormalized (e.g. not divided by vanadium spectrum) data. If the data has been normalized (e.g. divided by vanadium spectrum for total scattering) then multiplying by the number of spectra contributing to the bin is incorrect, use <tt class="docutils literal"><span class="pre">WeightedSum=True</span></tt> and <tt class="docutils literal"><span class="pre">MultiplyBySpectra=False</span></tt> to sum as</p>
<div class="math">
<p><img src="../_images/math/2e422023af9042efcbcae159c7241abd137c3ccc.png" alt="Signal[j] = \displaystyle\Sigma_{i \in spectra} \left(\frac{Signal_i[j]}{Error_i^2[j]}\right) / \Sigma_{i \in spectra}\left(\frac{1}{Error_i^2[j]}\right)"/></p>
</div><p>The algorithm adds to the <tt class="docutils literal"><span class="pre">OutputWorkspace</span></tt> three additional
properties (Log values). The properties (Log) names are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">NumAllSpectra</span></tt> is the number of spectra contributed to the sum</li>
<li><tt class="docutils literal"><span class="pre">NumMaskSpectra</span></tt> is the spectra dropped from the summations because they are masked. Monitors are not included in this total if <tt class="docutils literal"><span class="pre">IncludeMonitors=False</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">NumZeroSpectra</span></tt> is the number of zero bins in histogram workspace or empty spectra for event workspace. These spectra are dropped from the summation of histogram workspace when <tt class="docutils literal"><span class="pre">WeightedSum=True</span></tt>.</li>
</ul>
<p>Assuming <tt class="docutils literal"><span class="pre">pWS</span></tt> is the output workspace handle, from Python these
properties can be accessed using:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nSpectra</span>       <span class="o">=</span> <span class="n">pWS</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">getLogData</span><span class="p">(</span><span class="s">&quot;NumAllSpectra&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="n">nMaskedSpectra</span> <span class="o">=</span> <span class="n">pWS</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">getLogData</span><span class="p">(</span><span class="s">&quot;NumMaskSpectra&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="n">nZeroSpectra</span>   <span class="o">=</span> <span class="n">pWS</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">getLogData</span><span class="p">(</span><span class="s">&quot;NumZeroSpectra&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id5">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - a simple example of running SumSpectra.</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="s">&quot;Histogram&quot;</span><span class="p">,</span> <span class="n">Random</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Workspace has </span><span class="si">%d</span><span class="s"> spectra&quot;</span> <span class="o">%</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span>

<span class="n">ws</span> <span class="o">=</span> <span class="n">SumSpectra</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Workspace has </span><span class="si">%d</span><span class="s"> spectra&quot;</span> <span class="o">%</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Workspace has 200 spectra
Workspace has 1 spectra
</pre></div>
</div>
<p><strong>Example - running SumSpectra with a list of indices.</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="s">&quot;Histogram&quot;</span><span class="p">,</span> <span class="n">Random</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Workspace has </span><span class="si">%d</span><span class="s"> spectra&quot;</span> <span class="o">%</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span>

<span class="n">ws</span> <span class="o">=</span> <span class="n">SumSpectra</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">ListOfWorkspaceIndices</span><span class="o">=</span><span class="s">&#39;0-3, 10-13&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Workspace has </span><span class="si">%d</span><span class="s"> spectra&quot;</span> <span class="o">%</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Workspace has 200 spectra
Workspace has 1 spectra
</pre></div>
</div>
<p><strong>Example - a running SumSpectra with a start and end index.</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="s">&quot;Histogram&quot;</span><span class="p">,</span> <span class="n">Random</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Workspace has </span><span class="si">%d</span><span class="s"> spectra&quot;</span> <span class="o">%</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span>

<span class="n">ws</span> <span class="o">=</span> <span class="n">SumSpectra</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">StartWorkspaceIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">EndWorkspaceIndex</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Workspace has </span><span class="si">%d</span><span class="s"> spectra&quot;</span> <span class="o">%</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Workspace has 200 spectra
Workspace has 1 spectra
</pre></div>
</div>
<p><strong>Example - a running SumSpectra in weighted sum mode.</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="s">&quot;Histogram&quot;</span><span class="p">,</span> <span class="n">Random</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Workspace has </span><span class="si">%d</span><span class="s"> spectra&quot;</span> <span class="o">%</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span>

<span class="n">ws</span> <span class="o">=</span> <span class="n">SumSpectra</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">WeightedSum</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Workspace has </span><span class="si">%d</span><span class="s"> spectra&quot;</span> <span class="o">%</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Workspace has 200 spectra
Workspace has 1 spectra
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Transforms/Grouping.html">Transforms\Grouping</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id6">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/242afc63eface10e47f5e9e6aeaed50e11e3eb4c/Framework/Algorithms/src/SumSpectra.cpp">SumSpectra.cpp</a> <em>(last modified: 2019-07-17)</em></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/242afc63eface10e47f5e9e6aeaed50e11e3eb4c/Framework/Algorithms/inc/MantidAlgorithms/SumSpectra.h">SumSpectra.h</a> <em>(last modified: 2018-10-05)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="SumRowColumn-v1.html" title="Previous Chapter: SumRowColumn v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SumRowColumn v1</span>
    </a>
  </li>
  <li>
    <a href="SwapWidths-v1.html" title="Next Chapter: SwapWidths v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SwapWidths v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2019-11-18.<br/>
    </p>
  </div>
</footer>
  </body>
</html>