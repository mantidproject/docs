<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>DownloadInstrument v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.9.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="DownloadRemoteFile v1" href="DownloadRemoteFile-v1.html" />
    <link rel="prev" title="DownloadFile v1" href="DownloadFile-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="downloadinstrument-v1">
<span id="algm-downloadinstrument"></span><span id="algm-downloadinstrument-v1"></span><h1>DownloadInstrument v1<a class="headerlink" href="#downloadinstrument-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/DownloadInstrument-v1_dlg.png"><img alt="../_images/DownloadInstrument-v1_dlg.png" class="screenshot" src="../_images/DownloadInstrument-v1_dlg.png" style="width: 312px;" /></a>
<p class="caption"><strong>DownloadInstrument</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a><ul>
<li><a class="reference internal" href="#mantid-property-keys" id="id4">Mantid Property Keys</a></li>
<li><a class="reference internal" href="#output-messages" id="id5">Output Messages</a></li>
<li><a class="reference internal" href="#the-details" id="id6">The details</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id7">Usage</a></li>
<li><a class="reference internal" href="#source" id="id8">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Checks the Mantid instrument repository against the local instrument files, and downloads updates as appropriate.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="8%" />
<col width="9%" />
<col width="7%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ForceUpdate</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Ignore cache information</td>
</tr>
<tr class="row-odd"><td>FileDownloadCount</td>
<td>Output</td>
<td>number</td>
<td>&nbsp;</td>
<td>The number of files downloaded by this algorithm</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm connects with the cloud based Mantid Instrument Definition
Repository and downloads any updated instrument files for use within Mantid.</p>
<p>This algorithm is normally run on startup of Mantid for official installed
releases of Mantid from version 3.3 onwards.</p>
<div class="section" id="mantid-property-keys">
<h3><a class="toc-backref" href="#id4">Mantid Property Keys</a><a class="headerlink" href="#mantid-property-keys" title="Permalink to this headline">¶</a></h3>
<p>The code is configured using he following Mantid.Property, or Mantid.User.Property keys.</p>
<dl class="docutils">
<dt>UpdateInstrumentDefinitions.OnStartup = 1</dt>
<dd>This controls wether this algorithm is run on startup of Mantid.  1 = Run on startup, 0 = don&#8217;t.</dd>
<dt>UpdateInstrumentDefinitions.URL = <a class="reference external" href="https://api.github.com/repos/mantidproject/mantid/contents/instrument">https://api.github.com/repos/mantidproject/mantid/contents/instrument</a></dt>
<dd>This stores the url used to access the contents of the Mantid Instrument Definition Repository.</dd>
</dl>
</div>
<div class="section" id="output-messages">
<h3><a class="toc-backref" href="#id5">Output Messages</a><a class="headerlink" href="#output-messages" title="Permalink to this headline">¶</a></h3>
<p>The following may be logged at Notice</p>
<dl class="docutils">
<dt>All instrument definitions up to date</dt>
<dd>Everything is fine, there are no updates to download.</dd>
<dt>Downloading n files from the instrument repository</dt>
<dd>Some files have changed or been added to the Instrument Repository, they are being downloaded.</dd>
<dt>Internet Connection Failed - cannot update instrument definitions.</dt>
<dd>The connection to the instrument Repository failed.  This could be down to your network connection, proxy settings (we use the system proxy settings).  More details will be logged as another message at information level.</dd>
<dt>Instrument Definition Update: The Github API rate limit has been reached, try again after 19-Feb-2015 11:23:34</dt>
<dd>There is a limit of how many calls we are allowed to make to Github per hour.  Try again after the time specified.  If this keeps occuring let the developement team know.</dd>
</dl>
</div>
<div class="section" id="the-details">
<h3><a class="toc-backref" href="#id6">The details</a><a class="headerlink" href="#the-details" title="Permalink to this headline">¶</a></h3>
<p>The Mantid Instrument Definition Repository is currently a directory within the Mantid code repository on Github.
<a class="reference external" href="https://github.com/mantidproject/mantid">https://github.com/mantidproject/mantid</a></p>
<p>The instrument files within Mantid can be accessed in three locations.</p>
<ol class="arabic simple">
<li>The mantid install directory [Install Dir] (windows default &#8220;C:mantidinstallinstrument&#8221;).</li>
<li>The local user appdata directory [Appdata Dir] (windows &#8220;%APPDATA%mantidprojectmantidinstrument&#8221;, linux/Mac &#8220;~/.mantid/instrument&#8221;).</li>
<li>Mantid Instrument repository [Instrument Repo] on Github</li>
</ol>
<p>When running the algorithm the processing takes the following steps.</p>
<ol class="arabic simple">
<li>The description of the contents of the Instrument Repo is downloaded and stored in a file github.json to the Appdata Dir.</li>
<li>A file of the desription of xml files in  Appdata Dir and Install Dir are updated or created and saved into AppData Dir as install.json and appdata.json.</li>
<li>The contents of all 3 are inspected and new or updated files (based on the git checksum) are added to a download list.</li>
<li>The list of files are downloaded to the Appdata Dir.</li>
<li><a class="reference internal" href="LoadInstrument-v1.html#algm-loadinstrument"><em>LoadInstrument v1</em></a> will load files in Appdata Dir in preference to those in the Install Dir if both are valid.</li>
</ol>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id7">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">updatedFileCount</span> <span class="o">=</span> <span class="n">DownloadInstrument</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;The number of files updated was &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">updatedFileCount</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">files</span> <span class="n">updated</span> <span class="n">was</span> <span class="o">...</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/DataHandling/Instrument.html">DataHandling\Instrument</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id8">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/855d87d02cc81b30296c0eae91fc76b4b143c405/Framework/DataHandling/src/DownloadInstrument.cpp">DownloadInstrument.cpp</a></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/855d87d02cc81b30296c0eae91fc76b4b143c405/Framework/DataHandling/inc/MantidDataHandling/DownloadInstrument.h">DownloadInstrument.h</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="DownloadFile-v1.html" title="Previous Chapter: DownloadFile v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; DownloadFile v1</span>
    </a>
  </li>
  <li>
    <a href="DownloadRemoteFile-v1.html" title="Next Chapter: DownloadRemoteFile v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">DownloadRemoteFi... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>