<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Pearl Powder Diffraction Script</title>
    
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '3.9.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../../../index.html" />
    <link rel="up" title="Python API" href="../index.html" />
    <link rel="next" title="ISIS Powder Diffraction" href="PowderDiffractionISIS-v1.html" />
    <link rel="prev" title="Crystallography Powder Diffraction Script" href="CryPowderDiffractionISIS-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../../../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="pearl-powder-diffraction-script">
<span id="pearl-powder-diffraction-ref"></span><h1>Pearl Powder Diffraction Script<a class="headerlink" href="#pearl-powder-diffraction-script" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>A wide variety of algorithms are available within Mantid for
processing of data, writing results files, etc.  These may be run
interactively, one at a time, but in general scripting (using the
Python scripting language) enables a series of algorithms to be called
in a specific order to carry out more complex tasks, such as data
normalisation and writing data files suitable for input to Rietveld
refinement programmes (GSAS, FullProf, etc).
The script used to process Pearl data have been integrated to Mantid
which can be found inside the following directory on a Windows machine:
<cite>&#8216;C:\MantidInstall\scripts\PearlPowderISIS&#8217;</cite>.</p>
<p>Further extensions can be expected for next releases as it is under
active development and feedback is very much welcome. The sections
below describes how the script can be ran and help user develop
understanding of the script. By utilising this script it is assumed
that the scientists/users at ISIS have permission to read and write
from the network. Where <strong>`P:\`</strong> drive is linked to <strong>`\\britannic\Pearl\`</strong>
and <strong>`X:\`</strong> drive is linked to <strong>`\\isis\inst$\NDXPEARL\Instrument`</strong>.</p>
</div>
<div class="section" id="run-requirement">
<h2>Run Requirement<a class="headerlink" href="#run-requirement" title="Permalink to this headline">¶</a></h2>
<p>A simple script is required to be ran inside the <a class="reference external" href="http://docs.mantidproject.org/nightly/interfaces/ScriptingWindow.html">Scripting Window</a>
on mantid in order to carry out the data normalisation.</p>
<p>The script which is written inside <a class="reference external" href="http://docs.mantidproject.org/nightly/interfaces/ScriptingWindow.html">Scripting Window</a> on Mantid
requires the following from the user (followed up with an example
usage):</p>
<ul class="simple">
<li>user name e.g: (<cite>&#8216;Bull&#8217;</cite>)</li>
<li>cycle number e.g: (<cite>&#8216;15_4&#8217;</cite>)</li>
<li>run number/s e.g: (<cite>&#8216;92476_92479&#8217;</cite>)</li>
<li>fmode e.g: (<cite>&#8216;trans&#8217;</cite>)</li>
<li>ttmode e.g: (<cite>&#8216;TT70&#8217;</cite>)</li>
</ul>
<p>If the following parameters are not passed, the default values are
used instead.</p>
<ul class="simple">
<li>ext e.g: (<cite>&#8216;raw&#8217;</cite>, <cite>&#8216;s01&#8217;</cite>) - file extension, default is set as <cite>raw</cite></li>
<li>atten e.g: (<cite>True</cite> or <cite>False</cite>) - whether use attentuation file, default
is set as <cite>True</cite></li>
<li>debug e.g: (<cite>True`or `False</cite>) - whether to use debug mode, default
is set as <cite>False</cite></li>
<li>optional: Attentuation file directory - if you would wish to use
a different Attentuation file e.g:
(<cite>&#8216;P:\Mantid\Attentuation\PRL112_DC25_10MM_FF.OUT&#8217;</cite>)</li>
<li>optional: Output directory - only if you wish to write out the
files to preferred directory/location instead of the Pearl network.
e.g: (<cite>&#8216;C:\Mantid\MantidOut\&#8217;</cite>)</li>
</ul>
<p><em>Usage examples can be found under the</em> <a class="reference internal" href="#pearl-powder-diffraction-usage-ref"><em>Workflow</em></a> <em>section.</em></p>
</div>
<div class="section" id="file-folders">
<h2>File &amp; Folders<a class="headerlink" href="#file-folders" title="Permalink to this headline">¶</a></h2>
<p>The routines/script has been differentiated from the list of
directories of <cite>calibration</cite> and <cite>raw</cite> files. The calibration
directories can be found within <cite>&#8216;pearl_calib_factory.py&#8217;</cite>,
whereas the the raw directories can be found within
<cite>&#8216;pearl_cycle_factory.py&#8217;</cite>.</p>
<p>You are not require to set calibration and raw files directory,
unless you are utilising calibration files from your local machine.
The script will automatically find the correct calibration files
on the Pearl network according to the input run number, fmode and
ttmode. All the calibration files can be found in
<cite>&#8216;P:\Mantid\Calibration&#8217;</cite>, whereas all the Attenuation (<cite>.OUT</cite>)
files can be found within the following directory
<cite>&#8216;P:\Mantid\Attentuation&#8217;</cite>.</p>
<p>The output files by default will be written out to the following
location: <cite>&#8216;P:\users\cycle number\user name&#8217;</cite> e.g:
<cite>&#8216;P:\users\Cycle_15_4\Bull\&#8217;</cite>, however a personalised output
directory can be provided instead like explained in Run
Requirement section.</p>
</div>
<div class="section" id="workflow">
<span id="pearl-powder-diffraction-usage-ref"></span><h2>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pearl-run-focus-workflow">
<h3>PEARL Run Focus Workflow<a class="headerlink" href="#pearl-run-focus-workflow" title="Permalink to this headline">¶</a></h3>
<img alt="../../../_images/PEARL-Run_focus-wkflw.png" src="../../../_images/PEARL-Run_focus-wkflw.png" />
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example 1 - General Script Utilised To Process Powder Diffraction With Pearl</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pearl_routines</span>

<span class="c"># set up the user name and cycle number</span>
<span class="n">pearl_routines</span><span class="o">.</span><span class="n">PEARL_startup</span><span class="p">(</span><span class="s">&#39;Bull&#39;</span><span class="p">,</span><span class="s">&#39;15_4&#39;</span><span class="p">)</span>

<span class="c"># set up the directory to the attentuation file</span>
<span class="n">pearl_routines</span><span class="o">.</span><span class="n">PEARL_setattenfile</span><span class="p">(</span><span class="n">new_atten</span><span class="o">=</span><span class="s">&#39;P:</span><span class="se">\\</span><span class="s">Mantid</span><span class="se">\\</span><span class="s">Attentuation</span><span class="se">\\</span><span class="s">PRL112_DC25_10MM_FF.OUT&#39;</span><span class="p">)</span>

<span class="c"># set up the run number/s, ext, fmode, ttmode, use attentuation file (True), do vanadium normalisation (True)</span>
<span class="n">pearl_routines</span><span class="o">.</span><span class="n">PEARL_focus</span><span class="p">(</span><span class="s">&#39;92476_92479&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s">&#39;raw&#39;</span><span class="p">,</span> <span class="n">fmode</span><span class="o">=</span><span class="s">&#39;trans&#39;</span><span class="p">,</span> <span class="n">ttmode</span><span class="o">=</span><span class="s">&#39;TT70&#39;</span><span class="p">,</span> <span class="n">atten</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">van_norm</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Example 2 - Simplified Script Utilised To Process Powder Diffraction With Pearl</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pearl_routines</span>

<span class="n">pearl_routines</span><span class="o">.</span><span class="n">PEARL_startup</span><span class="p">(</span><span class="s">&#39;Mantid_Developer&#39;</span><span class="p">,</span><span class="s">&#39;15_4&#39;</span><span class="p">)</span>
<span class="c"># default values used here for ext (&#39;raw&#39;), atten (True), van_norm (True) and debug (False)</span>
<span class="c"># uses the default attentuation file within the script - &#39;PRL985_WC_HOYBIDE_NK_10MM_FF.OUT&#39;</span>
<span class="n">pearl_routines</span><span class="o">.</span><span class="n">PEARL_focus</span><span class="p">(</span><span class="mi">86329</span><span class="p">,</span> <span class="n">fmode</span><span class="o">=</span><span class="s">&#39;trans&#39;</span><span class="p">,</span> <span class="n">ttmode</span><span class="o">=</span><span class="s">&#39;TT70&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Example 3 - Script Utilised To Process Powder Diffraction With Pearl In Debug Mode</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pearl_routines</span>

<span class="n">pearl_routines</span><span class="o">.</span><span class="n">PEARL_startup</span><span class="p">(</span><span class="s">&#39;Bull&#39;</span><span class="p">,</span><span class="s">&#39;15_4&#39;</span><span class="p">)</span>
<span class="c"># &#39;s01&#39; is being passed as an extension instead of &#39;raw&#39; or `nxs`</span>
<span class="n">pearl_routines</span><span class="o">.</span><span class="n">PEARL_focus</span><span class="p">(</span><span class="mi">92475</span><span class="p">,</span> <span class="s">&#39;s01&#39;</span><span class="p">,</span> <span class="n">fmode</span><span class="o">=</span><span class="s">&#39;trans&#39;</span><span class="p">,</span> <span class="n">ttmode</span><span class="o">=</span><span class="s">&#39;TT70&#39;</span><span class="p">,</span> <span class="n">atten</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">van_norm</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="CryPowderDiffractionISIS-v1.html" title="Previous Chapter: Crystallography Powder Diffraction Script"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Crystallography ...</span>
    </a>
  </li>
  <li>
    <a href="PowderDiffractionISIS-v1.html" title="Next Chapter: ISIS Powder Diffraction"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">ISIS Powder Diff... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>