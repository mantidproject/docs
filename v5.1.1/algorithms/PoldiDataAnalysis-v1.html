<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>PoldiDataAnalysis v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PoldiFitPeaks1D v1" href="PoldiFitPeaks1D-v1.html" />
    <link rel="prev" title="PoldiCreatePeaksFromFile v1" href="PoldiCreatePeaksFromFile-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>5.1</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="poldidataanalysis-v1">
<span id="algm-poldidataanalysis"></span><span id="algm-poldidataanalysis-v1"></span><h1>PoldiDataAnalysis v1<a class="headerlink" href="#poldidataanalysis-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/PoldiDataAnalysis-v1_dlg.png"><img alt="../_images/PoldiDataAnalysis-v1_dlg.png" class="screenshot" src="../_images/PoldiDataAnalysis-v1_dlg.png" style="width: 332px;" /></a>
<p class="caption"><span class="caption-text"><strong>PoldiDataAnalysis</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id3">Properties</a></li>
<li><a class="reference internal" href="#description" id="id4">Description</a></li>
<li><a class="reference internal" href="#usage" id="id5">Usage</a></li>
<li><a class="reference internal" href="#source" id="id6">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Run all necessary steps for a complete analysis of POLDI data.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id3">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="3%" />
<col width="13%" />
<col width="5%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></td>
<td><em>Mandatory</em></td>
<td>MatrixWorkspace with 2D POLDI data and valid POLDI instrument.</td>
</tr>
<tr class="row-odd"><td>MaximumPeakNumber</td>
<td>Input</td>
<td>number</td>
<td>10</td>
<td>Maximum number of peaks to process in the analysis.</td>
</tr>
<tr class="row-even"><td>MinimumPeakSeparation</td>
<td>Input</td>
<td>number</td>
<td>10</td>
<td>Minimum number of points between neighboring peaks.</td>
</tr>
<tr class="row-odd"><td>MinimumPeakHeight</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Minimum height of peaks. If it is left at 0, the minimum peak height is calculatedfrom background noise.</td>
</tr>
<tr class="row-even"><td>MaximumRelativeFwhm</td>
<td>Input</td>
<td>number</td>
<td>0.02</td>
<td>Peaks with a relative FWHM larger than this are removed during the 1D fit.</td>
</tr>
<tr class="row-odd"><td>ScatteringContributions</td>
<td>Input</td>
<td>string</td>
<td>1</td>
<td>If there is more than one compound, you may supply estimates of their scattering contributions, which sometimes improves indexing.</td>
</tr>
<tr class="row-even"><td>ExpectedPeaks</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></td>
<td><em>Mandatory</em></td>
<td>TableWorkspace or WorkspaceGroup with expected peaks used for indexing.</td>
</tr>
<tr class="row-odd"><td>RemoveUnindexedPeaksFor2DFit</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Discard unindexed peaks for 2D fit, this is always the case if PawleyFit is active.</td>
</tr>
<tr class="row-even"><td>ProfileFunction</td>
<td>Input</td>
<td>string</td>
<td>Gaussian</td>
<td>Allowed values: [‘Gaussian’, ‘Lorentzian’, ‘PseudoVoigt’, ‘Voigt’]</td>
</tr>
<tr class="row-odd"><td>TieProfileParameters</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>If this option is activated, certain parameters are kept the same for all peaks. An example is the mixing parameter of the PseudoVoigt function.</td>
</tr>
<tr class="row-even"><td>PawleyFit</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Should the 2D-fit determine lattice parameters?</td>
</tr>
<tr class="row-odd"><td>MultipleRuns</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>If this is activated, peaks are searched again in theresiduals and the 1D- and 2D-fit is repeated with these data.</td>
</tr>
<tr class="row-even"><td>PlotResult</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>If this is activated, plot the sum of residuals and calculated spectrum together with the theoretical spectrum and the residuals.</td>
</tr>
<tr class="row-odd"><td>OutputIntegratedIntensities</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>If this option is checked the peak intensities of the 2D-fit will be integrated, otherwise they will be the maximum intensity.</td>
</tr>
<tr class="row-even"><td>OutputRawFitParameters</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Activating this option produces an output workspace which contains the raw fit parameters.</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></td>
<td><em>Mandatory</em></td>
<td>WorkspaceGroup with result data from all processing steps.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id4">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm performs all necessary steps for a complete analysis of POLDI data, combining all algorithms that are
specific to POLDI. In detail, it performs these steps on the supplied data:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="PoldiAutoCorrelation-v5.html#algm-poldiautocorrelation"><span class="std std-ref">PoldiAutoCorrelation v5</span></a></li>
<li><a class="reference internal" href="PoldiPeakSearch-v1.html#algm-poldipeaksearch"><span class="std std-ref">PoldiPeakSearch v1</span></a></li>
<li><a class="reference internal" href="PoldiFitPeaks1D-v2.html#algm-poldifitpeaks1d"><span class="std std-ref">PoldiFitPeaks1D v2</span></a></li>
<li><a class="reference internal" href="PoldiIndexKnownCompounds-v1.html#algm-poldiindexknowncompounds"><span class="std std-ref">PoldiIndexKnownCompounds v1</span></a></li>
<li><a class="reference internal" href="PoldiFitPeaks2D-v1.html#algm-poldifitpeaks2d"><span class="std std-ref">PoldiFitPeaks2D v1</span></a></li>
<li><a class="reference internal" href="PoldiAnalyseResiduals-v1.html#algm-poldianalyseresiduals"><span class="std std-ref">PoldiAnalyseResiduals v1</span></a></li>
</ol>
<p>Finally, the calculated diffractogram and the residuals are added together and all three spectra are plotted to give
an impression of the result. If the <cite>MultipleRuns</cite> option is activated, steps 2 - 6 are repeated, but instead of
using the initial correlation spectrum, the sum or calculated and residuals is used. Because this is usually much
smoother than the initial correlation spectrum, additional peaks can be found there sometimes. The 2D-fit is still
performed with the original data.</p>
<p>The actual output is a WorkspaceGroup with content that varies a bit depending on the input parameters. If
<cite>PawleyFit</cite> was active, it contains refined cell parameters. For the <cite>ExpectedPeaks</cite> parameter, a WorkpsaceGroup may
be given (this is necessary when multiple phases are present in a sample).</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id5">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path. In Mantid this is done using <a class="reference external" href="http://www.mantidproject.org/ManageUserDirectories">Manage User Directories</a>.</p>
</div>
<p>The algorithm requires relatively little input and can be run like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Load POLDI data</span>
<span class="n">PoldiLoadRuns</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">6903</span><span class="p">,</span> <span class="mi">6904</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;poldi&#39;</span><span class="p">,</span> <span class="n">MaskBadDetectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Create Silicon peaks</span>
<span class="n">PoldiCreatePeaksFromCell</span><span class="p">(</span><span class="n">SpaceGroup</span><span class="o">=</span><span class="s1">&#39;F d -3 m&#39;</span><span class="p">,</span> <span class="n">Atoms</span><span class="o">=</span><span class="s1">&#39;Si 0 0 0 1.0 0.01&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">5.431</span><span class="p">,</span>
                         <span class="n">LatticeSpacingMin</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                         <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;Si&#39;</span><span class="p">)</span>

<span class="n">PoldiDataAnalysis</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;poldi_data_6904&#39;</span><span class="p">,</span>
                  <span class="n">ExpectedPeaks</span><span class="o">=</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span> <span class="n">PawleyFit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">MaximumPeakNumber</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                  <span class="n">PlotResult</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>

<span class="c1"># Take a look at the refined cell:</span>

<span class="n">cell</span> <span class="o">=</span> <span class="n">AnalysisDataService</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s1">&#39;poldi_data_6904_cell_refined&#39;</span><span class="p">)</span>

<span class="n">cell_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">cell_a_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Refined lattice parameter a = </span><span class="si">{:.5f}</span><span class="s2"> +/- </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell_a</span><span class="p">,</span> <span class="n">cell_a_error</span><span class="p">))</span>
</pre></div>
</div>
<p>This will print the following output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Refined lattice parameter a = 5.43126 +/- 5e-05
</pre></div>
</div>
<p>If PlotResult is changed to True, a plot of the spectrum and the residuals is created as described above.</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/SINQ/Poldi.html">SINQ\Poldi</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id6">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/98431db1d0022558632d1e088c9c4b21d35b9356/Framework/PythonInterface/plugins/algorithms/WorkflowAlgorithms/PoldiDataAnalysis.py">PoldiDataAnalysis.py</a> <em>(last modified: 2020-03-27)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="PoldiCreatePeaksFromFile-v1.html" title="Previous Chapter: PoldiCreatePeaksFromFile v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; PoldiCreatePe...</span>
    </a>
  </li>
  <li>
    <a href="PoldiFitPeaks1D-v1.html" title="Next Chapter: PoldiFitPeaks1D v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">PoldiFitPeaks1D v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2020-10-23.<br/>
    </p>
  </div>
</footer>
  </body>
</html>