<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>UnwrapMonitor v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="UnwrapMonitorsInTOF v1" href="UnwrapMonitorsInTOF-v1.html" />
    <link rel="prev" title="UnGroupWorkspace v1" href="UnGroupWorkspace-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>5.1</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="unwrapmonitor-v1">
<span id="algm-unwrapmonitor"></span><span id="algm-unwrapmonitor-v1"></span><h1>UnwrapMonitor v1<a class="headerlink" href="#unwrapmonitor-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/UnwrapMonitor-v1_dlg.png"><img alt="../_images/UnwrapMonitor-v1_dlg.png" class="screenshot" src="../_images/UnwrapMonitor-v1_dlg.png" style="width: 336px;" /></a>
<p class="caption"><span class="caption-text"><strong>UnwrapMonitor</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a><ul>
<li><a class="reference internal" href="#restrictions-on-the-input-workspace" id="id6">Restrictions on the Input Workspace</a></li>
<li><a class="reference internal" href="#child-algorithms-used" id="id7">Child Algorithms Used</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id8">Usage</a></li>
<li><a class="reference internal" href="#source" id="id9">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Takes an input workspace that contains ‘raw’ data, unwraps the data according to the reference flightpath provided and converts the units to wavelength.The output workspace will have common bins in the maximum theoretical wavelength range.</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="UnwrapMonitorsInTOF-v1.html#algm-unwrapmonitorsintof"><span class="std std-ref">UnwrapMonitorsInTOF</span></a>, <a class="reference internal" href="UnwrapSNS-v1.html#algm-unwrapsns"><span class="std std-ref">UnwrapSNS</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="5%" />
<col width="28%" />
<col width="8%" />
<col width="48%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>A workspace with x values in units of TOF and y values in counts</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>The name of the workspace to be created as the output of the algorithm</td>
</tr>
<tr class="row-even"><td>LRef</td>
<td>Input</td>
<td>number</td>
<td><em>Mandatory</em></td>
<td>The length of the reference flight path (in metres)</td>
</tr>
<tr class="row-odd"><td>JoinWavelength</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm is for use with white-beam instruments with choppers. The
chopper cuts the range of wavelengths, so all detectors (including
monitors) should be reduced to the same wavelength range. This is done
using a “reference” flightpath, <img class="math" src="../_images/math/e9d4bcd5a218a4c9d11139b15be8ef8b99d265b0.png" alt="L_{ref}" style="vertical-align: -6px"/>, which is (usually, see
below) the flightpath of the farthest detectors.</p>
<p>If <img class="math" src="../_images/math/386d84f5acc06c1592ade7adffb7c63b0041b2f1.png" alt="T_{min}" style="vertical-align: -3px"/> and <img class="math" src="../_images/math/26ee09c7f3b543fda88d18d76787e0d4a93366b4.png" alt="T_{max}" style="vertical-align: -3px"/> are the beginning and end of the
frame, for each detector <img class="math" src="../_images/math/38c3f1bb635d72c20480efe631525d3464136e24.png" alt="D" style="vertical-align: 0px"/> at total flightpath <img class="math" src="../_images/math/f40d6ba4b335d2b80bd1cd5dc9c6128fe27f2f2c.png" alt="L_d" style="vertical-align: -3px"/> the
following times are defined:</p>
<div class="math">
<p><img src="../_images/math/fb0eec49594a1e65b3b859829ba66ce7ad147d62.png" alt="T_1 = T_{max} - \left ( T_{min} \times \left ( 1 - \frac{L_d}{L_{ref}} \right ) \right )"/></p>
</div><div class="math">
<p><img src="../_images/math/34cd7cfca549e9e68ba251283b4d07866ed07755.png" alt="T_2 = T_{max} \times \left ( \frac{L_d}{L_{ref}} \right )"/></p>
</div><p>Thus if <img class="math" src="../_images/math/2d0af8a12417279f58bfe20621b3767f7faa3a98.png" alt="L_d &lt; L_{ref}" style="vertical-align: -6px"/> then <img class="math" src="../_images/math/af3aeddbdb0a96a188778b0b501d85f54802052d.png" alt="T_1 &gt; T_2" style="vertical-align: -4px"/></p>
<p>Neutron velocities (and hence wavelengths) for the detector <img class="math" src="../_images/math/38c3f1bb635d72c20480efe631525d3464136e24.png" alt="D" style="vertical-align: 0px"/>
are calculated in the following way:</p>
<ul class="simple">
<li>For <img class="math" src="../_images/math/1951f63fc99a9f8369cd19be1c00783fb08703d6.png" alt="T_{min} &lt; T &lt; T_2" style="vertical-align: -3px"/>, velocities are calculated in the usual
way, i.e. <img class="math" src="../_images/math/69efaf31a917351e6a6348658e474d5e2896bbf8.png" alt="v = \frac{L_d}{T}" style="vertical-align: -6px"/></li>
<li>Data in the range <img class="math" src="../_images/math/df4bc05ce2cdbbf7d3f77fba2a2ffd6b2a81003f.png" alt="T_2 &lt; T &lt; T_1" style="vertical-align: -4px"/> are ignored (i.e. they are
not used in the wavelength-converted histograms)</li>
<li>For <img class="math" src="../_images/math/426849aafa7982deb657e11f27b6a568b605f02f.png" alt="T_1 &lt; T &lt; T_{max}" style="vertical-align: -4px"/>, velocities are calculated using the
formula <img class="math" src="../_images/math/668474e7686644ca9114c12d4f14ca679194ada6.png" alt="v = \frac{L_d}{T - T_{max} + T_{min}}" style="vertical-align: -8px"/></li>
</ul>
<p>Note that the minimum and maximum velocities for the points that are
actually <em>used</em> are:</p>
<div class="math">
<p><img src="../_images/math/27bb8ba3a1a28642e0c38ab4bf997152aafdff23.png" alt="v_{max} = \frac{L_d}{T - T_{max} + T_{min}} = \frac{L_{ref}}{T_{min}}"/></p>
</div><p>and <img class="math" src="../_images/math/715f21cf5c5ef3ce2765c2e85a3be2156d621987.png" alt="v_{min} = \frac{L_d}{T_2} = \frac{L_{ref}}{T_{max}}" style="vertical-align: -8px"/></p>
<p>In other words, these velocities are the same for all detectors, so the
wavelength range in the transformed histogram will correspondingly be
the same and this algorithm rebins the data into common bins in this
range.</p>
<p>Occasionally, it may be that some detectors (typically downstream
monitors) may be at a *longer* flightpath than <img class="math" src="../_images/math/e9d4bcd5a218a4c9d11139b15be8ef8b99d265b0.png" alt="L_{ref}" style="vertical-align: -6px"/>. This
depends entirely on the chopper aperture/setting. These detectors are
“frame-overlapped” - in other words, there is an ambiguity in the
definition of the wavelength for certain points, which should therefore
be excluded. These points are at the very beginning and at the very end
of the frame for a range <img class="math" src="../_images/math/b391ad2f669ce0fb26493fab57453aa2487bba6c.png" alt="Dt" style="vertical-align: 0px"/> (equal on both sides) given by</p>
<div class="math">
<p><img src="../_images/math/8facbf094db7d80edcb3a421c5807627178ec25e.png" alt="D_t = (T_{max} - T_{min}) \times \left (1 - \frac{L_{ref}}{L_d} \right)"/></p>
</div><p>In other words, points between <img class="math" src="../_images/math/386d84f5acc06c1592ade7adffb7c63b0041b2f1.png" alt="T_{min}" style="vertical-align: -3px"/> and <img class="math" src="../_images/math/b477cec0ee630065230da8e258bf5612d12eff8c.png" alt="T_{min} + D_t" style="vertical-align: -3px"/>
and between <img class="math" src="../_images/math/817403aa2213d03075ac61fb0a06b7b7f025646e.png" alt="T_{max} - D_t" style="vertical-align: -3px"/> and <img class="math" src="../_images/math/26ee09c7f3b543fda88d18d76787e0d4a93366b4.png" alt="T_{max}" style="vertical-align: -3px"/> should be
excluded. For all other points, velocities and wavelengths are
calculated in the normal way.</p>
<p>Note that since we are dealing with histogrammed data, the cut-off
values above will almost certainly not fall exactly on a bin boundary.
The approach taken by this algorithm is that if any part of a bin has a
value that should be excluded, then the entire bin is excluded. What
this means in practice is that the edge bins will possibly have a
reduced number of counts.</p>
<div class="section" id="restrictions-on-the-input-workspace">
<h3><a class="toc-backref" href="#id6">Restrictions on the Input Workspace</a><a class="headerlink" href="#restrictions-on-the-input-workspace" title="Permalink to this headline">¶</a></h3>
<p>The input workspace must contain histogram data where the X unit is
time-of-flight and the Y data is raw counts. The instrument associated with the
workspace must be fully defined because detector, source &amp; sample position are needed.</p>
</div>
<div class="section" id="child-algorithms-used">
<h3><a class="toc-backref" href="#id7">Child Algorithms Used</a><a class="headerlink" href="#child-algorithms-used" title="Permalink to this headline">¶</a></h3>
<p>If the input workspace contains more than a single spectrum, Unwrap
makes use of the <a class="reference internal" href="Rebin-v1.html#algm-rebin"><span class="std std-ref">rebin</span></a> algorithm to set the bins on the
output workspace to common values which cover the maximum theoretically
accessible wavelength range.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id8">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - unwrapping a raw workspace.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Create a raw data workspace.</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>

<span class="c1"># The result variable will contain a tuple: (OutputWorkspace, JoinWaveLength)</span>
<span class="c1"># To access individual outputs use result[i] where i is the index of the required output.</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">UnwrapMonitor</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span><span class="n">LRef</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;JoinWaveLength is: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>JoinWaveLength is: 1.4241722...
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/CorrectionFunctions/InstrumentCorrections.html">CorrectionFunctions\InstrumentCorrections</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id9">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/98431db1d0022558632d1e088c9c4b21d35b9356/Framework/Algorithms/inc/MantidAlgorithms/UnwrapMonitor.h">UnwrapMonitor.h</a> <em>(last modified: 2020-03-20)</em></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/98431db1d0022558632d1e088c9c4b21d35b9356/Framework/Algorithms/src/UnwrapMonitor.cpp">UnwrapMonitor.cpp</a> <em>(last modified: 2020-04-07)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="UnGroupWorkspace-v1.html" title="Previous Chapter: UnGroupWorkspace v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; UnGroupWorkspace v1</span>
    </a>
  </li>
  <li>
    <a href="UnwrapMonitorsInTOF-v1.html" title="Next Chapter: UnwrapMonitorsInTOF v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">UnwrapMonitor... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2020-10-23.<br/>
    </p>
  </div>
</footer>
  </body>
</html>