<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>DirectILLReduction v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DirectILLSelfShielding v1" href="DirectILLSelfShielding-v1.html" />
    <link rel="prev" title="DirectILLIntegrateVanadium v1" href="DirectILLIntegrateVanadium-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>5.1</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="directillreduction-v1">
<span id="algm-directillreduction"></span><span id="algm-directillreduction-v1"></span><h1>DirectILLReduction v1<a class="headerlink" href="#directillreduction-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/DirectILLReduction-v1_dlg.png"><img alt="../_images/DirectILLReduction-v1_dlg.png" class="screenshot" src="../_images/DirectILLReduction-v1_dlg.png" style="width: 332px;" /></a>
<p class="caption"><span class="caption-text"><strong>DirectILLReduction</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a><ul>
<li><a class="reference internal" href="#input-workspaces" id="id6">Input workspaces</a></li>
<li><a class="reference internal" href="#outputs" id="id7">Outputs</a></li>
<li><a class="reference internal" href="#normalisation-to-absolute-units" id="id8">Normalisation to absolute units</a></li>
<li><a class="reference internal" href="#re-binning-in-energy-and-momentum-transfer" id="id9">(Re)binning in energy and momentum transfer</a></li>
<li><a class="reference internal" href="#transposing-output" id="id10">Transposing output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id11">Usage</a></li>
<li><a class="reference internal" href="#source" id="id12">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Data reduction workflow for the direct geometry time-of-flight spectrometers at ILL.</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="DirectILLApplySelfShielding-v1.html#algm-directillapplyselfshielding"><span class="std std-ref">DirectILLApplySelfShielding</span></a>, <a class="reference internal" href="DirectILLCollectData-v1.html#algm-directillcollectdata"><span class="std std-ref">DirectILLCollectData</span></a>, <a class="reference internal" href="DirectILLDiagnostics-v1.html#algm-directilldiagnostics"><span class="std std-ref">DirectILLDiagnostics</span></a>, <a class="reference internal" href="DirectILLIntegrateVanadium-v1.html#algm-directillintegratevanadium"><span class="std std-ref">DirectILLIntegrateVanadium</span></a>, <a class="reference internal" href="DirectILLSelfShielding-v1.html#algm-directillselfshielding"><span class="std std-ref">DirectILLSelfShielding</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="3%" />
<col width="20%" />
<col width="9%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>A workspace to reduce.</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></td>
<td><em>Mandatory</em></td>
<td>The reduced S(Q, DeltaE) workspace.</td>
</tr>
<tr class="row-even"><td>Cleanup</td>
<td>Input</td>
<td>string</td>
<td>Cleanup ON</td>
<td>What to do with intermediate workspaces. Allowed values: [‘Cleanup ON’, ‘Cleanup OFF’]</td>
</tr>
<tr class="row-odd"><td>SubalgorithmLogging</td>
<td>Input</td>
<td>string</td>
<td>Logging OFF</td>
<td>Enable or disable subalgorithms to print in the logs. Allowed values: [‘Logging OFF’, ‘Logging ON’]</td>
</tr>
<tr class="row-even"><td>IntegratedVanadiumWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td>&#160;</td>
<td>An integrated vanadium workspace.</td>
</tr>
<tr class="row-odd"><td>AbsoluteUnitsNormalisation</td>
<td>Input</td>
<td>string</td>
<td>Absolute Units OFF</td>
<td>Enable or disable normalisation to absolute units. Allowed values: [‘Absolute Units OFF’, ‘Absolute Units ON’]</td>
</tr>
<tr class="row-even"><td>DiagnosticsWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td>&#160;</td>
<td>Detector diagnostics workspace for masking.</td>
</tr>
<tr class="row-odd"><td>GroupingAngleStep</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>A scattering angle step to which to group detectors, in degrees.</td>
</tr>
<tr class="row-even"><td>EnergyRebinningParams</td>
<td>Input</td>
<td>dbl list</td>
<td>&#160;</td>
<td>Manual energy rebinning parameters.</td>
</tr>
<tr class="row-odd"><td>EnergyRebinning</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>Energy rebinning when mixing manual and automatic binning parameters.</td>
</tr>
<tr class="row-even"><td>QBinningParams</td>
<td>Input</td>
<td>dbl list</td>
<td>&#160;</td>
<td>Manual q rebinning parameters.</td>
</tr>
<tr class="row-odd"><td>Transposing</td>
<td>Input</td>
<td>string</td>
<td>Transposing ON</td>
<td>Enable or disable OutputWorkspace transposing. Allowed values: [‘Transposing ON’, ‘Transposing OFF’]</td>
</tr>
<tr class="row-even"><td>OutputSofThetaEnergyWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></td>
<td>&#160;</td>
<td>Output workspace for reduced S(theta, DeltaE).</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This is the main data reduction algorithm in <a class="reference internal" href="../techniques/DirectILL.html#directill"><span class="std std-ref">ILL’s time-of-flight reduction suite</span></a>. It performs the last steps of the reduction workflow, namely vanadium normalisation and transformation to <img class="math" src="../_images/math/04aac0ccf3b627925273ef7351471c3afff8f7c9.png" alt="S(q,\omega)" style="vertical-align: -4px"/> space (optionally <img class="math" src="../_images/math/8418164127ba4bd05e9306c9cf40d68f3814c949.png" alt="S(2\theta,\omega)" style="vertical-align: -4px"/>). The algorithm’s workflow diagram is shown below:</p>
<img alt="../_images/DirectILLReduction-v1_wkflw.png" src="../_images/DirectILLReduction-v1_wkflw.png" />
<div class="section" id="input-workspaces">
<h3><a class="toc-backref" href="#id6">Input workspaces</a><a class="headerlink" href="#input-workspaces" title="Permalink to this headline">¶</a></h3>
<p><em>InputWorkspace</em> should contain data treated by <a class="reference internal" href="DirectILLCollectData-v1.html#algm-directillcollectdata"><span class="std std-ref">DirectILLCollectData</span></a> and, optionally, by <a class="reference internal" href="DirectILLApplySelfShielding-v1.html#algm-directillapplyselfshielding"><span class="std std-ref">DirectILLApplySelfShielding</span></a>.</p>
<p>The mandatory <em>IntegratedVanadiumWorkspace</em> should have gone through <a class="reference internal" href="DirectILLIntegrateVanadium-v1.html#algm-directillintegratevanadium"><span class="std std-ref">DirectILLIntegrateVanadium</span></a>. This workspace is used for the vanadium normalisation.</p>
<p><em>DiagnosticsWorkspace</em> should be a product of <a class="reference internal" href="DirectILLDiagnostics-v1.html#algm-directilldiagnostics"><span class="std std-ref">DirectILLDiagnostics</span></a>. It is used to mask the spectra of <em>InputWorkspace</em>.</p>
</div>
<div class="section" id="outputs">
<h3><a class="toc-backref" href="#id7">Outputs</a><a class="headerlink" href="#outputs" title="Permalink to this headline">¶</a></h3>
<p>The algorithm will transform the time-of-flight and spectrum numbers of <em>InputWorkspace</em> into <img class="math" src="../_images/math/04aac0ccf3b627925273ef7351471c3afff8f7c9.png" alt="S(q,\omega)" style="vertical-align: -4px"/> at its output. For <img class="math" src="../_images/math/8e9bb7fd3766daf063d69d9836ac5185a40a45a7.png" alt="2\theta" style="vertical-align: 0px"/> to <img class="math" src="../_images/math/fa6736677bcc2f4a1261bf930522ddbe4c7979d3.png" alt="q" style="vertical-align: -4px"/> transformation, <a class="reference internal" href="SofQWNormalisedPolygon-v1.html#algm-sofqwnormalisedpolygon"><span class="std std-ref">SofQWNormalisedPolygon</span></a> is used. By default, the output is transposed by <a class="reference internal" href="Transpose-v1.html#algm-transpose"><span class="std std-ref">Transpose</span></a>. This behavior can be turned off by the <em>Transpose</em> property.</p>
<p>The optional <img class="math" src="../_images/math/8418164127ba4bd05e9306c9cf40d68f3814c949.png" alt="S(2\theta,\omega)" style="vertical-align: -4px"/> output can be enabled by the <em>OutputSofThetaEnergyWorkspace</em>. This is the processed data right after detector grouping and before the transformation to <img class="math" src="../_images/math/04aac0ccf3b627925273ef7351471c3afff8f7c9.png" alt="S(q,\omega)" style="vertical-align: -4px"/>.</p>
</div>
<div class="section" id="normalisation-to-absolute-units">
<h3><a class="toc-backref" href="#id8">Normalisation to absolute units</a><a class="headerlink" href="#normalisation-to-absolute-units" title="Permalink to this headline">¶</a></h3>
<p>Normalisation to absolute units can be enabled by setting <em>AbsoluteUnitsNormalisation</em> to <code class="docutils literal"><span class="pre">'Absolute</span> <span class="pre">Units</span> <span class="pre">ON'</span></code>. In this case the data is multiplied by a factor</p>
<blockquote>
<div><img class="math" src="../_images/math/90da39ceb58304c4443f817da6213e4a5a2dd4fb.png" alt="f = \frac{N_V \sigma_V}{N_S}" style="vertical-align: -8px"/></div></blockquote>
<p>after normalisation to vanadium giving units of barn to the data. In the above, <img class="math" src="../_images/math/6f6e838f8c1195d5695fb2699386247183f33a9d.png" alt="N_V" style="vertical-align: -3px"/> stands for the vanadium number density, <img class="math" src="../_images/math/ed18bf85fabb781734cc886c0381cda068fd8077.png" alt="\sigma_V" style="vertical-align: -3px"/> for vanadium total scattering cross section and <img class="math" src="../_images/math/b2a95b516dadc21f668de2c030ce0a8f6e0e5c60.png" alt="N_S" style="vertical-align: -3px"/> sample number density.</p>
<p>The material properties should be set for <em>InputWorkspace</em> and <em>IntegratedVanadiumWorkspace</em> by <a class="reference internal" href="SetSample-v1.html#algm-setsample"><span class="std std-ref">SetSample</span></a> before running this algorithm .</p>
</div>
<div class="section" id="re-binning-in-energy-and-momentum-transfer">
<h3><a class="toc-backref" href="#id9">(Re)binning in energy and momentum transfer</a><a class="headerlink" href="#re-binning-in-energy-and-momentum-transfer" title="Permalink to this headline">¶</a></h3>
<p>After conversion from time-of-flight to energy transfer, the binning may differ from spectrum to spectrum if the sample to detector distances are unequal. The <a class="reference internal" href="SofQWNormalisedPolygon-v1.html#algm-sofqwnormalisedpolygon"><span class="std std-ref">SofQWNormalisedPolygon</span></a> algorithm cannot work with such ragged workspaces and thus rebinning in energy transfer is necessary. By default, the algorithm uses automatic rebinning:
- For negative energy transfers, copy binning from the spectrum which covers the largest negative energy transfer range.
- For positive energy transfers, use the median bin width over all spectra at zero energy transfer.</p>
<p>The automatic rebinning can be overriden by the <em>EnergyRebinningParams</em> or <em>EnergyRebinning</em> properties. <em>EnergyRebinningParams</em> is directly passed to <a class="reference internal" href="Rebin-v1.html#algm-rebin"><span class="std std-ref">Rebin</span></a> as the <em>Params</em> property. On the other hand, <em>EnergyRebinning</em> allows for mixture of automatic and user specified rebinning. Its syntax is a comma separated list of letters <cite>a</cite> for automatic binning and numbers for ranges and user-specified bin widths. Here are some examples:</p>
<dl class="docutils">
<dt><cite>‘a’</cite></dt>
<dd>Rebin the entire energy transfer axis automatically. Same as the defalt behavior.</dd>
<dt><cite>‘-4, a, 8’</cite></dt>
<dd>Rebin the energy transfer axis from -4 to 8 meV automatically.</dd>
<dt><cite>‘a, -1, 0.01, 1, a’</cite></dt>
<dd>Rebin everything automatically except from -1 to 1 meV, where the bin width is set to 0.01 meV.</dd>
<dt><cite>‘a, -5, 0.1, -1, 0.01, 1’</cite></dt>
<dd>Automatic rebinning from minimum energy transfer up to -5 meV, after which use user defined binning: between -5 and -1 meV the bin width is 0.1 mev, while between -1 and 1 meV, it is 0.01.</dd>
<dt><cite>‘-10, a, -1, 0.01, 1, a, 4’</cite></dt>
<dd>Start the energy transfer axis at -10 meV, use automatic binning up to -1 meV. Between -1 and 1 meV use bin width of 0.01 meV. Use automatic binning again from 1 to 4 meV.</dd>
</dl>
<p><em>QBinningParams</em> are passed to <a class="reference internal" href="SofQWNormalisedPolygon-v1.html#algm-sofqwnormalisedpolygon"><span class="std std-ref">SofQWNormalisedPolygon</span></a> and have the same format as <em>EnergyRebinningParamas</em>. If the property is not specified, <img class="math" src="../_images/math/fa6736677bcc2f4a1261bf930522ddbe4c7979d3.png" alt="q" style="vertical-align: -4px"/> is binned to a value that depends on the wavelength and the <img class="math" src="../_images/math/8e9bb7fd3766daf063d69d9836ac5185a40a45a7.png" alt="2\theta" style="vertical-align: 0px"/> separation of the grouped detectors. By default, the detectors are grouped to 0.01 degree wide bins in <img class="math" src="../_images/math/8e9bb7fd3766daf063d69d9836ac5185a40a45a7.png" alt="2\theta" style="vertical-align: 0px"/> or to the value of the <code class="docutils literal"><span class="pre">natural-angle-step</span></code> instrument parameter. The default behavior can be overriden by the <em>GroupingAngleStep</em> property.</p>
</div>
<div class="section" id="transposing-output">
<h3><a class="toc-backref" href="#id10">Transposing output</a><a class="headerlink" href="#transposing-output" title="Permalink to this headline">¶</a></h3>
<p>After conversion to momentum transfer, the vertical axis of the data is in units of momentum transfer while the horizontal axis is in energy transfer. By default, the data is transposed such that momentum transfer is on the horizontal axis and energy transfer in the vertical. This can be turned off by setting <em>Transposing</em> to <code class="docutils literal"><span class="pre">'Transposing</span> <span class="pre">OFF'</span></code>.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id11">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>For usage of this algorithm, check the examples <a class="reference internal" href="../techniques/DirectILL.html#directill"><span class="std std-ref">here</span></a>.</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/ILL/Direct.html">ILL\Direct</a> | <a class="reference external" href="categories/Inelastic/Reduction.html">Inelastic\Reduction</a> | <a class="reference external" href="categories/Workflow/Inelastic.html">Workflow\Inelastic</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id12">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/98431db1d0022558632d1e088c9c4b21d35b9356/Framework/PythonInterface/plugins/algorithms/WorkflowAlgorithms/DirectILLReduction.py">DirectILLReduction.py</a> <em>(last modified: 2020-03-27)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="DirectILLIntegrateVanadium-v1.html" title="Previous Chapter: DirectILLIntegrateVanadium v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; DirectILLInte...</span>
    </a>
  </li>
  <li>
    <a href="DirectILLSelfShielding-v1.html" title="Next Chapter: DirectILLSelfShielding v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">DirectILLSelf... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2020-10-23.<br/>
    </p>
  </div>
</footer>
  </body>
</html>