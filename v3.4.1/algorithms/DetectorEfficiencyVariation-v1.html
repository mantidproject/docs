<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>DetectorEfficiencyVariation v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="DetermineChunking v1" href="DetermineChunking-v1.html" />
    <link rel="prev" title="DetectorEfficiencyCorUser v1" href="DetectorEfficiencyCorUser-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="detectorefficiencyvariation-v1">
<span id="algm-detectorefficiencyvariation"></span><span id="algm-detectorefficiencyvariation-v1"></span><h1>DetectorEfficiencyVariation v1<a class="headerlink" href="#detectorefficiencyvariation-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/DetectorEfficiencyVariation-v1_dlg.png"><img alt="../_images/DetectorEfficiencyVariation-v1_dlg.png" class="screenshot" src="../_images/DetectorEfficiencyVariation-v1_dlg.png" style="width: 260px;" /></a>
<p class="caption"><strong>DetectorEfficiencyVariation</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a><ul>
<li><a class="reference internal" href="#child-algorithms-used" id="id4">Child algorithms used</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id5">Usage</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Compares two white beam vanadium workspaces from the same instrument to find detectors whose efficiencies have changed beyond a threshold.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="2%" />
<col width="14%" />
<col width="4%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>WhiteBeamBase</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Name of a white beam vanadium workspace</td>
</tr>
<tr class="row-odd"><td>WhiteBeamCompare</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Name of a matching second white beam vanadium run from the same instrument</td>
</tr>
<tr class="row-even"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>A MaskWorkpace where each spectra that failed the test is masked. Each histogram from the input workspace maps to a histogram in this workspace with one value that indicates if there was a dead detector.</td>
</tr>
<tr class="row-odd"><td>Variation</td>
<td>Input</td>
<td>number</td>
<td>1.1</td>
<td>Identify histograms whose total number of counts has changed by more than this factor of the median change between the two input workspaces.</td>
</tr>
<tr class="row-even"><td>StartWorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>The index number of the first spectrum to include in the calculation (default: 0)</td>
</tr>
<tr class="row-odd"><td>EndWorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>The index number of the last spectrum to include in the calculation (default: the last spectrum in the workspace)</td>
</tr>
<tr class="row-even"><td>RangeLower</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>No bin with a boundary at an x value less than this will be included in the summation used to decide if a detector is &#8216;bad&#8217; (default: the start of each histogram)</td>
</tr>
<tr class="row-odd"><td>RangeUpper</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>No bin with a boundary at an x value higher than this value will be included in the summation used to decide if a detector is &#8216;bad&#8217; (default: the end of each histogram)</td>
</tr>
<tr class="row-even"><td>NumberOfFailures</td>
<td>Output</td>
<td>number</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>It is intended that the input white beam vanadium workspaces are from
the same instrument and were collected before and after an experimental
run of interest. First the ratios of the total number of counts in
corresponding histograms from each input workspace are calculated and
then the median ratio is calculated. Each ratio is compared to the
median and a histogram will fail when any of the following conditions
are true:</p>
<ul class="simple">
<li>(sum1/sum2)/median(sum1/sum2) &gt; Variation</li>
<li>(sum1/sum2)/median(sum1/sum2) &lt; 1/Variation</li>
</ul>
<p>where sum1 is the sum of the counts in a histogram in the workspace
WhiteBeamBase and sum2 is the sum of the counts in the equivalent
histogram in WhiteBeamCompare. The above equations only make sense for
identifying bad detectors if Variation &gt; 1. If a value of less than one
is given for Variation then Variation will be set to the reciprocal.</p>
<p>The output workspace contains a MaskWorkspace where those spectra that
fail the tests are masked and those that pass them are assigned a single
positive value.</p>
<div class="section" id="child-algorithms-used">
<h3><a class="toc-backref" href="#id4">Child algorithms used</a><a class="headerlink" href="#child-algorithms-used" title="Permalink to this headline">¶</a></h3>
<p>Uses the <a class="reference internal" href="Integration-v1.html#algm-integration"><em>Integration v1</em></a> algorithm to sum the spectra.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id5">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">wsBase</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">noisyY</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">noisyY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mf">1e20</span>
<span class="n">ws</span><span class="o">.</span><span class="n">setY</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="n">noisyY</span><span class="p">)</span>

<span class="p">(</span><span class="n">wsOut</span><span class="p">,</span> <span class="n">numFailures</span><span class="p">)</span> <span class="o">=</span> <span class="n">DetectorEfficiencyVariation</span><span class="p">(</span><span class="n">WhiteBeamBase</span><span class="o">=</span><span class="s">&#39;wsBase&#39;</span><span class="p">,</span> <span class="n">WhiteBeamCompare</span><span class="o">=</span><span class="s">&#39;ws&#39;</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;</span><span class="si">%i</span><span class="s"> spectra has been masked in wsOut&quot;</span> <span class="o">%</span> <span class="n">numFailures</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>1 spectra has been masked in wsOut
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Diagnostics.html">Diagnostics</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, Mantid.<br/>
    </p>
  </div>
</footer>
  </body>
</html>