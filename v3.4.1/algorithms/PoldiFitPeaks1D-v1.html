<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PoldiFitPeaks1D v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="PoldiFitPeaks1D v2" href="PoldiFitPeaks1D-v2.html" />
    <link rel="prev" title="PoldiDataAnalysis v1" href="PoldiDataAnalysis-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="poldifitpeaks1d-v1">
<span id="algm-poldifitpeaks1d-v1"></span><h1>PoldiFitPeaks1D v1<a class="headerlink" href="#poldifitpeaks1d-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/PoldiFitPeaks1D-v1_dlg.png"><img alt="../_images/PoldiFitPeaks1D-v1_dlg.png" class="screenshot" src="../_images/PoldiFitPeaks1D-v1_dlg.png" style="width: 351px;" /></a>
<p class="caption"><strong>PoldiFitPeaks1D</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#usage" id="id4">Usage</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>PoldiPeakFit1D fits peak profiles to POLDI auto-correlation data.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="5%" />
<col width="28%" />
<col width="8%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/Workspace2D.html#workspace2d"><em>Workspace2D</em></a></td>
<td><em>Mandatory</em></td>
<td>An input workspace containing a POLDI auto-correlation spectrum.</td>
</tr>
<tr class="row-odd"><td>FwhmMultiples</td>
<td>Input</td>
<td>number</td>
<td>2</td>
<td>Each peak will be fitted using x times FWHM data in each direction.</td>
</tr>
<tr class="row-even"><td>PeakFunction</td>
<td>Input</td>
<td>string</td>
<td>Gaussian</td>
<td>Peak function that will be fitted to all peaks.</td>
</tr>
<tr class="row-odd"><td>PoldiPeakTable</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><em>TableWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>A table workspace containing POLDI peak data.</td>
</tr>
<tr class="row-even"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><em>TableWorkspace</em></a></td>
<td>&nbsp;</td>
<td>Output workspace with refined peak data.</td>
</tr>
<tr class="row-odd"><td>FitPlotsWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><em>Workspace</em></a></td>
<td>FitPlots</td>
<td>Plots of all peak fits.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>PoldiFitPeaks1D takes a TableWorkspace with peaks (for example from <a class="reference internal" href="PoldiPeakSearch-v1.html#algm-poldipeaksearch"><em>PoldiPeakSearch v1</em></a>) and a spectrum from <a class="reference internal" href="PoldiAutoCorrelation-v5.html#algm-poldiautocorrelation"><em>PoldiAutoCorrelation v5</em></a> and tries to fit a Gaussian peak profile to the spectrum for each peak. As described on the page of <a class="reference internal" href="PoldiAutoCorrelation-v5.html#algm-poldiautocorrelation"><em>PoldiAutoCorrelation v5</em></a>, each peak is surrounded by a dip. This dip is modeled by adding a quadratic background of the form</p>
<blockquote>
<div><img class="math" src="../_images/math/9534dc785ad6b50cf60837db35840b23bdef8d95.png" alt="f(x) = a_0\cdot(x - x_0)^2 + a_1" style="vertical-align: -4px"/></div></blockquote>
<p>where <img class="math" src="../_images/math/15752e53efcdc2bb348d175513bafef56ea42981.png" alt="x_0" style="vertical-align: -3px"/> is the peak position and <img class="math" src="../_images/math/2487a6160c6d60734efb44bdd1893b281bd6363f.png" alt="a_i" style="vertical-align: -3px"/> are the coefficients of the polynome.</p>
<p>The implementation is very close to the original POLDI analysis software
(using the same profile function). One point where this routine differs
is error calculation. In the original program the parameter errors were
adjusted by averaging <img class="math" src="../_images/math/4dcb4a08df7a8b829443c0b6705fa279c77218c3.png" alt="\chi^2" style="vertical-align: -4px"/>-values, but this does not work
properly if there is an outlier caused by a bad fit for one of the
peaks, so this step is not performed, the errors are derived directly from the fit.</p>
<p>The algorithm produces a number of output workspaces. One with refined peak parameters (OutputWorkspace), which is equivalent to the input TableWorkspace, except that the parameters are fitted and have errors. ResultTableWorkspace mimics the result files produced by the original data analysis software. FitCharacteristicsWorkspace contains the raw fitting results and the errors of the parameters, as well as <img class="math" src="../_images/math/4dcb4a08df7a8b829443c0b6705fa279c77218c3.png" alt="\chi^2" style="vertical-align: -4px"/>-values for each profile fit. FitPlotsWorkspace is a GroupWorkspace that contains plots for each peak profile fit with measured data, fitted data and a difference curve.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id4">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path. In MantidPlot this is done using <a class="reference external" href="http://www.mantidproject.org/ManageUserDirectories">Manage User Directories</a>.</p>
</div>
<p>The following small usage example performs a peak fit on the sample data already used in <a class="reference internal" href="PoldiAutoCorrelation-v5.html#algm-poldiautocorrelation"><em>PoldiAutoCorrelation v5</em></a> and <a class="reference internal" href="PoldiPeakSearch-v1.html#algm-poldipeaksearch"><em>PoldiPeakSearch v1</em></a>. After the fit, the plots can be viewed and used to visually judge the quality of the fits.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Load data file and instrument, perform correlation analysis</span>
<span class="n">raw_6904</span> <span class="o">=</span> <span class="n">LoadSINQFile</span><span class="p">(</span><span class="n">Filename</span> <span class="o">=</span> <span class="s">&quot;poldi2013n006904.hdf&quot;</span><span class="p">,</span> <span class="n">Instrument</span> <span class="o">=</span> <span class="s">&quot;POLDI&quot;</span><span class="p">)</span>
<span class="n">LoadInstrument</span><span class="p">(</span><span class="n">raw_6904</span><span class="p">,</span> <span class="n">InstrumentName</span> <span class="o">=</span> <span class="s">&quot;POLDI&quot;</span><span class="p">)</span>
<span class="n">correlated_6904</span> <span class="o">=</span> <span class="n">PoldiAutoCorrelation</span><span class="p">(</span><span class="n">raw_6904</span><span class="p">)</span>

<span class="c"># Run peak search algorithm, store peaks in TableWorkspace</span>
<span class="n">peaks_6904</span> <span class="o">=</span> <span class="n">PoldiPeakSearch</span><span class="p">(</span><span class="n">correlated_6904</span><span class="p">)</span>

<span class="n">PoldiFitPeaks1D</span><span class="p">(</span><span class="n">InputWorkspace</span> <span class="o">=</span> <span class="n">correlated_6904</span><span class="p">,</span> <span class="n">FwhmMultiples</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span>
                <span class="n">PeakFunction</span> <span class="o">=</span> <span class="s">&quot;Gaussian&quot;</span><span class="p">,</span> <span class="n">PoldiPeakTable</span> <span class="o">=</span> <span class="n">peaks_6904</span><span class="p">,</span>
                <span class="n">OutputWorkspace</span> <span class="o">=</span> <span class="s">&quot;peaks_refined_6904&quot;</span><span class="p">,</span>
                <span class="n">FitPlotsWorkspace</span> <span class="o">=</span> <span class="s">&quot;fit_plots_6904&quot;</span><span class="p">,</span>
                <span class="n">Version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;There are&quot;</span><span class="p">,</span> <span class="n">mtd</span><span class="p">[</span><span class="s">&#39;fit_plots_6904&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getNumberOfEntries</span><span class="p">(),</span> <span class="s">&quot;plots available for inspection.&quot;</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>There are 14 plots available for inspection.
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/SINQ.html">SINQ</a> | <a class="reference external" href="categories/Poldi.html">Poldi</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, Mantid.<br/>
    </p>
  </div>
</footer>
  </body>
</html>