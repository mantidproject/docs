<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PlotPeakByLogValue v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="Plus v1" href="Plus-v1.html" />
    <link rel="prev" title="PlotAsymmetryByLogValue v1" href="PlotAsymmetryByLogValue-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="plotpeakbylogvalue-v1">
<span id="algm-plotpeakbylogvalue"></span><span id="algm-plotpeakbylogvalue-v1"></span><h1>PlotPeakByLogValue v1<a class="headerlink" href="#plotpeakbylogvalue-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/PlotPeakByLogValue-v1_dlg.png"><img alt="../_images/PlotPeakByLogValue-v1_dlg.png" class="screenshot" src="../_images/PlotPeakByLogValue-v1_dlg.png" style="width: 263px;" /></a>
<p class="caption"><strong>PlotPeakByLogValue</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a><ul>
<li><a class="reference internal" href="#output-workspace-format" id="id4">Output workspace format</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id5">Usage</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Fits a number of spectra with the same function.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="2%" />
<col width="12%" />
<col width="6%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Input</td>
<td>Input</td>
<td>string</td>
<td><em>Mandatory</em></td>
<td>A list of sources of data to fit.  Sources can be either workspace names or file names followed optionally by a list of spectra/workspace-indices  or values using the notation described in the description section of the help page.</td>
</tr>
<tr class="row-odd"><td>Spectrum</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Set a spectrum to fit.  However, if spectra lists (or workspace-indices/values lists) are specified in the Input parameter string these take precedence.</td>
</tr>
<tr class="row-even"><td>WorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Set a workspace-index to fit (alternative option to Spectrum). However, if spectra lists (or workspace-indices/values lists) are specified in the Input parameter string,  or the Spectrum parameter integer, these take precedence.</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><em>TableWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>The output TableWorkspace</td>
</tr>
<tr class="row-even"><td>Function</td>
<td>Input</td>
<td>string</td>
<td><em>Mandatory</em></td>
<td>The fitting function, common for all workspaces in the input WorkspaceGroup</td>
</tr>
<tr class="row-odd"><td>LogValue</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Name of the log value to plot the parameters against. Default: use spectra numbers.</td>
</tr>
<tr class="row-even"><td>StartX</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>A value of x in, or on the low x boundary of, the first bin to include in the fit (default lowest value of x)</td>
</tr>
<tr class="row-odd"><td>EndX</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>A value in, or on the high x boundary of, the last bin the fitting range (default the highest value of x)</td>
</tr>
<tr class="row-even"><td>FitType</td>
<td>Input</td>
<td>string</td>
<td>Sequential</td>
<td>Defines the way of setting initial values.  If set to &#8216;Sequential&#8217; every next fit starts with parameters returned by the previous fit.  If set to &#8216;Individual&#8217; each fit starts with the same initial values defined in the Function property.</td>
</tr>
<tr class="row-odd"><td>PassWSIndexToFunction</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>For each spectrum in Input pass its workspace index to all functions thathave attribute WorkspaceIndex.</td>
</tr>
<tr class="row-even"><td>Minimizer</td>
<td>InOut</td>
<td>string</td>
<td>Levenberg-Marquardt</td>
<td>Minimizer to use for fitting. Minimizers available are &#8216;Levenberg-Marquardt&#8217;, &#8216;Simplex&#8217;,  &#8216;Conjugate gradient (Fletcher-Reeves imp.)&#8217;, &#8216;Conjugate gradient (Polak-Ribiere imp.)&#8217; and &#8216;BFGS&#8217;</td>
</tr>
<tr class="row-odd"><td>CostFunction</td>
<td>InOut</td>
<td>string</td>
<td>Least squares</td>
<td>Cost functions to use for fitting. Cost functions available are &#8216;Least squares&#8217; and &#8216;Ignore positive peaks&#8217;</td>
</tr>
<tr class="row-even"><td>CreateOutput</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Set to true to create output workspaces with the results of the fit(default is false).</td>
</tr>
<tr class="row-odd"><td>OutputCompositeMembers</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>If true and CreateOutput is true then the value of each member of a Composite Function is also output.</td>
</tr>
<tr class="row-even"><td>ConvolveMembers</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>If true and OutputCompositeMembers is true members of any Convolution are output convolved with corresponding resolution</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm fits a series of spectra with the same function. Each
spectrum is fit independently and the result is a table of fitting
parameters unique for each spectrum. The sources for the spectra are
defined in the Input property. The Input property expects a list of
spectra identifiers separated by semicolons (;). An identifier is itself
a comma-separated list of values. The first value is the name of the
source. It can be either a workspace name or a name of a file (RAW or
Nexus). If it is a name of a <a class="reference internal" href="../concepts/WorkspaceGroup.html#workspacegroup"><em>WorkspaceGroup</em></a> all its
members will be included in the fit. The second value selects a spectrum
within the workspace or file. It is an integer number with a prefix
defining the meaning of the number: &#8220;sp&#8221; for a spectrum number, &#8220;i&#8221; for
a workspace index, or &#8220;v&#8221; for a range of values on the numeric axis
associated with the workspace index. For example, sp12, i125, v0.5:2.3.
If the data source is a file only the spectrum number option is
accepted. The third value of the spectrum identifier is optional period
number. It is used if the input file contains multiperiod data. In case
of workspaces this third parameter is ignored. This are examples of
Input property</p>
<div class="line-block">
<div class="line"><tt class="docutils literal"><span class="pre">&nbsp;&quot;test1,i2;&nbsp;MUSR00015189.nxs,sp3;&nbsp;MUSR00015190.nxs,sp3;&nbsp;MUSR00015191.nxs,sp3&quot;</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">&nbsp;&quot;test2,v1.1:3.2&quot;</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">&nbsp;&quot;test3,v&quot;&nbsp;-&nbsp;fit&nbsp;all&nbsp;spectra&nbsp;in&nbsp;workspace&nbsp;test3</span></tt></div>
</div>
<p>Internally PlotPeakByLogValue uses <a class="reference internal" href="Fit-v1.html#algm-fit"><em>Fit v1</em></a> algorithm to perform
fitting and the following properties have the same meaning as in
<a class="reference internal" href="Fit-v1.html#algm-fit"><em>Fit v1</em></a>: Function, StartX, EndX, Minimizer, CostFunction. Property
FitType defines the way of setting initial values. If it is set to
&#8220;Sequential&#8221; every next fit starts with parameters returned by the
previous fit. If set to &#8220;Individual&#8221; each fit starts with the same
initial values defined in the Function property.</p>
<p>LogValue property specifies a log value to be included into the output.
If this property is empty the values of axis 1 will be used instead.
Setting this property to &#8220;SourceName&#8221; makes the first column of the
output table contain the names of the data sources (files or
workspaces).</p>
<div class="section" id="output-workspace-format">
<h3><a class="toc-backref" href="#id4">Output workspace format</a><a class="headerlink" href="#output-workspace-format" title="Permalink to this headline">¶</a></h3>
<div class="figure">
<img alt="PlotPeakByLogValue_Output.png" src="../_images/PlotPeakByLogValue_Output.png" />
<p class="caption">PlotPeakByLogValue_Output.png</p>
</div>
<p>In this example a group of three Matrix workspaces were fitted with a
<a class="reference internal" href="../fitfunctions/Gaussian.html#func-gaussian"><em>Gaussian</em></a> on a linear background.</p>
<p>The output workspace is a table in which rows correspond to the spectra
in the order they (spectra) appear in the Input property. The first
column of the table has the log values. It is followed by pairs of
columns with parameter values and fitting errors. If a parameter was
fixed or tied the error will be zero. Here is an example of the output
workspace:</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id5">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - fitting a single spectrum of in a workspace:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">function</span> <span class="o">=</span> <span class="s">&quot;name=Gaussian,Height=10.0041,PeakCentre=10098.6,Sigma=48.8581;name=FlatBackground,A0=0.3&quot;</span>
<span class="n">peaks</span> <span class="o">=</span> <span class="n">PlotPeakByLogValue</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">Spectrum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Example - sequentially fitting a workspace:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">function</span> <span class="o">=</span> <span class="s">&quot;name=Gaussian,Height=10.0041,PeakCentre=10098.6,Sigma=48.8581;name=FlatBackground,A0=0.3&quot;</span>

<span class="c">#create string of workspaces to fit (ws,i0; ws,i1, ws,i2 ...)</span>
<span class="n">workspaces</span> <span class="o">=</span> <span class="p">[</span><span class="n">ws</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39;,i</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())]</span>
<span class="n">workspaces</span> <span class="o">=</span> <span class="s">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">workspaces</span><span class="p">)</span>

<span class="n">peaks</span> <span class="o">=</span> <span class="n">PlotPeakByLogValue</span><span class="p">(</span><span class="n">workspaces</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">Spectrum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c">#get peak centres for comparison</span>
<span class="n">peak_centres</span> <span class="o">=</span> <span class="n">peaks</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s">&#39;f0.PeakCentre&#39;</span><span class="p">)</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">peak_centres</span><span class="p">))</span>
<span class="n">ref</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mf">10098.6</span><span class="p">)</span>

<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">peak_centres</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>True
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Optimization.html">Optimization</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, Mantid.<br/>
    </p>
  </div>
</footer>
  </body>
</html>