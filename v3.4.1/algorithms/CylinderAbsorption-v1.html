<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CylinderAbsorption v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="CylinderPaalmanPingsCorrection v1" href="CylinderPaalmanPingsCorrection-v1.html" />
    <link rel="prev" title="CutMD v1" href="CutMD-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="cylinderabsorption-v1">
<span id="algm-cylinderabsorption"></span><span id="algm-cylinderabsorption-v1"></span><h1>CylinderAbsorption v1<a class="headerlink" href="#cylinderabsorption-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/CylinderAbsorption-v1_dlg.png"><img alt="../_images/CylinderAbsorption-v1_dlg.png" class="screenshot" src="../_images/CylinderAbsorption-v1_dlg.png" style="width: 218px;" /></a>
<p class="caption"><strong>CylinderAbsorption</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a><ul>
<li><a class="reference internal" href="#assumptions" id="id4">Assumptions</a></li>
<li><a class="reference internal" href="#restrictions-on-the-input-workspace" id="id5">Restrictions on the input workspace</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id6">References</a></li>
<li><a class="reference internal" href="#usage" id="id7">Usage</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Calculates bin-by-bin correction factors for attenuation due to absorption and single scattering in a &#8216;cylindrical&#8217; sample.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="3%" />
<col width="16%" />
<col width="5%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>The X values for the input workspace must be in units of wavelength</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Output workspace name</td>
</tr>
<tr class="row-even"><td>AttenuationXSection</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>The ABSORPTION cross-section, at 1.8 Angstroms, for the sample material in barns. Column 8 of a table generated from <a class="reference external" href="http://www.ncnr.nist.gov/resources/n-lengths/">http://www.ncnr.nist.gov/resources/n-lengths/</a>.</td>
</tr>
<tr class="row-odd"><td>ScatteringXSection</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>The (coherent + incoherent) scattering cross-section for the sample material in barns. Column 7 of a table generated from <a class="reference external" href="http://www.ncnr.nist.gov/resources/n-lengths/">http://www.ncnr.nist.gov/resources/n-lengths/</a>.</td>
</tr>
<tr class="row-even"><td>SampleNumberDensity</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>The number density of the sample in number of atoms per cubic angstrom if not set with SetSampleMaterial</td>
</tr>
<tr class="row-odd"><td>NumberOfWavelengthPoints</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>The number of wavelength points for which the numerical integral is calculated (default: all points)</td>
</tr>
<tr class="row-even"><td>ExpMethod</td>
<td>Input</td>
<td>string</td>
<td>Normal</td>
<td>Select the method to use to calculate exponentials, normal or a fast approximation (default: Normal)</td>
</tr>
<tr class="row-odd"><td>EMode</td>
<td>Input</td>
<td>string</td>
<td>Elastic</td>
<td>The energy mode (default: elastic)</td>
</tr>
<tr class="row-even"><td>EFixed</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>The value of the initial or final energy, as appropriate, in meV. Will be taken from the instrument definition file, if available.</td>
</tr>
<tr class="row-odd"><td>CylinderSampleHeight</td>
<td>Input</td>
<td>number</td>
<td><em>Mandatory</em></td>
<td>The height of the cylindrical sample in centimetres</td>
</tr>
<tr class="row-even"><td>CylinderSampleRadius</td>
<td>Input</td>
<td>number</td>
<td><em>Mandatory</em></td>
<td>The radius of the cylindrical sample in centimetres</td>
</tr>
<tr class="row-odd"><td>NumberOfSlices</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>The number of slices into which the cylinder is divided for the calculation</td>
</tr>
<tr class="row-even"><td>NumberOfAnnuli</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>The number of annuli into which each slice is divided for the calculation</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm uses a numerical integration method to calculate
attenuation factors resulting from absorption and single scattering in a
cylindrical sample with the dimensions and material properties given.
Factors are calculated for each spectrum (i.e. detector position) and
wavelength point, as defined by the input workspace. The sample is
divided up into a stack of slices, which are then divided into annuli
(rings). These annuli are further divided (see Ref. [2], Appendix A) to
give the full set of elements for which a calculation will be carried
out. Thus the calculation speed depends linearly on the total number of
bins in the workspace and on the number of slices. The dependence on the
number of annuli is stronger, going as <img class="math" src="../_images/math/fbd3f3d3ea12cfb7fc3f6bb4a586d7595cf5ff33.png" alt="3n ( n+1 )" style="vertical-align: -4px"/>.</p>
<p>Path lengths through the sample are then calculated for the centre-point
of each element and a numerical integration is carried out using these
path lengths over the volume elements.</p>
<div class="section" id="assumptions">
<h3><a class="toc-backref" href="#id4">Assumptions</a><a class="headerlink" href="#assumptions" title="Permalink to this headline">¶</a></h3>
<p>Although no assumptions are made about the beam direction or the sample
position, the cylinder will be constructed with its centre at the sample
position and it&#8217;s axis along the y axis (which in the case of most
instruments is the vertical).</p>
</div>
<div class="section" id="restrictions-on-the-input-workspace">
<h3><a class="toc-backref" href="#id5">Restrictions on the input workspace</a><a class="headerlink" href="#restrictions-on-the-input-workspace" title="Permalink to this headline">¶</a></h3>
<p>The input workspace must have units of wavelength. The
<a class="reference internal" href="../concepts/Instrument.html#instrument"><em>instrument</em></a> associated with the workspace must be fully
defined because detector, source &amp; sample position are needed.</p>
</div>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id6">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>The method used here is based upon work presented in the following two
papers, although it does not yet fully implement all aspects discussed
there (e.g. there&#8217;s no multiple scattering and no concentric cylinders).</p>
<ol class="arabic simple">
<li>I.A. Blech &amp; B.L. Averbach, <em>Multiple Scattering of Neutrons in
Vanadium and Copper</em>, Phys. Rev. <strong>137 4A</strong> (1965) A1113
<a class="reference external" href="http://dx.doi.org/10.1103/PhysRev.137.A1113">doi: 10.1103/PhysRev.137.A1113</a></li>
<li>A.K. Soper &amp; P.A. Egelstaff, <em>Multiple Scattering and Attenuation of
Neutrons in Concentric Cylinders</em>, NIM <strong>178</strong> (1980) 415
<a class="reference external" href="http://dx.doi.org/10.1016/0029-554X(80)90820-4">doi: 10.1016/0029-554X(80)90820-4</a></li>
</ol>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id7">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - Using a X Section Values</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">ConvertUnits</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="s">&quot;Wavelength&quot;</span><span class="p">)</span>

<span class="n">wsOut</span> <span class="o">=</span> <span class="n">CylinderAbsorption</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">AttenuationXSection</span><span class="o">=</span><span class="mf">5.08</span><span class="p">,</span>
    <span class="n">ScatteringXSection</span><span class="o">=</span><span class="mf">5.1</span><span class="p">,</span><span class="n">SampleNumberDensity</span><span class="o">=</span><span class="mf">0.07192</span><span class="p">,</span>
    <span class="n">NumberOfWavelengthPoints</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">CylinderSampleHeight</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">CylinderSampleRadius</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">NumberOfSlices</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">NumberOfAnnuli</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="k">print</span> <span class="p">(</span><span class="s">&quot;The Absorption correction is calculated to match the input workspace&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&quot;  over </span><span class="si">%i</span><span class="s"> bins, ranging from  </span><span class="si">%.2f</span><span class="s"> to </span><span class="si">%.2f</span><span class="s">&quot;</span> <span class="o">%</span>
    <span class="p">(</span><span class="n">wsOut</span><span class="o">.</span><span class="n">blocksize</span><span class="p">(),</span>
    <span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">wsOut</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>The Absorption correction is calculated to match the input workspace
  over 100 bins, ranging from  0.77 to 0.37
</pre></div>
</div>
<p><strong>Example - Using a SetSampleMaterial</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">ConvertUnits</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="s">&quot;Wavelength&quot;</span><span class="p">)</span>
<span class="n">SetSampleMaterial</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">ChemicalFormula</span><span class="o">=</span><span class="s">&#39;Cd&#39;</span><span class="p">)</span>

<span class="n">wsOut</span> <span class="o">=</span> <span class="n">CylinderAbsorption</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span>
    <span class="n">NumberOfWavelengthPoints</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">CylinderSampleHeight</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">CylinderSampleRadius</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">NumberOfSlices</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">NumberOfAnnuli</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="k">print</span> <span class="p">(</span><span class="s">&quot;The Absorption correction is calculated to match the input workspace&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&quot;  over </span><span class="si">%i</span><span class="s"> bins, ranging from  </span><span class="si">%.2f</span><span class="s"> to </span><span class="si">%.2f</span><span class="s">&quot;</span> <span class="o">%</span>
    <span class="p">(</span><span class="n">wsOut</span><span class="o">.</span><span class="n">blocksize</span><span class="p">(),</span>
    <span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="n">wsOut</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>The Absorption correction is calculated to match the input workspace
  over 100 bins, ranging from  0.25 to 0.00
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/CorrectionFunctions.html">CorrectionFunctions</a> | <a class="reference external" href="categories/AbsorptionCorrections.html">AbsorptionCorrections</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, Mantid.<br/>
    </p>
  </div>
</footer>
  </body>
</html>