<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PoldiTruncateData v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.9.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="PolynomialCorrection v1" href="PolynomialCorrection-v1.html" />
    <link rel="prev" title="PoldiPeakSummary v1" href="PoldiPeakSummary-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="polditruncatedata-v1">
<span id="algm-polditruncatedata"></span><span id="algm-polditruncatedata-v1"></span><h1>PoldiTruncateData v1<a class="headerlink" href="#polditruncatedata-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/PoldiTruncateData-v1_dlg.png"><img alt="../_images/PoldiTruncateData-v1_dlg.png" class="screenshot" src="../_images/PoldiTruncateData-v1_dlg.png" style="width: 424px;" /></a>
<p class="caption"><strong>PoldiTruncateData</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#usage" id="id4">Usage</a></li>
<li><a class="reference internal" href="#source" id="id5">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Truncate POLDI time bins according to chopper speed.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="5%" />
<col width="28%" />
<col width="8%" />
<col width="42%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Input workspace containing raw POLDI data.</td>
</tr>
<tr class="row-odd"><td>ExtraCountsWorkspaceName</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Workspace name for extra counts. Leave empty if not required.</td>
</tr>
<tr class="row-even"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Output workspace with truncated POLDI data.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>POLDI data consists of one spectrum for each detector wire, where one spectrum contains a certain number of time bins. This number is directly related to the chopper speed, here represented by <img class="math" src="../_images/math/f4656db9137a68753ab306eeaa778fa55bfb30b7.png" alt="t_{cycle}" style="vertical-align: -6px"/> which is the duration of one chopper period and the amount of time one bin spans:</p>
<blockquote>
<div><img class="math" src="../_images/math/b9c8e65baa6d18776354c1441fd1e94bb1fde4b1.png" alt="N_{bins} = \frac{t_{cycle}}{\Delta t}" style="vertical-align: -6px"/></div></blockquote>
<p>Since the first bin starts at 0, the last bin starts at <img class="math" src="../_images/math/5ec5bbd31b00456c68d34fb01efbbfa7a7a500a9.png" alt="\Delta t \cdot (N_{bin} - 1)" style="vertical-align: -4px"/>, so the workspace has to be cropped to the proper bin count in each spectrum, which is usually 500.</p>
<p>As a check for the experimental setup, some more time bins are recorded (usually 10). If they are empty or contain only a very small number of counts, the assignment of neutron arrival times in the detector can be assumed to be correct.</p>
<p>Since further data analysis steps rely on the correct number of bins being present, this algorithm crops the supplied workspace to the correct size. If desired, the algorithm can also create a workspace where the counts of the extra bins are summed into one spectrum.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id4">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path. In MantidPlot this is done using <a class="reference external" href="http://www.mantidproject.org/ManageUserDirectories">Manage User Directories</a>.</p>
</div>
<p>In the first example, POLDI data is cropped to the correct workspace size:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Load data and instrument - this is important, as the chopper configuration must be known.</span>
<span class="n">raw_6903</span> <span class="o">=</span> <span class="n">LoadSINQFile</span><span class="p">(</span><span class="n">Filename</span> <span class="o">=</span> <span class="s">&quot;poldi2013n006903.hdf&quot;</span><span class="p">,</span> <span class="n">Instrument</span> <span class="o">=</span> <span class="s">&quot;POLDI&quot;</span><span class="p">)</span>
<span class="n">LoadInstrument</span><span class="p">(</span><span class="n">raw_6903</span><span class="p">,</span> <span class="n">InstrumentName</span> <span class="o">=</span> <span class="s">&quot;POLDI&quot;</span><span class="p">,</span> <span class="n">RewriteSpectraMap</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;The raw data workspace contains&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_6903</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="s">&quot;time bins.&quot;</span>

<span class="c"># Truncate the data</span>
<span class="n">truncated_6903</span> <span class="o">=</span> <span class="n">PoldiTruncateData</span><span class="p">(</span><span class="n">raw_6903</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;The truncated data workspace contains&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">truncated_6903</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="s">&quot;time bins.&quot;</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>The raw data workspace contains 510 time bins.
The truncated data workspace contains 500 time bins.
</pre></div>
</div>
<p>The second example also examines the extra time bins:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Load data and instrument again.</span>
<span class="n">raw_6903</span> <span class="o">=</span> <span class="n">LoadSINQFile</span><span class="p">(</span><span class="n">Filename</span> <span class="o">=</span> <span class="s">&quot;poldi2013n006903.hdf&quot;</span><span class="p">,</span> <span class="n">Instrument</span> <span class="o">=</span> <span class="s">&quot;POLDI&quot;</span><span class="p">)</span>
<span class="n">LoadInstrument</span><span class="p">(</span><span class="n">raw_6903</span><span class="p">,</span> <span class="n">InstrumentName</span> <span class="o">=</span> <span class="s">&quot;POLDI&quot;</span><span class="p">,</span> <span class="n">RewriteSpectraMap</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># Truncate and store the extra bins in a workspace called &quot;extra_6903&quot;</span>
<span class="n">truncated_6903</span> <span class="o">=</span> <span class="n">PoldiTruncateData</span><span class="p">(</span><span class="n">raw_6903</span><span class="p">,</span> <span class="n">ExtraCountsWorkspaceName</span> <span class="o">=</span> <span class="s">&quot;extra_6903&quot;</span><span class="p">)</span>

<span class="c"># Get the workspace from central workspace manager</span>
<span class="n">extra_6903</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s">&#39;extra_6903&#39;</span><span class="p">]</span>

<span class="c"># Examine the workspace a bit</span>
<span class="k">print</span> <span class="s">&quot;The extra data workspace contains&quot;</span><span class="p">,</span> <span class="n">extra_6903</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">(),</span> <span class="s">&quot;spectrum.&quot;</span>
<span class="k">print</span> <span class="s">&quot;The bins contain the following data:&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">extra_6903</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>The extra data workspace contains 1 spectrum.
The bins contain the following data: [13, 0, 0, 0, 0, 0, 0, 0, 0, 0]
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/SINQ/Poldi.html">SINQ\Poldi</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id5">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a948b43f4e569c67c5896a3135c635a82d326bdb/Framework/SINQ/src/PoldiTruncateData.cpp">PoldiTruncateData.cpp</a></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a948b43f4e569c67c5896a3135c635a82d326bdb/Framework/SINQ/inc/MantidSINQ/PoldiTruncateData.h">PoldiTruncateData.h</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="PoldiPeakSummary-v1.html" title="Previous Chapter: PoldiPeakSummary v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; PoldiPeakSummary...</span>
    </a>
  </li>
  <li>
    <a href="PolynomialCorrection-v1.html" title="Next Chapter: PolynomialCorrection v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">PolynomialCorrec... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>