<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>UnwrapMonitorsInTOF v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.9.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="UnwrapSNS v1" href="UnwrapSNS-v1.html" />
    <link rel="prev" title="UnwrapMonitor v1" href="UnwrapMonitor-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="unwrapmonitorsintof-v1">
<span id="algm-unwrapmonitorsintof"></span><span id="algm-unwrapmonitorsintof-v1"></span><h1>UnwrapMonitorsInTOF v1<a class="headerlink" href="#unwrapmonitorsintof-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/UnwrapMonitorsInTOF-v1_dlg.png"><img alt="../_images/UnwrapMonitorsInTOF-v1_dlg.png" class="screenshot" src="../_images/UnwrapMonitorsInTOF-v1_dlg.png" style="width: 455px;" /></a>
<p class="caption"><strong>UnwrapMonitorsInTOF</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#usage" id="id4">Usage</a></li>
<li><a class="reference internal" href="#source" id="id5">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Takes a TOF input workspace that contains &#8216;raw&#8217; data and unwraps monitor data according to a specified wavelength range. The monitor spectra are essentially doubled and then trimmed to the specified wavelength range. If no wavelength range is specified (-1), then the doubled data is not trimmed. The units of the output workspace is in TOF. Note that currently only workspaces with linearly binned monitor data can be handled correctly.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="6%" />
<col width="35%" />
<col width="10%" />
<col width="34%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>An input workspace.</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>An output workspace.</td>
</tr>
<tr class="row-even"><td>WavelengthMin</td>
<td>Input</td>
<td>number</td>
<td>-1</td>
<td>A lower bound of the wavelength range.</td>
</tr>
<tr class="row-odd"><td>WavelengthMax</td>
<td>Input</td>
<td>number</td>
<td>-1</td>
<td>An upper bound of the wavelength range.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm is for use with white-beam instruments with choppers. When setting two different
time regimes for monitors and detectors it can occur that neutrons from the previous frame
are detected by monitors further down the beam line. Note that this algorithm currently only
operates well on linearly binned monitor data.</p>
<p>The schematic illustration below explains the situation. Two pulses are in the beam line
at the same time. All monitors are operating in the same time regime. This means that
while a monitor closer to the source starts detecting neutrons associated with the current frame,
a monitor further down the beam line might be detecting neutrons associated with the previous frame as
is depicted in illustration a) below.</p>
<p>This means that the measured signal for a monitor further down the beam line can be comprised of data from
two sequential frames. It will be chopped up as is depicted in illustration b) below.</p>
<div class="figure">
<img alt="../_images/UnwrapMonitorsInTOF_wrapped_monitors.png" src="../_images/UnwrapMonitorsInTOF_wrapped_monitors.png" />
</div>
<p>This algorithm duplicates the data and appends it to itself. This means that the TOF is essentially doubled
(in the case of linear time binning). This is depicted in illustration a) below. This means that we now
have data in the monitors which is not physical, i.e. some monitors seem to have measured data for certain
time-of-flight values which are not accessible for the wavelength range of the apperatus and the locations of the monitors.
Therefore the user can specify the wavelength range of the apperatus. This is translated into the effective
time-of-flight range of each monitor and data outside of this range is set to zero. This is illustrated in image b) below.</p>
<div class="figure">
<img alt="../_images/UnwrapMonitorsInTOF_unwrapped_monitors.png" src="../_images/UnwrapMonitorsInTOF_unwrapped_monitors.png" />
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id4">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - UnwrapMonitorsInTOF</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>

<span class="c"># Create a sample SANS2D workspace</span>
<span class="n">sans2D_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ConfigService</span><span class="o">.</span><span class="n">getInstrumentDirectory</span><span class="p">(),</span><span class="s">&quot;SANS2D_Definition.xml&quot;</span><span class="p">)</span>
<span class="n">workspace</span> <span class="o">=</span> <span class="n">LoadEmptyInstrument</span><span class="p">(</span><span class="n">sans2D_path</span><span class="p">)</span>
<span class="n">workspace</span> <span class="o">=</span> <span class="n">Rebin</span><span class="p">(</span><span class="n">workspace</span><span class="p">,</span> <span class="s">&quot;1,10000, 100000&quot;</span><span class="p">)</span>

<span class="c"># Set monitor 4  (at workspace index 3) to  [3, 2, 1, 0, 0, 0, 0, 0, 5, 4]</span>
<span class="n">dataY</span> <span class="o">=</span> <span class="n">workspace</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">dataY</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_values</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>


<span class="c"># Apply the UnwrapMonitorsInTOF algorithm</span>
<span class="n">output_workspace</span> <span class="o">=</span> <span class="n">UnwrapMonitorsInTOF</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">workspace</span><span class="p">,</span> <span class="n">WavelengthMin</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">WavelengthMax</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c"># Inspect the unwrapped data</span>
<span class="n">dataY_doubled</span> <span class="o">=</span> <span class="n">output_workspace</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;The number of bins is {0} and is expected to be 20.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataY_doubled</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;The monitor 4 entries are: {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dataY_doubled</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>The number of bins is 20 and is expected to be 20.
The monitor 4 entries are: [ 0.  0.  0.  0.  0.  0.  0.  0.  5.  4.  3.  2.  1.  0.  0.  0.  0.  0.
  0.  0.].
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/CorrectionFunctions/InstrumentCorrections.html">CorrectionFunctions\InstrumentCorrections</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id5">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a948b43f4e569c67c5896a3135c635a82d326bdb/Framework/Algorithms/src/UnwrapMonitorsInTOF.cpp">UnwrapMonitorsInTOF.cpp</a></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/a948b43f4e569c67c5896a3135c635a82d326bdb/Framework/Algorithms/inc/MantidAlgorithms/UnwrapMonitorsInTOF.h">UnwrapMonitorsInTOF.h</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="UnwrapMonitor-v1.html" title="Previous Chapter: UnwrapMonitor v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; UnwrapMonitor v1</span>
    </a>
  </li>
  <li>
    <a href="UnwrapSNS-v1.html" title="Next Chapter: UnwrapSNS v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">UnwrapSNS v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>