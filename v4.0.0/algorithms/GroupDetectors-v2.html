<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GroupDetectors v2</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '4.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="GroupToXResolution v1" href="GroupToXResolution-v1.html" />
    <link rel="prev" title="GroupDetectors v1" href="GroupDetectors-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>4.0</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="groupdetectors-v2">
<span id="algm-groupdetectors"></span><span id="algm-groupdetectors-v2"></span><h1>GroupDetectors v2<a class="headerlink" href="#groupdetectors-v2" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/GroupDetectors-v2_dlg.png"><img alt="../_images/GroupDetectors-v2_dlg.png" class="screenshot" src="../_images/GroupDetectors-v2_dlg.png" style="width: 332px;" /></a>
<p class="caption"><strong>GroupDetectors</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id5">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id6">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id7">Properties</a></li>
<li><a class="reference internal" href="#description" id="id8">Description</a><ul>
<li><a class="reference internal" href="#mapfile" id="id9">MapFile</a></li>
<li><a class="reference internal" href="#groupingpattern" id="id10">GroupingPattern</a></li>
<li><a class="reference internal" href="#vertical-axis-on-output" id="id11">Vertical Axis on Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#previous-versions" id="id12">Previous Versions</a><ul>
<li><a class="reference internal" href="#version-1" id="id13">Version 1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id14">Usage</a><ul>
<li><a class="reference internal" href="#output" id="id15">Output</a></li>
<li><a class="reference internal" href="#id1" id="id16">Output</a></li>
<li><a class="reference internal" href="#id2" id="id17">Output</a></li>
<li><a class="reference internal" href="#id3" id="id18">Output</a></li>
<li><a class="reference internal" href="#id4" id="id19">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#source" id="id20">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id5">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Sums spectra bin-by-bin, equivalent to grouping the data from a set of detectors.  Individual groups can be specified by passing the algorithm a list of spectrum numbers, detector IDs or workspace indices. Many spectra groups can be created in one execution via an input file.</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id6">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="SpatialGrouping-v1.html#algm-spatialgrouping"><em>SpatialGrouping</em></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id7">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="2%" />
<col width="11%" />
<col width="3%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>The name of the input 2D workspace</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>The name of the output workspace</td>
</tr>
<tr class="row-even"><td>MapFile</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>A file that consists of lists of spectra numbers to group. See the help for the file format. Allowed extensions: [&#8216;.map&#8217;, &#8216;.xml&#8217;]</td>
</tr>
<tr class="row-odd"><td>IgnoreGroupNumber</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>If true, use sequential spectrum numbers, otherwise use the group number from MapFile as spectrum numbers.</td>
</tr>
<tr class="row-even"><td>GroupingPattern</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Describes how this algorithm should group the detectors. See the help for full instructions.</td>
</tr>
<tr class="row-odd"><td>SpectraList</td>
<td>Input</td>
<td>int list</td>
<td>&nbsp;</td>
<td>An array containing a list of the spectrum numbers to combine (DetectorList and WorkspaceIndexList are ignored if this is set)</td>
</tr>
<tr class="row-even"><td>DetectorList</td>
<td>Input</td>
<td>int list</td>
<td>&nbsp;</td>
<td>An array of detector IDs to combine (WorkspaceIndexList is ignored if this is set)</td>
</tr>
<tr class="row-odd"><td>WorkspaceIndexList</td>
<td>Input</td>
<td>unsigned int list</td>
<td>&nbsp;</td>
<td>An array of workspace indices to combine</td>
</tr>
<tr class="row-even"><td>KeepUngroupedSpectra</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>If true ungrouped spectra will be copied to the output workspace and placed after the groups</td>
</tr>
<tr class="row-odd"><td>Behaviour</td>
<td>Input</td>
<td>string</td>
<td>Sum</td>
<td>Whether to sum or average the values when grouping detectors. Allowed values: [&#8216;Sum&#8217;, &#8216;Average&#8217;]</td>
</tr>
<tr class="row-even"><td>PreserveEvents</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Keep the output workspace as an EventWorkspace, if the input has events.</td>
</tr>
<tr class="row-odd"><td>CopyGroupingFromWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td>&nbsp;</td>
<td>The name of a workspace to copy the grouping from. This can be either a normal workspace or a grouping workspace, but they must be from the same instrument. Detector ids are used to match up the spectra to be grouped. If this option is selected all file and list options will be ignored.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id8">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm sums, bin-by-bin, multiple spectra into a single spectra.
The errors are summed in quadrature and the algorithm checks that the
bin boundaries in X are the same. The new summed spectra are created at
the start of the output workspace and have spectra numbers that
start at zero and increase in the order the groups are specified. All
detectors from the grouped spectra will be moved to belong to the new
spectrum.</p>
<p>Not all spectra in the input workspace have to be copied to a group. If
KeepUngroupedSpectra is set to true any spectra not listed will be
copied to the output workspace after the groups in order. If
KeepUngroupedSpectra is set to false only the spectra selected to be in
a group will be used.</p>
<p>To create a single group the list of spectra can be identified using a
list of either spectrum numbers, detector IDs or workspace indices. The
list should be set against the appropriate property.</p>
<div class="section" id="mapfile">
<h3><a class="toc-backref" href="#id9">MapFile</a><a class="headerlink" href="#mapfile" title="Permalink to this headline">¶</a></h3>
<p>An input file allows the specification of many groups. The file has the
following format:</p>
<div class="highlight-python"><div class="highlight"><pre>[number of groups in file]

[first group&#39;s number]
[number of spectra in first group]
[spectrum 1] [spectrum 2] [spectrum 3] [...] [spectrum n]

[second group&#39;s number]
[number of spectra in second group]
[spectrum 1] [spectrum 2] [spectrum 3] [...] [spectrum n]

[repeat as necessary]
</pre></div>
</div>
<p>Mantid will still work if the number of groups specified at the start is
incorrect, but other software may not. Mantid will warn you if the value
given is incorrect.</p>
<p>Each group&#8217;s spectrum number is determined by the group&#8217;s number. This
behaviour can be overridden by enabling the IgnoreGroupNumber property, in
which case the first group will be numbered 1, and the second 2, and so on.</p>
<p>Blank lines and whitespace in the map file are ignored. Comments may be
entered using a #, like in a Python script.</p>
<p>An example of an input file follows:</p>
<div class="highlight-python"><div class="highlight"><pre>2
1
64
1 2 3 4 5 6 7 8 9 10
11 12 13 14 15 16 17 18 19 20
21 22 23 24 25 26 27 28 29 30
31 32 33 34 35 36 37 38 39 40
41 42 43 44 45 46 47 48 49 50
51 52 53 54 55 56 57 58 59 60
61 62 63 64
2
60
65 66 67 68 69 70 71 72 73 74
75 76 77 78 79 80 81 82 83 84
85 86 87 88 89 90 91 92 93 94
95 96 97 98 99 100 101 102 103 104
105 106 107 108 109 110 111 112 113 114
115 116 117 118 119 120 121 122 123 124
</pre></div>
</div>
<p>In addition the following XML grouping format is also supported</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;detector-grouping&gt;</span>
  <span class="nt">&lt;group</span> <span class="na">name=</span><span class="s">&quot;fwd1&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;ids</span> <span class="na">val=</span><span class="s">&quot;1-32&quot;</span><span class="nt">/&gt;</span> <span class="nt">&lt;/group&gt;</span>
  <span class="nt">&lt;group</span> <span class="na">name=</span><span class="s">&quot;bwd1&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;ids</span> <span class="na">val=</span><span class="s">&quot;33,36,38,60-64&quot;</span><span class="nt">/&gt;</span> <span class="nt">&lt;/group&gt;</span>

  <span class="nt">&lt;group</span> <span class="na">name=</span><span class="s">&quot;fwd2&quot;</span><span class="nt">&gt;&lt;detids</span> <span class="na">val=</span><span class="s">&quot;1,2,17,32&quot;</span><span class="nt">/&gt;&lt;/group&gt;</span>
  <span class="nt">&lt;group</span> <span class="na">name=</span><span class="s">&quot;bwd2&quot;</span><span class="nt">&gt;&lt;detids</span> <span class="na">val=</span><span class="s">&quot;33,36,38,60,64&quot;</span><span class="nt">/&gt;</span> <span class="nt">&lt;/group&gt;</span>
<span class="nt">&lt;/detector-grouping&gt;</span>
</pre></div>
</div>
<p>where is used to specify spectra IDs and detector IDs.</p>
</div>
<div class="section" id="groupingpattern">
<h3><a class="toc-backref" href="#id10">GroupingPattern</a><a class="headerlink" href="#groupingpattern" title="Permalink to this headline">¶</a></h3>
<p>Grouping can also be specified using the GroupingPattern property. Its syntax
is as follows:</p>
<p>The pattern consists of a list of numbers that refer to workspace indices and
various operators: <tt class="docutils literal"><span class="pre">,:+-</span></tt>.</p>
<p>The spectra you wish to keep can be specified by selecting the appropriate
workspace indices. This can be achieved with the following operators:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">,</span></tt> allows you to specify additional indices. <tt class="docutils literal"><span class="pre">1,2,4</span></tt> will
keep indices 1, 2 and 4 only.</li>
<li><tt class="docutils literal"><span class="pre">:</span></tt> indicates a continuous range of indices. For example,
<tt class="docutils literal"><span class="pre">1:5</span></tt> is the same as <tt class="docutils literal"><span class="pre">1,2,3,4,5</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">+</span></tt> sums two spectra together. <tt class="docutils literal"><span class="pre">7+9</span></tt> will produce a single
spectra listing the sum of 7 and 9, ignoring any others.</li>
<li><tt class="docutils literal"><span class="pre">-</span></tt> sums a range of spectra together. For example, <tt class="docutils literal"><span class="pre">3-8</span></tt> is
the same as <tt class="docutils literal"><span class="pre">3+4+5+6+7+8</span></tt>.</li>
</ul>
<p>One could combine these operations, for example <tt class="docutils literal"><span class="pre">10+12,13:89</span></tt> would
list the sum of 10 and 12 followed by 13 to 89.</p>
</div>
<div class="section" id="vertical-axis-on-output">
<h3><a class="toc-backref" href="#id11">Vertical Axis on Output</a><a class="headerlink" href="#vertical-axis-on-output" title="Permalink to this headline">¶</a></h3>
<p>The OutputWorkspace of this algorithm will always have spectrum numbers as the
vertical axis, independent of the vertical axis units in InputWorkspace. This
is because after grouping, the vertical axis can have meaningless values and
generally, there is not enough information available to rebuild the axis. The
vertical axis can be manually restored afterwards by e.g.
<a class="reference internal" href="ConvertSpectrumAxis-v2.html#algm-convertspectrumaxis"><em>ConvertSpectrumAxis</em></a>.</p>
</div>
</div>
<div class="section" id="previous-versions">
<h2><a class="toc-backref" href="#id12">Previous Versions</a><a class="headerlink" href="#previous-versions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="version-1">
<h3><a class="toc-backref" href="#id13">Version 1</a><a class="headerlink" href="#version-1" title="Permalink to this headline">¶</a></h3>
<p>The set of spectra to be grouped can be given as a list of either
spectrum numbers, detector IDs or workspace indices. The new, summed
spectrum will appear in the workspace at the first workspace index of
the pre-grouped spectra (which will be given by the ResultIndex property
after execution). The detectors for all the grouped spectra will be
moved to belong to the first spectrum. <em>A technical note: the workspace
indices previously occupied by summed spectra will have their data
zeroed and their spectrum number set to a value of -1.</em> <a class="reference external" href="GroupDetectors-v1.html">See page
for version 1 here.</a></p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id14">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example 1: specifying a map file</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>

<span class="c"># Create a grouping file from the example above.</span>
<span class="c"># It makes 2 groups of 64 and 60 detectors respectively.</span>
<span class="n">groupingFileContent</span> <span class="o">=</span> \
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">2</span>
<span class="sd">1</span>
<span class="sd">64</span>
<span class="sd">1 2 3 4 5 6 7 8 9 10</span>
<span class="sd">11 12 13 14 15 16 17 18 19 20</span>
<span class="sd">21 22 23 24 25 26 27 28 29 30</span>
<span class="sd">31 32 33 34 35 36 37 38 39 40</span>
<span class="sd">41 42 43 44 45 46 47 48 49 50</span>
<span class="sd">51 52 53 54 55 56 57 58 59 60</span>
<span class="sd">61 62 63 64</span>
<span class="sd">2</span>
<span class="sd">60</span>
<span class="sd">65 66 67 68 69 70 71 72 73 74</span>
<span class="sd">75 76 77 78 79 80 81 82 83 84</span>
<span class="sd">85 86 87 88 89 90 91 92 93 94</span>
<span class="sd">95 96 97 98 99 100 101 102 103 104</span>
<span class="sd">105 106 107 108 109 110 111 112 113 114</span>
<span class="sd">115 116 117 118 119 120 121 122 123 124</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c"># Save the data to a file</span>
<span class="n">groupingFilePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s">&#39;~/MantidUsageExample_GroupDetectorsGrouping.txt&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">groupingFilePath</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="n">groupingFileContent</span> <span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c"># Create a workspace filled with a constant value = 0.3</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c"># Group detectors according to the created file.</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">MapFile</span> <span class="o">=</span> <span class="n">groupingFilePath</span> <span class="p">)</span>

<span class="c"># Check the result</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of groups is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;First grouped spectrum is a sum 64 input spectra:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;{:.1f} == 64 * 0.3 == {:.1f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">64</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Second grouped spectrum is a sum 60 input spectra:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;{:.1f} == 60 * 0.3 == {:.1f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">60</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">))</span>
<span class="c"># Get detector IDs of the first group</span>
<span class="n">grp0_ids</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of grouped detectors is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grp0_ids</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;5 first detectors in group: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span> <span class="n">grp0_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;5 last  detectors in group: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span> <span class="n">grp0_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">59</span><span class="p">,</span><span class="mi">64</span><span class="p">)]))</span>
<span class="c"># Get detector IDs of the second group</span>
<span class="n">grp1_ids</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of grouped detectors is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grp1_ids</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;5 first detectors in group: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span> <span class="n">grp1_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;5 last  detectors in group: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span> <span class="n">grp1_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span><span class="mi">60</span><span class="p">)]))</span>
</pre></div>
</div>
<div class="section" id="output">
<h3><a class="toc-backref" href="#id15">Output</a><a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none"><div class="highlight"><pre>Number of groups is 2
First grouped spectrum is a sum 64 input spectra:
19.2 == 64 * 0.3 == 19.2
Second grouped spectrum is a sum 60 input spectra:
18.0 == 60 * 0.3 == 18.0
Number of grouped detectors is 64
5 first detectors in group: [100, 101, 102, 103, 104]
5 last  detectors in group: [159, 160, 161, 162, 163]
Number of grouped detectors is 60
5 first detectors in group: [164, 165, 166, 167, 168]
5 last  detectors in group: [219, 220, 221, 222, 223]
</pre></div>
</div>
<p><strong>Example 2: specifying spectrum numbers</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Create a workspace filled with a constant value = 0.3</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c"># Group detectots using a list of spectrum numbers</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">SpectraList</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

<span class="c"># Check the result</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of groups is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;The grouped spectrum is a sum 3 input spectra:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;{:.1f} == 3 * 0.3 == {:.1f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">))</span>

<span class="c"># Get detector IDs in the group</span>
<span class="n">grp_ids</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">()</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;Number of grouped detectors is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grp_ids</span><span class="p">)))</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;Detector IDs: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grp_ids</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id16">Output</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none"><div class="highlight"><pre>Number of groups is 1
The grouped spectrum is a sum 3 input spectra:
0.9 == 3 * 0.3 == 0.9
Number of grouped detectors is 3
Detector IDs: set(100,102,104)
</pre></div>
</div>
<p><strong>Example 3: specifying detctor IDs</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Create a workspace filled with a constant value = 0.3</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c"># Group detectots using a list of detctor IDs</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">DetectorList</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">102</span><span class="p">,</span><span class="mi">104</span><span class="p">])</span>

<span class="c"># Check the result</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of groups is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;The grouped spectrum is a sum 3 input spectra:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;{:.1f} == 3 * 0.3 == {:.1f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">))</span>

<span class="c"># Get detector IDs in the group</span>
<span class="n">grp_ids</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">()</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;Number of grouped detectors is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grp_ids</span><span class="p">)))</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;Detector IDs: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grp_ids</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id17">Output</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none"><div class="highlight"><pre>Number of groups is 1
The grouped spectrum is a sum 3 input spectra:
0.9 == 3 * 0.3 == 0.9
Number of grouped detectors is 3
Detector IDs: set(100,102,104)
</pre></div>
</div>
<p><strong>Example 4: specifying workspace indices</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Create a workspace filled with a constant value = 0.3</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c"># Group detectots using a list of workspace indices</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">WorkspaceIndexList</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>

<span class="c"># Check the result</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of groups is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;The grouped spectrum is a sum 3 input spectra:&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;{:.1f} == 3 * 0.3 == {:.1f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">))</span>

<span class="c"># Get detector IDs in the group</span>
<span class="n">grp_ids</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">()</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;Number of grouped detectors is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grp_ids</span><span class="p">)))</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;Detector IDs: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grp_ids</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id18">Output</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none"><div class="highlight"><pre>Number of groups is 1
The grouped spectrum is a sum 3 input spectra:
0.9 == 3 * 0.3 == 0.9
Number of grouped detectors is 3
Detector IDs: set(100,102,104)
</pre></div>
</div>
<p><strong>Example 5: keeping ungrouped spectra</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>

<span class="c"># Create a grouping file from the example above.</span>
<span class="c"># It makes 2 groups of 64 and 60 detectors respectively.</span>
<span class="n">groupingFileContent</span> <span class="o">=</span> \
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">2</span>
<span class="sd">1</span>
<span class="sd">64</span>
<span class="sd">1 2 3 4 5 6 7 8 9 10</span>
<span class="sd">11 12 13 14 15 16 17 18 19 20</span>
<span class="sd">21 22 23 24 25 26 27 28 29 30</span>
<span class="sd">31 32 33 34 35 36 37 38 39 40</span>
<span class="sd">41 42 43 44 45 46 47 48 49 50</span>
<span class="sd">51 52 53 54 55 56 57 58 59 60</span>
<span class="sd">61 62 63 64</span>
<span class="sd">2</span>
<span class="sd">60</span>
<span class="sd">65 66 67 68 69 70 71 72 73 74</span>
<span class="sd">75 76 77 78 79 80 81 82 83 84</span>
<span class="sd">85 86 87 88 89 90 91 92 93 94</span>
<span class="sd">95 96 97 98 99 100 101 102 103 104</span>
<span class="sd">105 106 107 108 109 110 111 112 113 114</span>
<span class="sd">115 116 117 118 119 120 121 122 123 124</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c"># Save the data to a file</span>
<span class="n">groupingFilePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s">&#39;~/MantidUsageExample_GroupDetectorsGrouping.txt&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">groupingFilePath</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="n">groupingFileContent</span> <span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c"># Create a workspace filled with a constant value = 0.3</span>
<span class="n">ws</span><span class="o">=</span><span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c"># Group detectors according to the created file.</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">MapFile</span><span class="o">=</span><span class="n">groupingFilePath</span><span class="p">,</span> <span class="n">KeepUngroupedSpectra</span><span class="o">=</span><span class="bp">True</span> <span class="p">)</span>

<span class="c"># Check the result</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of spectra in grouped workspace is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;It includes 2 groups + {} remaining ungrouped spectra&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="mi">64</span> <span class="o">+</span> <span class="mi">60</span><span class="p">)))</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;First  spectrum is grouped, it has {} detectors&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">())))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Second spectrum is grouped, it has {} detectors&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">())))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Spectrum   2  is ungrouped, it has  {} detector&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">())))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Spectrum   3  is ungrouped, it has  {} detector&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">())))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;...&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Spectrum  77  is ungrouped, it has  {} detector&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="mi">77</span><span class="p">)</span><span class="o">.</span><span class="n">getDetectorIDs</span><span class="p">())))</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3><a class="toc-backref" href="#id19">Output</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none"><div class="highlight"><pre>Number of spectra in grouped workspace is 78
It includes 2 groups + 76 remaining ungrouped spectra
First  spectrum is grouped, it has 64 detectors
Second spectrum is grouped, it has 60 detectors
Spectrum   2  is ungrouped, it has  1 detector
Spectrum   3  is ungrouped, it has  1 detector
...
Spectrum  77  is ungrouped, it has  1 detector
</pre></div>
</div>
<p><strong>Example 6: Group detectors using spectra list</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Create test input</span>
<span class="n">xx</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="c"># create spectra with signal equal to spectra number</span>
<span class="n">yy</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="n">yy</span><span class="o">=</span><span class="n">yy</span><span class="o">+</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

<span class="n">ws</span><span class="o">=</span><span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="n">DataY</span><span class="o">=</span><span class="n">yy</span><span class="p">,</span><span class="n">NSpec</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
<span class="c"># Group detectors</span>
<span class="n">wsg0</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">SpectraList</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">KeepUngroupedSpectra</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">Behaviour</span><span class="o">=</span><span class="s">&#39;Sum&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Grouped first 3 spectra results in workspace with {0} spectra and the grouped spectra is spectrum 0:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg0</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="n">wsg0</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;First unaffected spectrum is now spectrum 1, former spectrum 4:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">wsg0</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*********************************************************&quot;</span><span class="p">)</span>

<span class="c"># Group detectors differently</span>
<span class="n">wsg1</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">SpectraList</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="n">KeepUngroupedSpectra</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">Behaviour</span><span class="o">=</span><span class="s">&#39;Sum&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Grouped 3 spectra starting with second results in workspace with {0} spectra and the grouped spectra is spectrum 0:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg1</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="n">wsg1</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;First unaffected spectrum is now spectrum 1, former spectrum 0:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">wsg1</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*********************************************************&quot;</span><span class="p">)</span>

<span class="c"># Group detectors in a chain:</span>
<span class="n">wsg2</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">wsg0</span><span class="p">,</span><span class="n">SpectraList</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">KeepUngroupedSpectra</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">Behaviour</span><span class="o">=</span><span class="s">&#39;Sum&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Grouped 6 spectra 3x3 twice results in workspace with {0} spectra and the grouped spectra is spectrum 0 and 1:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg2</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="n">wsg2</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">wsg2</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;First unaffected spectrum is now spectrum 3, former spectrum 7:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">wsg2</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;*********************************************************&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Grouped first 3 spectra results in workspace with 8 spectra and the grouped spectra is spectrum 0:
[ 6.  6.  6.  6.  6.  6.  6.  6.  6.  6.]
First unaffected spectrum is now spectrum 1, former spectrum 4:
[ 4.  4.  4.  4.  4.  4.  4.  4.  4.  4.]
*********************************************************
Grouped 3 spectra starting with second results in workspace with 8 spectra and the grouped spectra is spectrum 0:
[ 9.  9.  9.  9.  9.  9.  9.  9.  9.  9.]
First unaffected spectrum is now spectrum 1, former spectrum 0:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
*********************************************************
Grouped 6 spectra 3x3 twice results in workspace with 6 spectra and the grouped spectra is spectrum 0 and 1:
[ 15.  15.  15.  15.  15.  15.  15.  15.  15.  15.]
[ 6.  6.  6.  6.  6.  6.  6.  6.  6.  6.]
First unaffected spectrum is now spectrum 3, former spectrum 7:
[ 7.  7.  7.  7.  7.  7.  7.  7.  7.  7.]
*********************************************************
</pre></div>
</div>
<p><strong>Example 7: Group detectors using map file:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="c"># Create test input</span>
<span class="n">xx</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="c"># create spectra with signal equal to spectra number</span>
<span class="n">yy</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="n">yy</span><span class="o">=</span><span class="n">yy</span><span class="o">+</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

<span class="n">ws</span><span class="o">=</span><span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="n">DataY</span><span class="o">=</span><span class="n">yy</span><span class="p">,</span><span class="n">NSpec</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>

<span class="c"># Create map file</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;defaultsave.directory&quot;</span><span class="p">],</span> <span class="s">&quot;TestMapFile.map&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">);</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;4</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">);</span> <span class="c"># header, four groups</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;1</span><span class="se">\n</span><span class="s">3</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">);</span> <span class="c"># header group 1</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;1 2 3</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">);</span> <span class="c">#  group 1</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;2</span><span class="se">\n</span><span class="s">3</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">);</span> <span class="c"># header group 2</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;4 5 6</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">);</span> <span class="c">#  group 2</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;3</span><span class="se">\n</span><span class="s">2</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">);</span> <span class="c"># header group 3</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;7 8</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">);</span> <span class="c">#  group 3</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;4</span><span class="se">\n</span><span class="s">2</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">);</span> <span class="c"># header group 4</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;9 10</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">);</span> <span class="c">#  group 4</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c"># Group detectors</span>
<span class="n">wsg</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">MapFile</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span><span class="n">KeepUngroupedSpectra</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">Behaviour</span><span class="o">=</span><span class="s">&#39;Sum&#39;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;Grouped workspace has {0} spectra&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;spectrum 1 (sum of spectra 1-3): {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;spectrum 2 (sum of spectra 4-6): {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;spectrum 3 (sum of spectra 7-8): {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;spectrum 4 (sum of spectra 9-10): {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wsg</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Grouped workspace has 4 spectra
spectrum 1 (sum of spectra 1-3): [ 6.  6.  6.  6.  6.  6.  6.  6.  6.  6.]
spectrum 2 (sum of spectra 4-6): [ 15.  15.  15.  15.  15.  15.  15.  15.  15.  15.]
spectrum 3 (sum of spectra 7-8): [ 15.  15.  15.  15.  15.  15.  15.  15.  15.  15.]
spectrum 4 (sum of spectra 9-10): [ 19.  19.  19.  19.  19.  19.  19.  19.  19.  19.]
</pre></div>
</div>
<p><strong>Example 8: Group detectors using grouping pattern:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Create Workspace of 10 spectra each with one bin.</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">DataY</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="n">NSpec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c"># Run algorithm adding first two spectra and then keep the fourth, add the fifth to seventh, and then keep the last three spectra</span>
<span class="n">ws2</span> <span class="o">=</span> <span class="n">GroupDetectors</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">GroupingPattern</span><span class="o">=</span><span class="s">&quot;0+1,3,4-6,7:9&quot;</span><span class="p">)</span>

<span class="c">#print result</span>
<span class="k">print</span><span class="p">(</span><span class="n">ws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ws2</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>[ 3.]
[ 4.]
[ 18.]
[ 8.]
[ 9.]
[ 10.]
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">Algorithm Index</a> | <a class="reference external" href="categories/Transforms/Grouping.html">Transforms\Grouping</a></p>
</div>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id20">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/de259314d655b6c31c46dac22c46bbf8fd7d5abd/Framework/DataHandling/src/GroupDetectors2.cpp">GroupDetectors2.cpp</a> <em>(last modified: 2019-01-23)</em></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/de259314d655b6c31c46dac22c46bbf8fd7d5abd/Framework/DataHandling/inc/MantidDataHandling/GroupDetectors2.h">GroupDetectors2.h</a> <em>(last modified: 2018-10-31)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="GroupDetectors-v1.html" title="Previous Chapter: GroupDetectors v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; GroupDetectors v...</span>
    </a>
  </li>
  <li>
    <a href="GroupToXResolution-v1.html" title="Next Chapter: GroupToXResolution v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">GroupToXResoluti... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2019-03-25.<br/>
    </p>
  </div>
</footer>
  </body>
</html>