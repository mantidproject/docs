<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>FindCenterOfMassPosition v2</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '4.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="FindClusterFaces v1" href="FindClusterFaces-v1.html" />
    <link rel="prev" title="FindCenterOfMassPosition v1" href="FindCenterOfMassPosition-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>4.0</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="findcenterofmassposition-v2">
<span id="algm-findcenterofmassposition"></span><span id="algm-findcenterofmassposition-v2"></span><h1>FindCenterOfMassPosition v2<a class="headerlink" href="#findcenterofmassposition-v2" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/FindCenterOfMassPosition-v2_dlg.png"><img alt="../_images/FindCenterOfMassPosition-v2_dlg.png" class="screenshot" src="../_images/FindCenterOfMassPosition-v2_dlg.png" style="width: 270px;" /></a>
<p class="caption"><strong>FindCenterOfMassPosition</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#usage" id="id4">Usage</a></li>
<li><a class="reference internal" href="#source" id="id5">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Finds the beam center in a 2D SANS data set.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="3%" />
<col width="18%" />
<col width="5%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>Output</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>If not empty, a table workspace of that name will contain the center of mass position.</td>
</tr>
<tr class="row-even"><td>CenterX</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Estimate for the beam center in X [m]. Default: 0</td>
</tr>
<tr class="row-odd"><td>CenterY</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Estimate for the beam center in Y [m]. Default: 0</td>
</tr>
<tr class="row-even"><td>Tolerance</td>
<td>Input</td>
<td>number</td>
<td>0.00125</td>
<td>Tolerance on the center of mass position between each iteration [m]. Default: 0.00125</td>
</tr>
<tr class="row-odd"><td>DirectBeam</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>If true, a direct beam calculation will be performed. Otherwise, the center of mass of the scattering data will be computed by excluding the beam area.</td>
</tr>
<tr class="row-even"><td>BeamRadius</td>
<td>Input</td>
<td>number</td>
<td>0.0155</td>
<td>Radius of the beam area, in meters, used the exclude the beam when calculating the center of mass of the scattering pattern.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Finds the beam center using the direct beam method.
This algorithm is used by the EQSANS and HFIR SANS reduction.</p>
<p>The position of the beam center <em>p</em> is given by</p>
<p><img class="math" src="../_images/math/014667d44ad19d7adaa49763968e9f236381c28e.png" alt="\vec{p}=\frac{\sum_iI_i\vec{d}_i}{\sum_iI_i}" style="vertical-align: -10px"/></p>
<p>where i runs over all pixels within the largest square detector area centered on the
initial guess for the beam center position. The initial guess is the center of the detector.
<img class="math" src="../_images/math/2f7d8606f8268045fcbdccb990703f9f7ad4ed0c.png" alt="I_i" style="vertical-align: -3px"/> is the detector count for pixel i, and <img class="math" src="../_images/math/2fabcaf088745c48f7c8042151113d50fe6a3356.png" alt="\vec{d}_i" style="vertical-align: -3px"/> is the pixel coordinates. The calculation above
is repeated iteratively by replacing the initial guess with the position found with the
previous iteration. The process stops when the difference between the positions found
with two consecutive iterations is smaller than 0.25 pixel.</p>
<p>If <em>DirectBeam</em> is set to False, the beam center will be found using the
scattered beam method. The process is identical to the direct beam method, with the
only difference being that the pixels within a distance R (the beam radius) of the
beam center guess are excluded from the calculation. The direct beam is thus
excluded and only the scattered data is used.</p>
<p>If the <em>Output</em> property is set, the beam centre will be placed in a
table workspace. Otherwise, the result is placed in an ArrayProperty
named <em>CenterOfMass</em>.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id4">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path. In MantidPlot this is done using <a class="reference external" href="http://www.mantidproject.org/ManageUserDirectories">Manage User Directories</a>.</p>
</div>
<p><strong>Example - Find the beam center for a BioSANS data file:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Load your data file</span>
<span class="n">workspace</span> <span class="o">=</span> <span class="n">LoadSpice2D</span><span class="p">(</span><span class="s">&#39;BioSANS_empty_cell.xml&#39;</span><span class="p">)</span>

<span class="c"># Compute the center position, which will be put in a table workspace</span>
<span class="n">FindCenterOfMassPosition</span><span class="p">(</span><span class="s">&#39;workspace&#39;</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">Algorithm Index</a> | <a class="reference external" href="categories/SANS.html">SANS</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id5">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/de259314d655b6c31c46dac22c46bbf8fd7d5abd/Framework/Algorithms/src/FindCenterOfMassPosition2.cpp">FindCenterOfMassPosition2.cpp</a> <em>(last modified: 2019-01-07)</em></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/de259314d655b6c31c46dac22c46bbf8fd7d5abd/Framework/Algorithms/inc/MantidAlgorithms/FindCenterOfMassPosition2.h">FindCenterOfMassPosition2.h</a> <em>(last modified: 2018-10-05)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="FindCenterOfMassPosition-v1.html" title="Previous Chapter: FindCenterOfMassPosition v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; FindCenterOfMass...</span>
    </a>
  </li>
  <li>
    <a href="FindClusterFaces-v1.html" title="Next Chapter: FindClusterFaces v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">FindClusterFaces... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2019-03-25.<br/>
    </p>
  </div>
</footer>
  </body>
</html>