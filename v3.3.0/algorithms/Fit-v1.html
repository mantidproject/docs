<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Fit v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="FitPeak v1" href="FitPeak-v1.html" />
    <link rel="prev" title="FindUBUsingMinMaxD v1" href="FindUBUsingMinMaxD-v1.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.3</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="fit-v1">
<span id="algm-fit"></span><span id="algm-fit-v1"></span><h1>Fit v1<a class="headerlink" href="#fit-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/Fit-v1_dlg.png"><img alt="../_images/Fit-v1_dlg.png" class="screenshot" src="../_images/Fit-v1_dlg.png" style="width: 357px;" /></a>
<p class="caption"><strong>Fit</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a><ul>
<li><a class="reference internal" href="#additional-properties-for-a-1d-function-and-a-matrixworkspace" id="id4">Additional properties for a 1D function and a MatrixWorkspace</a></li>
<li><a class="reference internal" href="#overview" id="id5">Overview</a></li>
<li><a class="reference internal" href="#setting-a-simple-function" id="id6">Setting a simple function</a></li>
<li><a class="reference internal" href="#setting-a-composite-function" id="id7">Setting a composite function</a></li>
<li><a class="reference internal" href="#setting-ties" id="id8">Setting ties</a></li>
<li><a class="reference internal" href="#setting-constraints" id="id9">Setting constraints</a></li>
<li><a class="reference internal" href="#fitting-to-data-in-a-matrixworkspace" id="id10">Fitting to data in a MatrixWorkspace</a></li>
<li><a class="reference internal" href="#output" id="id11">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples" id="id12">Examples</a></li>
<li><a class="reference internal" href="#usage" id="id13">Usage</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Fits a function to data in a Workspace</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="2%" />
<col width="10%" />
<col width="7%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Function</td>
<td>InOut</td>
<td>Function</td>
<td>Mandatory</td>
<td>Parameters defining the fitting function and its initial values</td>
</tr>
<tr class="row-odd"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><em>Workspace</em></a></td>
<td>Mandatory</td>
<td>Name of the input Workspace</td>
</tr>
<tr class="row-even"><td>DomainType</td>
<td>Input</td>
<td>string</td>
<td>Simple</td>
<td>The type of function domain to use: Simple, Sequential, or Parallel.</td>
</tr>
<tr class="row-odd"><td>Ties</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Math expressions defining ties between parameters of the fitting function.</td>
</tr>
<tr class="row-even"><td>Constraints</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>List of constraints</td>
</tr>
<tr class="row-odd"><td>MaxIterations</td>
<td>Input</td>
<td>number</td>
<td>500</td>
<td>Stop after this number of iterations if a good fit is not found</td>
</tr>
<tr class="row-even"><td>IgnoreInvalidData</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Flag to ignore infinities, NaNs and data with zero errors.</td>
</tr>
<tr class="row-odd"><td>OutputStatus</td>
<td>Output</td>
<td>string</td>
<td>&nbsp;</td>
<td>Whether the fit was successful</td>
</tr>
<tr class="row-even"><td>OutputChi2overDoF</td>
<td>Output</td>
<td>number</td>
<td>&nbsp;</td>
<td>Returns the goodness of the fit</td>
</tr>
<tr class="row-odd"><td>Minimizer</td>
<td>Input</td>
<td>string</td>
<td>Levenberg-Marquardt</td>
<td>Minimizer to use for fitting. Minimizers available are &#8220;Levenberg-Marquardt&#8221;, &#8220;Simplex&#8221;, &#8220;FABADA&#8221;, &#8220;Conjugate gradient (Fletcher-Reeves imp.)&#8221;, &#8220;Conjugate gradient (Polak-Ribiere imp.)&#8221;, &#8220;BFGS&#8221;, and &#8220;Levenberg-MarquardtMD&#8221;</td>
</tr>
<tr class="row-even"><td>CostFunction</td>
<td>InOut</td>
<td>string</td>
<td>Least squares</td>
<td>The cost function to be used for the fit, default is Least squares</td>
</tr>
<tr class="row-odd"><td>CreateOutput</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Set to true to create output workspaces with the results of the fit(default is false).</td>
</tr>
<tr class="row-even"><td>Output</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>A base name for the output workspaces (if not given default names will be created).</td>
</tr>
<tr class="row-odd"><td>CalcErrors</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Set to true to calcuate errors when output isn&#8217;t created (default is false).</td>
</tr>
<tr class="row-even"><td>OutputCompositeMembers</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>If true and CreateOutput is true then the value of each member of a Composite Function is also output.</td>
</tr>
<tr class="row-odd"><td>ConvolveMembers</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>If true and OutputCompositeMembers is true members of any Convolution are output convolved with corresponding resolution</td>
</tr>
<tr class="row-even"><td>OutputParametersOnly</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Set to true to output only the parameters and not workspace(s) with the calculated values (default is false, ignored if CreateOutput is false and Output is an empty string).</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<div class="section" id="additional-properties-for-a-1d-function-and-a-matrixworkspace">
<h3><a class="toc-backref" href="#id4">Additional properties for a 1D function and a MatrixWorkspace</a><a class="headerlink" href="#additional-properties-for-a-1d-function-and-a-matrixworkspace" title="Permalink to this headline">¶</a></h3>
<p>If Function defines a one-dimensional function and InputWorkspace is a
<a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a> the algorithm will have these
additional properties:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="10%" />
<col width="8%" />
<col width="18%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>WorkspaceIndex</td>
<td>Input</td>
<td>integer</td>
<td>0</td>
<td>The spectrum to fit, using the workspace numbering of the spectra</td>
</tr>
<tr class="row-odd"><td>StartX</td>
<td>Input</td>
<td>double</td>
<td>Start of the spectrum</td>
<td>An X value in the first bin to be included in the fit</td>
</tr>
<tr class="row-even"><td>EndX</td>
<td>Input</td>
<td>double</td>
<td>End of the spectrum</td>
<td>An X value in the last bin to be included in the fit</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="overview">
<h3><a class="toc-backref" href="#id5">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>This is a generic algorithm for fitting data in a Workspace with a
function. The workspace must have the type supported by the algorithm.
Currently supported types are: <a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a> for
fitting with a <a class="reference external" href="http://www.mantidproject.org/IFunction1D">IFunction1D</a> and
<a class="reference external" href="http://www.mantidproject.org/IMDWorkspace">IMDWorkspace</a> for fitting with
<a class="reference external" href="http://www.mantidproject.org/IFunctionMD">IFunctionMD</a>. After Function and InputWorkspace
properties are set the algorithm may decide that it needs more
information from the caller to locate the fitting data. For example, if
a spectrum in a MatrixWorkspace is to be fit with a 1D function it will
need to know at least the index of that spectrum. To request this
information Fit dynamically creates relevant properties which the caller
can set. Note that the dynamic properties depend both on the workspace
and the function. For example, the data in a MatrixWorkspace can be fit
with a 2D function. In this case all spectra will be used in the fit and
no additional properties will be declared. The Function property must be
set before any other.</p>
<p>The function and the initial values for its parameters are set with the
Function property. A function can be simple or composite. A <a class="reference external" href="../fitfunctions/categories/Functions.html">simple
function</a> has a name registered with Mantid
framework. The Fit algorithm creates an instance of a function by this
name. A composite function is an arithmetic sum of two or more functions
(simple or composite). Each function has a number of named parameters,
the names are case sensitive. All function parameters will be used in
the fit unless some of them are tied. Parameters can be tied by setting
the Ties property. A tie is a mathematical expression which is used to
calculate the value of a (dependent) parameter. Only the parameter names
of the same function can be used as variables in this expression.</p>
<p>Using the Minimizer property, Fit can be set to use different algorithms
to perform the minimization. By default if the function&#8217;s derivatives
can be evaluated then Fit uses the GSL Levenberg-Marquardt minimizer.</p>
<p>In Mantidplot this algorithm can be run from the <a class="reference external" href="MantidPlot:_DataAnalysisandCurveFitting#Simple_Peak_Fitting_with_the_Fit_Wizard">Fit Property
Browser</a>
which allows all the settings to be specified via its graphical user
interface.</p>
</div>
<div class="section" id="setting-a-simple-function">
<h3><a class="toc-backref" href="#id6">Setting a simple function</a><a class="headerlink" href="#setting-a-simple-function" title="Permalink to this headline">¶</a></h3>
<p>To use a simple function for a fit set its name and initial parameter
values using the Function property. This property is a comma separated
list of name=value pairs. The name of the first name=value pairs must be
&#8220;name&#8221; and it must be set equal to the name of one of a <a class="reference external" href="../fitfunctions/categories/Functions.html">simple
function</a>. This name=value pair is followed
by name=value pairs specifying values for the parameters of this
function. If a parameter is not set in Function it will be given its
default value defined by the function. All names are case sensitive. For
example for fitting a Gaussian the Function property might look like
this:</p>
<p><tt class="docutils literal"><span class="pre">Function:</span> <span class="pre">&quot;name=Gaussian,</span> <span class="pre">PeakCentre=4.6,</span> <span class="pre">Height=10,</span> <span class="pre">Sigma=0.5&quot;</span></tt></p>
<p>Some functions have attributes. An attribute is a non-fitting parameter
and can be of one of the following types: text string, integer, or
double. Attributes are set just like the parameters using name=value
pairs. For example:</p>
<p><tt class="docutils literal"><span class="pre">Function:</span> <span class="pre">&quot;name=UserFunction,</span> <span class="pre">Formula=a+b*x,</span> <span class="pre">a=1,</span> <span class="pre">b=2&quot;</span></tt></p>
<p>In this example Formula is the name of a string attribute which defines
an expression for the user UserFunction. The fitting parameters a and b
are created when the Formula attribute is set. It is important that
Formula is defined before initializing the parameters.</p>
<p>A list of the available simple functions can be found
<a class="reference external" href="../fitfunctions/categories/Functions.html">here</a>.</p>
</div>
<div class="section" id="setting-a-composite-function">
<h3><a class="toc-backref" href="#id7">Setting a composite function</a><a class="headerlink" href="#setting-a-composite-function" title="Permalink to this headline">¶</a></h3>
<p>A composite function is a sum of simple functions. It does not have a
name. To define a composite function set a number of simple functions in
the Function property. Each simple function definition must be separated
by a semicolon &#8216;;&#8217;. For example fitting two Gaussians on a linear
background might look like this:</p>
<div class="highlight-python"><div class="highlight"><pre>Function: &quot;name=LinearBackground, A0=0.3;
           name=Gaussian, PeakCentre=4.6, Height=10, Sigma=0.5;
           name=Gaussian, PeakCentre=7.6, Height=8, Sigma=0.5&quot;
</pre></div>
</div>
</div>
<div class="section" id="setting-ties">
<h3><a class="toc-backref" href="#id8">Setting ties</a><a class="headerlink" href="#setting-ties" title="Permalink to this headline">¶</a></h3>
<p>Parameters can be tied to other parameters or to a constant. In this
case they do not take part in the fitting but are evaluated using the
tying expressions. Use Ties property to set any ties. In case of a
simple function the parameter names are used as variables in the tying
expressions. For example</p>
<p><tt class="docutils literal"><span class="pre">Ties:</span> <span class="pre">&quot;a=2*b+1,</span> <span class="pre">c=2&quot;</span></tt></p>
<p>This ties parameter &#8220;a&#8221; to parameter &#8220;b&#8221; and fixes &#8220;c&#8221; to the constant
2.</p>
<p>In case of a composite function the variable name must refer to both the
parameter name and the simple function it belongs to. It is done by
writing the variable name in the following format:</p>
<p><tt class="docutils literal"><span class="pre">f</span></tt><tt class="docutils literal"><span class="pre">.</span></tt></p>
<p>The format consists of two parts separated by a period &#8216;.&#8217;. The first
part defines the function by its index in the composite function
(starting at 0). The index corresponds to the order in which the
functions are defined in the Function property. For example:</p>
<p><tt class="docutils literal"><span class="pre">Ties:</span> <span class="pre">&quot;f1.Sigma=f0.Sigma,f2.Sigma=f0.Sigma&quot;</span></tt></p>
<p>This ties parameter &#8220;Sigma&#8221; of functions 1 and 2 to the &#8220;Sigma&#8221; of
function 0. Of course all three functions must have a parameter called
&#8220;Sigma&#8221; for this to work. The last example can also be written</p>
<p><tt class="docutils literal"><span class="pre">Ties:</span> <span class="pre">&quot;f1.Sigma=f2.Sigma=f0.Sigma&quot;</span></tt></p>
</div>
<div class="section" id="setting-constraints">
<h3><a class="toc-backref" href="#id9">Setting constraints</a><a class="headerlink" href="#setting-constraints" title="Permalink to this headline">¶</a></h3>
<p>Parameters can be constrained to be above a lower boundary and/or below
an upper boundary. If a constraint is violated a penalty to the fit is
applied which should result the parameters satisfying the constraint.
The penalty applied is described in more detail
<a class="reference internal" href="../concepts/FitConstraint.html#fitconstraint"><em>here</em></a>. Use Constraints property to set any
constraints. In case of a simple function the parameter names are used
as variables in the constraint expressions. For example</p>
<p><tt class="docutils literal"><span class="pre">Constraints:</span> <span class="pre">&quot;4.0</span> <span class="pre">&lt;</span> <span class="pre">c</span> <span class="pre">&lt;</span> <span class="pre">4.2&quot;</span></tt></p>
<p>Constraint the parameter &#8220;c&#8221; to be with the range 4.0 to 4.2, whereas</p>
<p><tt class="docutils literal"><span class="pre">Constraints:</span> <span class="pre">&quot;c</span> <span class="pre">&gt;</span> <span class="pre">4.0&quot;</span></tt></p>
<p>means &#8220;c&#8221; is constrained to be above the lower value 4.0 and</p>
<p><tt class="docutils literal"><span class="pre">Constraints:</span> <span class="pre">&quot;c</span> <span class="pre">&lt;</span> <span class="pre">4.2&quot;</span></tt></p>
<p>means &#8220;c&#8221; is constrained to be below the upper value 4.2.</p>
<p>In case of a composite function the same notation is used for
constraints and for ties. For example</p>
<p><tt class="docutils literal"><span class="pre">Constraints:</span> <span class="pre">&quot;f1.c</span> <span class="pre">&lt;</span> <span class="pre">4.2&quot;</span></tt></p>
<p>constrain the parameter &#8220;c&#8221; of function 1.</p>
</div>
<div class="section" id="fitting-to-data-in-a-matrixworkspace">
<h3><a class="toc-backref" href="#id10">Fitting to data in a MatrixWorkspace</a><a class="headerlink" href="#fitting-to-data-in-a-matrixworkspace" title="Permalink to this headline">¶</a></h3>
<p>The error values in the input workspace are used to weight the data in
the fit. Zero error values are not allowed and are replaced with ones.</p>
</div>
<div class="section" id="output">
<h3><a class="toc-backref" href="#id11">Output</a><a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<p>Setting the Output property defines the names of the two output
workspaces. One of them is a <a class="reference external" href="http://www.mantidproject.org/TableWorkspace">TableWorkspace</a> with
the fitted parameter values. The other is a
<a class="reference internal" href="../concepts/Workspace2D.html#workspace2d"><em>Workspace2D</em></a> which compares the fit with the original
data. It has three spectra. The first (index 0) contains the original
data, the second one the data simulated with the fitting function and
the third spectrum is the difference between the first two. For example,
if the Output was set to &#8220;MyResults&#8221; the parameter TableWorkspace will
have name &#8220;MyResults_Parameters&#8221; and the Workspace2D will be named
&#8220;MyResults_Workspace&#8221;. If the function&#8217;s derivatives can be evaluated
an additional TableWorkspace is returned. When the Output is set to
&#8220;MyResults&#8221; this TableWorkspace will have the name
&#8220;MyResults_NormalisedCovarianceMatrix&#8221; and it returns a calculated
correlation matrix. Denote this matrix C and its elements Cij then the
diagonal elements are listed as 1.0 and the off diagnonal elements as
percentages of correlation between parameter i and j equal to
100*Cij/sqrt(Cii*Cjj).</p>
</div>
</div>
<div class="section" id="examples">
<h2><a class="toc-backref" href="#id12">Examples</a><a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>This example shows a simple fit to a Gaussian function. The algorithm
properties are:</p>
<div class="line-block">
<div class="line"><tt class="docutils literal"><span class="pre">InputWorkspace:</span>&nbsp; <span class="pre">Test</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">WorkspaceIndex:</span>&nbsp; <span class="pre">0</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">Function:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="pre">name=Gaussian,</span> <span class="pre">PeakCentre=4,</span> <span class="pre">Height=1.3,</span> <span class="pre">Sigma=0.5</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">Output:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="pre">res</span></tt></div>
</div>
<div class="figure">
<img alt="GaussianFit.jpg" src="../_images/GaussianFit.jpg" />
<p class="caption">GaussianFit.jpg</p>
</div>
<hr class="docutils" />
<p>The next example shows a fit of the same data but with a tie.</p>
<div class="line-block">
<div class="line"><tt class="docutils literal"><span class="pre">InputWorkspace:</span>&nbsp; <span class="pre">Test</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">WorkspaceIndex:</span>&nbsp; <span class="pre">0</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">Function:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="pre">name=Gaussian,</span> <span class="pre">PeakCentre=4,</span> <span class="pre">Height=1.3,</span> <span class="pre">Sigma=0.5</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">Ties:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="pre">Sigma=Height/2</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">Output:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="pre">res</span></tt></div>
</div>
<div class="figure">
<img alt="GaussianFit_Ties.jpg" src="../_images/GaussianFit_Ties.jpg" />
<p class="caption">GaussianFit_Ties.jpg</p>
</div>
<hr class="docutils" />
<p>This example shows a fit of two overlapping Gaussians on a linear
background. Here we create a composite function with a LinearBackground
and two Gaussians:</p>
<div class="line-block">
<div class="line"><tt class="docutils literal"><span class="pre">InputWorkspace:</span>&nbsp; <span class="pre">Test</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">WorkspaceIndex:</span>&nbsp; <span class="pre">0</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">Function:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="pre">name=LinearBackground,A0=1;</span></tt></div>
<div class="line">``                 name=Gaussian,PeakCentre=4,Height=1.5, Sigma=0.5;``</div>
<div class="line">``                 name=Gaussian,PeakCentre=6,Height=4, Sigma=0.5 ``</div>
<div class="line"><tt class="docutils literal"><span class="pre">Output:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="pre">res</span></tt></div>
</div>
<div class="figure">
<img alt="Gaussian2Fit.jpg" src="../_images/Gaussian2Fit.jpg" />
<p class="caption">Gaussian2Fit.jpg</p>
</div>
<hr class="docutils" />
<p>This example repeats the previous one but with the Sigmas of the two
Gaussians tied:</p>
<div class="line-block">
<div class="line"><tt class="docutils literal"><span class="pre">InputWorkspace:</span>&nbsp; <span class="pre">Test</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">WorkspaceIndex:</span>&nbsp; <span class="pre">0</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">Function:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="pre">name=LinearBackground,A0=1;</span></tt></div>
<div class="line">``                 name=Gaussian,PeakCentre=4,Height=1.5, Sigma=0.5;``</div>
<div class="line">``                 name=Gaussian,PeakCentre=6,Height=4, Sigma=0.5 ``</div>
<div class="line"><tt class="docutils literal"><span class="pre">Ties:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="pre">f2.Sigma</span> <span class="pre">=</span> <span class="pre">f1.Sigma</span></tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">Output:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="pre">res</span></tt></div>
</div>
<div class="figure">
<img alt="Gaussian2Fit_Ties.jpg" src="../_images/Gaussian2Fit_Ties.jpg" />
<p class="caption">Gaussian2Fit_Ties.jpg</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id13">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - Fit a Gaussian to a peak in a spectrum:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># create a workspace with a gaussian peak sitting on top of a linear (here flat) background</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="n">Function</span><span class="o">=</span><span class="s">&quot;User Defined&quot;</span><span class="p">,</span> <span class="n">UserDefinedFunction</span><span class="o">=</span><span class="s">&quot;name=LinearBackground, </span><span class="se">\</span>
<span class="s">   A0=0.3;name=Gaussian, PeakCentre=5, Height=10, Sigma=0.7&quot;</span><span class="p">,</span> <span class="n">NumBanks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">BankPixelWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">XMin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">XMax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">BinWidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c"># Setup the data to fit:</span>
<span class="n">workspaceIndex</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># the spectrum with which WorkspaceIndex to fit</span>
<span class="n">startX</span> <span class="o">=</span> <span class="mi">1</span>      <span class="c"># specify fitting region</span>
<span class="n">endX</span> <span class="o">=</span> <span class="mi">9</span>      <span class="c">#</span>

<span class="c"># Setup the model, here a Gaussian, to fit to data</span>
<span class="n">tryCentre</span> <span class="o">=</span> <span class="s">&#39;4&#39;</span>   <span class="c"># A start guess on peak centre</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="s">&#39;1&#39;</span>          <span class="c"># A start guess on peak width</span>
<span class="n">height</span> <span class="o">=</span> <span class="s">&#39;8&#39;</span>         <span class="c"># A start guess on peak height</span>
<span class="n">myFunc</span> <span class="o">=</span> <span class="s">&#39;name=Gaussian, Height=&#39;</span><span class="o">+</span><span class="n">height</span><span class="o">+</span><span class="s">&#39;, PeakCentre=&#39;</span><span class="o">+</span><span class="n">tryCentre</span><span class="o">+</span><span class="s">&#39;, Sigma=&#39;</span><span class="o">+</span><span class="n">sigma</span>
<span class="c"># here purposely haven&#39;t included a linear background which mean fit will not be spot on</span>
<span class="c"># to include a linear background uncomment the line below</span>
<span class="c">#myFunc = &#39;name=LinearBackground, A0=0.3;name=Gaussian, Height=&#39;+height+&#39;, PeakCentre=&#39;+tryCentre+&#39;, Sigma=&#39;+sigma</span>

<span class="c"># Do the fitting</span>
<span class="n">fitStatus</span><span class="p">,</span> <span class="n">chiSq</span><span class="p">,</span> <span class="n">covarianceTable</span><span class="p">,</span> <span class="n">paramTable</span><span class="p">,</span> <span class="n">fitWorkspace</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s">&#39;ws&#39;</span><span class="p">,</span> \
   <span class="n">WorkspaceIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">StartX</span> <span class="o">=</span> <span class="n">startX</span><span class="p">,</span> <span class="n">EndX</span><span class="o">=</span><span class="n">endX</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s">&#39;fit&#39;</span><span class="p">,</span> <span class="n">Function</span><span class="o">=</span><span class="n">myFunc</span><span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;The fit was: &quot;</span> <span class="o">+</span> <span class="n">fitStatus</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;chi-squared of fit is: </span><span class="si">%.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">chiSq</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Fitted Height value is: </span><span class="si">%.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">paramTable</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Fitted centre value is: </span><span class="si">%.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">paramTable</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Fitted sigma value is: </span><span class="si">%.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">paramTable</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>
<span class="c"># fitWorkspace contains the data, the calculated and the difference patterns</span>
<span class="k">print</span> <span class="s">&quot;Number of spectra in fitWorkspace is: &quot;</span> <span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="n">fitWorkspace</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;The 20th y-value of the calculated pattern: </span><span class="si">%.4f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">fitWorkspace</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">19</span><span class="p">])</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>The fit was: success
chi-squared of fit is: 0.14
Fitted Height value is: 9.79
Fitted centre value is: 5.05
Fitted sigma value is: 0.77
Number of spectra in fitWorkspace is: 3
The 20th y-value of the calculated pattern: 0.2361
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Optimization.html">Optimization</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014, Mantid.<br/>
    </p>
  </div>
</footer>
  </body>
</html>