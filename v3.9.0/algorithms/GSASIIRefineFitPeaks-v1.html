<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GSASIIRefineFitPeaks v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.9.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="Description" href="GatherWorkspaces-v1.html" />
    <link rel="prev" title="FlatPlatePaalmanPingsCorrection v1" href="FlatPlatePaalmanPingsCorrection-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.9</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="gsasiirefinefitpeaks-v1">
<span id="algm-gsasiirefinefitpeaks"></span><span id="algm-gsasiirefinefitpeaks-v1"></span><h1>GSASIIRefineFitPeaks v1<a class="headerlink" href="#gsasiirefinefitpeaks-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/GSASIIRefineFitPeaks-v1_dlg.png"><img alt="../_images/GSASIIRefineFitPeaks-v1_dlg.png" class="screenshot" src="../_images/GSASIIRefineFitPeaks-v1_dlg.png" style="width: 245px;" /></a>
<p class="caption"><strong>GSASIIRefineFitPeaks</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id4">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id5">Properties</a></li>
<li><a class="reference internal" href="#description" id="id6">Description</a></li>
<li><a class="reference internal" href="#usage" id="id7">Usage</a></li>
<li><a class="reference internal" href="#source" id="id8">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id4">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Uses GSAS-II (powder diffraction and structure modules) to perform whole pattern refinement of lattice parameters (or fit peaks) on an diffraction spectrum</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id5">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="1%" />
<col width="8%" />
<col width="4%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Method</td>
<td>Input</td>
<td>string</td>
<td>Pawley refinement</td>
<td>Rietveld corresponds to the Calculate/Refine option of the GSAS-II GUI. Peak fitting is single peak (does not use phase information  and corresponds to the option Peaks List/Peak Fitting/PeakFitType of the GSAS-II GUI. The third alternative requires a list of peaks which can be bassed in the properties ExpectedPeaks and ExpectedPeaksFromFile. Allowed values: [&#8216;Pawley refinement&#8217;, &#8216;Rietveld refinement&#8217;, &#8216;Peak fitting&#8217;]</td>
</tr>
<tr class="row-odd"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Workspace with spectra to fit peaks. ToF is expected X unit.</td>
</tr>
<tr class="row-even"><td>WorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Index of the workspace for the spectrum to fit. By default the first spectrum will be processed (that is, the only spectrum for focussed data workspaces.</td>
</tr>
<tr class="row-odd"><td>InstrumentFile</td>
<td>Input</td>
<td>string</td>
<td><em>Mandatory</em></td>
<td>File with instrument parameters (in GSAS format). Allowed extensions: [&#8216;.par&#8217;, &#8216;.prm&#8217;, &#8216;.ipar&#8217;, &#8216;.iparm&#8217;]</td>
</tr>
<tr class="row-even"><td>PhaseInfoFile</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>File with phase information for the material. Allowed extensions: [&#8216;.cif&#8217;]</td>
</tr>
<tr class="row-odd"><td>PathToGSASII</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Optional path to GSAS-II software installation. This will be used to import several Python modules from GSAS-II.</td>
</tr>
<tr class="row-even"><td>GoF</td>
<td>Output</td>
<td>number</td>
<td>&nbsp;</td>
<td>Goodness of fit value (Chi squared).</td>
</tr>
<tr class="row-odd"><td>Rwp</td>
<td>Output</td>
<td>number</td>
<td>&nbsp;</td>
<td>Weighted profile R-factor (Rwp) discrepancy index for the goodness of fit.</td>
</tr>
<tr class="row-even"><td>LatticeParameters</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><em>TableWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Table to output the the lattice parameters (refined).</td>
</tr>
<tr class="row-odd"><td>FittedPeakParameters</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Name for an (output) table of fitted parameters. This is used with the peak fitting method. The table will have one row per peak found.</td>
</tr>
<tr class="row-even"><td>SaveGSASIIProjectFile</td>
<td>Input</td>
<td>string</td>
<td><em>Mandatory</em></td>
<td>GSAS-II project file (that can be openened in the GSAS-II GUI). Allowed extensions: [&#8216;.gpx&#8217;]</td>
</tr>
<tr class="row-odd"><td>BackgroundType</td>
<td>Input</td>
<td>string</td>
<td>Chebyshev</td>
<td>Type of background for the peak fitting. Currently only the default option of GSAS-II (chebyshev) is supported. Allowed values: [&#8216;Chebyshev&#8217;, &#8216;None&#8217;]</td>
</tr>
<tr class="row-even"><td>MinX</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>Minimum x value for the fitting, in the same units as the input workspace (TOF). Defines the range or domain of fitting together with the property MaxX. Leave empty to use the whole range</td>
</tr>
<tr class="row-odd"><td>MaxX</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>Maximum x value for the fitting, in the same units as the input workspace (TOF). Defines the range or domain of fitting together with the property MinX. Leave empty to use the whole range</td>
</tr>
<tr class="row-even"><td>PawleyDmin</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>For Pawley refiment: as defined in GSAS-II, the minimum d-spacing to be used in a Pawley refinement. Please refer to the GSAS-II documentation for full details.</td>
</tr>
<tr class="row-odd"><td>PawleyNegativeWeight</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>For Pawley refinement: as defined in GSAS-II, the weight for a penalty function applied during a Pawley refinement on resulting negative intensities. Please refer to the GSAS-II documentation for full details.</td>
</tr>
<tr class="row-even"><td>ExpectedPeaks</td>
<td>Input</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>A list of dSpacing values for the peak centers. These will be converted into TOF to find expected peaks.</td>
</tr>
<tr class="row-odd"><td>ExpectedPeaksFromFile</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Load from this file a list of dSpacing values to be converted into TOF . This takes precedence over &#8216;ExpectedPeaks&#8217; when both options are given. Allowed extensions: [&#8216;.csv&#8217;]</td>
</tr>
<tr class="row-even"><td>RefineCenter</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether to refine the peak centers.</td>
</tr>
<tr class="row-odd"><td>RefineIntensity</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether to refine the peak function intensity parameters (assuming a shape of type back-to-back exponential convoluted with pseudo-voigt (BackToBackExponentialPV).</td>
</tr>
<tr class="row-even"><td>RefineAlpha</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether to refine the peak function beta parameters (assuming a BackToBackExponentialPV peak shape.</td>
</tr>
<tr class="row-odd"><td>RefineBeta</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether to refine the peak function beta parameters (assuming a BackToBackExponentialPV peak shape.</td>
</tr>
<tr class="row-even"><td>RefineSigma</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Whether to refine the peak function sigma parameters (assuming a BackToBackExponentialPV peak shape.</td>
</tr>
<tr class="row-odd"><td>RefineGamma</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Whether to refine the peak function gamma parameters (assuming a BackToBackExponentialPV peak shape.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id6">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This algorithm is experimental and at the moment is being developed
for a specific technique. It might be changed, renamed or even
removed without a notification, should instrument scientists decide
to do so.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This algorithm requires GSAS-II, with custom modifications to
enable it to be used from Mantid. Please contact the Mantid
developers for details. The GSAS-II installation instructions are
available from the <a class="reference external" href="https://subversion.xray.aps.anl.gov/trac/pyGSAS">GSAS-II website</a>.</p>
</div>
<p>Uses <a class="reference external" href="https://subversion.xray.aps.anl.gov/trac/pyGSAS">GSAS-II</a>
<a class="reference internal" href="#tobyvondreele2013" id="id1">[TobyVonDreele2013]</a> as external software to fit peaks to a powder /
engineering diffraction pattern. Here the process of peak fitting is
in the context of Rietveld / Pawley / Le Bail analysis <a class="reference internal" href="#lebail2005" id="id2">[LeBail2005]</a></p>
<p>The algorithm supports three refinement or fitting methods: Pawley
refinement, Rietveld refinement, and single peak fitting (or &#8220;Peaks
List&#8221; of GSAS-II). The first two methods of this algorithm implement
whole diffraction pattern fitting whereas the third method fits peaks
individually.  The use of this algorithm is very close to the examples
described in these two GSAS-II tutorials: <a class="reference external" href="https://subversion.xray.aps.anl.gov/pyGSAS/Tutorials/CWNeutron/Neutron%20CW%20Powder%20Data.htm">Rietveld fitting / CW
Neutron Powder fit for Yttrium-Iron Garnet</a>,
and <a class="reference external" href="https://subversion.xray.aps.anl.gov/pyGSAS/Tutorials/FitPeaks/Fit%20Peaks.htm">Getting started / Fitting individual peaks &amp; autoindexing</a>,
The functionality of this algorithm is based on the <a class="reference external" href="https://subversion.xray.aps.anl.gov/pyGSAS/sphinxdocs/build/html/GSASIIpwd.html">powder
calculation module</a>
and the <a class="reference external" href="https://subversion.xray.aps.anl.gov/pyGSAS/sphinxdocs/build/html/GSASIIstruc.html">structure routines</a>
of GSAS-II.</p>
<p>To run this algorithm GSAS-II must be installed and it must be
available for importing from the Mantid Python interpreter. This
algorithm requires a modified version of GSAS-II. Please contact the
developers for details.</p>
<p>The methods &#8220;Pawley refinement&#8221; and &#8220;Rietveld refinement&#8221; of this
algorithm are equivalent to the function &#8220;Calculate / Refine&#8221; from the
main menu of the GSAS-II GUI.  The method &#8220;Peak fitting&#8221; is equivalent
to the &#8220;Peak Fitting / Peak fit&#8221; action of the &#8220;Peaks List&#8221; window
menu of the GSAS-II GUI.</p>
<p>The main inputs required are histogram data, an instrument definition
parameter (in GSAS format, readable by GSAS-II), and various
parameters for the fitting/refinement process. Phase information is
also required to use the Pawley and Rietveld refinement.</p>
<p>The phase information must be provided in <a class="reference external" href="https://en.wikipedia.org/wiki/Crystallographic_Information_File">CIF format
(Crystallographic Information File)</a>.
When phase information is available and the Rietveld/Pawley method is
used the algorithm will output the lattice parameters in a table
workspace. The values are given for the the full set of lattice
parameters (three lattice constants, three angles, and volume in this
sequence: a, b, c, alpha, beta, gamma, volume). The a,b, and c values
are given in Angstroms (<img class="math" src="../_images/math/37faabf1d403f1a0ec64e85192a355bbdfbcb4e7.png" alt="\mathrm{\AA{}}" style="vertical-align: -1px"/>). The angles are given
in degrees, and the volume in <img class="math" src="../_images/math/18af14e8ed16d8acfa0a4d919ce14e0a45be4cd3.png" alt="\mathrm{\AA{}}^3" style="vertical-align: -1px"/>.</p>
<p>The algorithm provides goodness-of-fit estimates in the outputs <em>GoF</em>
and <em>Rwp</em> or weighted profile R-factor <a class="reference internal" href="#toby2008" id="id3">[Toby2008]</a>. The <em>Rwp</em> is given
as a percentage value.</p>
<p>Note that the option to save the GSAS-II project file
(<em>SaveGSASIIProjectFile</em>) is mandatory. This is a requirement of
GSAS-II. These project files can be opened in the GSAS-II GUI for
further processing and analysis of the data.</p>
<p>When Pawley refinement is selected as refinement method the flag for
histogram scale factor refinement is disabled, as recommended in the
<a class="reference external" href="https://subversion.xray.aps.anl.gov/pyGSAS/trunk/help/gsasII.html">GSAS-II documentation</a>,
as this cannot be refined simultaenously with the Pawley reflection
intensities.</p>
<p>The GSAS-II Rietveld/Pawley refinement process writes lattice
parameters and extensive additional information in an output file with
the same name as the output GSAS-II project file but with extension
&#8221;.lst&#8221;. This is noted in a log message that specifies where the file
has been written (next to the output project file).</p>
<p>When fitting individual peaks using the peak fitting method (not using
Rietveld/Pawley refinement), the algorithm only supports peaks with
shape of type back-to-back exponential convoluted with pseudo-voigt
(BackToBackExponentialPV). It is possible to enable the refinement of
the different function parameters via several properties (RefineAlpha,
RefineSigma, etc.). The fitted peak parameters are given in an output
table with as many rows as peaks have been found. The columns of the
table give the parameters fitted, similarly to the information found
in the &#8220;Peaks List&#8221; window of the GSAS-II GUI. These results are
printed in the log messages as well.</p>
<p>For fitting single peaks, one at a time, see also <a class="reference internal" href="EnggFitPeaks-v1.html#algm-enggfitpeaks"><em>EnggFitPeaks</em></a>. For other algorithms that implement different
variants of whole diffraction pattern refinement and fitting see also
<a class="reference internal" href="PawleyFit-v1.html#algm-pawleyfit"><em>PawleyFit</em></a> and <a class="reference internal" href="LeBailFit-v1.html#algm-lebailfit"><em>LeBailFit</em></a>.</p>
<p><em>References</em>:</p>
<table class="docutils citation" frame="void" id="lebail2005" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[LeBail2005]</a></td><td>Le Bail, A (2005). &#8220;Whole Powder Pattern Decomposition Methods and
Applications: A Retrospection&#8221;. Powder Diffraction 20(4): 316-326.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="tobyvondreele2013" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[TobyVonDreele2013]</a></td><td>Toby, B. H., &amp; Von Dreele, R. B. (2013). &#8220;GSAS-II: the
genesis of a modern open-source all purpose crystallography
software package&#8221;. Journal of Applied Crystallography, 46(2),
544-549.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="toby2008" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[Toby2008]</a></td><td>Toby, B. H. (2008). &#8220;R factors in Rietveld analysis: How good is good
enough?&#8221;. Powder Diffraction, 21(1), 67-70.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id7">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - Pawley refinement of lattice parameters from a diffraction spectrum</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># You would normally generate the focused file using the Engg GUI or,</span>
<span class="c"># alternatively, with commands like these:</span>
<span class="c">#</span>
<span class="c"># wks = Load(&#39;ENGINX00256663-256675&#39;)</span>
<span class="c"># wks_ceria = Load(&#39;ENGINX00255924&#39;)</span>
<span class="c"># wks_vana = Load(&#39;ENGINX00254854&#39;)</span>
<span class="c"># # Using default expected peaks for Ceria</span>
<span class="c"># difa, difc, tzero, peaks_tbl = EnggCalibrate(InputWorkspace=wks_ceria, VanadiumWorkspace=wks_vana, Bank=&#39;North&#39;)</span>
<span class="c"># wks_focused = EnggFocus(InputWorkspace=wks, VanadiumWorkspace=wks_vana, Bank=&#39;North&#39;)</span>
<span class="c"># SaveNexus(InputWorkspace=wks_focused, Filename=&#39;focused_bank1_ENGINX00256663.nxs&#39;)</span>
<span class="c">#</span>
<span class="n">wks</span><span class="o">=</span><span class="n">Load</span><span class="p">(</span><span class="s">&#39;focused_bank1_ENGINX00256663.nxs&#39;</span><span class="p">)</span>
<span class="n">GoF</span><span class="p">,</span> <span class="n">Rwp</span><span class="p">,</span> <span class="n">lattice_tbl</span> <span class="o">=</span> <span class="n">GSASIIRefineFitPeaks</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">wks</span><span class="p">,</span>
                                             <span class="n">InstrumentFile</span><span class="o">=</span><span class="s">&#39;ENGINX_255924_254854_North_bank.par&#39;</span><span class="p">,</span>
                                             <span class="n">PhaseInfoFile</span><span class="o">=</span><span class="s">&#39;FE_ALPHA.cif&#39;</span><span class="p">,</span>
                                             <span class="n">PathToGSASII</span><span class="o">=</span><span class="s">&#39;/home/user/gsas&#39;</span><span class="p">,</span>
                                             <span class="n">SaveGSASIIProjectFile</span><span class="o">=</span><span class="s">&#39;example_gsas2_project&#39;</span><span class="p">,</span>
                                             <span class="n">LatticeParameters</span><span class="o">=</span><span class="s">&#39;lattice_tbl&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Goodness of fit coefficient: {0:.5f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">GoF</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Weighted profile R-factor (Rwp): {0:.5f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Rwp</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&quot;Lattice parameters, a: {a}, b: {b}, c: {c}, alpha: {alpha}, beta: {beta}, gamma: {gamma}, &quot;</span>
       <span class="s">&quot;Volume: {volume:.3f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">lattice_tbl</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Goodness of fit coefficient: 3.63591
Weighted profile R-factor (Rwp): 77.27831
Lattice parameters, a: 2.8665, b: 2.8665, c: 2.8665, alpha: 90.0, beta: 90.0, gamma: 90.0, Volume: 23.554
</pre></div>
</div>
<p><strong>Example - Rietveld refinement of lattice parameters from a diffraction spectrum</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">wks</span><span class="o">=</span><span class="n">Load</span><span class="p">(</span><span class="s">&#39;focused_bank1_ENGINX00256663.nxs&#39;</span><span class="p">)</span>
<span class="n">GoF</span><span class="p">,</span> <span class="n">Rwp</span><span class="p">,</span> <span class="n">lattice_tbl</span> <span class="o">=</span> <span class="n">GSASIIRefineFitPeaks</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">wks</span><span class="p">,</span>
                                             <span class="n">Method</span><span class="o">=</span><span class="s">&#39;Rietveld refinement&#39;</span><span class="p">,</span>
                                             <span class="n">InstrumentFile</span><span class="o">=</span><span class="s">&#39;ENGINX_255924_254854_North_bank.par&#39;</span><span class="p">,</span>
                                             <span class="n">PhaseInfoFile</span><span class="o">=</span><span class="s">&#39;FE_ALPHA.cif&#39;</span><span class="p">,</span>
                                             <span class="n">PathToGSASII</span><span class="o">=</span><span class="s">&#39;/home/user/gsas&#39;</span><span class="p">,</span>
                                             <span class="n">SaveGSASIIProjectFile</span><span class="o">=</span><span class="s">&#39;example_gsas2_project&#39;</span><span class="p">,</span>
                                             <span class="n">LatticeParameters</span><span class="o">=</span><span class="s">&#39;lattice_tbl&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Goodness of fit coefficient: {0:.5f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">GoF</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Weighted profile R-factor (Rwp): {0:.5f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Rwp</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&quot;Lattice parameters, a: {a}, b: {b}, c: {c}, alpha: {alpha}, beta: {beta}, gamma: {gamma}, &quot;</span>
       <span class="s">&quot;Volume: {volume:.3f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">lattice_tbl</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Goodness of fit coefficient: 3.62483
Weighted profile R-factor (Rwp): 77.03530
Lattice parameters, a: 2.8665, b: 2.8665, c: 2.8665, alpha: 90.0, beta: 90.0, gamma: 90.0, Volume: 23.554
</pre></div>
</div>
<p><strong>Example - Fit several peaks from a diffraction spectrum</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">wks</span><span class="o">=</span><span class="n">Load</span><span class="p">(</span><span class="s">&#39;focused_bank1_ENGINX00256663.nxs&#39;</span><span class="p">)</span>
<span class="n">params_tbl_name</span> <span class="o">=</span> <span class="s">&#39;tbl_fitted_params&#39;</span>
<span class="n">GoF</span><span class="p">,</span> <span class="n">Rwp</span><span class="p">,</span> <span class="n">lattice_tbl</span> <span class="o">=</span> <span class="n">GSASIIRefineFitPeaks</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">wks</span><span class="p">,</span>
                                             <span class="n">Method</span><span class="o">=</span><span class="s">&#39;Peak fitting&#39;</span><span class="p">,</span>
                                             <span class="n">FittedPeakParameters</span><span class="o">=</span><span class="n">params_tbl_name</span><span class="p">,</span>
                                             <span class="n">InstrumentFile</span><span class="o">=</span><span class="s">&#39;ENGINX_255924_254854_North_bank.par&#39;</span><span class="p">,</span>
                                             <span class="n">PhaseInfoFile</span><span class="o">=</span><span class="s">&#39;FE_ALPHA.cif&#39;</span><span class="p">,</span>
                                             <span class="n">PathToGSASII</span><span class="o">=</span><span class="s">&#39;/home/user/mantid-repos/gsas&#39;</span><span class="p">,</span>
                                             <span class="n">SaveGSASIIProjectFile</span><span class="o">=</span><span class="s">&#39;test_gsas2_project&#39;</span><span class="p">,</span>
                                             <span class="n">FittedPeakParameters</span><span class="o">=</span><span class="n">params_tbl_name</span><span class="p">)</span>
<span class="n">tbl_fitted_params</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="n">params_tbl_name</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&quot;Fitted {0} peaks.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl_fitted_params</span><span class="o">.</span><span class="n">rowCount</span><span class="p">())</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&quot;Parameters of the first peak. Center: {Center:.6g}, intensity: {Intensity:.5f}, &quot;</span>
       <span class="s">&quot;alpha: {Alpha:.5f}, beta: {Beta:.5f}, sigma: {Sigma:.5f}, gamma: {Gamma:.5f}&quot;</span><span class="o">.</span>
       <span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">tbl_fitted_params</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Fitted 18 peaks.
Parameters of the first peak. Center: 38563.8, intensity: 26.22137, alpha: 0.13125, beta: 0.01990, sigma: 125475.11036, gamma: -6681.38965
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Diffraction/Engineering.html">Diffraction\Engineering</a> | <a class="reference external" href="categories/Diffraction/Fitting.html">Diffraction\Fitting</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id8">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/3343e70222874fbd364099f979bd048987dd346c/Framework/PythonInterface/plugins/algorithms/GSASIIRefineFitPeaks.py">GSASIIRefineFitPeaks.py</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="FlatPlatePaalmanPingsCorrection-v1.html" title="Previous Chapter: FlatPlatePaalmanPingsCorrection v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; FlatPlatePaalman...</span>
    </a>
  </li>
  <li>
    <a href="GatherWorkspaces-v1.html" title="Next Chapter: Description"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Description &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>