<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>WorkflowAlgorithmRunner v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.10.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="XorMD v1" href="XorMD-v1.html" />
    <link rel="prev" title="WienerSmooth v1" href="WienerSmooth-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.10</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="workflowalgorithmrunner-v1">
<span id="algm-workflowalgorithmrunner"></span><span id="algm-workflowalgorithmrunner-v1"></span><h1>WorkflowAlgorithmRunner v1<a class="headerlink" href="#workflowalgorithmrunner-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/WorkflowAlgorithmRunner-v1_dlg.png"><img alt="../_images/WorkflowAlgorithmRunner-v1_dlg.png" class="screenshot" src="../_images/WorkflowAlgorithmRunner-v1_dlg.png" style="width: 322px;" /></a>
<p class="caption"><strong>WorkflowAlgorithmRunner</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#usage" id="id4">Usage</a></li>
<li><a class="reference internal" href="#source" id="id5">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Manages dependency resolution, input/output mapping and running of algorithms.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="5%" />
<col width="32%" />
<col width="9%" />
<col width="42%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Algorithm</td>
<td>Input</td>
<td>string</td>
<td><em>Mandatory</em></td>
<td>Name of the algorithm to run</td>
</tr>
<tr class="row-odd"><td>SetupTable</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><em>TableWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Table workspace containing the setup of the runs.</td>
</tr>
<tr class="row-even"><td>InputOutputMap</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><em>TableWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Table workspace mapping algorithm outputs to inputs.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This utility algorithm is used to control consecutive executions of another algorithm. After defining a table of desired input and output properties, <tt class="docutils literal"><span class="pre">WorkflowAlgorithmRunner</span></tt> connects the outputs to input properties, declares the order of execution, and runs the algorithm. It is mainly meant for managing the execution of workflow algorithms for data reduction purposes although it can run all types of algorithms.</p>
<p>The runs are specified in a <cite>TableWorkspace</cite> and given as the <em>SetupTable</em> input property to the algorihtm. The first column has to contain unique string identifiers for each row. The rest of the columns have to be named same as the input/output properties of the managed algorithm.</p>
<p>Each row in the <em>SetupTable</em> corresponds to a single run of the managed algorithm. Its properties are set without modifications from the corresponding columns of the row except for special input/output columns declare in the <em>InputOutputMap</em>. For example, two independent runs of the <a class="reference internal" href="Scale-v1.html#algm-scale"><em>Scale v1</em></a> would be specified as</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="27%" />
<col width="29%" />
<col width="12%" />
<col width="18%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Id</th>
<th class="head">InputWorkspace</th>
<th class="head">OutputWorkspace</th>
<th class="head">Factor</th>
<th class="head">Operation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1st run</td>
<td>ws1</td>
<td>ws1</td>
<td>0.42</td>
<td>Multiply</td>
</tr>
<tr class="row-odd"><td>2nd run</td>
<td>ws2</td>
<td>scaled_ws2</td>
<td>100</td>
<td>Multiply</td>
</tr>
</tbody>
</table>
<p>The <em>Operation</em> column could have been omitted in the above to use the default value of the <em>Operation</em> property of <cite>Scale</cite>.</p>
<p><em>InputOutputMap</em> connects the outputs of a run to the inputs of another run. It is a <cite>TableWorkspace</cite> where the column names correspond to some or all of the managed algorithm&#8217;s input properties. The table has only a single row which lists the names of the output properties whose final values will be forwarded to the corresponding input property. To continue the <a class="reference internal" href="Scale-v1.html#algm-scale"><em>Scale v1</em></a> example above, the <em>InputWorkspace</em> and <em>OutputWorkspace</em> properties would be connected by the following single column table:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">InputWorkspace</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>OutputWorkspace</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only workspace properties can be specified in the <em>InputOutputMap</em>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A single output property can be wired to several input properties. However, an input property cannot have multiple output properties.</p>
</div>
<p>If the one wanted to give the workspace scaled by &#8216;2nd run&#8217; as an input for &#8216;1st run&#8217;, the <em>InputOutputMap</em> would look like the following:</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="27%" />
<col width="29%" />
<col width="12%" />
<col width="18%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Id</th>
<th class="head">InputWorkspace</th>
<th class="head">OutputWorkspace</th>
<th class="head">Factor</th>
<th class="head">Operation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1st run</td>
<td>2nd run</td>
<td>&#8216;ws1&#8217;</td>
<td>0.42</td>
<td>Multiply</td>
</tr>
<tr class="row-odd"><td>2nd run</td>
<td>&#8216;ws2&#8217;</td>
<td>scaled_ws2</td>
<td>100</td>
<td>Multiply</td>
</tr>
</tbody>
</table>
<p>This would result in &#8216;2nd run&#8217; to be executed first to produce the &#8216;scaled_ws2&#8217; workspace which in turn would be fed to &#8216;1st run&#8217; as the <em>InputWorkspace</em> property. Behind the scenes, <tt class="docutils literal"><span class="pre">WorkflowAlgorithmRunner</span></tt> will replace the &#8216;2nd run&#8217; in the InputWorkspace column of &#8216;1st run&#8217; by scaled_ws2.</p>
<p>In the above, note the quotation marks around the &#8216;ws2&#8217; and &#8216;ws1&#8217; property names. These are <strong>hard coded input</strong> and <strong>forced output</strong> values, respectively. This tells <cite>WorkspaceAlgorithmRunner</cite> to omit input/output mapping and to keep these values as they are.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A non-forced output property which is not needed by the other runs will be cleared by <tt class="docutils literal"><span class="pre">WorkflowAlgorithmRunner</span></tt>.</p>
</div>
<p>An equivalent python commands to running <tt class="docutils literal"><span class="pre">WorkflowAlgorithmRunner</span></tt> with the above <em>InputOutputMap</em> and <em>SetupTable</em> would be</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Scale</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s">&#39;ws2&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s">&#39;scaled_ws2&#39;</span><span class="p">,</span> <span class="n">Factor</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">Operation</span><span class="o">=</span><span class="s">&#39;Multiply&#39;</span><span class="p">)</span>
<span class="n">Scale</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s">&#39;scaled_ws2&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s">&#39;ws1&#39;</span><span class="p">,</span> <span class="n">Factor</span><span class="o">=</span><span class="mf">0.42</span><span class="p">,</span> <span class="n">Operation</span><span class="o">=</span><span class="s">&#39;Multiply&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id4">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example: Let&#8217;s recreate the example in the Description section</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># This is our initial workspace. We want to scale it first by 100</span>
<span class="c"># and then by 0.42</span>
<span class="n">CreateSingleValuedWorkspace</span><span class="p">(</span><span class="n">OutputWorkspace</span><span class="o">=</span><span class="s">&#39;ws2&#39;</span><span class="p">,</span> <span class="n">DataValue</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c"># Setup the runs for the Scale algorithm</span>
<span class="n">setupTable</span> <span class="o">=</span> <span class="n">WorkspaceFactoryImpl</span><span class="o">.</span><span class="n">Instance</span><span class="p">()</span><span class="o">.</span><span class="n">createTable</span><span class="p">()</span>
<span class="n">setupTable</span><span class="o">.</span><span class="n">addColumn</span><span class="p">(</span><span class="s">&#39;str&#39;</span><span class="p">,</span> <span class="s">&#39;Run name&#39;</span><span class="p">)</span> <span class="c"># First column can have arbitrary name.</span>
<span class="c"># The rest of the columns can be in arbitrary order</span>
<span class="n">setupTable</span><span class="o">.</span><span class="n">addColumn</span><span class="p">(</span><span class="s">&#39;str&#39;</span><span class="p">,</span> <span class="s">&#39;InputWorkspace&#39;</span><span class="p">)</span>
<span class="n">setupTable</span><span class="o">.</span><span class="n">addColumn</span><span class="p">(</span><span class="s">&#39;double&#39;</span><span class="p">,</span> <span class="s">&#39;Factor&#39;</span><span class="p">)</span> <span class="c"># Scale expects to get a number here.</span>
<span class="n">setupTable</span><span class="o">.</span><span class="n">addColumn</span><span class="p">(</span><span class="s">&#39;str&#39;</span><span class="p">,</span> <span class="s">&#39;OutputWorkspace&#39;</span><span class="p">)</span>
<span class="n">row</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;Run name&#39;</span><span class="p">:</span> <span class="s">&#39;1st run&#39;</span><span class="p">,</span>
    <span class="s">&#39;InputWorkspace&#39;</span><span class="p">:</span> <span class="s">&#39;2nd run&#39;</span><span class="p">,</span>
    <span class="s">&#39;Factor&#39;</span><span class="p">:</span> <span class="mf">0.42</span><span class="p">,</span>
    <span class="s">&#39;OutputWorkspace&#39;</span><span class="p">:</span> <span class="s">&#39;&quot;ws1&quot;&#39;</span> <span class="c"># Forced output either by &#39;&#39; or &quot;&quot;.</span>
<span class="p">}</span>
<span class="n">setupTable</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="n">row</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;Run name&#39;</span><span class="p">:</span> <span class="s">&#39;2nd run&#39;</span><span class="p">,</span>
    <span class="s">&#39;InputWorkspace&#39;</span><span class="p">:</span> <span class="s">&quot;&#39;ws2&#39;&quot;</span><span class="p">,</span>
    <span class="s">&#39;Factor&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s">&#39;OutputWorkspace&#39;</span><span class="p">:</span> <span class="s">&#39;scaled_ws2&#39;</span>
<span class="p">}</span>
<span class="n">setupTable</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="n">AnalysisDataServiceImpl</span><span class="o">.</span><span class="n">Instance</span><span class="p">()</span><span class="o">.</span><span class="n">addOrReplace</span><span class="p">(</span><span class="s">&#39;setupTable&#39;</span><span class="p">,</span> <span class="n">setupTable</span><span class="p">)</span>

<span class="c"># Map OutputWorkspace to InputWorkspace</span>
<span class="n">ioMap</span> <span class="o">=</span> <span class="n">WorkspaceFactoryImpl</span><span class="o">.</span><span class="n">Instance</span><span class="p">()</span><span class="o">.</span><span class="n">createTable</span><span class="p">()</span>
<span class="n">ioMap</span><span class="o">.</span><span class="n">addColumn</span><span class="p">(</span><span class="s">&#39;str&#39;</span><span class="p">,</span> <span class="s">&#39;InputWorkspace&#39;</span><span class="p">)</span>
<span class="n">ioMap</span><span class="o">.</span><span class="n">addRow</span><span class="p">({</span><span class="s">&#39;InputWorkspace&#39;</span><span class="p">:</span> <span class="s">&#39;OutputWorkspace&#39;</span><span class="p">})</span>
<span class="n">AnalysisDataServiceImpl</span><span class="o">.</span><span class="n">Instance</span><span class="p">()</span><span class="o">.</span><span class="n">addOrReplace</span><span class="p">(</span><span class="s">&#39;ioMapTable&#39;</span><span class="p">,</span> <span class="n">ioMap</span><span class="p">)</span>

<span class="c"># Execute the algorithm</span>
<span class="n">WorkflowAlgorithmRunner</span><span class="p">(</span><span class="s">&#39;Scale&#39;</span><span class="p">,</span> <span class="n">SetupTable</span><span class="o">=</span><span class="n">setupTable</span><span class="p">,</span> <span class="n">InputOutputMap</span><span class="o">=</span><span class="n">ioMap</span><span class="p">)</span>

<span class="c"># Print some results</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Original input value: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mtd</span><span class="p">[</span><span class="s">&#39;ws2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;After scaling by 100: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mtd</span><span class="p">[</span><span class="s">&#39;scaled_ws2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;After further scaling by 0.42: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mtd</span><span class="p">[</span><span class="s">&#39;ws1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dataY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>Original input value: 1.0
After scaling by 100: 100.0
After further scaling by 0.42: 42.0
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Utility.html">Utility</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id5">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/ff859df4a5faa6fa5e3cecb8f2efeb4c4aa53864/Framework/Algorithms/src/WorkflowAlgorithmRunner.cpp">WorkflowAlgorithmRunner.cpp</a></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/ff859df4a5faa6fa5e3cecb8f2efeb4c4aa53864/Framework/Algorithms/inc/MantidAlgorithms/WorkflowAlgorithmRunner.h">WorkflowAlgorithmRunner.h</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="WienerSmooth-v1.html" title="Previous Chapter: WienerSmooth v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; WienerSmooth v1</span>
    </a>
  </li>
  <li>
    <a href="XorMD-v1.html" title="Next Chapter: XorMD v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">XorMD v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>