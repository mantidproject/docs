<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>NormaliseToMonitor v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.10.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="NormaliseToUnity v1" href="NormaliseToUnity-v1.html" />
    <link rel="prev" title="NormaliseSpectra v1" href="NormaliseSpectra-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.10</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="normalisetomonitor-v1">
<span id="algm-normalisetomonitor"></span><span id="algm-normalisetomonitor-v1"></span><h1>NormaliseToMonitor v1<a class="headerlink" href="#normalisetomonitor-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/NormaliseToMonitor-v1_dlg.png"><img alt="../_images/NormaliseToMonitor-v1_dlg.png" class="screenshot" src="../_images/NormaliseToMonitor-v1_dlg.png" style="width: 227px;" /></a>
<p class="caption"><strong>NormaliseToMonitor</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a><ul>
<li><a class="reference internal" href="#bin-by-bin-mode" id="id4">Bin-by-bin mode</a></li>
<li><a class="reference internal" href="#normalisation-by-integrated-count-mode" id="id5">Normalisation by integrated count mode</a></li>
<li><a class="reference internal" href="#restrictions-on-the-input-workspace" id="id6">Restrictions on the input workspace</a></li>
<li><a class="reference internal" href="#child-algorithms-used" id="id7">Child Algorithms used</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id8">Usage</a></li>
<li><a class="reference internal" href="#source" id="id9">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Normalizes a 2D workspace by a specified spectrum, spectrum, described by a monitor ID or spectrun provided in a separate worskspace.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="2%" />
<col width="10%" />
<col width="3%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Name of the input workspace. Must be a non-distribution histogram.</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Name to use for the output workspace</td>
</tr>
<tr class="row-even"><td>MonitorSpectrum</td>
<td>InOut</td>
<td>number</td>
<td>-1</td>
<td>The spectrum number within the InputWorkspace you want to normalize by (It can be a monitor spectrum or a spectrum responsible for a group of detectors or monitors)</td>
</tr>
<tr class="row-odd"><td>MonitorID</td>
<td>Input</td>
<td>number</td>
<td>-1</td>
<td>The MonitorID (pixel ID), which defines the monitor&#8217;s data within the InputWorkspace. Will be overridden by the values correspondent to MonitorSpectrum field if one is provided in the field above. If workspace do not have monitors, the MonitorID can refer to empty data and the field then can accepts any MonitorID within the InputWorkspace.</td>
</tr>
<tr class="row-even"><td>MonitorWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td>&nbsp;</td>
<td>A workspace containing one or more spectra to normalize the InputWorkspace by.</td>
</tr>
<tr class="row-odd"><td>MonitorWorkspaceIndex</td>
<td>InOut</td>
<td>number</td>
<td>0</td>
<td>The index of the spectrum within the MonitorWorkspace(2 (0&lt;=ind&lt;=nHistograms in MonitorWorkspace) you want to normalize by (usually related to the index, responsible for the monitor&#8217;s data but can be any). If no value is provided in this field, &#8216;&#8217;&#8216;InputWorkspace&#8217;&#8216;&#8217; will be normalized by first spectra (with index 0)</td>
</tr>
<tr class="row-even"><td>IntegrationRangeMin</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>If set, normalization will be by integrated count from this minimum x value</td>
</tr>
<tr class="row-odd"><td>IntegrationRangeMax</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>If set, normalization will be by integrated count up to this maximum x value</td>
</tr>
<tr class="row-even"><td>IncludePartialBins</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>If true and an integration range is set then partial bins at either  end of the integration range are also included</td>
</tr>
<tr class="row-odd"><td>NormFactorWS</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td>&nbsp;</td>
<td>Name of the workspace, containing the normalization factor. If this name is empty, normalization workspace is not returned. If the name coincides with the output workspace name, _normFactor suffix is added to this name</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bin-by-bin-mode">
<h3><a class="toc-backref" href="#id4">Bin-by-bin mode</a><a class="headerlink" href="#bin-by-bin-mode" title="Permalink to this headline">¶</a></h3>
<p>In this, the default scenario, each spectrum in the workspace is
normalised on a bin-by-bin basis by the monitor spectrum given. The
error on the monitor spectrum is taken into account. The normalisation
scheme used is:</p>
<p><img class="math" src="../_images/math/db4e5d672e2688053176fc731bcc5d8f4397dd0f.png" alt="(s_i)_{Norm}=(\frac{s_i}{m_i})*\Delta w_i*\frac{\sum_i{m_i}}{\sum_i(\Delta w_i)}" style="vertical-align: -10px"/></p>
<p>where <img class="math" src="../_images/math/0e4f2adbaa7818857e80844a28cf835b5c73b2d1.png" alt="s_i" style="vertical-align: -3px"/> is the signal in a bin, <img class="math" src="../_images/math/18115b7c27e7eba2c16e4953e05bd9c05af5b432.png" alt="m_i" style="vertical-align: -3px"/> the count in the
corresponding monitor bin, <img class="math" src="../_images/math/65e6cf2bdf1536d1508ae07c9ee642d622598821.png" alt="\Delta w_i" style="vertical-align: -3px"/> the bin width,
<img class="math" src="../_images/math/12b3ca88eeabbf63b247cb66e40bf495e993aded.png" alt="\sum_i{m_i}" style="vertical-align: -5px"/> the integrated monitor count and
<img class="math" src="../_images/math/1731fef7fd3bdd229d2b616dcbbf56907fea2c00.png" alt="\sum_i{\Delta w_i}" style="vertical-align: -5px"/> the sum of the monitor bin widths. In words,
this means that after normalisation each bin is multiplied by the bin
width and the total monitor count integrated over the entire frame, and
then divided by the total frame width. This leads to a normalised
histogram which has unit of counts, as before.</p>
<p>If the workspace does not have common binning, then the monitor spectrum
is rebinned internally to match each data spectrum prior to doing the
normalisation.</p>
<p>If a bin in the monitor spectrum contains 0 counts there is no special
treatment, only a warning is logged. The following options are available to deal
with the issue:</p>
<ul class="simple">
<li>Smooth the monitor spectrum before normalisation (using for example <a class="reference internal" href="FFTSmooth-v2.html#algm-fftsmooth"><em>FFTSmooth v2</em></a>, <a class="reference internal" href="SmoothData-v1.html#algm-smoothdata"><em>SmoothData v1</em></a>, <a class="reference internal" href="SplineSmoothing-v1.html#algm-splinesmoothing"><em>SplineSmoothing v1</em></a> algorithms).</li>
<li>Replace the infinite numbers and NaNs after normalisation (<a class="reference internal" href="ReplaceSpecialValues-v1.html#algm-replacespecialvalues"><em>ReplaceSpecialValues v1</em></a> algorithm).</li>
</ul>
</div>
<div class="section" id="normalisation-by-integrated-count-mode">
<h3><a class="toc-backref" href="#id5">Normalisation by integrated count mode</a><a class="headerlink" href="#normalisation-by-integrated-count-mode" title="Permalink to this headline">¶</a></h3>
<p>This mode is used if one or both of the relevant &#8216;IntegrationRange&#8217;
optional parameters are set. If either is set to a value outside the
workspace range, then it will be reset to the frame minimum or maximum,
as appropriate.</p>
<p>The error on the integrated monitor spectrum is taken into account in
the normalisation. No adjustment of the overall normalisation takes
place, meaning that the output values in the output workspace are
technically dimensionless.</p>
</div>
<div class="section" id="restrictions-on-the-input-workspace">
<h3><a class="toc-backref" href="#id6">Restrictions on the input workspace</a><a class="headerlink" href="#restrictions-on-the-input-workspace" title="Permalink to this headline">¶</a></h3>
<p>The data must be histogram, non-distribution data.</p>
</div>
<div class="section" id="child-algorithms-used">
<h3><a class="toc-backref" href="#id7">Child Algorithms used</a><a class="headerlink" href="#child-algorithms-used" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="ExtractSingleSpectrum-v1.html#algm-extractsinglespectrum"><em>ExtractSingleSpectrum v1</em></a> algorithm is used
to pull out the monitor spectrum if it&#8217;s part of the InputWorkspace or
MonitorWorkspace. For the &#8216;integrated range&#8217; option, the
<a class="reference internal" href="Integration-v1.html#algm-integration"><em>Integration v1</em></a> algorithm is used to integrate the monitor
spectrum.</p>
<p>In both cases, the <a class="reference internal" href="Divide-v1.html#algm-divide"><em>Divide v1</em></a> algorithm is used to perform the
normalisation.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id8">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path. In MantidPlot this is done using <a class="reference external" href="http://www.mantidproject.org/ManageUserDirectories">Manage User Directories</a>.</p>
</div>
<p><strong>Example - Normalise to Monitor ID=1</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ws</span> <span class="o">=</span><span class="n">Load</span><span class="p">(</span><span class="s">&#39;IRS26173.raw&#39;</span><span class="p">)</span>

<span class="n">wsN</span> <span class="o">=</span> <span class="n">NormaliseToMonitor</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">MonitorID</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;Without normalisation&quot;</span>
<span class="k">print</span> <span class="s">&quot;Monitor ID=1 </span><span class="si">%.3f</span><span class="s">, </span><span class="si">%.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Selected data </span><span class="si">%.6f</span><span class="s">, </span><span class="si">%.6f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>

<span class="k">print</span> <span class="s">&quot;With Normalisation&quot;</span>
<span class="k">print</span> <span class="s">&quot;Monitor ID=1 </span><span class="si">%.3f</span><span class="s">, </span><span class="si">%.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">wsN</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wsN</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Selected data </span><span class="si">%.6f</span><span class="s">, </span><span class="si">%.6f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">wsN</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wsN</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Without normalisation
Monitor ID=1 626034.000, 626681.000
Selected data 2.000000, 1.000000
With Normalisation
Monitor ID=1 464872.441, 464872.441
Selected data 1.485135, 0.741801
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/CorrectionFunctions/NormalisationCorrections.html">CorrectionFunctions\NormalisationCorrections</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id9">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/ff859df4a5faa6fa5e3cecb8f2efeb4c4aa53864/Framework/Algorithms/src/NormaliseToMonitor.cpp">NormaliseToMonitor.cpp</a></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/ff859df4a5faa6fa5e3cecb8f2efeb4c4aa53864/Framework/Algorithms/inc/MantidAlgorithms/NormaliseToMonitor.h">NormaliseToMonitor.h</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="NormaliseSpectra-v1.html" title="Previous Chapter: NormaliseSpectra v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; NormaliseSpectra...</span>
    </a>
  </li>
  <li>
    <a href="NormaliseToUnity-v1.html" title="Next Chapter: NormaliseToUnity v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">NormaliseToUnity... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>