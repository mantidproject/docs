<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>FitPeak v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.8.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="FitPowderDiffPeaks v1" href="FitPowderDiffPeaks-v1.html" />
    <link rel="prev" title="FitGaussian v1" href="FitGaussian-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.8</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="fitpeak-v1">
<span id="algm-fitpeak"></span><span id="algm-fitpeak-v1"></span><h1>FitPeak v1<a class="headerlink" href="#fitpeak-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/FitPeak-v1_dlg.png"><img alt="../_images/FitPeak-v1_dlg.png" class="screenshot" src="../_images/FitPeak-v1_dlg.png" style="width: 318px;" /></a>
<p class="caption"><strong>FitPeak</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a><ul>
<li><a class="reference internal" href="#peak-profile" id="id4">Peak profile</a></li>
<li><a class="reference internal" href="#background" id="id5">Background</a></li>
<li><a class="reference internal" href="#input-and-output" id="id6">Input and Output</a><ul>
<li><a class="reference internal" href="#default-function-parameters-names" id="id7">Default function parameters&#8217; names</a></li>
<li><a class="reference internal" href="#output-of-function-parameters" id="id8">Output of function parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fitting-algorithm" id="id9">Fitting algorithm</a><ul>
<li><a class="reference internal" href="#simple-fit" id="id10">Simple fit</a></li>
<li><a class="reference internal" href="#high-background-fit" id="id11">High background fit</a></li>
<li><a class="reference internal" href="#starting-values-of-the-peak-function" id="id12">Starting values of the peak function</a></li>
<li><a class="reference internal" href="#criteria-to-validate-peaks-found" id="id13">Criteria To Validate Peaks Found</a></li>
<li><a class="reference internal" href="#fit-window-and-peak-range" id="id14">Fit Window and Peak Range</a></li>
</ul>
</li>
<li><a class="reference internal" href="#subalgorithms-used" id="id15">Subalgorithms used</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id16">Usage</a></li>
<li><a class="reference internal" href="#source" id="id17">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Fit a single peak with checking mechanism.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="1%" />
<col width="5%" />
<col width="2%" />
<col width="89%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Name of the input workspace for peak fitting.</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Name of the output workspace containing fitted peak.</td>
</tr>
<tr class="row-even"><td>ParameterTableWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><em>TableWorkspace</em></a></td>
<td>&nbsp;</td>
<td>Name of the table workspace containing the fitted parameters.</td>
</tr>
<tr class="row-odd"><td>WorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Workspace index</td>
</tr>
<tr class="row-even"><td>PeakFunctionType</td>
<td>Input</td>
<td>string</td>
<td><em>Mandatory</em></td>
<td>Peak function type.  Allowed values: [&#8216;BackToBackExponential&#8217;, &#8216;BackToBackExponential (I, A, B, X0, S)&#8217;, &#8216;Bk2BkExpConvPV&#8217;, &#8216;Bk2BkExpConvPV (TOF_h, Height, Alpha, Beta, Sigma2, Gamma)&#8217;, &#8216;DeltaFunction&#8217;, &#8216;DeltaFunction (Height, Centre)&#8217;, &#8216;ElasticDiffRotDiscreteCircle&#8217;, &#8216;ElasticDiffRotDiscreteCircle (Height, Centre, Radius)&#8217;, &#8216;ElasticDiffSphere&#8217;, &#8216;ElasticDiffSphere (Height, Centre, Radius)&#8217;, &#8216;ExamplePeakFunction&#8217;, &#8216;ExamplePeakFunction (Height, PeakCentre, Sigma)&#8217;, &#8216;Gaussian&#8217;, &#8216;Gaussian (Height, PeakCentre, Sigma)&#8217;, &#8216;IkedaCarpenterPV&#8217;, &#8216;IkedaCarpenterPV (I, Alpha0, Alpha1, Beta0, Kappa, SigmaSquared, Gamma, X0)&#8217;, &#8216;Lorentzian&#8217;, &#8216;Lorentzian (Amplitude, PeakCentre, FWHM)&#8217;, &#8216;PseudoVoigt&#8217;, &#8216;PseudoVoigt (Mixing, Height, PeakCentre, FWHM)&#8217;, &#8216;Voigt&#8217;, &#8216;Voigt (LorentzAmp, LorentzPos, LorentzFWHM, GaussianFWHM)&#8217;]</td>
</tr>
<tr class="row-odd"><td>PeakParameterNames</td>
<td>Input</td>
<td>str list</td>
<td>&nbsp;</td>
<td>List of peak parameter names.</td>
</tr>
<tr class="row-even"><td>PeakParameterValues</td>
<td>Input</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>List of peak parameter values.  They must have a 1-to-1 mapping to PeakParameterNames list.</td>
</tr>
<tr class="row-odd"><td>FittedPeakParameterValues</td>
<td>Output</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>Fitted peak parameter values.</td>
</tr>
<tr class="row-even"><td>BackgroundType</td>
<td>Input</td>
<td>string</td>
<td>Linear</td>
<td>Type of Background. Allowed values: [&#8216;Flat&#8217;, &#8216;Flat (A0)&#8217;, &#8216;Linear&#8217;, &#8216;Linear (A0, A1)&#8217;, &#8216;Quadratic&#8217;, &#8216;Quadratic (A0, A1, A2)&#8217;]</td>
</tr>
<tr class="row-odd"><td>BackgroundParameterNames</td>
<td>Input</td>
<td>str list</td>
<td>&nbsp;</td>
<td>List of background parameter names.</td>
</tr>
<tr class="row-even"><td>BackgroundParameterValues</td>
<td>Input</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>List of background parameter values.  They must have a 1-to-1 mapping to BackgroundParameterNames list.</td>
</tr>
<tr class="row-odd"><td>FittedBackgroundParameterValues</td>
<td>Output</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>Fitted background parameter values.</td>
</tr>
<tr class="row-even"><td>FitWindow</td>
<td>Input</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>Enter a comma-separated list of the expected X-position of windows to fit. The number of values must be 2.</td>
</tr>
<tr class="row-odd"><td>PeakRange</td>
<td>Input</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>Enter a comma-separated list of expected x-position as peak range. The number of values must be 2.</td>
</tr>
<tr class="row-even"><td>FitBackgroundFirst</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>If true, then the algorithm will fit background first. And then the peak.</td>
</tr>
<tr class="row-odd"><td>RawParams</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>If true, then the output table workspace contains the raw profile parameter. Otherwise, the effective parameters will be written.</td>
</tr>
<tr class="row-even"><td>MinGuessedPeakWidth</td>
<td>Input</td>
<td>number</td>
<td>2</td>
<td>Minimum guessed peak width for fit. It is in unit of number of pixels.</td>
</tr>
<tr class="row-odd"><td>MaxGuessedPeakWidth</td>
<td>Input</td>
<td>number</td>
<td>10</td>
<td>Maximum guessed peak width for fit. It is in unit of number of pixels.</td>
</tr>
<tr class="row-even"><td>GuessedPeakWidthStep</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>Step of guessed peak width. It is in unit of number of pixels.</td>
</tr>
<tr class="row-odd"><td>PeakPositionTolerance</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>Peak position tolerance.  If fitted peak&#8217;s position differs from proposed value more than the given value, fit is treated as failure.</td>
</tr>
<tr class="row-even"><td>CostFunction</td>
<td>Input</td>
<td>string</td>
<td>Chi-Square</td>
<td>Cost functions. Allowed values: [&#8216;Chi-Square&#8217;, &#8216;Rwp&#8217;]</td>
</tr>
<tr class="row-odd"><td>Minimizer</td>
<td>Input</td>
<td>string</td>
<td>Levenberg-Marquardt</td>
<td>Minimizer to use for fitting. Minimizers available are &#8220;Levenberg-Marquardt&#8221;, &#8220;Simplex&#8221;,&#8221;Conjugate gradient (Fletcher-Reeves imp.)&#8221;, &#8220;Conjugate gradient (Polak-Ribiere imp.)&#8221;, &#8220;BFGS&#8221;, and &#8220;Levenberg-MarquardtMD&#8221;. Allowed values: [&#8216;BFGS&#8217;, &#8216;Conjugate gradient (Fletcher-Reeves imp.)&#8217;, &#8216;Conjugate gradient (Polak-Ribiere imp.)&#8217;, &#8216;Damping&#8217;, &#8216;FABADA&#8217;, &#8216;Levenberg-Marquardt&#8217;, &#8216;Levenberg-MarquardtMD&#8217;, &#8216;More-Sorensen&#8217;, &#8216;Simplex&#8217;, &#8216;SteepestDescent&#8217;, &#8216;Trust Region&#8217;]</td>
</tr>
<tr class="row-even"><td>CostFunctionValue</td>
<td>Output</td>
<td>number</td>
<td>&nbsp;</td>
<td>Value of cost function of the fitted peak.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm is used to fit a single peak with some checking mechanism
to ensure its fitting result is physical.</p>
<p>The output <a class="reference external" href="http://www.mantidproject.org/TableWorkspace">TableWorkspace</a> contains the following
columns...</p>
<div class="section" id="peak-profile">
<h3><a class="toc-backref" href="#id4">Peak profile</a><a class="headerlink" href="#peak-profile" title="Permalink to this headline">¶</a></h3>
<p>All peak profiles supported by Mantid are supported by FitPeak.</p>
<p>Starting parameter values specified by user should be close to the real values,
unless the automatic starting values determination algorithm works well with that
profile type.</p>
<p>But only [[Gaussian]] has been well tested with this functionalities.</p>
</div>
<div class="section" id="background">
<h3><a class="toc-backref" href="#id5">Background</a><a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h3>
<p>There are only three types of backgrounds that are supported, including
FlatBackground, LinearBackground and Quadratic.</p>
</div>
<div class="section" id="input-and-output">
<h3><a class="toc-backref" href="#id6">Input and Output</a><a class="headerlink" href="#input-and-output" title="Permalink to this headline">¶</a></h3>
<p>FitPeak is designed to fit the parameters of a peak function with background function in a given region.
In order to provide convenient UI to both user interactively and algorithms calling this algorithm automatically,
a various formats for the input of the starting values of functions and output of the fitted values of the functions are
implemented.</p>
<div class="section" id="default-function-parameters-names">
<h4><a class="toc-backref" href="#id7">Default function parameters&#8217; names</a><a class="headerlink" href="#default-function-parameters-names" title="Permalink to this headline">¶</a></h4>
<p>Input function parameters&#8217; names should be exactly the same as those defined in Mantid.
This brings some inconvenience to users through MantidPlot GUI.
Thus user can input function parameters values in the default order,
which is instructed in the list of functions.
For example, one background function type is defined as &#8216;Linear (A0, A1)&#8217;.
As user chooses this function, he does not need to input background function parameter names,
but writes values of A0 and A1, respectively.</p>
</div>
<div class="section" id="output-of-function-parameters">
<h4><a class="toc-backref" href="#id8">Output of function parameters</a><a class="headerlink" href="#output-of-function-parameters" title="Permalink to this headline">¶</a></h4>
<p>The output [[TableWorkspace]] contains the following columns...
* parameter name
* fitted parameter value
* error</p>
</div>
</div>
<div class="section" id="fitting-algorithm">
<h3><a class="toc-backref" href="#id9">Fitting algorithm</a><a class="headerlink" href="#fitting-algorithm" title="Permalink to this headline">¶</a></h3>
<p>FindPeaks uses a more complicated approach to fit peaks if &#8216;&#8217;&#8216;HighBackground&#8217;&#8216;&#8217; is flagged. In this case, FindPeak will fit the background first, and then do a Gaussian fit the peak with the fitted background removed.  This procedure will be repeated for a couple of times with different guessed peak widths.  And the parameters of the best result is selected.  The last step is to fit the peak with a combo function including background and Gaussian by using the previously recorded best background and peak parameters as the starting values.</p>
<div class="section" id="simple-fit">
<h4><a class="toc-backref" href="#id10">Simple fit</a><a class="headerlink" href="#simple-fit" title="Permalink to this headline">¶</a></h4>
<p>In the &#8216;simple fit&#8217; mode, the algorithm will make a composite function including
peak and background function and fit it agains the observed data.</p>
<p>It works well with good starting values of the peak and background function,
especially when the peak is significant with low background.</p>
</div>
<div class="section" id="high-background-fit">
<h4><a class="toc-backref" href="#id11">High background fit</a><a class="headerlink" href="#high-background-fit" title="Permalink to this headline">¶</a></h4>
<p>In the &#8216;high background fit&#8217; mode, the background will be removed first;
then the fitting is focussed on the &#8216;pure&#8217; peak function;
and a composite function is fit agains the original data as the last step.</p>
<p>This approach is developed due to the failure of &#8216;simple fit&#8217; mode on the cases
that background level is much higher than the peak height.
Without the background being removed, the optimizer intends to favor the background
rather than the peak function.</p>
</div>
<div class="section" id="starting-values-of-the-peak-function">
<h4><a class="toc-backref" href="#id12">Starting values of the peak function</a><a class="headerlink" href="#starting-values-of-the-peak-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Peak height is estimated by the maximum value, with background removed, inside the peak range;</li>
<li>Peak position can be set up either to the X value of the maximum Y value in the peak range, or to the vlaue specified by user accordin to user&#8217;s selection.  For example, in the case of calibrating the offsets of detectors of powder diffractometers, the peak positons are unknown.  Then it is better to use the X value with the maximum Y value as the starting peak centre.  While in the case of striping vanadium peaks, all peaks&#8217; centres should be exactly same as the theortical values.</li>
</ul>
</div>
<div class="section" id="criteria-to-validate-peaks-found">
<h4><a class="toc-backref" href="#id13">Criteria To Validate Peaks Found</a><a class="headerlink" href="#criteria-to-validate-peaks-found" title="Permalink to this headline">¶</a></h4>
<p>FindPeaks finds peaks by fitting a Guassian with background to a certain
range in the input histogram. <a class="reference internal" href="Fit-v1.html#algm-fit"><em>Fit v1</em></a> may not give a correct
result even if chi^2 is used as criteria alone. Thus some other criteria
are provided as options to validate the result</p>
<p>1. Peak position. If peak positions are given, and trustful, then the
fitted peak position must be within a short distance to the give one.</p>
<p>2. Peak height. In the certain number of trial, peak height can be used
to select the best fit among various starting sigma values.</p>
<ol class="arabic simple" start="3">
<li>Peak width: Peak width cannot be equal or wider than the given fit window.</li>
</ol>
</div>
<div class="section" id="fit-window-and-peak-range">
<h4><a class="toc-backref" href="#id14">Fit Window and Peak Range</a><a class="headerlink" href="#fit-window-and-peak-range" title="Permalink to this headline">¶</a></h4>
<p>If FitWindows is defined, then a peak&#8217;s range to fit (i.e., x-min and
x-max) is confined by this window.</p>
<p>If PeakRange is defined and starting peak centre given by user is not
within this range, then the situation is considered illegal. In future,
FitPeak might be able to estimate the peak centre in this situation by
locating the X-value whose corresponding Y-value is largest within
user-defined peak range.</p>
</div>
</div>
<div class="section" id="subalgorithms-used">
<h3><a class="toc-backref" href="#id15">Subalgorithms used</a><a class="headerlink" href="#subalgorithms-used" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Fit</li>
</ul>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id16">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - Fit a single peak with rough estimation on staring parameter values:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Load</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="s">r&#39;focussed.nxs&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s">&#39;focussed&#39;</span><span class="p">)</span>
<span class="n">FitPeak</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s">&#39;focussed&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s">&#39;peak4&#39;</span><span class="p">,</span> <span class="n">ParameterTableWorkspace</span><span class="o">=</span><span class="s">&#39;peak4result&#39;</span><span class="p">,</span>
        <span class="n">WorkspaceIndex</span><span class="o">=</span><span class="s">&#39;3&#39;</span><span class="p">,</span><span class="n">PeakFunctionType</span><span class="o">=</span><span class="s">&#39;Gaussian (Height, PeakCentre, Sigma)&#39;</span><span class="p">,</span>
        <span class="n">PeakParameterValues</span><span class="o">=</span><span class="s">&#39;2000,2.14,0.01&#39;</span><span class="p">,</span><span class="n">BackgroundType</span><span class="o">=</span><span class="s">&#39;Linear (A0, A1)&#39;</span><span class="p">,</span>
        <span class="n">BackgroundParameterValues</span><span class="o">=</span><span class="s">&#39;2500,2000&#39;</span><span class="p">,</span><span class="n">FitWindow</span><span class="o">=</span><span class="s">&#39;2,2.3&#39;</span><span class="p">,</span><span class="n">PeakRange</span><span class="o">=</span><span class="s">&#39;2.1,2.25&#39;</span><span class="p">)</span>


<span class="n">tbws</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s">&quot;peak4result&quot;</span><span class="p">]</span>
<span class="n">chi2</span> <span class="o">=</span> <span class="n">tbws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">peakheight</span> <span class="o">=</span> <span class="n">tbws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">peakcentre</span> <span class="o">=</span> <span class="n">tbws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">tbws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Chi-square = </span><span class="si">%.5f</span><span class="s">: Peak centre = </span><span class="si">%.5f</span><span class="s">, Height = </span><span class="si">%.2f</span><span class="s">, Sigma = </span><span class="si">%.5f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">chi2</span><span class="p">,</span> <span class="n">peakcentre</span><span class="p">,</span> <span class="n">peakheight</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre>Chi-square = 1.74892: Peak centre = 2.14201, Height = 7490.67, Sigma = 0.00776
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Optimization.html">Optimization</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id17">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c46a67d64e22c52f6c639900deb1c2a0efa0aa66/Framework/Algorithms/src/FitPeak.cpp">FitPeak.cpp</a></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c46a67d64e22c52f6c639900deb1c2a0efa0aa66/Framework/Algorithms/inc/MantidAlgorithms/FitPeak.h">FitPeak.h</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="FitGaussian-v1.html" title="Previous Chapter: FitGaussian v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; FitGaussian v1</span>
    </a>
  </li>
  <li>
    <a href="FitPowderDiffPeaks-v1.html" title="Next Chapter: FitPowderDiffPeaks v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">FitPowderDiffPea... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>