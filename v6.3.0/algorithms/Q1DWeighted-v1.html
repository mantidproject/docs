<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Q1DWeighted v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="QENSFitSequential v1" href="QENSFitSequential-v1.html" />
    <link rel="prev" title="Q1D v2" href="Q1D-v2.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.3</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="q1dweighted-v1">
<span id="algm-q1dweighted"></span><span id="algm-q1dweighted-v1"></span><h1>Q1DWeighted v1<a class="headerlink" href="#q1dweighted-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/Q1DWeighted-v1_dlg.png"><img alt="../_images/Q1DWeighted-v1_dlg.png" class="screenshot" src="../_images/Q1DWeighted-v1_dlg.png" style="width: 349px;" /></a>
<p class="caption"><span class="caption-text"><strong>Q1DWeighted</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a></li>
<li><a class="reference internal" href="#i-o" id="id6">I/O</a></li>
<li><a class="reference internal" href="#additional-options" id="id7">Additional options</a><ul>
<li><a class="reference internal" href="#npixeldivision" id="id8">NPixelDivision</a></li>
<li><a class="reference internal" href="#errorweighting" id="id9">ErrorWeighting</a></li>
<li><a class="reference internal" href="#wedges" id="id10">Wedges</a><ul>
<li><a class="reference internal" href="#defining-wedges" id="id11">Defining wedges</a></li>
<li><a class="reference internal" href="#drawing-sectors" id="id12">Drawing sectors</a></li>
<li><a class="reference internal" href="#symmetric" id="id13">Symmetric</a></li>
<li><a class="reference internal" href="#asymmetric" id="id14">Asymmetric</a></li>
</ul>
</li>
<li><a class="reference internal" href="#masked-bins" id="id15">Masked Bins</a></li>
<li><a class="reference internal" href="#accountforgravity" id="id16">AccountForGravity</a></li>
</ul>
</li>
<li><a class="reference internal" href="#source" id="id17">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Performs azimuthal averaging on a 2D SANS data to produce I(Q).</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="Q1D-v2.html#algm-q1d"><span class="std std-ref">Q1D</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="3%" />
<col width="17%" />
<col width="5%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>Input workspace containing the SANS 2D data</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>Workspace that will contain the I(Q) data</td>
</tr>
<tr class="row-even"><td>OutputBinning</td>
<td>Input</td>
<td>dbl list</td>
<td><em>Mandatory</em></td>
<td>The new bin boundaries in the form: <span class="math">\(x_1,\Delta x_1,x_2,\Delta x_2,\dots,x_n\)</span></td>
</tr>
<tr class="row-odd"><td>NPixelDivision</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Number of sub-pixels used for each detector pixel in each direction.The total number of sub-pixels will be NPixelDivision*NPixelDivision.</td>
</tr>
<tr class="row-even"><td>NumberOfWedges</td>
<td>Input</td>
<td>number</td>
<td>2</td>
<td>Number of wedges to calculate.</td>
</tr>
<tr class="row-odd"><td>WedgeAngle</td>
<td>Input</td>
<td>number</td>
<td>30</td>
<td>Opening angle of the wedge, in degrees.</td>
</tr>
<tr class="row-even"><td>WedgeOffset</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Wedge offset relative to the horizontal axis, in degrees.</td>
</tr>
<tr class="row-odd"><td>WedgeWorkspace</td>
<td>Output</td>
<td>WorkspaceGroup</td>
<td>&#160;</td>
<td>Name for the WorkspaceGroup containing the wedge I(q) distributions.</td>
</tr>
<tr class="row-even"><td>PixelSizeX</td>
<td>Input</td>
<td>number</td>
<td>5.15</td>
<td>Pixel size in the X direction (mm).</td>
</tr>
<tr class="row-odd"><td>PixelSizeY</td>
<td>Input</td>
<td>number</td>
<td>5.15</td>
<td>Pixel size in the Y direction (mm).</td>
</tr>
<tr class="row-even"><td>ErrorWeighting</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Choose whether each pixel contribution will be weighted by 1/error^2.</td>
</tr>
<tr class="row-odd"><td>AsymmetricWedges</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Choose to produce the results for asymmetric wedges.</td>
</tr>
<tr class="row-even"><td>AccountForGravity</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Take the nominal gravity drop into account.</td>
</tr>
<tr class="row-odd"><td>ShapeTable</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></td>
<td>&#160;</td>
<td>Table workspace containing the shapes (sectors only) drawn in the instrument viewer; if specified, the wedges properties defined above are not taken into account.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Performs azimuthal averaging for a 2D SANS data set by going through
each wavelength bin of each detector pixel, determining its Q-value, and adding its amplitude
<span class="math">\(I\)</span> to the appropriate Q bin. The algorithm works both for monochromatic and TOF SANS data.</p>
<p>Note that in TOF case, the algorithm performs averaging in 2 steps.
First, for each wavelength slice of the input it performs azimuthal averaging in radial rings.
This results in a stack of I(Q)s, one for each input wavelength.
As a second step, all the I(Q)s corresponding to different wavelengths are averaged again.
Note that for the TOF data, this is mathematically not equivalent to performing averaging with one step; that is averaging everything into a single I(Q) histogram.
The latter is done in <a class="reference internal" href="Q1D-v2.html#algm-q1d"><span class="std std-ref">Q1D</span></a> algorithm.
See the <a class="reference internal" href="Rebin-v1.html#algm-rebin"><span class="std std-ref">Rebin</span></a> documentation for details about choosing the <code class="docutils literal"><span class="pre">OutputBinning</span></code> parameter.</p>
<p>For monochromatic data, the algorithm considers each bin as belonging to a different sample and/or kinetic frame.
Usage
—–</p>
<p>This algorithm is used as a part of the <a class="reference internal" href="HFIRSANSReduction-v1.html#algm-hfirsansreduction-v1"><span class="std std-ref">SANSReduction</span></a> and <a class="reference internal" href="SANSILLIntegration-v1.html#algm-sansillintegration"><span class="std std-ref">SANSILLIntegration</span></a>.
However, it can also be used directly, provided that the input data is already corrected for all the effects.</p>
</div>
<div class="section" id="i-o">
<h2><a class="toc-backref" href="#id6">I/O</a><a class="headerlink" href="#i-o" title="Permalink to this headline">¶</a></h2>
<p>The input to this algorithm must be a histogram with common wavelength bins for each pixel, or a monochromatic workspace with a different sample or kinetic frame in each bin.
In this case the workspace must not be in units of wavelength, but the wavelength must be present in the sample logs.
The output will be a distribution though.</p>
</div>
<div class="section" id="additional-options">
<h2><a class="toc-backref" href="#id7">Additional options</a><a class="headerlink" href="#additional-options" title="Permalink to this headline">¶</a></h2>
<div class="section" id="npixeldivision">
<h3><a class="toc-backref" href="#id8">NPixelDivision</a><a class="headerlink" href="#npixeldivision" title="Permalink to this headline">¶</a></h3>
<p>For greater precision, each detector
pixel can be sub-divided in sub-pixels by setting the <code class="docutils literal"><span class="pre">NPixelDivision</span></code>
parameters. This will split each pixel to a grid of <code class="docutils literal"><span class="pre">NPixelDivision</span></code> * <code class="docutils literal"><span class="pre">NPixelDivision</span></code> pixels.
<code class="docutils literal"><span class="pre">PixelSizeX</span></code> and <code class="docutils literal"><span class="pre">PixelSizeY</span></code> inputs will be used only if pixels are to be split.</p>
</div>
<div class="section" id="errorweighting">
<h3><a class="toc-backref" href="#id9">ErrorWeighting</a><a class="headerlink" href="#errorweighting" title="Permalink to this headline">¶</a></h3>
<p>Each pixel has a weight of 1 by default, but the weight of
each pixel can be set to <span class="math">\(1/\sigma^2 I\)</span> by setting the
<code class="docutils literal"><span class="pre">ErrorWeighting</span></code> parameter to True. This will effectively transmute the average to a weighted average, where the weight is inversely proportional to the absolute statistical uncertainty on the intensity.
This option will potentially produce very different results, so care must be taken when analysing the data with this option.
In the reduction workflows this option is deprecated.</p>
</div>
<div class="section" id="wedges">
<h3><a class="toc-backref" href="#id10">Wedges</a><a class="headerlink" href="#wedges" title="Permalink to this headline">¶</a></h3>
<p>For anisotropic scatterer, the <em>I(Q)</em> can be calculated for different angular sectors (or wedges).</p>
<p>These sectors can be defined in two different ways : either by drawing them, or by defining them.
There are also two integration mode: symmetric wedges (default) or asymmetric wedges.</p>
<div class="section" id="defining-wedges">
<h4><a class="toc-backref" href="#id11">Defining wedges</a><a class="headerlink" href="#defining-wedges" title="Permalink to this headline">¶</a></h4>
<p>Wedges are defined by the <code class="docutils literal"><span class="pre">NumberOfWedges</span></code>, <code class="docutils literal"><span class="pre">WedgeAngle</span></code> and <code class="docutils literal"><span class="pre">WedgeOffset</span></code> parameters.
The trigonometrical circle is split in <code class="docutils literal"><span class="pre">NumberOfWedges</span></code> sectors, equally spaced, spanning a range of <code class="docutils literal"><span class="pre">WedgeAngle</span></code>.</p>
</div>
<div class="section" id="drawing-sectors">
<h4><a class="toc-backref" href="#id12">Drawing sectors</a><a class="headerlink" href="#drawing-sectors" title="Permalink to this headline">¶</a></h4>
<p>This option is still in active development, and might be subject to changes in later versions.
It is also possible to use the instrument viewer to draw the shape of the angular sector. Only sector shapes are currently supported,
and they must be drawn in the Full 3D, Z- projection, without any rotation (translation and zoom are supported). Please
note that in this projection, the X-axis points to the left. So when doing the wedges without the table (see above), they are ordered
clockwise, opening from the positive ray of the X-axis.
If running Q1DWeighted with drawn sectors as input, the output will be ordered similarly, regardless of the order in which they were drawn.
Once the shapes are drawn, they must be saved using the <code class="docutils literal"><span class="pre">Save</span> <span class="pre">shapes</span> <span class="pre">to</span> <span class="pre">table</span></code> button.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/Q1DWeightedShapeIntegration.png"><img alt="../_images/Q1DWeightedShapeIntegration.png" src="../_images/Q1DWeightedShapeIntegration.png" style="width: 1000px;" /></a>
</div>
<p>Contrary to the wedges defined in the previous manner, the sectors don’t need to be regularly placed, centered or even symmetrical.</p>
<p>When running <code class="docutils literal"><span class="pre">Q1DWeighted</span></code>, the created table workspace - generally named <cite>MaskShapes</cite> - can be provided
as an argument to the <code class="docutils literal"><span class="pre">ShapeTable</span></code> field. The algorithm will then use the drawn shapes as wedges, and ignore <code class="docutils literal"><span class="pre">NumberOfWedges</span></code>,
<code class="docutils literal"><span class="pre">WedgeAngle</span></code> and <code class="docutils literal"><span class="pre">WedgeOffset</span></code> fields.</p>
</div>
<div class="section" id="symmetric">
<h4><a class="toc-backref" href="#id13">Symmetric</a><a class="headerlink" href="#symmetric" title="Permalink to this headline">¶</a></h4>
<p>Symmetric or asymmetric integration is determined by the <cite>AsymmetricWedges</cite> flag.</p>
<p>The figure below illustrates an example for symmetric wedges. Each wedge in this case represents two back-to-back sectors.
The wedges output group will have two workspaces: one for the red region, one for the blue region.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/wedge_symm.png"><img alt="../_images/wedge_symm.png" src="../_images/wedge_symm.png" style="width: 600px;" /></a>
</div>
<p>In the case of drawn sectors, when doing symmetric integration, symmetric shapes will be grouped together.
Taking the above example, the shape table will have 4 shapes in it, but the output will only have 2 workspaces, because the
red shapes and the blue shapes will be grouped.
If no corresponding symmetric is found for a shape, the algorithm will nonetheless integrate on the projected symmetric too,
so the result will be identical (though for clarity it is not advised to provide only one of the shapes).
Again, in the above example, the result will be identical whether only one or both of the red and blue shapes are provided,
because the algorithm will find the missing symmetric if needed.</p>
</div>
<div class="section" id="asymmetric">
<h4><a class="toc-backref" href="#id14">Asymmetric</a><a class="headerlink" href="#asymmetric" title="Permalink to this headline">¶</a></h4>
<p>An example for asymmetric wedges is shown below. The output will have four workspaces, one per each sector of different color.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/wedge_asymm.png"><img alt="../_images/wedge_asymm.png" src="../_images/wedge_asymm.png" style="width: 600px;" /></a>
</div>
</div>
</div>
<div class="section" id="masked-bins">
<h3><a class="toc-backref" href="#id15">Masked Bins</a><a class="headerlink" href="#masked-bins" title="Permalink to this headline">¶</a></h3>
<p>Bins masked in the input workspace will not enter the calculation.</p>
</div>
<div class="section" id="accountforgravity">
<h3><a class="toc-backref" href="#id16">AccountForGravity</a><a class="headerlink" href="#accountforgravity" title="Permalink to this headline">¶</a></h3>
<p>If enabled, this will correct for the gravity effect by analytical calculation of the drop during the time-of-flight from sample to detector.</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/SANS.html">SANS</a></p>
</div>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id17">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c7a0e2338713fd338893c4f24ed76cd968f52b11/Framework/Algorithms/inc/MantidAlgorithms/Q1DWeighted.h">Q1DWeighted.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c7a0e2338713fd338893c4f24ed76cd968f52b11/Framework/Algorithms/src/Q1DWeighted.cpp">Q1DWeighted.cpp</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="Q1D-v2.html" title="Previous Chapter: Q1D v2"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Q1D v2</span>
    </a>
  </li>
  <li>
    <a href="QENSFitSequential-v1.html" title="Next Chapter: QENSFitSequential v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">QENSFitSequential v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>