<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>RealFFT v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Rebin v1" href="Rebin-v1.html" />
    <link rel="prev" title="ReadGroupsFromFile v1" href="ReadGroupsFromFile-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.3</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="realfft-v1">
<span id="algm-realfft"></span><span id="algm-realfft-v1"></span><h1>RealFFT v1<a class="headerlink" href="#realfft-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/RealFFT-v1_dlg.png"><img alt="../_images/RealFFT-v1_dlg.png" class="screenshot" src="../_images/RealFFT-v1_dlg.png" style="width: 403px;" /></a>
<p class="caption"><span class="caption-text"><strong>RealFFT</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a></li>
<li><a class="reference internal" href="#usage" id="id6">Usage</a><ul>
<li><a class="reference internal" href="#output" id="id7">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#source" id="id8">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Performs real Fast Fourier Transform</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="ExtractFFTSpectrum-v1.html#algm-extractfftspectrum"><span class="std std-ref">ExtractFFTSpectrum</span></a>, <a class="reference internal" href="FFT-v1.html#algm-fft"><span class="std std-ref">FFT</span></a>, <a class="reference internal" href="FFTDerivative-v1.html#algm-fftderivative"><span class="std std-ref">FFTDerivative</span></a>, <a class="reference internal" href="MaxEnt-v1.html#algm-maxent"><span class="std std-ref">MaxEnt</span></a>, <a class="reference internal" href="SassenaFFT-v1.html#algm-sassenafft"><span class="std std-ref">SassenaFFT</span></a>, <a class="reference internal" href="FFTSmooth-v2.html#algm-fftsmooth"><span class="std std-ref">FFTSmooth</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="3%" />
<col width="19%" />
<col width="6%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>The name of the input workspace.</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>The name of the output workspace. It contains three spectra: the real, the imaginary parts of the transform and their modulus.</td>
</tr>
<tr class="row-even"><td>WorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>The index of the spectrum in the input workspace to transform.</td>
</tr>
<tr class="row-odd"><td>Transform</td>
<td>Input</td>
<td>string</td>
<td>Forward</td>
<td>The direction of the transform: “Forward” or “Backward”. Allowed values: [‘Forward’, ‘Backward’]</td>
</tr>
<tr class="row-even"><td>IgnoreXBins</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Ignores the requirement that X bins be linear and of the same size. FFT result will not be valid for the X axis, and should be ignored.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This is an algorithm for Fourier transform of real data. It uses the GSL
routines gsl_fft_real_transform and gsl_fft_halfcomplex_inverse.
The result of a forward transform is a three-spectra workspace with the
real and imaginary parts of the transform in position 0 and 1
correspondingly. The third spectrum has the modulus of the transform (<span class="math">\(\sqrt{Re^2+Im^2}\)</span>).
Only positive frequencies are given and as a result the
output spectra are twice as short as the input one.</p>
<p>An input workspace for backward transform must have the form of the
output workspace of the forward algorithm, i.e. its first two spectra must have
the real part and the imaginary parts. The output workspace contains a single spectrum with the real
inverse transform.</p>
<p>The forward transform doesn’t use the absolute values of the X axis but rather assumes that the data starts at
X = 0 and ends at X = XMax - XMin, where XMin and XMax are the lower and the upper limits on the X axis.
As a result the output is a transform of the input spectrum shifted along the X axis so that the
first bin is centered at 0.</p>
<p>The output of the backward transform always starts at X = 0.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id6">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Create a workspace with a Gaussian peak in the centre.</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="n">Function</span><span class="o">=</span><span class="s1">&#39;User Defined&#39;</span><span class="p">,</span><span class="n">UserDefinedFunction</span><span class="o">=</span><span class="s1">&#39;name=Gaussian,Height=1,PeakCentre=0,Sigma=1&#39;</span><span class="p">,</span><span class="n">XMin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">XMax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">BinWidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="c1"># Forward transform its 11-th spectrum</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">RealFFT</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;Forward&quot;</span><span class="p">)</span>
<span class="c1"># Backward transform must look like the original spectrum only shifted along the X axis</span>
<span class="n">ws_back</span> <span class="o">=</span> <span class="n">RealFFT</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">Transform</span><span class="o">=</span><span class="s2">&quot;Backward&quot;</span><span class="p">)</span>

<span class="c1"># Check the outputs</span>

<span class="c1"># Check the sizes</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of bins in the input workspace    </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of bins in the forward transform  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">transform</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of bins in the backward transform </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws_back</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()))</span>

<span class="c1"># Check the X axes</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Input starts at </span><span class="si">{:.1f}</span><span class="s1"> , ends at </span><span class="si">{:.1f}</span><span class="s1"> , the width is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">ws</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ws</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ws</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ws</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Forward starts at  </span><span class="si">{:.1f}</span><span class="s1"> , ends at </span><span class="si">{:.2f}</span><span class="s1"> , the width is </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">transform</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">transform</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">transform</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">transform</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Backward starts at </span><span class="si">{:.1f}</span><span class="s1"> , ends at </span><span class="si">{:.1f}</span><span class="s1"> , the width is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
      <span class="n">ws_back</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ws_back</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ws_back</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ws_back</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># Check that the backward transform restores the original data.</span>
<span class="c1"># The input spetrum values</span>
<span class="n">y10</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># The spectrum returned from the backward RealFFT</span>
<span class="n">y_back</span> <span class="o">=</span> <span class="n">ws_back</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Check that they are almost equal.</span>
<span class="c1"># Using numpy array calculations show that all elements of arrays y_back and y10 are very close</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_back</span> <span class="o">-</span> <span class="n">y10</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-15</span><span class="p">))</span>
<span class="c1"># but not equal</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">y_back</span> <span class="o">==</span> <span class="n">y10</span><span class="p">))</span>
</pre></div>
</div>
<div class="section" id="output">
<h3><a class="toc-backref" href="#id7">Output</a><a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none"><div class="highlight"><pre><span></span>Number of bins in the input workspace    200
Number of bins in the forward transform  101
Number of bins in the backward transform 200
Input starts at -10.0 , ends at 10.0 , the width is 20.0
Forward starts at  0.0 , ends at 5.05 , the width is 5.05
Backward starts at 0.0 , ends at 20.0 , the width is 20.0
True
False
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Arithmetic/FFT.html">Arithmetic\FFT</a></p>
</div>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id8">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c7a0e2338713fd338893c4f24ed76cd968f52b11/Framework/Algorithms/inc/MantidAlgorithms/RealFFT.h">RealFFT.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/c7a0e2338713fd338893c4f24ed76cd968f52b11/Framework/Algorithms/src/RealFFT.cpp">RealFFT.cpp</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ReadGroupsFromFile-v1.html" title="Previous Chapter: ReadGroupsFromFile v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; ReadGroupsFromFile v1</span>
    </a>
  </li>
  <li>
    <a href="Rebin-v1.html" title="Next Chapter: Rebin v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Rebin v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>