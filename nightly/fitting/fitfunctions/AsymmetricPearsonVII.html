<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Asymmetric Pearson VII</title>
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.4.20220909.1939',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="BSpline" href="BSpline.html" />
    <link rel="prev" title="ActivationmeV" href="ActivationmeV.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Fit Functions</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">Asymmetric Pearson VII</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="asymmetric-pearson-vii">
<span id="func-asymmetricpearsonvii"></span><h1>Asymmetric Pearson VII<a class="headerlink" href="#asymmetric-pearson-vii" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<span id="index-0"></span><h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The asymmetric Pearson VII function (sometimes it is also referred to as the split-Pearson VII function) is a function that combines
two Pearson VII distributions so to fit sharp peak curves <a class="footnote-reference" href="#id4" id="id1">[1]</a>. It is useful for analysis of X-ray diffraction peaks which consist of two separable components.</p>
<p>In one of the representations, the asymmetric Pearson VII function <span class="math">\(A(x)\)</span> can be written as a superposition of the “left” and “right” Pearson VII functions <span class="math">\(P_L(x)\)</span> and <span class="math">\(P_R(x)\)</span> <a class="footnote-reference" href="#id5" id="id2">[2]</a>,</p>
<div class="math">
\[A(x) = P_L(x) \, \theta(x_0 - x) + P_R(x) \, \theta(x - x_0) = P_L(x) \, \theta(x_0 - x) + P_R(x) \, \left(1 - \theta(x_0 - x) \right),\]</div>
<p>where <span class="math">\(x_0\)</span> is the value when the function changes between the left and right Pearson VII, and this is usually chosen to be the peak centre. Moreover, <span class="math">\(\theta\)</span> denotes the Heavyside step function with <span class="math">\(\theta(y \ge 0) = 1\)</span> and <span class="math">\(\theta(y &lt; 0)=0\)</span>, and <span class="math">\(P(x)\)</span> denotes the Pearson VII function. This function takes four additional parameters and in general is defined as</p>
<div class="math">
\[P(x, h, x_0, \Gamma, m) = \frac{h}{\left(1 + \left[ \frac{2 (x-x_0) \sqrt{2^{1/m}-1}}{\Gamma} \right]^2 \right)^m} \, .\]</div>
<p>The four free parameters that the Pearson VII function <span class="math">\(P(x, h, x_0, \Gamma, m)\)</span> takes represent the following quantities</p>
<ul class="simple">
<li><span class="math">\(h\)</span> - the height of the peak</li>
<li><span class="math">\(x_0\)</span> - the location (centre) of the peak</li>
<li><span class="math">\(\Gamma\)</span> - the full width at half maximum</li>
<li><span class="math">\(m\)</span> - the function’s shape parameter</li>
</ul>
<p>The parameter <span class="math">\(m\)</span> can take values in the range <span class="math">\([0, \infty)\)</span> and it determines whether <span class="math">\(P(x, h, x_0, \Gamma, m)\)</span> is more close to a Lorentzian or a Gaussian. When <span class="math">\(m=1\)</span> it’s a Lorentzian, whereas when <span class="math">\(m \rightarrow \infty\)</span> it’s a Gaussian. The “left” and “right” Pearson VII functions <span class="math">\(P_L(x)\)</span> and <span class="math">\(P_R(x)\)</span> take identical parameters <span class="math">\(h, x_0, \Gamma\)</span>, but diffent <span class="math">\(m\)</span>, so that</p>
<div class="math">
\[P_L \equiv P(x, h, x_0, \Gamma, m_L),\]</div>
<div class="math">
\[P_R \equiv P(x, h, x_0, \Gamma, m_R).\]</div>
<p>In other words, it is assumed that the asymmetric Pearson VII function uses two halves of the Pearson VII with a common  peak hight, peak centre, and full width at half maximum. As a result, the asymmetric Pearson VII distribution takes five parameters: <span class="math">\(h, x_0, \Gamma, m_L, m_R\)</span>. For the sake of stability of the numerical implementation of asymmetric Pearson VII distribution in Mantid, one operates with the weight parameter <span class="math">\(w \equiv 1/\Gamma\)</span>, i. e. <span class="math">\(A = A(x, h, x_0, w, m_L, m_R)\)</span>.</p>
</div>
<div class="section" id="analytic-derivatives">
<h2>Analytic Derivatives<a class="headerlink" href="#analytic-derivatives" title="Permalink to this headline">¶</a></h2>
<p>Below is the list of analytic derivatives of <span class="math">\(P = P(x, h, x_0, w, m)\)</span> with respect to <span class="math">\(h, x_0, w, m\)</span>:</p>
<div class="math">
\[\frac{\partial P}{\partial h} = \frac{1}{d^m},\]</div>
<div class="math">
\[\frac{\partial P}{\partial x_0} = \frac{8 h m (x - x_0) \left( 2^{1/m} - 1 \right) w^2}{d^{m + 1}},\]</div>
<div class="math">
\[\frac{\partial P}{\partial w} = - \frac{8 h m (x - x_0)^2 \left( 2^{1/m} - 1 \right) w}{d^{m + 1}},\]</div>
<div class="math">
\[\frac{\partial P}{\partial m} = \frac{h}{d^{m + 1}} \left[ \frac{4 (x - x_0)^2 w^2 2^{1/m} \ln 2}{m d} - \ln \frac{1}{d} \right],\]</div>
<p>where</p>
<div class="math">
\[d \equiv \frac{1}{\left( 1 + 4 \left( x - x_0 \right)^2 \left( 2^{1/m} - 1 \right) w^2 \right)} \, .\]</div>
</div>
<div class="section" id="asymptotic-behavior">
<h2>Asymptotic Behavior<a class="headerlink" href="#asymptotic-behavior" title="Permalink to this headline">¶</a></h2>
<p>The numerical calculation of  <span class="math">\(P(x, h, x_0, w, m)\)</span> and its partial derivatives is complicated by singularities as <span class="math">\(m \rightarrow 0\)</span>. For this reason, one needs to operate with a limit of the corresponding expressions:</p>
<div class="math">
\[\lim_{m \rightarrow 0} P(x, h, x_0, w, m) = \frac{h}{2} \, ,\]</div>
<div class="math">
\[\lim_{m \rightarrow 0} \, \frac{\partial P(x, h, x_0, w, m)}{\partial h} = \frac{1}{2} \, ,\]</div>
<div class="math">
\[\lim_{m \rightarrow 0} \, \frac{\partial P(x, h, x_0, w, m)}{\partial x_0} = 0 \, ,\]</div>
<div class="math">
\[\lim_{m \rightarrow 0} \, \frac{\partial P(x, h, x_0, w, m)}{\partial w} = 0 \, ,\]</div>
<div class="math">
\[\lim_{m \rightarrow 0} \, \frac{\partial P(x, h, x_0, w, m)}{\partial m} = - \frac{h}{2} \, \ln \left[ 4(x-x_0)^2 w^2 \right] \, .\]</div>
<p>The figure below illustrates the comparison of shapes between various symmetric <a class="footnote-reference" href="#id6" id="id3">[3]</a> and asymmetric Pearson VII distributions plotted for <span class="math">\(h_0 = 0.7297\)</span>, <span class="math">\(x_{00} = 0.0035\)</span>, <span class="math">\(w_0 = 5.7215\)</span>.</p>
<div class="figure">
<img alt="AsymmetricPearsonVII.png" src="../../_images/AsymmetricPearsonVII.png" />
</div>
</div>
<div class="section" id="properties-fitting-parameters">
<h2>Properties (fitting parameters)<a class="headerlink" href="#properties-fitting-parameters" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="10%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>PeakHeight</td>
<td>1.0</td>
<td>Hight of the peak</td>
</tr>
<tr class="row-odd"><td>PeakCentre</td>
<td>0.0</td>
<td>Location of the peak</td>
</tr>
<tr class="row-even"><td>Width</td>
<td>0.1</td>
<td>Full width at half maximum</td>
</tr>
<tr class="row-odd"><td>LeftShape</td>
<td>1.0</td>
<td>Left shape parameter</td>
</tr>
<tr class="row-even"><td>RightShape</td>
<td>1.0</td>
<td>Right shape parameter</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Gupta, S. K. Peak Decomposition using Pearson Type VII Function, <a class="reference external" href="https://doi.org/10.1107/S0021889897011047">J. Appl. Cryst. (1998). 31, 474-476</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Lifshin, E. (Ed.). (1999), X-ray Characterization of Materials, WILEY-VCH, <a class="reference external" href="https://doi.org/10.1002/9783527613748">https://doi.org/10.1002/9783527613748</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><a class="reference external" href="http://pd.chem.ucl.ac.uk/pdnn/peaks/pvii.htm">http://pd.chem.ucl.ac.uk/pdnn/peaks/pvii.htm</a></td></tr>
</tbody>
</table>
<p><strong>Categories</strong>: <a class="reference external" href="categories/FitFunctions.html">FitFunctions</a> | <a class="reference external" href="categories/XrayDiffraction.html">XrayDiffraction</a></p>
</div>
<div class="section" id="source">
<h2>Source<a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/34d8076c38ee24128cff66d5dfa6be380c8f35dc/Framework/CurveFitting/inc/MantidCurveFitting/Functions/AsymmetricPearsonVII.h">AsymmetricPearsonVII.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/34d8076c38ee24128cff66d5dfa6be380c8f35dc/Framework/CurveFitting/src/Functions/AsymmetricPearsonVII.cpp">AsymmetricPearsonVII.cpp</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ActivationmeV.html" title="Previous Chapter: ActivationmeV"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; ActivationmeV</span>
    </a>
  </li>
  <li>
    <a href="BSpline.html" title="Next Chapter: BSpline"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">BSpline &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>