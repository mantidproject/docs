<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>CalculateChiSquared v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.4.20220909.1939',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CalculateCostFunction v1" href="CalculateCostFunction-v1.html" />
    <link rel="prev" title="CalculateCarpenterSampleCorrection v1" href="CalculateCarpenterSampleCorrection-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">CalculateChiSquared v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="calculatechisquared-v1">
<span id="algm-calculatechisquared"></span><span id="algm-calculatechisquared-v1"></span><h1>CalculateChiSquared v1<a class="headerlink" href="#calculatechisquared-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/CalculateChiSquared-v1_dlg.png"><img alt="../_images/CalculateChiSquared-v1_dlg.png" class="screenshot" src="../_images/CalculateChiSquared-v1_dlg.png" style="width: 303px;" /></a>
<p class="caption"><span class="caption-text"><strong>CalculateChiSquared</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a></li>
<li><a class="reference internal" href="#usage" id="id6">Usage</a></li>
<li><a class="reference internal" href="#source" id="id7">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Calculate chi squared for a function and a data set in a workspace.</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="CalculateCostFunction-v1.html#algm-calculatecostfunction"><span class="std std-ref">CalculateCostFunction</span></a>, <a class="reference internal" href="Fit-v1.html#algm-fit"><span class="std std-ref">Fit</span></a>, <a class="reference internal" href="ProfileChiSquared1D-v1.html#algm-profilechisquared1d"><span class="std std-ref">ProfileChiSquared1D</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="1%" />
<col width="6%" />
<col width="2%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Function</td>
<td>InOut</td>
<td>Function</td>
<td><em>Mandatory</em></td>
<td>Parameters defining the fitting function and its initial values</td>
</tr>
<tr class="row-odd"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></td>
<td><em>Mandatory</em></td>
<td>Name of the input Workspace</td>
</tr>
<tr class="row-even"><td>IgnoreInvalidData</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Flag to ignore infinities, NaNs and data with zero errors.</td>
</tr>
<tr class="row-odd"><td>DomainType</td>
<td>Input</td>
<td>string</td>
<td>Simple</td>
<td>The type of function domain to use: Simple, Sequential, or Parallel. Allowed values: [‘Simple’, ‘Sequential’, ‘Parallel’]</td>
</tr>
<tr class="row-even"><td>EvaluationType</td>
<td>Input</td>
<td>string</td>
<td>CentrePoint</td>
<td>The way the function is evaluated on histogram data sets. If value is “CentrePoint” then function is evaluated at centre of each bin. If it is “Histogram” then function is integrated within the bin and the integrals returned. Allowed values: [‘CentrePoint’, ‘Histogram’]</td>
</tr>
<tr class="row-odd"><td>StepSizeMethod</td>
<td>Input</td>
<td>string</td>
<td>Default</td>
<td>The way the step size is calculated for numerical derivatives. See the section about step sizes in the Fit algorithm documentation to understand the difference between “Default” and “Sqrt epsilon”. Allowed values: [‘Default’, ‘Sqrt epsilon’]</td>
</tr>
<tr class="row-even"><td>PeakRadius</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>A value of the peak radius the peak functions should use. A peak radius defines an interval on the x axis around the centre of the peak where its values are calculated. Values outside the interval are not calculated and assumed zeros.Numerically the radius is a whole number of peak widths (FWHM) that fit into the interval on each side from the centre. The default value of 0 means the whole x axis.</td>
</tr>
<tr class="row-odd"><td>ChiSquared</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Output value of chi squared.</td>
</tr>
<tr class="row-even"><td>ChiSquaredDividedByDOF</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Output value of chi squared divided by the number of degrees of freedom (NofData - nOfParams).</td>
</tr>
<tr class="row-odd"><td>ChiSquaredDividedByNData</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Output value of chi squared divided by the number of data points).</td>
</tr>
<tr class="row-even"><td>ChiSquaredWeighted</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Output value of weighted chi squared.</td>
</tr>
<tr class="row-odd"><td>ChiSquaredWeightedDividedByDOF</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Output value of weighted chi squared divided by the number of degrees of freedom (NofData - nOfParams).</td>
</tr>
<tr class="row-even"><td>ChiSquaredWeightedDividedByNData</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Output value of weighted chi squared divided by the number of  data points).</td>
</tr>
<tr class="row-odd"><td>Weighted</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Option to use the weighted chi squared in error estimation. Default is false.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Calculates a measure of the goodness of a fit in four ways.</p>
<p>The ChiSquared property returns the sum of squares of differences between the calculated and measured values:</p>
<p><span class="math">\(\chi_{1}^{2} = \sum_{i} (y_i - f_i)^2\)</span></p>
<p>where <span class="math">\(y_i\)</span> and <span class="math">\(f_i\)</span> are the measured and calculated values at i-th point.</p>
<p>The ChiSquaredDividedByDOF is ChiSquared divided by the number of degrees of freedom (DOF):</p>
<p><span class="math">\(\chi_{2}^{2} = \frac{1}{DOF}\sum_{i} (y_i - f_i)^2\)</span></p>
<p><span class="math">\(DOF = N_d - N_p\)</span> where <span class="math">\(N_d\)</span> is the number of data points used in fitting and <span class="math">\(N_p\)</span>
is the number of free (not fixed or tied) parameters of the function.</p>
<p>The ChiSquaredWeighted property sums the squares of the differences divided by the data errors:</p>
<p><span class="math">\(\chi_{3}^{2} = \sum_{i} \left(\frac{y_i - f_i}{\sigma_i}\right)^2\)</span></p>
<p>Finally, ChiSquaredWeightedDividedByDOF is</p>
<p><span class="math">\(\chi_{4}^{2} = \chi_{3}^{2} / DOF\)</span></p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id6">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example 1</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Create a data set</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">DataY</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">DataE</span><span class="o">=</span><span class="n">e</span><span class="p">)</span>

<span class="c1"># Define a function</span>
<span class="n">func</span> <span class="o">=</span> <span class="s1">&#39;name=LinearBackground,A0=1.1,A1=1.9&#39;</span>

<span class="c1"># Calculate the chi squared</span>
<span class="n">chi2</span><span class="p">,</span><span class="n">chi2dof</span><span class="p">,</span><span class="n">chi2ndata</span><span class="p">,</span><span class="n">chi2W</span><span class="p">,</span><span class="n">chi2Wdof</span><span class="p">,</span><span class="n">chi2Wndata</span> <span class="o">=</span> <span class="n">CalculateChiSquared</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="n">ws</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared is </span><span class="si">{:.13f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared / DOF is </span><span class="si">{:.14f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2dof</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared / NDATA is </span><span class="si">{:.14f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2ndata</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared weighted is </span><span class="si">{:.11f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2W</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared weighted / DOF is </span><span class="si">{:.14f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2Wdof</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared weighted / NDATA is </span><span class="si">{:.12f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2Wndata</span><span class="p">))</span>

<span class="c1"># Define a function that models the data exactly</span>
<span class="n">func</span> <span class="o">=</span> <span class="s1">&#39;name=LinearBackground,A0=1.0,A1=2.0&#39;</span>

<span class="c1"># Calculate the chi squared</span>
<span class="n">chi2</span><span class="p">,</span><span class="n">chi2dof</span><span class="p">,</span><span class="n">chi2ndata</span><span class="p">,</span><span class="n">chi2W</span><span class="p">,</span><span class="n">chi2Wdof</span><span class="p">,</span><span class="n">chi2Wndata</span> <span class="o">=</span> <span class="n">CalculateChiSquared</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="n">ws</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared / DOF is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2dof</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared / NDATA is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2ndata</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared weighted is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2W</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared weighted / DOF is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2Wdof</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi squared weighted / NDATA is </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2Wndata</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Chi squared is 0.0351851851852
Chi squared / DOF is 0.00439814814815
Chi squared / NDATA is 0.00351851851852
Chi squared weighted is 0.02660287840
Chi squared weighted / DOF is 0.00332535979971
Chi squared weighted / NDATA is 0.002660287840
Chi squared is 0.0
Chi squared / DOF is 0.0
Chi squared / NDATA is 0.0
Chi squared weighted is 0.0
Chi squared weighted / DOF is 0.0
Chi squared weighted / NDATA is 0.0
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Optimization.html">Optimization</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id7">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/34d8076c38ee24128cff66d5dfa6be380c8f35dc/Framework/CurveFitting/inc/MantidCurveFitting/Algorithms/CalculateChiSquared.h">CalculateChiSquared.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/34d8076c38ee24128cff66d5dfa6be380c8f35dc/Framework/CurveFitting/src/Algorithms/CalculateChiSquared.cpp">CalculateChiSquared.cpp</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="CalculateCarpenterSampleCorrection-v1.html" title="Previous Chapter: CalculateCarpenterSampleCorrection v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; CalculateCarp...</span>
    </a>
  </li>
  <li>
    <a href="CalculateCostFunction-v1.html" title="Next Chapter: CalculateCostFunction v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">CalculateCost... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>