<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>CompressEvents v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.4.20220909.1939',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ComputeCalibrationCoefVan v1" href="ComputeCalibrationCoefVan-v1.html" />
    <link rel="prev" title="CompareWorkspaces v1" href="CompareWorkspaces-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">CompressEvents v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="compressevents-v1">
<span id="algm-compressevents"></span><span id="algm-compressevents-v1"></span><h1>CompressEvents v1<a class="headerlink" href="#compressevents-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/CompressEvents-v1_dlg.png"><img alt="../_images/CompressEvents-v1_dlg.png" class="screenshot" src="../_images/CompressEvents-v1_dlg.png" style="width: 361px;" /></a>
<p class="caption"><span class="caption-text"><strong>CompressEvents</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a><ul>
<li><a class="reference internal" href="#without-pulsetime-resolution" id="id6">Without pulsetime resolution</a></li>
<li><a class="reference internal" href="#with-pulsetime-resolution" id="id7">With pulsetime resolution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id8">Usage</a></li>
<li><a class="reference internal" href="#source" id="id9">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Reduce the number of events in an EventWorkspace by grouping together events with identical or similar X-values (time-of-flight).</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="LoadEventNexus-v1.html#algm-loadeventnexus"><span class="std std-ref">LoadEventNexus</span></a>, <a class="reference internal" href="LoadEventAndCompress-v1.html#algm-loadeventandcompress"><span class="std std-ref">LoadEventAndCompress</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="3%" />
<col width="15%" />
<col width="5%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/EventWorkspace.html#eventworkspace"><span class="std std-ref">EventWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>The name of the EventWorkspace on which to perform the algorithm</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/EventWorkspace.html#eventworkspace"><span class="std std-ref">EventWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>The name of the output EventWorkspace.</td>
</tr>
<tr class="row-even"><td>Tolerance</td>
<td>Input</td>
<td>number</td>
<td>1e-05</td>
<td>The tolerance on each event’s X value (normally TOF, but may be a different unit if you have used ConvertUnits). Any events within Tolerance will be summed into a single event.</td>
</tr>
<tr class="row-odd"><td>WallClockTolerance</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>The tolerance (in seconds) on the wall-clock time for comparison. Unset means compressing all wall-clock times together disabling pulsetime resolution.</td>
</tr>
<tr class="row-even"><td>StartTime</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>An ISO formatted date/time string specifying the timestamp for starting filtering. Ignored if WallClockTolerance is not specified. Default is start of run</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The algorithm can be run in two modes, with and without pulsetime
resolution. This switch is made by specifying a
<code class="docutils literal"><span class="pre">WallClockTolerance</span></code>. The <code class="docutils literal"><span class="pre">StartTime</span></code> is ignored unless
<code class="docutils literal"><span class="pre">WallClockTolerance</span></code> is specified.</p>
<div class="section" id="without-pulsetime-resolution">
<h3><a class="toc-backref" href="#id6">Without pulsetime resolution</a><a class="headerlink" href="#without-pulsetime-resolution" title="Permalink to this headline">¶</a></h3>
<p>This algorithm starts by sorting the event lists by TOF (or whatever
the independent axis is) and ignoring the pulsetime. Therefore you may
gain speed by calling <a class="reference internal" href="SortEvents-v1.html#algm-sortevents"><span class="std std-ref">SortEvents v1</span></a> beforehand.  Starting
from the smallest TOF, all events within <code class="docutils literal"><span class="pre">Tolerance</span></code> in a spectrum
are considered to be identical. A <a class="reference internal" href="../api/python/mantid/api/EventType.html#mantid.api.EventType.WEIGHTED_NOTIME" title="mantid.api.EventType.WEIGHTED_NOTIME"><code class="xref py py-obj docutils literal"><span class="pre">weighted</span> <span class="pre">event</span> <span class="pre">without</span> <span class="pre">time</span>
<span class="pre">information</span></code></a> is created; its
TOF is the average value of the summed events; its weight is the sum
of the weights of the input events; its error is the sum of the square
of the errors of the input events.</p>
<p>Note that using <code class="docutils literal"><span class="pre">CompressEvents</span></code> may introduce errors if you use too large
of a tolerance. Rebinning an event workspace still uses an
all-or-nothing view: if the TOF of the event is in the bin, then the
counts of the bin is increased by the event’s weight. If your tolerance
is large enough that the compound event spans more than one bin, then
you will get small differences in the final histogram.</p>
<p>If you are working from the raw events with TOF resolution of 0.100
microseconds, then you can safely use a tolerance of, e.g., 0.05
microseconds to group events together. In this case, histograms
with/without compression are identical. If your workspace has undergone
changes to its X values (unit conversion for example), you have to use
your best judgement for the Tolerance value.</p>
</div>
<div class="section" id="with-pulsetime-resolution">
<h3><a class="toc-backref" href="#id7">With pulsetime resolution</a><a class="headerlink" href="#with-pulsetime-resolution" title="Permalink to this headline">¶</a></h3>
<p>Similar to the version without pulsetime resolution with a few key differences:</p>
<ol class="arabic simple">
<li>The <a class="reference internal" href="../api/python/mantid/api/EventType.html#mantid.api.EventType.WEIGHTED" title="mantid.api.EventType.WEIGHTED"><code class="xref py py-obj docutils literal"><span class="pre">events</span> <span class="pre">are</span> <span class="pre">weighted</span> <span class="pre">with</span> <span class="pre">time</span></code></a>. As a result, one can still run
<a class="reference internal" href="FilterEvents-v1.html#algm-filterevents"><span class="std std-ref">FilterEvents v1</span></a> on the results.</li>
<li>Similar to the TOF, the resulting pulsetime of an individual
weighted event is the average of the individual events that
contribute to it.</li>
</ol>
<p>While the algorithm can be run with arbitrary values of
<code class="docutils literal"><span class="pre">WallClockTolerance</span></code>, it is recommended to keep in mind what
resolution is desired for later filtering. The pulsetime is
effectively filtered on a bin of the form:
<span class="math">\({pulsetime[i]} = {StartTime} + {WallClockTolerance} * i\)</span></p>
<p>The <code class="docutils literal"><span class="pre">StartTime</span></code> property is only used in pulsetime resolution
mode. Any events that occur before it in a run are ignored and do not
appear in the <code class="docutils literal"><span class="pre">OutputWorkspace</span></code>. If it is not specified, then the
<a class="reference internal" href="../api/python/mantid/api/Run.html#mantid.api.Run.startTime" title="mantid.api.Run.startTime"><code class="xref py py-obj docutils literal"><span class="pre">Run.startTime</span></code></a> is used. An example
<a class="reference external" href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO8601</a>
format for the <code class="docutils literal"><span class="pre">StartTime</span></code> is <code class="docutils literal"><span class="pre">2010-09-14T04:20:12</span></code>. Normally this
parameter can be left unset.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id8">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="s2">&quot;Event&quot;</span><span class="p">,</span><span class="n">BankPixelWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The unfiltered workspace </span><span class="si">{}</span><span class="s2"> has </span><span class="si">{}</span><span class="s2"> events and a peak value of </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberEvents</span><span class="p">(),</span> <span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">50</span><span class="p">]))</span>

<span class="n">ws</span> <span class="o">=</span> <span class="n">CompressEvents</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The compressed workspace </span><span class="si">{}</span><span class="s2"> still has </span><span class="si">{}</span><span class="s2"> events and a peak value of </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getNumberEvents</span><span class="p">(),</span> <span class="n">ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">50</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;However it now takes up less memory.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>The unfiltered workspace ws has 1900 events and a peak value of 257.00
The compressed workspace ws still has 1900 events and a peak value of 257.00
However it now takes up less memory.
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Events.html">Events</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id9">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/34d8076c38ee24128cff66d5dfa6be380c8f35dc/Framework/DataHandling/inc/MantidDataHandling/CompressEvents.h">CompressEvents.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/34d8076c38ee24128cff66d5dfa6be380c8f35dc/Framework/DataHandling/src/CompressEvents.cpp">CompressEvents.cpp</a></p>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/34d8076c38ee24128cff66d5dfa6be380c8f35dc/Testing/SystemTests/tests/framework/CompressEvents.py">CompressEvents.py</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="CompareWorkspaces-v1.html" title="Previous Chapter: CompareWorkspaces v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; CompareWorkspaces v1</span>
    </a>
  </li>
  <li>
    <a href="ComputeCalibrationCoefVan-v1.html" title="Next Chapter: ComputeCalibrationCoefVan v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">ComputeCalibr... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>