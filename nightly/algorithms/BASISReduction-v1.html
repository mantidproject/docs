<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>BASISReduction v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.4.20220909.1939',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="BayesQuasi v1" href="BayesQuasi-v1.html" />
    <link rel="prev" title="BASISPowderDiffraction v1" href="BASISPowderDiffraction-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">BASISReduction v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="basisreduction-v1">
<span id="algm-basisreduction"></span><span id="algm-basisreduction-v1"></span><h1>BASISReduction v1<a class="headerlink" href="#basisreduction-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/BASISReduction-v1_dlg.png"><img alt="../_images/BASISReduction-v1_dlg.png" class="screenshot" src="../_images/BASISReduction-v1_dlg.png" style="width: 349px;" /></a>
<p class="caption"><span class="caption-text"><strong>BASISReduction</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id3">Properties</a></li>
<li><a class="reference internal" href="#description" id="id4">Description</a><ul>
<li><a class="reference internal" href="#reflection-selector" id="id5">Reflection Selector</a></li>
<li><a class="reference internal" href="#vanadium-normalization" id="id6">Vanadium Normalization</a></li>
<li><a class="reference internal" href="#saving-nxspe-files" id="id7">Saving NXSPE files</a></li>
<li><a class="reference internal" href="#dynamic-susceptibility" id="id8">Dynamic Susceptibility</a></li>
<li><a class="reference internal" href="#powder-diffraction" id="id9">Powder Diffraction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id10">Usage</a></li>
<li><a class="reference internal" href="#source" id="id11">Source</a></li>
<li><a class="reference internal" href="#workflow" id="id12">Workflow</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Multiple-file BASIS reduction for its two reflections.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id3">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="2%" />
<col width="3%" />
<col width="5%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>RunNumbers</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>Sample run numbers</td>
</tr>
<tr class="row-odd"><td>DoIndividual</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Do each run individually</td>
</tr>
<tr class="row-even"><td>ExcludeTimeSegment</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>Exclude a contigous time segment; Examples: “71546:0-60” filter run 71546 from start to 60 seconds, “71546:300-600”, “71546:120-end” from 120s to the end of the run</td>
</tr>
<tr class="row-odd"><td>RetainTimeSegment</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>Only retain events occurring within a time segment. Examples: 71546:0-3600 only retains events from the first hour of run 71546. 71546:3600-7200 retain only the second hour. 71546:7200-end retain events after the first two hours</td>
</tr>
<tr class="row-even"><td>GroupDetectors</td>
<td>Input</td>
<td>string</td>
<td>None</td>
<td>Switch for grouping detectors. Allowed values: [‘None’, ‘Low-Resolution’, ‘By-Tube’]</td>
</tr>
<tr class="row-odd"><td>DoFluxNormalization</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Do we normalize data by incoming flux?</td>
</tr>
<tr class="row-even"><td>FluxNormalizationType</td>
<td>Input</td>
<td>string</td>
<td>Monitor</td>
<td>Flux Normalization Type. Allowed values: [‘Monitor’, ‘Proton Charge’, ‘Duration’]</td>
</tr>
<tr class="row-odd"><td>NormalizeToFirst</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Normalize spectra to intensity of spectrum with lowest Q?</td>
</tr>
<tr class="row-even"><td>ReflectionType</td>
<td>Input</td>
<td>string</td>
<td>silicon_111</td>
<td>Analyzer. Documentation lists typical                              associated property values. Allowed values: [‘silicon_111’, ‘silicon_311’, ‘silicon_333’]</td>
</tr>
<tr class="row-odd"><td>EnergyBins</td>
<td>Input</td>
<td>dbl list</td>
<td>-150,0.4,500</td>
<td>Energy transfer binning scheme (in ueV)</td>
</tr>
<tr class="row-even"><td>MomentumTransferBins</td>
<td>Input</td>
<td>dbl list</td>
<td>0.3,0.2,1.9</td>
<td>Momentum transfer binning scheme</td>
</tr>
<tr class="row-odd"><td>MaskFile</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>See documentation for latest mask files. Allowed extensions: [‘.xml’]</td>
</tr>
<tr class="row-even"><td>DivideByVanadium</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Do we normalize by the vanadium intensity?</td>
</tr>
<tr class="row-odd"><td>NormalizationType</td>
<td>Input</td>
<td>string</td>
<td>by Q slice</td>
<td>Select a Vanadium normalization. Allowed values: [‘by Q slice’, ‘by detector ID’]</td>
</tr>
<tr class="row-even"><td>NormRunNumbers</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>Normalization run numbers</td>
</tr>
<tr class="row-odd"><td>SaveNXSPE</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Do we save to NXSPE format?</td>
</tr>
<tr class="row-even"><td>PsiAngleLog</td>
<td>Input</td>
<td>string</td>
<td>SE50Rot</td>
<td>name of entry in the logs storing the psi                              angle</td>
</tr>
<tr class="row-odd"><td>PsiOffset</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>add this quantity to the psi angle stored                              in the log</td>
</tr>
<tr class="row-even"><td>OutputSusceptibility</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Output dynamic susceptibility (Xqw)</td>
</tr>
<tr class="row-odd"><td>OutputPowderSpectrum</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Output S(Q) and S(theta) powder diffraction</td>
</tr>
<tr class="row-even"><td>RemoveTemporaryWorkspaces</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Remove temporary workspaces and files</td>
</tr>
</tbody>
</table>
<p>For each property, the algorithm will remember the last value used. If user deletes
this value and leaves blank the property field, the default value will be used. Default
values are typical of the silicon111 reflection.</p>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id4">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p><strong>Run numbers</strong>:
Reduction can be carried out for each run or all runs can be aggregated into
a single data collection.</p>
<p>Examples:</p>
<ul class="simple">
<li>2144-2147: runs from 2144 to 2147.</li>
<li>2144-2147,2149,2156: runs from 2144 to 2147 and also runs 2149 and 156</li>
</ul>
<p>If <em>DoIndividual</em> is checked, then each run number is reduced separately
from the rest.</p>
<p><strong>ExcludeTimeSegment</strong>:
Events happening in a time segment with no proton charge are most likely
noise. Those events can be filtered out of the reduction process.</p>
<p>Example:</p>
<ul class="simple">
<li>“71465:0-500,71466:900-2100,71467:4000-end” will filter out events
happening between the start of the run and 500 seconds for run 71465, then
between 900 and 2100 seconds for run 71466 and between 4000 seconds and the
end of the run for 71467. Only one time segment can be excluded per run number.</li>
</ul>
<p><strong>RetainTimeSegment</strong>:
When interested only in a single and contiguous part of the run. Only events
within that time window can be kept.</p>
<p>Examples:
- “71465:0-3600,71466:3600-7200,71467:3600-end” will retain events of the first
hour of run 71465, events of the second hour of run 71466, and events after
the first hour of run 71467. Events outside these time windows will not be
taken into account.</p>
<p><strong>Momentum transfer binning scheme</strong>: Three values are required, the
center of the bin with the minimum momentum, the bin width, and the
center of the bin with the maximum momentum.</p>
<p><strong>Rescaling to first spectrum</strong>: Since the Y-scale has arbitrary units, a
rescaling convention is taken whereby the maximum of the
first spectrum (lowest Q-value) is rescaled to 1.0. This rescaling may not
be employed when the intent is to compare to other runs, like can substraction
of comparison between deuterated and hydrogenated samples.</p>
<div class="section" id="reflection-selector">
<h3><a class="toc-backref" href="#id5">Reflection Selector</a><a class="headerlink" href="#reflection-selector" title="Permalink to this headline">¶</a></h3>
<p>Currently three types of reflection are possible, associated with the
silicon analyzers of BASIS. These are typical binning values for each
reflection:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="32%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Reflection</th>
<th class="head"><dl class="first last docutils">
<dt>Energy bins</dt>
<dd>(micro-eV)</dd>
</dl>
</th>
<th class="head"><dl class="first last docutils">
<dt>Momentum transfer bins</dt>
<dd>(inverse Angstroms)</dd>
</dl>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>silicon111</td>
<td>-150, 0.4, 500</td>
<td>0.3, 0.2, 1.9</td>
</tr>
<tr class="row-odd"><td>silicon311</td>
<td>-740, 1.6, 740</td>
<td>0.5, 0.2, 3.7</td>
</tr>
<tr class="row-even"><td>silicon333</td>
<td>-1500, 3.2 1500</td>
<td>0.5, 0.2, 3.7</td>
</tr>
</tbody>
</table>
<p>Also the following default mask files are associated to each reflection:</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Reflection</th>
<th class="head">Mask file</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>silicon111</td>
<td>BASIS_Mask_default_111.xml</td>
</tr>
<tr class="row-odd"><td>silicon311</td>
<td>BASIS_Mask_default_311.xml</td>
</tr>
<tr class="row-even"><td>silicon333</td>
<td>BASIS_Mask_default_333.xml</td>
</tr>
</tbody>
</table>
<p>Note: masks for reflections 111 and 333 are actually the same since both
reflections take place at the same silicon crystal analyzers.</p>
<p>These mask files can be found in the SNS filesystem
(<strong>/SNS/BSS/shared/autoreduce/new_masks_08_12_2015/</strong>)</p>
</div>
<div class="section" id="vanadium-normalization">
<h3><a class="toc-backref" href="#id6">Vanadium Normalization</a><a class="headerlink" href="#vanadium-normalization" title="Permalink to this headline">¶</a></h3>
<p>The syntax for the vanadium run numbers designation (<strong>NormRunNumbers</strong>) is the same as in
the case of the sample (hyphens and commas are understood).
All runs are jointly reduced into a single vanadium workspace.</p>
<p>Normalization type <strong>by Q slice</strong> is the default
normalization. In this case, the sample is reduced into <span class="math">\(S_{s}(Q,E)\)</span> and
the vanadium is reduced into <span class="math">\(S_{v}(Q,E)\)</span>. Later, <span class="math">\(S_{v}(Q,E)\)</span> is integrated
along the energy axis in the range [-0.034, 0.034]meV to produce <span class="math">\(S_{v}(Q)\)</span>.
Finally the sample is divided by the vanadium, <span class="math">\(S_{s}(Q,E) / S_{v}(Q)\)</span>.</p>
<p>Normalization type <strong>by detector ID</strong> carries out the division on each
detector of the instrument. If we have for detector <span class="math">\(i\)</span> sample <span class="math">\(S_s(\lambda, i)\)</span>
and vanadium <span class="math">\(S_v(\lambda, i)\)</span>, we integrate along the <span class="math">\(\lambda\)</span> axis in the
range given by <strong>NormWavelengthRange</strong> to obtain
<span class="math">\(S_v(i)\)</span> and then divide <span class="math">\(S_s(\lambda, i)/S_v(i)=S'_s(\lambda, i)\)</span>. From this
point on, the reduction process continues using <span class="math">\(S'_s\)</span> in place of <span class="math">\(S_s\)</span>.</p>
</div>
<div class="section" id="saving-nxspe-files">
<h3><a class="toc-backref" href="#id7">Saving NXSPE files</a><a class="headerlink" href="#saving-nxspe-files" title="Permalink to this headline">¶</a></h3>
<p>NXSPE files are suitable for intensity visualization in <span class="math">\(\vec{Q}\)</span> space with
[MSLICE](<a class="reference external" href="http://mslice.isis.rl.ac.uk/Main_Page">http://mslice.isis.rl.ac.uk/Main_Page</a>). When using this program, make
sure you select the <em>inverse</em> geometry.</p>
<a class="reference internal image-reference" href="../_images/BASISReduction_NXSPE.png"><img alt="Wavelength spectrum." src="../_images/BASISReduction_NXSPE.png" style="width: 50%;" /></a>
<p>Also, make sure that the sample rotation angle is stored in the logs of the run,
since this is a required property of the algorithm.</p>
</div>
<div class="section" id="dynamic-susceptibility">
<h3><a class="toc-backref" href="#id8">Dynamic Susceptibility</a><a class="headerlink" href="#dynamic-susceptibility" title="Permalink to this headline">¶</a></h3>
<p>If &lt;i&gt;OutputSusceptibility&lt;/i&gt; is checked, one additional workspace and one Nexus file will be generated,
both containing the dynamic susceptibility as a function of frequency, in units of GHz.
The extension denoting this quantity in the workspace and file names is “Xqw”
(the extension for the structure factor is “sqw”).</p>
</div>
<div class="section" id="powder-diffraction">
<h3><a class="toc-backref" href="#id9">Powder Diffraction</a><a class="headerlink" href="#powder-diffraction" title="Permalink to this headline">¶</a></h3>
<p>If &lt;i&gt;OutputPowderSpectrum&lt;/i&gt; is checked,
two additional workspaces are created
after a call to algorithm <a class="reference internal" href="BASISPowderDiffraction-v1.html#algm-basispowderdiffraction"><span class="std std-ref">BASISPowderDiffraction v1</span></a>
- <cite>BSS_XXXX_sq_angle</cite>: Intensity versus scattering angle <span class="math">\(\vec{2\theta}\)</span>
- <cite>BSS_XXXX_sq</cite>: Intensity versus momentum transfer</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id10">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Perform a reduction:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">BASISReduction</span><span class="p">(</span><span class="n">RunNumbers</span><span class="o">=</span><span class="s2">&quot;59671&quot;</span><span class="p">,</span>
               <span class="n">EnergyBins</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mi">120</span><span class="p">],</span>
               <span class="n">MomentumTransferBins</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">],</span>
               <span class="n">DivideByVanadium</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">NormRunNumbers</span><span class="o">=</span><span class="s2">&quot;58183&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Inelastic/Reduction.html">Inelastic\Reduction</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id11">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/34d8076c38ee24128cff66d5dfa6be380c8f35dc/Framework/PythonInterface/plugins/algorithms/BASISReduction.py">BASISReduction.py</a></p>
</div>
<div class="section" id="workflow">
<h2><a class="toc-backref" href="#id12">Workflow</a><a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/BASISReduction-v1_wkflw.svg" src="../_images/BASISReduction-v1_wkflw.svg" /></div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="BASISPowderDiffraction-v1.html" title="Previous Chapter: BASISPowderDiffraction v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; BASISPowderDi...</span>
    </a>
  </li>
  <li>
    <a href="BayesQuasi-v1.html" title="Next Chapter: BayesQuasi v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">BayesQuasi v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>