<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>FindGoniometerFromUB v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.4.20220909.1939',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FindPeakBackground v1" href="FindPeakBackground-v1.html" />
    <link rel="prev" title="FindGlobalBMatrix v1" href="FindGlobalBMatrix-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">FindGoniometerFromUB v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="findgoniometerfromub-v1">
<span id="algm-findgoniometerfromub"></span><span id="algm-findgoniometerfromub-v1"></span><h1>FindGoniometerFromUB v1<a class="headerlink" href="#findgoniometerfromub-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/FindGoniometerFromUB-v1_dlg.png"><img alt="../_images/FindGoniometerFromUB-v1_dlg.png" class="screenshot" src="../_images/FindGoniometerFromUB-v1_dlg.png" style="width: 349px;" /></a>
<p class="caption"><span class="caption-text"><strong>FindGoniometerFromUB</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id3">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id4">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id5">Properties</a></li>
<li><a class="reference internal" href="#description" id="id6">Description</a></li>
<li><a class="reference internal" href="#useage" id="id7">Useage</a></li>
<li><a class="reference internal" href="#source" id="id8">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id3">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Takes a series of exported UB (from SaveISawUB) and using the first UB supplied as a reference saves UB files that share common indexing (i.e. no inversion or swapping of crystallographic axes relative to the reference UB) in the default save directory and produces a table of the goniometer angle (phi) and the unit vector of the goniometer axis for each run (excl. the reference).</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id4">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="SetGoniometer-v1.html#algm-setgoniometer"><span class="std std-ref">SetGoniometer</span></a>, <a class="reference internal" href="CalculateUMatrix-v1.html#algm-calculateumatrix"><span class="std std-ref">CalculateUMatrix</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id5">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="3%" />
<col width="2%" />
<col width="10%" />
<col width="3%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>UBfiles</td>
<td>Input</td>
<td>list of str lists</td>
<td><em>Mandatory</em></td>
<td>Files with exported UB (from SaveISawUB). The filename must have .mat extension and only contain the run number as would be supplied to Load (e.g. WISH00043350.mat). The first UB will be the reference (typically, but not necessarily, omega = phi = 0) and a consistent UB will be made for each of the subsequent runs. Allowed extensions: [‘.mat’]</td>
</tr>
<tr class="row-odd"><td>Chi</td>
<td>Input</td>
<td>number</td>
<td>45</td>
<td>Angle of the goniometer axis from +ve Z (vertical up).</td>
</tr>
<tr class="row-even"><td>ChiTol</td>
<td>Input</td>
<td>number</td>
<td>5</td>
<td>Tolerance of chi angle to test for consistency.</td>
</tr>
<tr class="row-odd"><td>PhiTol</td>
<td>Input</td>
<td>number</td>
<td>15</td>
<td>Tolerance of phi angle to test for consistency (due to uncertainty on the gonio axis at omega=0this tol might need to be quite large).</td>
</tr>
<tr class="row-even"><td>PhiHand</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Handedness for the phi angles (rotation around goniometer axis) in the log file (1 for ccw/RH, -1 for cw/LH). Allowed values: [‘-1’, ‘1’]</td>
</tr>
<tr class="row-odd"><td>PhiLogName</td>
<td>Input</td>
<td>string</td>
<td>ewald_pos</td>
<td>Name of log entry that records angle of rotation about goniometer axis</td>
</tr>
<tr class="row-even"><td>DOmega</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>omega rotation between component of goniometer axis in XY-plane from +ve Y-axis(perpendicular to ki)</td>
</tr>
<tr class="row-odd"><td>OmegaHand</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Handedness for the omega angles (rotation around +ve Z) in the log file (1 for ccw/RH, -1 for cw/LH). Allowed values: [‘-1’, ‘1’]</td>
</tr>
<tr class="row-even"><td>OmegaLogName</td>
<td>Input</td>
<td>string</td>
<td>ccr_pos</td>
<td>Name of log entry that records angle of rotation about vertical axis</td>
</tr>
<tr class="row-odd"><td>OutputTable</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><span class="std std-ref">TableWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>Output table to display goniometer axis and angles for runs with UBs that can share common indexing</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id6">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Takes a list of exported UB files (from SaveISawUB) and saves (in the default save directory) UB files that are consistent with the first UB file specified such that the same reflection in different runs has the same index (i.e. no inversion or swapping of crystallographic axes relative to the reference UB). Note this algorithm assume the sample is perfectly on the centre of rotation.</p>
<div class="figure" id="id2">
<img alt="FindGoniometerFromUB_schematic.PNG" src="../_images/FindGoniometerFromUB_schematic.PNG" />
<p class="caption"><span class="caption-text">Fig.1: Schematic of the coordinate system used and definition of the goniometer axes. The arrow associated with an angle denote the counter clockwise rotation which corresponds to a handedness of +1 (right-handed). If the log file angles are for a clockwise rotation then the corresponding handedness shuold be specified as -1 in the input to the algroithm.</span></p>
</div>
<p>The algorithm uses the right-hand coordinate system where X is the beam direction and Z is vertically upward (IPNS convention). The algorithm considers two rotation axes: rotation about the Z-axis, <span class="math">\(\Omega\)</span> ,and rotation of <span class="math">\(\phi\)</span> around the goniometer axis. The angles <span class="math">\(\Omega\)</span> and <span class="math">\(\phi\)</span> for each run are read from the first value of the specified log entry in the run log files.
The goniometer axis is defined by the angle from the vertical, <span class="math">\(\chi\)</span>, and the angle between the component of the goniometer axis in the scattering plane (XY) from the positive Y-axis, <span class="math">\(d\Omega\)</span>, defined when <span class="math">\(\Omega=0\)</span> - for which nominal/best-guess values need to be supplied as arguments.</p>
<p>The test for consistency requires some tolerances to be supplied on <span class="math">\(\chi\)</span> and <span class="math">\(\phi\)</span>, if the nominal goniometer axis is not within those tolerances the most likely permutation of the axes is tried (see <a class="reference internal" href="FindPeaksMD-v1.html#algm-findpeaksmd"><span class="std std-ref">FindPeaksMD v1</span></a>) and the consistency is checked again. The algorithm displays a table with the actual <span class="math">\(\chi\)</span> and <span class="math">\(\phi\)</span> and the unit vector of the goniometer axis for each run for which a consistent UB was found</p>
</div>
<div class="section" id="useage">
<h2><a class="toc-backref" href="#id7">Useage</a><a class="headerlink" href="#useage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># WISH single crystal</span>
<span class="c1"># demonstration of linkedUBs algorithm on D10 Ruby (cyle 18/1)</span>

<span class="kn">from</span> <span class="nn">mantid.simpleapi</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">ubList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;WISH00043350&#39;</span><span class="p">,</span> <span class="s1">&#39;WISH00043351&#39;</span><span class="p">,</span> <span class="s1">&#39;WISH00043352&#39;</span><span class="p">,</span><span class="s1">&#39;WISH00043353&#39;</span><span class="p">,</span><span class="s1">&#39;WISH00043354&#39;</span><span class="p">]</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">FindGonioFromUB</span><span class="p">(</span><span class="n">UBfiles</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ubList</span><span class="p">),</span> <span class="n">chi</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">chiTol</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">phiTol</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">phiHand</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dOmega</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">omegaHand</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Diffraction/Reduction.html">Diffraction\Reduction</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id8">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/34d8076c38ee24128cff66d5dfa6be380c8f35dc/Framework/PythonInterface/plugins/algorithms/FindGoniometerFromUB.py">FindGoniometerFromUB.py</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="FindGlobalBMatrix-v1.html" title="Previous Chapter: FindGlobalBMatrix v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; FindGlobalBMatrix v1</span>
    </a>
  </li>
  <li>
    <a href="FindPeakBackground-v1.html" title="Next Chapter: FindPeakBackground v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">FindPeakBackground v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>