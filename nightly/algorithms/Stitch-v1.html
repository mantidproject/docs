<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Stitch v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.4.20220909.1939',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Stitch1D v3" href="Stitch1D-v3.html" />
    <link rel="prev" title="StepScan v1" href="StepScan-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">Stitch v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="stitch-v1">
<span id="algm-stitch"></span><span id="algm-stitch-v1"></span><h1>Stitch v1<a class="headerlink" href="#stitch-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/Stitch-v1_dlg.png"><img alt="../_images/Stitch-v1_dlg.png" class="screenshot" src="../_images/Stitch-v1_dlg.png" style="width: 302px;" /></a>
<p class="caption"><span class="caption-text"><strong>Stitch</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id3">Properties</a></li>
<li><a class="reference internal" href="#description" id="id4">Description</a></li>
<li><a class="reference internal" href="#inputs" id="id5">Inputs</a><ul>
<li><a class="reference internal" href="#inputworkspaces" id="id6">InputWorkspaces</a></li>
<li><a class="reference internal" href="#referenceworkspace" id="id7">ReferenceWorkspace</a></li>
<li><a class="reference internal" href="#combinationbehaviour" id="id8">CombinationBehaviour</a></li>
<li><a class="reference internal" href="#scalefactorcalculation" id="id9">ScaleFactorCalculation</a></li>
<li><a class="reference internal" href="#manualscalefactors" id="id10">ManualScaleFactors</a></li>
<li><a class="reference internal" href="#tiescalefactors" id="id11">TieScaleFactors</a></li>
<li><a class="reference internal" href="#outputworkspace" id="id12">OutputWorkspace</a></li>
<li><a class="reference internal" href="#outputscalefactorsworkspace" id="id13">OutputScaleFactorsWorkspace</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id14">Usage</a></li>
<li><a class="reference internal" href="#source" id="id15">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Stitches overlapping spectra from multiple 2D workspaces.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id3">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="2%" />
<col width="12%" />
<col width="4%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspaces</td>
<td>Input</td>
<td>str list</td>
<td><em>Mandatory</em></td>
<td>The names of the input workspaces or groups of those as a list. At least two compatible MatrixWorkspaces are required, having one spectrum each.</td>
</tr>
<tr class="row-odd"><td>ReferenceWorkspace</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>The name of the workspace that will serve as the reference; that is, the one that will not be scaled. If left blank, stitching will be performed left to right in the order of x-axes ascending, no matter the order of workspaces names in the input.</td>
</tr>
<tr class="row-even"><td>CombinationBehaviour</td>
<td>Input</td>
<td>string</td>
<td>Interleave</td>
<td>Allowed values: [‘Interleave’]</td>
</tr>
<tr class="row-odd"><td>ScaleFactorCalculation</td>
<td>Input</td>
<td>string</td>
<td>MedianOfRatios</td>
<td>Allowed values: [‘MedianOfRatios’, ‘Manual’]</td>
</tr>
<tr class="row-even"><td>ManualScaleFactors</td>
<td>Input</td>
<td>dbl list</td>
<td>&#160;</td>
<td>Manually specified scale factors, must follow the same order of the workspaces in the list.</td>
</tr>
<tr class="row-odd"><td>TieScaleFactors</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether or not to calculate a single scale factor per workspace for all the spectra.</td>
</tr>
<tr class="row-even"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>The output workspace.</td>
</tr>
<tr class="row-odd"><td>OutputScaleFactorsWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td>&#160;</td>
<td>The output workspace containing the applied scale factors.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id4">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm performs stitching of multiple 2D workspaces. Stitching is the operation of scaling one workspace to match the scale of another one in the overlap region and the combination of the workspaces after scale matching.
For each pair of adjacent workspaces in the input, it will find the overlap, interpolate one to another in the overlap region, make the ratio and find the scaling factor.
Then each workspace will be scaled with that factor, and finally all the workspaces will be combined.</p>
</div>
<div class="section" id="inputs">
<h2><a class="toc-backref" href="#id5">Inputs</a><a class="headerlink" href="#inputs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="inputworkspaces">
<h3><a class="toc-backref" href="#id6">InputWorkspaces</a><a class="headerlink" href="#inputworkspaces" title="Permalink to this headline">¶</a></h3>
<p>The list of input workspace or workspace group names. The workspace groups will be flattened to a list of workspaces.
Note that because of this type of input that relies on WorkspaceGroups, this algorithm is currently supported only for named workspaces present on ADS.
The inputs can be in any order in terms of their x-axis extent. The algorithm will first sort them ascending in terms of x-intervals.
Then it will start stitching iteratively to the left and to the right starting from the reference workspace. The input workspaces must be point-data and must have common bins.</p>
</div>
<div class="section" id="referenceworkspace">
<h3><a class="toc-backref" href="#id7">ReferenceWorkspace</a><a class="headerlink" href="#referenceworkspace" title="Permalink to this headline">¶</a></h3>
<p>The name of the workspace that will not be scaled. This means that other workspaces will be scaled to match up the scale of the reference one.
The reference is optional; if it is not specified, the workspace with the lowest x-axis interval will be taken as reference, which means that the stitching will iterate left-to-right.</p>
</div>
<div class="section" id="combinationbehaviour">
<h3><a class="toc-backref" href="#id8">CombinationBehaviour</a><a class="headerlink" href="#combinationbehaviour" title="Permalink to this headline">¶</a></h3>
<p>At the moment the only option is interleave, which means that all the points from all the inputs will be preserved and the output will be sorted by the x-axis values.</p>
</div>
<div class="section" id="scalefactorcalculation">
<h3><a class="toc-backref" href="#id9">ScaleFactorCalculation</a><a class="headerlink" href="#scalefactorcalculation" title="Permalink to this headline">¶</a></h3>
<p>By default it will calculate the median of the point-wise ratios. This is robust in the sense that it is not sensitive to outliers.
This can be set to manual, in which case the scale factors can be specified by the user.</p>
</div>
<div class="section" id="manualscalefactors">
<h3><a class="toc-backref" href="#id10">ManualScaleFactors</a><a class="headerlink" href="#manualscalefactors" title="Permalink to this headline">¶</a></h3>
<p>Those must be in the same order as the workspaces in the original input list. By setting those to 1. one could enforce no-scale stitching.</p>
</div>
<div class="section" id="tiescalefactors">
<h3><a class="toc-backref" href="#id11">TieScaleFactors</a><a class="headerlink" href="#tiescalefactors" title="Permalink to this headline">¶</a></h3>
<p>If this is checked, one will enforce that the scale factor calculated between two workspaces is the global median of point-wise ratios in the overlapping region and is hence constant for all the spectra.
Otherwise, for each spectra, it will find the median for that spectrum and scale each spectrum with its own factor.
Manual factors can only be considered as tied, i.e. they will be applied to all the spectra.</p>
</div>
<div class="section" id="outputworkspace">
<h3><a class="toc-backref" href="#id12">OutputWorkspace</a><a class="headerlink" href="#outputworkspace" title="Permalink to this headline">¶</a></h3>
<p>The workspace containing the stitched outputs.</p>
</div>
<div class="section" id="outputscalefactorsworkspace">
<h3><a class="toc-backref" href="#id13">OutputScaleFactorsWorkspace</a><a class="headerlink" href="#outputscalefactorsworkspace" title="Permalink to this headline">¶</a></h3>
<p>An optional output workspace to store the scale factors.
If manual or tied scale factors are used, this will be a single spectrum workspace containing those factors in the original order.
Without ties this will contain as many spectra as the inputs, each of which will contain the scale factors for that spectrum.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id14">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - Stitch</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">179864</span><span class="p">)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">ws1</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span><span class="n">DataY</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span><span class="n">NSpec</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">ws2</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">DataX</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span><span class="n">DataY</span><span class="o">=</span><span class="n">y2</span><span class="p">,</span><span class="n">NSpec</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">Stitch</span><span class="p">([</span><span class="n">ws1</span><span class="p">,</span><span class="n">ws2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Stitched curve has {st.blocksize()} points&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Stitched curve has 22 points
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Transforms/Merging.html">Transforms\Merging</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id15">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/34d8076c38ee24128cff66d5dfa6be380c8f35dc/Framework/Algorithms/inc/MantidAlgorithms/Stitch.h">Stitch.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/34d8076c38ee24128cff66d5dfa6be380c8f35dc/Framework/Algorithms/src/Stitch.cpp">Stitch.cpp</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="StepScan-v1.html" title="Previous Chapter: StepScan v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; StepScan v1</span>
    </a>
  </li>
  <li>
    <a href="Stitch1D-v3.html" title="Next Chapter: Stitch1D v3"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Stitch1D v3 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>