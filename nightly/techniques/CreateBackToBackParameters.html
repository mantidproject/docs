<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Create Back To Back Parameters</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.4.20220909.1939',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Create Ikeda Carpenter Parameters" href="CreateIkedaCarpenterParameters.html" />
    <link rel="prev" title="Calibration Implementation Details" href="Calibration_implementation.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Techniques</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">Create Back To Back Parameters</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="create-back-to-back-parameters">
<span id="createbacktobackparameters"></span><h1>Create Back To Back Parameters<a class="headerlink" href="#create-back-to-back-parameters" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id3">Introduction</a></li>
<li><a class="reference internal" href="#example-fullprof-hrpd-icpv-instrument-parameter-file" id="id4">Example Fullprof HRPD ICPV instrument parameter file</a></li>
<li><a class="reference internal" href="#converting-above-fullprof-icpv-parameter-into-mantid-parameter-file" id="id5">Converting above Fullprof ICPV parameter into Mantid parameter file</a></li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id3">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This is how to create back-to-back exponential peudo-voigt Fullprof fit function parameters with Mantid’s <a class="reference internal" href="../fitting/fitfunctions/BackToBackExponential.html#func-backtobackexponential"><span class="std std-ref">BackToBackExponential</span></a> function.</p>
</div>
<div class="section" id="example-fullprof-hrpd-icpv-instrument-parameter-file">
<h2><a class="toc-backref" href="#id4">Example Fullprof HRPD ICPV instrument parameter file</a><a class="headerlink" href="#example-fullprof-hrpd-icpv-instrument-parameter-file" title="Permalink to this headline">¶</a></h2>
<p>The fullprof param file (also called fullprof resolution file) below describes default fitting parameters to use for the fullprof NPROF=9 fitting functions. More specifically it does this in the example below for three collections of detectors, which could be any collection of detectors, but for this particular example happens to be:</p>
<ul class="simple">
<li>The 1st set of parameters refer to the detectors of the bank scattering bank. In HPRD_Definition.xml called “bank_bsk”</li>
<li>The 2nd set of parameters refer to the detectors of the 90 degree bank. In HPRD_Definition.xml called “bank_90degnew”</li>
<li>The 3nd set of parameters refer to the collection of detectors grouped with the name “bank_1a” HPRD_Definition.xml called “bank_90degnew”</li>
</ul>
<div class="highlight-text"><div class="highlight"><pre><span></span>Instrumental resolution function for HRPD/ISIS L. Chapon 12/2003  ireso: 5
! To be used with function NPROF=9 in FullProf (Res=5)
! ----------------------------------------------------  Bank 1
!  Type of profile function: back-to-back expon * pseudo-Voigt
NPROF   9
!       Tof-min(us)    step      Tof-max(us)
TOFRG   10364.0000      1.0000   235100.00000
!        Dtt1           Dtt2       Zero
D2TOF     48293.168           -0.201        -2.086
!     TOF-TWOTH of the bank
TWOTH    168.33
!       Sig-2     Sig-1     Sig-0
SIGMA   7.429     132.188      0.000
!       Gam-2     Gam-1     Gam-0
GAMMA   0.000     7.550   0.000
!          alph0       beta0       alph1       beta1
ALFBE    0.000000    0.026707    0.086999    0.005560
END
! ----------------------------------------------------- Bank 2
!  Type of profile function: back-to-back expon * pseudo-Voigt
NPROF   9
!       Tof-min(us)    step      Tof-max(us)
TOFRG   10680.00     7.85    231500.00
!        Dtt1          Dtt2        Zero
D2TOF     34824.055           3.354        8.729
!     TOF-TWOTH of the bank
TWOTH    89.58
!       Sig-2       Sig-1     Sig-0
SIGMA   158.011     4166.279     0.000
!       Gam-2     Gam-1     Gam-0
GAMMA   0.000     4.916     0.000
!          alph0       beta0       alph1       beta1
ALFBE    0.000000    0.020300    0.086999    0.019136
END
! ----------------------------------------------------- Bank 2
!  Type of profile function: back-to-back expon * pseudo-Voigt
NPROF   9
!       Tof-min(us)    step      Tof-max(us)
TOFRG   10570.00     7.85    231500.00
!        Dtt1          Dtt2        Zero
D2TOF     12763.054           8.302        0.000
!     TOF-TWOTH of the bank
TWOTH    89.58
!       Sig-2       Sig-1     Sig-0
SIGMA   188.149     6520.945     0.000
!       Gam-2     Gam-1     Gam-0
GAMMA   0.000     0.000     0.000
!          alph0       beta0       alph1       beta1
ALFBE    0.000000    0.026707    0.086999    0.005560
END
</pre></div>
</div>
</div>
<div class="section" id="converting-above-fullprof-icpv-parameter-into-mantid-parameter-file">
<h2><a class="toc-backref" href="#id5">Converting above Fullprof ICPV parameter into Mantid parameter file</a><a class="headerlink" href="#converting-above-fullprof-icpv-parameter-into-mantid-parameter-file" title="Permalink to this headline">¶</a></h2>
<p>The syntax for a Mantid parameter file is described <a class="reference internal" href="../concepts/InstrumentDefinitionFile.html#instrumentdefinitionfile"><span class="std std-ref">here</span></a>, in particular look for the section on fitting <a class="reference internal" href="../concepts/InstrumentDefinitionFile.html#using-parameter"><span class="std std-ref">parameter</span></a> on that page.</p>
<p>Fullprof definition of <code class="docutils literal"><span class="pre">NPROF=9</span></code> is the convolution of a back-to-back exponential with a pseudo-voigt.
This is in fact not a perfect match with Mantid’s <a class="reference internal" href="../fitting/fitfunctions/BackToBackExponential.html#func-backtobackexponential"><span class="std std-ref">BackToBackExponential</span></a> function
(as of this writing), since it is the peak shape function for a back-to-back exponential convoluted with a Gaussian.
Hence the Lorentzian part of the fullprof <code class="docutils literal"><span class="pre">NPROF=9</span></code> is here ignored.</p>
<p>So the exercise is to convert fullprof</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>!       Sig-2     Sig-1     Sig-0
SIGMA   7.429     132.188      0.000
!          alph0       beta0       alph1       beta1
ALFBE    0.000000    0.026707    0.086999    0.005560
</pre></div>
</div>
<p>Into the parameters <span class="math">\(A\)</span>, <span class="math">\(B\)</span> and <span class="math">\(S\)</span> of <a class="reference internal" href="../fitting/fitfunctions/BackToBackExponential.html#func-backtobackexponential"><span class="std std-ref">BackToBackExponential</span></a>.
From comparing the formula for the fitting function <a class="reference internal" href="../fitting/fitfunctions/BackToBackExponential.html#func-backtobackexponential"><span class="std std-ref">BackToBackExponential</span></a> with
formulas in the :ref:<a href="#id1"><span class="problematic" id="id2">`</span></a>fullprof manual &lt;<a class="reference external" href="http://www.ill.eu/sites/fullprof/">http://www.ill.eu/sites/fullprof/</a>&gt;`the conversion equations are estimated to be:</p>
<div class="math">
\[S = \sqrt{Sig \mbox{-}2 * d^4 + Sig\mbox{-}1 * d^2 + Sig\mbox{-}0}\]</div>
<div class="math">
\[A = alph0 + alph1/d\]</div>
<div class="math">
\[B = beta0 + beta1/d^4\]</div>
<p>where <span class="math">\(d\)</span> is the d-Spacing at the centre of the peak.</p>
<p>So the translation of the example just above into <a class="reference internal" href="../fitting/fitfunctions/BackToBackExponential.html#func-backtobackexponential"><span class="std std-ref">BackToBackExponential</span></a> parameters gives:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>&lt;parameter name=&quot;BackToBackExponential:S&quot; type=&quot;fitting&quot;&gt;
  &lt;formula eq=&quot;sqrt(7.429*centre^4+132.188*centre^2)&quot; unit=&quot;dSpacing&quot; result-unit=&quot;TOF&quot; /&gt;
&lt;/parameter&gt;
&lt;parameter name=&quot;BackToBackExponential:A&quot; type=&quot;fitting&quot;&gt;
  &lt;formula eq=&quot;(0.086999/centre)&quot; unit=&quot;dSpacing&quot; result-unit=&quot;1/TOF&quot; /&gt; &lt;fixed /&gt;
&lt;/parameter&gt;
&lt;parameter name=&quot;BackToBackExponential:B&quot; type=&quot;fitting&quot;&gt;
  &lt;formula eq=&quot;(0.026707+0.005560/(centre^4))&quot; unit=&quot;dSpacing&quot; result-unit=&quot;1/TOF&quot; /&gt; &lt;fixed /&gt;
&lt;/parameter&gt;
</pre></div>
</div>
<p>Notice <code class="docutils literal"><span class="pre">&lt;fixed</span> <span class="pre">/&gt;</span></code> has been added, such that, by default the parameters <code class="docutils literal"><span class="pre">A</span></code> and <code class="docutils literal"><span class="pre">B</span></code> are fixed.
This is entirely optional, but for fitting e.g. HRPD or GEM data this makes sense since these parameters are supposed
to be instrument specific (considered fixed for a given beamline period at least) whereas <code class="docutils literal"><span class="pre">S</span></code> depends on the specific
sample data that are collected on the beamline.</p>
<p>In Fullprof: Sig-2, Sig-1, beta1, etc. carries units and the result-unit of <code class="docutils literal"><span class="pre">S</span></code> is TOF and the result-unit of <code class="docutils literal"><span class="pre">A</span></code> and <code class="docutils literal"><span class="pre">B</span></code> is 1/TOF.</p>
<p><strong>Category</strong>: <a class="reference external" href="categories/Techniques.html">Techniques</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="Calibration_implementation.html" title="Previous Chapter: Calibration Implementation Details"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Calibration I...</span>
    </a>
  </li>
  <li>
    <a href="CreateIkedaCarpenterParameters.html" title="Next Chapter: Create Ikeda Carpenter Parameters"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Create Ikeda ... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>