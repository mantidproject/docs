<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>3D Mesh Plots for Sample Shapes</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.4.20220909.1939',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Release Notes" href="../release/index.html" />
    <link rel="prev" title="3D Plots: Surface and Wireframe" href="3DPlotsHelp.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Matplotlib in Mantid</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">3D Mesh Plots for Sample Shapes</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="d-mesh-plots-for-sample-shapes">
<span id="mesh-plots"></span><h1>3D Mesh Plots for Sample Shapes<a class="headerlink" href="#d-mesh-plots-for-sample-shapes" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html">3D plotting in Matplotlib</a></p>
<p><strong>Other Plot Docs</strong></p>
<ul class="simple">
<li><a class="reference internal" href="3DPlotsHelp.html#d-plots"><span class="std std-ref">3D Plots: Surface and Wireframe</span></a></li>
<li><a class="reference internal" href="../tutorials/mantid_basic_course/loading_and_displaying_data/06_formatting_plots.html#formatting-plots"><span class="std std-ref">Formatting Plots with the User Interface</span></a></li>
<li><a class="reference internal" href="../tutorials/python_in_mantid/plotting/02_scripting_plots.html#scripting-plots"><span class="std std-ref">Formatting Plots with a script</span></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<div class="contents local topic" id="d-mesh-plots-table-of-contents">
<p class="topic-title first">3D Mesh Plots - Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#meshobject" id="id1">MeshObject</a></li>
<li><a class="reference internal" href="#csgobject" id="id2">CSGObject</a></li>
<li><a class="reference internal" href="#containers-and-components" id="id3">Containers and Components</a></li>
<li><a class="reference internal" href="#add-arrows-for-beam-or-crystal-axes" id="id4">Add Arrows for Beam or Crystal Axes</a></li>
<li><a class="reference internal" href="#set-mesh-axes-equal" id="id5"><code class="docutils literal"><span class="pre">set_mesh_axes_equal()</span></code></a></li>
</ul>
</div>
<p><strong>Mesh Plots can only be accessed with a script, not through the Workbench interface</strong>
Here the mesh is plotted as a Poly3DCollection <a class="reference external" href="https://matplotlib.org/stable/tutorials/toolkits/mplot3d.html#polygon-plots">Polygon</a>.</p>
<p>These sample shapes can be created with <a class="reference internal" href="../algorithms/SetSample-v1.html#algm-setsample"><span class="std std-ref">SetSample v1</span></a>, <a class="reference internal" href="../algorithms/LoadSampleShape-v1.html#algm-loadsampleshape"><span class="std std-ref">LoadSampleShape v1</span></a> or
<a class="reference internal" href="../algorithms/LoadSampleEnvironment-v1.html#algm-loadsampleenvironment"><span class="std std-ref">LoadSampleEnvironment v1</span></a> and copied using <a class="reference internal" href="../algorithms/CopySample-v1.html#algm-copysample"><span class="std std-ref">CopySample v1</span></a>.</p>
<div class="section" id="meshobject">
<h2><a class="toc-backref" href="#id1">MeshObject</a><a class="headerlink" href="#meshobject" title="Permalink to this headline">¶</a></h2>
<p>Plot a MeshObject from an .stl (or .3mf) file:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mantid.simpleapi</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d.art3d</span> <span class="kn">import</span> <span class="n">Poly3DCollection</span>
<span class="kn">from</span> <span class="nn">mantid.api</span> <span class="kn">import</span> <span class="n">AnalysisDataService</span> <span class="k">as</span> <span class="n">ADS</span>

<span class="c1"># load sample shape mesh file for a workspace</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="c1"># alternatively: ws = Load(&#39;filepath&#39;) or ws = ADS.retrieve(&#39;ws&#39;)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">LoadSampleShape</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="s2">&quot;tube.stl&quot;</span><span class="p">)</span>

<span class="c1"># get shape and mesh vertices</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="n">shape</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">getShape</span><span class="p">()</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">getMesh</span><span class="p">()</span>

<span class="c1"># Create 3D Polygon and set facecolor</span>
<span class="n">mesh_polygon</span> <span class="o">=</span> <span class="n">Poly3DCollection</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">facecolors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">],</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="s1">&#39;mantid3d&#39;</span><span class="p">})</span>
<span class="n">axes</span><span class="o">.</span><span class="n">add_collection3d</span><span class="p">(</span><span class="n">mesh_polygon</span><span class="p">)</span>

<span class="n">axes</span><span class="o">.</span><span class="n">set_mesh_axes_equal</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sample Shape: Tube&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X / m&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y / m&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Z / m&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../plotting/MeshPlotHelp-1.py">Source code</a>, <a class="reference external" href="../plotting/MeshPlotHelp-1.png">png</a>, <a class="reference external" href="../plotting/MeshPlotHelp-1.hires.png">hires.png</a>, <a class="reference external" href="../plotting/MeshPlotHelp-1.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/MeshPlotHelp-1.png" src="../_images/MeshPlotHelp-1.png" />
</div>
</div>
<div class="section" id="csgobject">
<h2><a class="toc-backref" href="#id2">CSGObject</a><a class="headerlink" href="#csgobject" title="Permalink to this headline">¶</a></h2>
<p>For help defining CSG Shapes and Rotations, see <a class="reference internal" href="../concepts/HowToDefineGeometricShape.html#howtodefinegeometricshape"><span class="std std-ref">How To Define Geometric Shape</span></a>.
Plot a CSGObject defined in an XML string:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># import mantid algorithms, numpy and matplotlib</span>
<span class="kn">from</span> <span class="nn">mantid.simpleapi</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d.art3d</span> <span class="kn">import</span> <span class="n">Poly3DCollection</span>

<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>

<span class="n">merge_xml</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="se">\</span>
<span class="s1">&lt;cylinder id=&quot;stick&quot;&gt; </span><span class="se">\</span>
<span class="s1">&lt;centre-of-bottom-base x=&quot;-0.5&quot; y=&quot;0.0&quot; z=&quot;0.0&quot; /&gt; </span><span class="se">\</span>
<span class="s1">&lt;axis x=&quot;1.0&quot; y=&quot;0.0&quot; z=&quot;0.0&quot; /&gt;  </span><span class="se">\</span>
<span class="s1">&lt;radius val=&quot;0.05&quot; /&gt; </span><span class="se">\</span>
<span class="s1">&lt;height val=&quot;1.0&quot; /&gt; </span><span class="se">\</span>
<span class="s1">&lt;/cylinder&gt; </span><span class="se">\</span>
<span class="se">\</span>
<span class="s1">&lt;sphere id=&quot;some-sphere&quot;&gt; </span><span class="se">\</span>
<span class="s1">&lt;centre x=&quot;0.7&quot;  y=&quot;0.0&quot; z=&quot;0.0&quot; /&gt; </span><span class="se">\</span>
<span class="s1">&lt;radius val=&quot;0.2&quot; /&gt; </span><span class="se">\</span>
<span class="s1">&lt;/sphere&gt; </span><span class="se">\</span>
<span class="se">\</span>
<span class="s1">&lt;rotate-all x=&quot;90&quot; y=&quot;-45&quot; z=&quot;0&quot; /&gt; </span><span class="se">\</span>
<span class="s1">&lt;algebra val=&quot;some-sphere (: stick)&quot; /&gt; </span><span class="se">\</span>
<span class="s1">&#39;</span>

<span class="n">SetSample</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Geometry</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Shape&#39;</span><span class="p">:</span> <span class="s1">&#39;CSG&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">merge_xml</span><span class="p">})</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="n">shape</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">getShape</span><span class="p">()</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">getMesh</span><span class="p">()</span>

<span class="n">mesh_polygon</span> <span class="o">=</span> <span class="n">Poly3DCollection</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">mesh_polygon</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="s1">&#39;mantid3d&#39;</span><span class="p">})</span>
<span class="n">axes</span><span class="o">.</span><span class="n">add_collection3d</span><span class="p">(</span><span class="n">mesh_polygon</span><span class="p">)</span>

<span class="n">axes</span><span class="o">.</span><span class="n">set_mesh_axes_equal</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">azim</span><span class="o">=-</span><span class="mi">150</span><span class="p">)</span>

<span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sample Shape: Microphone&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X / m&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y / m&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Z / m&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../plotting/MeshPlotHelp-2.py">Source code</a>, <a class="reference external" href="../plotting/MeshPlotHelp-2.png">png</a>, <a class="reference external" href="../plotting/MeshPlotHelp-2.hires.png">hires.png</a>, <a class="reference external" href="../plotting/MeshPlotHelp-2.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/MeshPlotHelp-2.png" src="../_images/MeshPlotHelp-2.png" />
</div>
</div>
<div class="section" id="containers-and-components">
<h2><a class="toc-backref" href="#id3">Containers and Components</a><a class="headerlink" href="#containers-and-components" title="Permalink to this headline">¶</a></h2>
<p>For help defining Containers and Components, see <a class="reference internal" href="../concepts/SampleEnvironment.html#sampleenvironment"><span class="std std-ref">Sample Environment</span></a>.
Note Component index 0 is usually the Container.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">LoadInstrument</span><span class="p">(</span><span class="n">Workspace</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span><span class="n">RewriteSpectraMap</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">InstrumentName</span><span class="o">=</span><span class="s2">&quot;Pearl&quot;</span><span class="p">)</span>
<span class="n">SetSample</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">Environment</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Pearl&#39;</span><span class="p">})</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="n">environment</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">getEnvironment</span><span class="p">()</span>

<span class="sd">&#39;&#39;&#39;getMesh() to plot the Sample Shape&#39;&#39;&#39;</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">getShape</span><span class="p">()</span><span class="o">.</span><span class="n">getMesh</span><span class="p">()</span>

<span class="sd">&#39;&#39;&#39;getMesh() to plot the Container Shape&#39;&#39;&#39;</span>
<span class="n">container_mesh</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="n">getContainer</span><span class="p">()</span><span class="o">.</span><span class="n">getShape</span><span class="p">()</span><span class="o">.</span><span class="n">getMesh</span><span class="p">()</span>

<span class="sd">&#39;&#39;&#39;getMesh() to plot any Component Shape&#39;&#39;&#39;</span>
<span class="c1"># Component index 0 is the Container:</span>
<span class="c1"># container_mesh = environment.getComponent(0).getShape().getMesh()</span>
<span class="n">component_mesh</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="n">getComponent</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">getMesh</span><span class="p">()</span>

<span class="c1"># plot as meshes as previously described</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../plotting/MeshPlotHelp-3.py">Source code</a>, <a class="reference external" href="../plotting/MeshPlotHelp-3.png">png</a>, <a class="reference external" href="../plotting/MeshPlotHelp-3.hires.png">hires.png</a>, <a class="reference external" href="../plotting/MeshPlotHelp-3.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/MeshPlotHelp-3.png" src="../_images/MeshPlotHelp-3.png" />
</div>
</div>
<div class="section" id="add-arrows-for-beam-or-crystal-axes">
<h2><a class="toc-backref" href="#id4">Add Arrows for Beam or Crystal Axes</a><a class="headerlink" href="#add-arrows-for-beam-or-crystal-axes" title="Permalink to this headline">¶</a></h2>
<p>In the above Containers example, a black arrow for the beam direction was added. Below, the real and reciprocal lattice
vectors have been plotted (in solid and dashed linestyles respectively). Both of them make use of the <code class="docutils literal"><span class="pre">arrow()</span></code> function here:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">arrow</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">vector</span><span class="p">,</span> <span class="n">origin</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
 <span class="k">if</span> <span class="n">origin</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
     <span class="n">origin</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim3d</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim3d</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span><span class="n">ax</span><span class="o">.</span><span class="n">get_zlim3d</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
 <span class="k">if</span> <span class="n">factor</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
     <span class="n">lims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim3d</span><span class="p">()</span>
     <span class="n">factor</span> <span class="o">=</span> <span class="p">(</span><span class="n">lims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">lims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">3.0</span>
 <span class="n">vector_norm</span> <span class="o">=</span> <span class="n">vector</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
 <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span>
      <span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">origin</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">origin</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
      <span class="n">vector_norm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">factor</span><span class="p">,</span> <span class="n">vector_norm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">factor</span><span class="p">,</span> <span class="n">vector_norm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">factor</span><span class="p">,</span>
      <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span>
      <span class="n">linestyle</span> <span class="o">=</span> <span class="n">linestyle</span>
 <span class="p">)</span>

 <span class="c1"># Create ws and plot sample shape as previously described</span>

<span class="sd">&#39;&#39;&#39;Add arrow along beam direction&#39;&#39;&#39;</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getSource</span><span class="p">()</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getSample</span><span class="p">()</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span> <span class="o">-</span> <span class="n">source</span>
<span class="n">arrow</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.04</span><span class="p">))</span>

<span class="sd">&#39;&#39;&#39;Calculate Lattice Vectors&#39;&#39;&#39;</span>
<span class="n">SetUB</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">sample</span><span class="o">.</span><span class="n">hasOrientedLattice</span><span class="p">():</span>
   <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;There is no valid lattice&quot;</span><span class="p">)</span>
<span class="n">UB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span><span class="o">.</span><span class="n">getOrientedLattice</span><span class="p">()</span><span class="o">.</span><span class="n">getUB</span><span class="p">())</span>
<span class="n">hkl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]])</span>
<span class="n">QSample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">UB</span><span class="p">,</span><span class="n">hkl</span><span class="p">)</span>
<span class="n">Goniometer</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getRun</span><span class="p">()</span><span class="o">.</span><span class="n">getGoniometer</span><span class="p">()</span><span class="o">.</span><span class="n">getR</span><span class="p">()</span>
<span class="n">reciprocal_lattice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">Goniometer</span><span class="p">,</span><span class="n">QSample</span><span class="p">)</span><span class="c1">#QLab</span>
<span class="n">real_lattice</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">reciprocal_lattice</span><span class="p">))</span>

<span class="sd">&#39;&#39;&#39;Add arrows for real and reciprocal lattice vectors&#39;&#39;&#39;</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="c1"># plot real_lattice with &#39;-&#39; solid linestyle</span>
   <span class="n">arrow</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">real_lattice</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="c1"># plot reciprocal_lattice with &#39;--&#39; dashed linestyle</span>
   <span class="n">arrow</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">reciprocal_lattice</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../plotting/MeshPlotHelp-4.py">Source code</a>, <a class="reference external" href="../plotting/MeshPlotHelp-4.png">png</a>, <a class="reference external" href="../plotting/MeshPlotHelp-4.hires.png">hires.png</a>, <a class="reference external" href="../plotting/MeshPlotHelp-4.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/MeshPlotHelp-4.png" src="../_images/MeshPlotHelp-4.png" />
</div>
</div>
<div class="section" id="set-mesh-axes-equal">
<h2><a class="toc-backref" href="#id5"><code class="docutils literal"><span class="pre">set_mesh_axes_equal()</span></code></a><a class="headerlink" href="#set-mesh-axes-equal" title="Permalink to this headline">¶</a></h2>
<p>To centre the axes on the mesh and to set the aspect ratio equal, simply provide
the mesh of the largest object on your plot. If you want to add arrows to your plot,
you probably want to call <code class="docutils literal"><span class="pre">set_mesh_axes_equal()</span></code> first.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mesh</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">getMesh</span><span class="p">()</span>
<span class="n">mesh_polygon</span> <span class="o">=</span> <span class="n">Poly3DCollection</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">facecolors</span> <span class="o">=</span> <span class="n">facecolors</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="s1">&#39;mantid3d&#39;</span><span class="p">})</span>
<span class="n">axes</span><span class="o">.</span><span class="n">add_collection3d</span><span class="p">(</span><span class="n">mesh_polygon</span><span class="p">)</span>

<span class="n">axes</span><span class="o">.</span><span class="n">set_mesh_axes_equal</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="c1"># then add arrows as desired</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>Other Plotting Documentation</strong></p>
<ul class="simple">
<li><a class="reference internal" href="index.html#plotting"><span class="std std-ref">Matplotlib in Mantid</span></a></li>
<li><a class="reference external" href="https://matplotlib.org/3.1.1/users/navigation_toolbar.html#navigation-keyboard-shortcuts">Matplotlib Keyboard Shortcuts</a></li>
<li>See <a class="reference internal" href="index.html#plotting"><span class="std std-ref">here</span></a> for custom color cycles and colormaps</li>
</ul>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="3DPlotsHelp.html" title="Previous Chapter: 3D Plots: Surface and Wireframe"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 3D Plots: Sur...</span>
    </a>
  </li>
  <li>
    <a href="../release/index.html" title="Next Chapter: Release Notes"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Release Notes &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>