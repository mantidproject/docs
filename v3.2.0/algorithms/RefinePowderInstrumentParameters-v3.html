<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>RefinePowderInstrumentParameters v3</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="ReflectometryReductionOne v1" href="ReflectometryReductionOne-v1.html" />
    <link rel="prev" title="RefinePowderDiffProfileSeq v1" href="RefinePowderDiffProfileSeq-v1.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.2</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="refinepowderinstrumentparameters-v3">
<span id="algm-refinepowderinstrumentparameters"></span><span id="algm-refinepowderinstrumentparameters-v3"></span><h1>RefinePowderInstrumentParameters v3<a class="headerlink" href="#refinepowderinstrumentparameters-v3" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/RefinePowderInstrumentParameters-v3_dlg.png"><img alt="../_images/RefinePowderInstrumentParameters-v3_dlg.png" class="screenshot" src="../_images/RefinePowderInstrumentParameters-v3_dlg.png" style="width: 296px;" /></a>
<p class="caption"><strong>RefinePowderInstrumentParameters</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a><ul>
<li><a class="reference internal" href="#mathematics" id="id4">Mathematics</a></li>
<li><a class="reference internal" href="#refinement-algorithm" id="id5">Refinement Algorithm</a><ul>
<li><a class="reference internal" href="#directfit" id="id6">DirectFit</a></li>
<li><a class="reference internal" href="#montecarlo" id="id7">MonteCarlo</a></li>
<li><a class="reference internal" href="#constraint" id="id8">Constraint</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use-algorithm-with-other-algorithms" id="id9">How to use algorithm with other algorithms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id10">Usage</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Parameters include Dtt1, Dtt1t, Dtt2t, Zero, Zerot.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="4%" />
<col width="10%" />
<col width="9%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputPeakPositionWorkspace</td>
<td>Input</td>
<td>Workspace2D</td>
<td>Mandatory</td>
<td>Data workspace containing workspace positions in TOF agains dSpacing.</td>
</tr>
<tr class="row-odd"><td>WorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Workspace Index of the peak positions in PeakPositionWorkspace.</td>
</tr>
<tr class="row-even"><td>OutputPeakPositionWorkspace</td>
<td>Output</td>
<td>Workspace2D</td>
<td>&nbsp;</td>
<td>Output data workspace containing refined workspace positions in TOF agains dSpacing.</td>
</tr>
<tr class="row-odd"><td>InputInstrumentParameterWorkspace</td>
<td>Input</td>
<td>TableWorkspace</td>
<td>Mandatory</td>
<td>INput tableWorkspace containg instrument&#8217;s parameters.</td>
</tr>
<tr class="row-even"><td>OutputInstrumentParameterWorkspace</td>
<td>Output</td>
<td>TableWorkspace</td>
<td>&nbsp;</td>
<td>Output tableworkspace containing instrument&#8217;s fitted parameters.</td>
</tr>
<tr class="row-odd"><td>RefinementAlgorithm</td>
<td>Input</td>
<td>string</td>
<td>MonteCarlo</td>
<td>Algorithm to refine the instrument parameters.</td>
</tr>
<tr class="row-even"><td>RandomWalkSteps</td>
<td>Input</td>
<td>number</td>
<td>10000</td>
<td>Number of Monte Carlo random walk steps.</td>
</tr>
<tr class="row-odd"><td>MonteCarloRandomSeed</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Random seed for Monte Carlo simulation.</td>
</tr>
<tr class="row-even"><td>StandardError</td>
<td>Input</td>
<td>string</td>
<td>ConstantValue</td>
<td>Algorithm to calculate the standard error of peak positions.</td>
</tr>
<tr class="row-odd"><td>Damping</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Damping factor for (1) minimizer &#8216;damping&#8217;. (2) Monte Calro.</td>
</tr>
<tr class="row-even"><td>AnnealingTemperature</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Starting aneealing temperature.</td>
</tr>
<tr class="row-odd"><td>MonteCarloIterations</td>
<td>Input</td>
<td>number</td>
<td>100</td>
<td>Number of iterations in Monte Carlo random walk.</td>
</tr>
<tr class="row-even"><td>ChiSquare</td>
<td>Output</td>
<td>number</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm refines the instrumental geometry parameters for powder
diffractomers. The parameters that can be refined are Dtt1, Zero, Dtt1t,
Dtt2t, Zerot, Width and Tcross.</p>
<p>It serves as the second step to fit/refine instrumental parameters that
will be introduced in Le Bail Fit. It uses the outcome from algorithm
FitPowderDiffPeaks().</p>
<div class="section" id="mathematics">
<h3><a class="toc-backref" href="#id4">Mathematics</a><a class="headerlink" href="#mathematics" title="Permalink to this headline">¶</a></h3>
<p>The function to fit is</p>
<div class="math">
<p><img src="../_images/math/05d1b21ae11141aa5a6806c6492d0ee1e543fd9b.png" alt="TOF\_h = n(Zero + Dtt1\cdot d) + (1-n)(Zerot + Dtt1t\cdot d + Dtt2t/d)"/></p>
</div><div class="math">
<p><img src="../_images/math/0aabff5bae2df4aae0a28e0df7afe33e14c7eaec.png" alt="n = 1/2 erfc(W\cdot (1-Tcross/d))"/></p>
</div><p>The coefficients in this function are strongly correlated to each other.</p>
</div>
<div class="section" id="refinement-algorithm">
<h3><a class="toc-backref" href="#id5">Refinement Algorithm</a><a class="headerlink" href="#refinement-algorithm" title="Permalink to this headline">¶</a></h3>
<p>Two refinement algorithms, DirectFit and MonteCarlo, are provided.</p>
<div class="section" id="directfit">
<h4><a class="toc-backref" href="#id6">DirectFit</a><a class="headerlink" href="#directfit" title="Permalink to this headline">¶</a></h4>
<p>This is a simple one step fitting. If there is one parameter to fit,
Levenberg Marquart minimizer is chosen. As its coefficients are strongly
correlated to each other, Simplex minimizer is used if there are more
than 1 parameter to fit.</p>
</div>
<div class="section" id="montecarlo">
<h4><a class="toc-backref" href="#id7">MonteCarlo</a><a class="headerlink" href="#montecarlo" title="Permalink to this headline">¶</a></h4>
<p>This adopts the concept of Monte Carlo random walk in the parameter
space. In each MC step, one parameter will be chosen, and a new value is
proposed for it. A constraint fitting by Simplex minimizer is used to
fit the coefficients in new configuration.</p>
<p>Simulated annealing will be tried as soon as it is implemented in
Mantid.</p>
</div>
<div class="section" id="constraint">
<h4><a class="toc-backref" href="#id8">Constraint</a><a class="headerlink" href="#constraint" title="Permalink to this headline">¶</a></h4>
<p>In future, constaint will be considered.</p>
</div>
</div>
<div class="section" id="how-to-use-algorithm-with-other-algorithms">
<h3><a class="toc-backref" href="#id9">How to use algorithm with other algorithms</a><a class="headerlink" href="#how-to-use-algorithm-with-other-algorithms" title="Permalink to this headline">¶</a></h3>
<p>This algorithm is designed to work with other algorithms to do Le Bail
fit. The introduction can be found in the wiki page of
<a class="reference internal" href="LeBailFit-v1.html#algm-lebailfit"><em>LeBailFit v1</em></a>.</p>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id10">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Diffraction.html">Diffraction</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014, Mantid.<br/>
    </p>
  </div>
</footer>
  </body>
</html>