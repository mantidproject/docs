<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>CubicSpline</title>
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DampedBessel" href="DampedBessel.html" />
    <link rel="prev" title="CrystalFieldSusceptibility" href="CrystalFieldSusceptibility.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Fit Functions</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">CubicSpline</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="cubicspline">
<span id="func-cubicspline"></span><h1>CubicSpline<a class="headerlink" href="#cubicspline" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<span id="index-0"></span><h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This function creates spline of order 3 using the set of points and interpolates
the input between them taking into account the least-squares fit</p>
<p>First and second derivatives from the spline can be calculated by using
the derivative1D function.</p>
<p>A CubicSpline is a polynomial function <span class="math">\(f(x)\)</span> of order 3, defined between an interval <span class="math">\(a \leqslant x \leqslant b\)</span>.
When using CubicSplines for interpolation or for fitting, we essentially chain <a class="reference internal" href="BSpline.html#func-bspline"><span class="std std-ref">BSplines</span></a>
of order 3 together so that each spline passes through the breakpoints in that interval.</p>
<p>A Cubic Spline is a specific case of <a class="reference internal" href="BSpline.html#func-bspline"><span class="std std-ref">BSpline</span></a>
that only uses polynomials of order 3 to define the spline functions.</p>
<p>Again, as with <a class="reference internal" href="BSpline.html#func-bspline"><span class="std std-ref">BSplines</span></a> , there are certain conditions
that must be fulfilled at each breakpoint such that the overall Spline is piecewise-smooth.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>To demonstrate these conditions we can set up a basic CubicSpline with 3 breakpoints:</p>
<p>Our CubicSpline will be defined as the following:</p>
<p>Breakpoints : <span class="math">\(x_0, x_1, x_2\)</span></p>
<div class="math">
\[\begin{split}C(x) =
                            \begin{cases}
                              f_1(x)&amp; x_0 \leq x \leq x_1 \\
                              f_2(x)&amp; x_1 \leq x \leq x_2 \\
                            \end{cases}\end{split}\]</div>
<p>Our piecewise functions can be written as <span class="math">\(f_1(x) = c_0x^3 + c_1x^2 + c_2x + c_3\)</span> and <span class="math">\(f_2(x) = c_4x^3 + c_5x^2 + c_6x + c_7\)</span></p>
<p>To make our CubicSpline piecewise-smooth we must ensure that these conditions are satisfied:</p>
<div class="math">
\[\begin{split}f_1(x_0) = y_0\\
f_2(x_2) = y_2\\
\frac{df_1}{dx}(x_1) = \frac{df_2}{dx}(x_1)\\
\frac{d^2 f_1}{dx^2}(x_1) = \frac{d^2 f_2}{dx^2}(x_1)\\\end{split}\]</div>
<p>This point of smoothness is represented by the red circle in the graph below of our CubicSpline function <span class="math">\(C(x)\)</span></p>
<a class="reference internal image-reference" href="../../_images/CubicSplineExample.png"><img alt="quadratic example of BSpline" class="align-center" src="../../_images/CubicSplineExample.png" style="width: 800px; height: 600px;" /></a>
</div>
<div class="section" id="cubicsplines-and-fitting">
<h2>CubicSplines and Fitting<a class="headerlink" href="#cubicsplines-and-fitting" title="Permalink to this headline">¶</a></h2>
<p>Fitting using a CubicSpline fit function is different to interpolating with a CubicSpline as it requires the number of breakpoints
to be less than the number of data points. This allows the CubicSpline to fit as close as possible to the dataset using a least-squares fit
instead of passing through all data points as with interpolation. The fitted curve will pass through the breakpoints however it may not pass through
all of the data points in the set.</p>
<p>A example of fitting with a CubicSpline has been provided below, with the breakpoints highlighted in green.
The original data plot is in black and our fitted CubicSpline with four breakpoints is in red.</p>
<a class="reference internal image-reference" href="../../_images/BSplineFittingExample.png"><img alt="fitting example using BSplines" class="align-center" src="../../_images/BSplineFittingExample.png" style="width: 800px; height: 600px;" /></a>
</div>
<div class="section" id="attributes-non-fitting-parameters">
<h2>Attributes (non-fitting parameters)<a class="headerlink" href="#attributes-non-fitting-parameters" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="15%" />
<col width="5%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>n</td>
<td>Integer</td>
<td>3</td>
<td>Number of breakpoints in Spline</td>
</tr>
<tr class="row-odd"><td>x0</td>
<td>Double</td>
<td>-</td>
<td>Position of first exterior breakpoint</td>
</tr>
<tr class="row-even"><td>x1</td>
<td>Double</td>
<td>-</td>
<td>Position of the interior breakpoint</td>
</tr>
<tr class="row-odd"><td>x2</td>
<td>Double</td>
<td>-</td>
<td>Position of the last exterior breakpoint</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="properties-fitting-parameters">
<h2>Properties (fitting parameters)<a class="headerlink" href="#properties-fitting-parameters" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="49%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>y0</td>
<td>0.0</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>y1</td>
<td>0.0</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>y2</td>
<td>0.0</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p>Even though the number of fitting parameters is set to 3 by default, this number is based off <span class="math">\(N + K - 2\)</span>.
Where <span class="math">\(N\)</span> is the number of breakpoints in the fit, <span class="math">\(K\)</span> is the order of the spline (stays as 3 for the cubic spline case) and the <span class="math">\(-2\)</span>
accounts for our two exterior breakpoints <span class="math">\(x_0, x_n\)</span>.
Increasing the number of breakpoints in your fit will increase the number of fitting parameters by the same amount.</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/FitFunctions.html">FitFunctions</a> | <a class="reference external" href="categories/Background.html">Background</a></p>
</div>
<div class="section" id="source">
<h2>Source<a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/7cec3a047fd2864c82ac0280d76fe566152576ec/Framework/CurveFitting/inc/MantidCurveFitting/Functions/CubicSpline.h">CubicSpline.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/7cec3a047fd2864c82ac0280d76fe566152576ec/Framework/CurveFitting/src/Functions/CubicSpline.cpp">CubicSpline.cpp</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="CrystalFieldSusceptibility.html" title="Previous Chapter: CrystalFieldSusceptibility"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; CrystalFieldS...</span>
    </a>
  </li>
  <li>
    <a href="DampedBessel.html" title="Next Chapter: DampedBessel"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">DampedBessel &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>