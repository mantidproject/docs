<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>ProfileChiSquared1D v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ProjectMD v1" href="ProjectMD-v1.html" />
    <link rel="prev" title="ProcessIndirectFitParameters v1" href="ProcessIndirectFitParameters-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">ProfileChiSquared1D v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="profilechisquared1d-v1">
<span id="algm-profilechisquared1d"></span><span id="algm-profilechisquared1d-v1"></span><h1>ProfileChiSquared1D v1<a class="headerlink" href="#profilechisquared1d-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/ProfileChiSquared1D-v1_dlg.png"><img alt="../_images/ProfileChiSquared1D-v1_dlg.png" class="screenshot" src="../_images/ProfileChiSquared1D-v1_dlg.png" style="width: 302px;" /></a>
<p class="caption"><span class="caption-text"><strong>ProfileChiSquared1D</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a></li>
<li><a class="reference internal" href="#references" id="id6">References</a></li>
<li><a class="reference internal" href="#source" id="id7">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Profiles chi squared about its minimum to obtain parameter errors for the input function.</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="CalculateChiSquared-v1.html#algm-calculatechisquared"><span class="std std-ref">CalculateChiSquared</span></a>, <a class="reference internal" href="Fit-v1.html#algm-fit"><span class="std std-ref">Fit</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="1%" />
<col width="6%" />
<col width="3%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Function</td>
<td>InOut</td>
<td>Function</td>
<td><em>Mandatory</em></td>
<td>Parameters defining the fitting function and its initial values</td>
</tr>
<tr class="row-odd"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><span class="std std-ref">Workspace</span></a></td>
<td><em>Mandatory</em></td>
<td>Name of the input Workspace</td>
</tr>
<tr class="row-even"><td>IgnoreInvalidData</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Flag to ignore infinities, NaNs and data with zero errors.</td>
</tr>
<tr class="row-odd"><td>DomainType</td>
<td>Input</td>
<td>string</td>
<td>Simple</td>
<td>The type of function domain to use: Simple, Sequential, or Parallel. Allowed values: [‘Simple’, ‘Sequential’, ‘Parallel’]</td>
</tr>
<tr class="row-even"><td>EvaluationType</td>
<td>Input</td>
<td>string</td>
<td>CentrePoint</td>
<td>The way the function is evaluated on histogram data sets. If value is “CentrePoint” then function is evaluated at centre of each bin. If it is “Histogram” then function is integrated within the bin and the integrals returned. Allowed values: [‘CentrePoint’, ‘Histogram’]</td>
</tr>
<tr class="row-odd"><td>StepSizeMethod</td>
<td>Input</td>
<td>string</td>
<td>Default</td>
<td>The way the step size is calculated for numerical derivatives. See the section about step sizes in the Fit algorithm documentation to understand the difference between “Default” and “Sqrt epsilon”. Allowed values: [‘Default’, ‘Sqrt epsilon’]</td>
</tr>
<tr class="row-even"><td>PeakRadius</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>A value of the peak radius the peak functions should use. A peak radius defines an interval on the x axis around the centre of the peak where its values are calculated. Values outside the interval are not calculated and assumed zeros.Numerically the radius is a whole number of peak widths (FWHM) that fit into the interval on each side from the centre. The default value of 0 means the whole x axis.</td>
</tr>
<tr class="row-odd"><td>Output</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>A base name for output workspaces.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm explores the surface of the <span class="math">\(\chi^{2}\)</span> around its minimum and estimates the standard deviations for the parameters.
The value of the output property is a base name for two output table workspaces: ‘&lt;Output&gt;_errors’ and ‘&lt;Output&gt;_pdf’.
The former workspace contains parameter error estimates and the latter shows <span class="math">\(\chi^{2}\)</span>‘s 1d slices along each parameter.</p>
<p>The procedure for calculating errors of parameters is described in Chapter 15 of Numerical recipes in C [1] and Chapter 9
of Statistical Data Analysis [2]. Here, we summarise the main results.</p>
<p>Consider the input dataset <span class="math">\(D_0\)</span>, with fit parameters <span class="math">\(\mathbf a_0\)</span>. Assuming Gaussian noise in the data, it is possible
to create <span class="math">\(n\)</span> artificial datasets <span class="math">\(D_j\)</span> for <span class="math">\(j=1,2,..,n\)</span>. If we were to run the fit on each dataset,
a set of parameters <span class="math">\(\mathbf a_j\)</span> would be obtained. The distribution of these parameters,
about our original parameter set <span class="math">\(\delta \mathbf a =  \mathbf a_j - \mathbf a_0\)</span> is described by the multivariate normal distribution,</p>
<div class="math">
\[P(\delta \mathbf a ) \propto exp (-\Delta \chi^2)\]</div>
<p>where <span class="math">\(\Delta \chi^2=\chi^2(\mathbf a_J) - \chi^2(\mathbf a_0)\)</span>, is the difference between the chi squared statistics obtained for each parameter set,</p>
<div class="math">
\[\Delta \chi^2 = \sum_{i \in D_0} \left ( \frac{y_i -f(x_i;\mathbf a_J)}{\sigma_i}\right)^2 - \left ( \frac{y_i -f(x_i;\mathbf a_0)}{\sigma_i}\right)^2\]</div>
<p>If we consider the variation of a single parameter <span class="math">\(a_k\)</span>, while the other parameters are the values that minimize <span class="math">\(\chi^2\)</span>,
the quantity <span class="math">\(\Delta \chi^2\)</span> will be distributed as a chi squared distributed, <span class="math">\(f_{\chi^2}(x; \nu)\)</span> with 1 degree of freedom,
<span class="math">\(\nu=1\)</span>. From this distribution, the probability of finding increases less than <span class="math">\(\Delta \chi^2\)</span> can be found from the integral,</p>
<div class="math">
\[p = P(X &lt; \Delta \chi^2 ) = \int_0^{\Delta \chi^2} f_{\chi^2}(x; 1) dx\]</div>
<p>where <span class="math">\(p\)</span> is the desired confidence level. For instance, if we consider a confidence level of <span class="math">\(p=68.3\%\)</span> (1-sigma),
we find a critical value for the chi squared fluctuation of <span class="math">\(\Delta \chi^2 &lt; 1\)</span>. From this desired confidence level,
we can then calculate the parameter variation, (<span class="math">\(\sigma_{left}\)</span>, <span class="math">\(\sigma_{right}\)</span>), that increases chi squared by 1
and obtain a <span class="math">\(68.3\%\)</span> confidence interval for the single parameter <span class="math">\(a_k\)</span>:</p>
<div class="math">
\[P( a_k - \sigma_{left} &lt; a_k &lt;  a_k + \sigma_{right}) = 68.3\%\]</div>
<p>This algorithm obtains the 1-sigma confidence level by varying a single parameter at a time and recording the extremums
of the values that increase <span class="math">\(\chi^2\)</span> by <span class="math">\(1\)</span>. The results are outputted in the table ‘&lt;Output&gt;_errors’,
which reports the left and right 1-sigma errors. This procedure is repeated for 2-sigma and 3-sigma,
with the results displayed in the columns (2-sigma) and (3-sigma). An additional value is also reported, termed the quadratic error.
This is the 1-sigma error obtained from a Taylor expansion of the chi squared function about its minimum:</p>
<div class="math">
\[\chi^2(\mathbf a + \delta \mathbf a) = \chi^2(\mathbf a)_{min} + \delta \mathbf a^T  \mathbf C \delta \mathbf a\]</div>
<p>where <span class="math">\(\mathbf{C}\)</span> is the covariance matrix obtained from least squares fitting of the data, see the <a class="reference internal" href="Fit-v1.html#algm-fit"><span class="std std-ref">Fitting</span></a> documentation for further details.
For a linear model (or approximately linear model) the quadratic error should be equal to the left and right errors, i.e it will be symmetric.
This can be seen in the following example</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mantid.simpleapi</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c1"># create the data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># run the fit</span>
<span class="n">func</span> <span class="o">=</span> <span class="s2">&quot;name=LinearBackground, A0=1, A1=2&quot;</span><span class="p">;</span>
<span class="n">func_</span> <span class="o">=</span> <span class="n">FunctionFactory</span><span class="o">.</span><span class="n">Instance</span><span class="p">()</span><span class="o">.</span><span class="n">createInitialized</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

<span class="n">fit_output</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">Function</span><span class="o">=</span><span class="n">func_</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s2">&quot;LinearFit&quot;</span><span class="p">)</span>
<span class="n">a0_fit</span> <span class="o">=</span> <span class="n">fit_output</span><span class="o">.</span><span class="n">OutputParameters</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">a1_fit</span> <span class="o">=</span> <span class="n">fit_output</span><span class="o">.</span><span class="n">OutputParameters</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># explore the chi squared profile for the fit parameters</span>
<span class="n">fitted_func</span> <span class="o">=</span> <span class="s2">&quot;name=LinearBackground, A0={}, A1={}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a0_fit</span><span class="p">,</span> <span class="n">a1_fit</span><span class="p">);</span>
<span class="n">ProfileChiSquared1D</span><span class="p">(</span><span class="n">fitted_func</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s2">&quot;LinearProfile&quot;</span><span class="p">)</span>

<span class="c1"># print left and right errors of parameters</span>
<span class="c1"># you should note that they are approx equal to the quadratic error for this linear model</span>
<span class="n">error_table</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s2">&quot;LinearProfile_errors&quot;</span><span class="p">]</span>
<span class="n">lerror_a0</span> <span class="o">=</span> <span class="n">error_table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rerror_a0</span><span class="o">=</span> <span class="n">error_table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">qerror_a0</span> <span class="o">=</span> <span class="n">error_table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">9</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;1-sigma error bounds of A0 are {} and {}, with quadratic estimate {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lerror_a0</span><span class="p">,</span> <span class="n">rerror_a0</span><span class="p">,</span> <span class="n">qerror_a0</span><span class="p">))</span>

<span class="n">lerror_a1</span> <span class="o">=</span> <span class="n">error_table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">rerror_a1</span><span class="o">=</span> <span class="n">error_table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">4</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">qerror_a1</span> <span class="o">=</span> <span class="n">error_table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">9</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;1-sigma error bounds of A1 are {} and {}, with quadratic estimate {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lerror_a1</span><span class="p">,</span> <span class="n">rerror_a1</span><span class="p">,</span> <span class="n">qerror_a1</span><span class="p">))</span>
</pre></div>
</div>
<p>For a non-linear model, it’s possible that the left and right variances will not be equal, leading to an asymmetric error.
This is shown in the example below:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># import mantid algorithms, numpy and matplotlib</span>
<span class="kn">from</span> <span class="nn">mantid.simpleapi</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>


<span class="c1"># create decaying exponential data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">3.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># run the fit</span>
<span class="n">func</span> <span class="o">=</span> <span class="s2">&quot;name=ExpDecay,Height=3.0, Lifetime=0.5&quot;</span><span class="p">;</span>
<span class="n">func_</span> <span class="o">=</span> <span class="n">FunctionFactory</span><span class="o">.</span><span class="n">Instance</span><span class="p">()</span><span class="o">.</span><span class="n">createInitialized</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

<span class="n">fit_output</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">Function</span><span class="o">=</span><span class="n">func_</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s2">&quot;ExpFit&quot;</span><span class="p">)</span>
<span class="n">height_fit</span> <span class="o">=</span> <span class="n">fit_output</span><span class="o">.</span><span class="n">OutputParameters</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">lifetime_fit</span> <span class="o">=</span> <span class="n">fit_output</span><span class="o">.</span><span class="n">OutputParameters</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># explore the chi squared profile for the fit parameters</span>
<span class="n">fitted_func</span> <span class="o">=</span> <span class="s2">&quot;name=ExpDecay, Height={}, Lifetime={}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">height_fit</span><span class="p">,</span> <span class="n">lifetime_fit</span><span class="p">);</span>
<span class="n">ProfileChiSquared1D</span><span class="p">(</span><span class="n">fitted_func</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">Output</span><span class="o">=</span><span class="s2">&quot;ExpProfile&quot;</span><span class="p">)</span>

<span class="c1"># print left and right errors of parameters</span>
<span class="c1"># you should note that they differ from the quadratic errors</span>
<span class="n">error_table</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s2">&quot;ExpProfile_errors&quot;</span><span class="p">]</span>
<span class="n">lerror_height</span> <span class="o">=</span> <span class="n">error_table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rerror_height</span><span class="o">=</span> <span class="n">error_table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">qerror_height</span> <span class="o">=</span> <span class="n">error_table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">9</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;1-sigma error bounds of Height are {} and {}, with quadratic estimate {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lerror_height</span><span class="p">,</span> <span class="n">rerror_height</span><span class="p">,</span> <span class="n">qerror_height</span><span class="p">))</span>

<span class="n">lerror_lifetime</span> <span class="o">=</span> <span class="n">error_table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">rerror_lifetime</span><span class="o">=</span> <span class="n">error_table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">4</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">qerror_lifetime</span> <span class="o">=</span> <span class="n">error_table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">9</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;1-sigma error bounds of Lifetime are {} and {}, with quadratic estimate {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lerror_lifetime</span><span class="p">,</span> <span class="n">rerror_lifetime</span><span class="p">,</span> <span class="n">qerror_lifetime</span><span class="p">))</span>
</pre></div>
</div>
<p>For each problem, the error table has the following columns:</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Column</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Parameter</td>
<td>Parameter name</td>
</tr>
<tr class="row-odd"><td>Value</td>
<td>Parameter value passed with the Function property</td>
</tr>
<tr class="row-even"><td>Value at Min</td>
<td>The minimum point of the 1d slice of the <span class="math">\(\chi^{2}\)</span>. If the Function is at the minimum then
Value at Min should be equal to Value.</td>
</tr>
<tr class="row-odd"><td>Left Error (1-sigma)</td>
<td>The negative deviation from the minimum point equivalent to <span class="math">\(1\sigma\)</span>. Estimated from analisys
of the surface.</td>
</tr>
<tr class="row-even"><td>Right Error (1-sigma)</td>
<td>The positive deviation from the minimum point equivalent to <span class="math">\(1\sigma\)</span>. Estimated from analisys
of the surface.</td>
</tr>
<tr class="row-odd"><td>Left Error (2-sigma)</td>
<td>The negative deviation from the minimum point equivalent to <span class="math">\(2\sigma\)</span>. Estimated from analisys
of the surface.</td>
</tr>
<tr class="row-even"><td>Right Error (2-sigma)</td>
<td>The positive deviation from the minimum point equivalent to <span class="math">\(2\sigma\)</span>. Estimated from analisys
of the surface.</td>
</tr>
<tr class="row-odd"><td>Left Error (3-sigma)</td>
<td>The negative deviation from the minimum point equivalent to <span class="math">\(3\sigma\)</span>. Estimated from analisys
of the surface.</td>
</tr>
<tr class="row-even"><td>Right Error (3-sigma)</td>
<td>The positive deviation from the minimum point equivalent to <span class="math">\(3\sigma\)</span>. Estimated from analisys
of the surface.</td>
</tr>
<tr class="row-odd"><td>Quadratic Error</td>
<td><span class="math">\(1\sigma\)</span> standard deviation in the quadratic approximation of the surface.</td>
</tr>
</tbody>
</table>
<p>This algorithm also reports a probability density function (PDF) for each parameter, stored in the ‘&lt;Output&gt;_pdf’ table.
This PDF is found from Eq. (1), which relates the increase in chi squared, to the probability of the parameter variation.
The pdf table also contains slices of the <span class="math">\(\chi^{2}\)</span> along each parameter. It has 3 column per parameter. The first column of the 3
is the parameter values, the second has the <span class="math">\(\chi^{2}\)</span> and the third is the probability density function normalised to
have 1 at the maximum. Plotting the second column of each parameter will show the change in <span class="math">\(\chi^{2}\)</span> with respect to
the parameter value.</p>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id6">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>[1] William H. Press, Saul A. Teukolsky, William T. Vetterling, and Brian P. Flannery. 1992.
Numerical recipes in C (2nd ed.): the art of scientific computing. Cambridge University Press, USA.</p>
<p>[2] G. Cowan, Statistical Data Analysis, Clarendon, Oxford, 1998</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Optimization.html">Optimization</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id7">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/7cec3a047fd2864c82ac0280d76fe566152576ec/Framework/CurveFitting/inc/MantidCurveFitting/Algorithms/ProfileChiSquared1D.h">ProfileChiSquared1D.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/7cec3a047fd2864c82ac0280d76fe566152576ec/Framework/CurveFitting/src/Algorithms/ProfileChiSquared1D.cpp">ProfileChiSquared1D.cpp</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="ProcessIndirectFitParameters-v1.html" title="Previous Chapter: ProcessIndirectFitParameters v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; ProcessIndire...</span>
    </a>
  </li>
  <li>
    <a href="ProjectMD-v1.html" title="Next Chapter: ProjectMD v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">ProjectMD v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>