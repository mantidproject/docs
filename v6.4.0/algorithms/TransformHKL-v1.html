<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>TransformHKL v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TransformMD v1" href="TransformMD-v1.html" />
    <link rel="prev" title="TotScatCalculateSelfScattering v1" href="TotScatCalculateSelfScattering-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">TransformHKL v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="transformhkl-v1">
<span id="algm-transformhkl"></span><span id="algm-transformhkl-v1"></span><h1>TransformHKL v1<a class="headerlink" href="#transformhkl-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/TransformHKL-v1_dlg.png"><img alt="../_images/TransformHKL-v1_dlg.png" class="screenshot" src="../_images/TransformHKL-v1_dlg.png" style="width: 404px;" /></a>
<p class="caption"><span class="caption-text"><strong>TransformHKL</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a></li>
<li><a class="reference internal" href="#usage" id="id6">Usage</a></li>
<li><a class="reference internal" href="#source" id="id7">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Specify a 3x3 matrix to apply to (HKL) vectors as a list of 9 comma separated numbers. Both the UB and HKL values will be updated</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="SortHKL-v1.html#algm-sorthkl"><span class="std std-ref">SortHKL</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="4%" />
<col width="9%" />
<col width="10%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>PeaksWorkspace</td>
<td>InOut</td>
<td>IPeaksWorkspace</td>
<td><em>Mandatory</em></td>
<td>Input Peaks Workspace</td>
</tr>
<tr class="row-odd"><td>Tolerance</td>
<td>Input</td>
<td>number</td>
<td>0.15</td>
<td>Indexing Tolerance (0.15)</td>
</tr>
<tr class="row-even"><td>HKLTransform</td>
<td>Input</td>
<td>dbl list</td>
<td>1,0,0,0,1,0,0,0,1</td>
<td>Specify 3x3 HKL transform matrix as a comma separated list of 9 numbers</td>
</tr>
<tr class="row-odd"><td>FindError</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Whether to obtain the error in the lattice parameters. Set this to false if there are not enough peaks to do an optimization</td>
</tr>
<tr class="row-even"><td>NumIndexed</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Gets set with the number of indexed peaks.</td>
</tr>
<tr class="row-odd"><td>AverageError</td>
<td>Output</td>
<td>number</td>
<td>&#160;</td>
<td>Gets set with the average HKL indexing error.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Given a PeaksWorkspace with a <a class="reference internal" href="../concepts/Lattice.html#lattice"><span class="std std-ref">UB matrix</span></a> stored with
the sample, this algorithm will accept a 3x3 transformation matrix <span class="math">\(M\)</span>,
change <span class="math">\(UB\)</span> to <span class="math">\(UBM^{-1}\)</span> and map each <span class="math">\((HKL)\)</span> vector to <span class="math">\(M(HKL)\)</span>.
For example, the transformation with elements 0,1,0,1,0,0,0,0,-1 will
interchange the <span class="math">\(H\)</span> and <span class="math">\(K\)</span> values and negate <span class="math">\(L\)</span>.
This algorithm should allow
the user to perform any required transformation of the Miller indices,
provided that transformation has a positive determinant. If a transformation
with a negative or zero determinant is entered, the algorithm with throw an
exception. The 9 elements of the transformation must be specified as a
comma separated list of numbers.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id6">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example:</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="o">=</span><span class="n">LoadIsawPeaks</span><span class="p">(</span><span class="s2">&quot;TOPAZ_3007.peaks&quot;</span><span class="p">)</span>
<span class="n">FindUBUsingFFT</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">MinD</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span><span class="n">MaxD</span><span class="o">=</span><span class="mf">13.0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before Transformation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span><span class="o">.</span><span class="n">getOrientedLattice</span><span class="p">()</span><span class="o">.</span><span class="n">getUB</span><span class="p">())</span>

<span class="c1">#This HKLTransform is a matrix that will swap H and K and negate L</span>
<span class="n">TransformHKL</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">HKLTransform</span><span class="o">=</span><span class="s2">&quot;0,1,0,1,0,0,0,0,-1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After Transformation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span><span class="o">.</span><span class="n">getOrientedLattice</span><span class="p">()</span><span class="o">.</span><span class="n">getUB</span><span class="p">())</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Before Transformation:
[[ 0.01223576  0.00480107  0.08604016]
 [-0.11654506  0.00178069 -0.00458823]
 [-0.02737294 -0.08973552 -0.02525994]]

After Transformation:
[[ 0.00480107  0.01223576 -0.08604016]
 [ 0.00178069 -0.11654506  0.00458823]
 [-0.08973552 -0.02737294  0.02525994]]
</pre></div>
</div>
<p><strong>Example - skipping error calculation</strong></p>
<p>In special cases, users may not have enough peaks to find the error.
For example, if peaks are constrained to two dimensions in HKL space,
the error calculation will fail. In this case, <cite>FindError=False</cite> can be
specified to skip the calculation. In this case, the lattice parameter
error will be set to zero.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreatePeaksWorkspace</span><span class="p">(</span><span class="n">OutputType</span><span class="o">=</span><span class="s1">&#39;LeanElasticPeak&#39;</span><span class="p">,</span> <span class="n">NumberOfPeaks</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">SetUB</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>

<span class="n">ws</span><span class="o">.</span><span class="n">addPeak</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">createPeakHKL</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="n">ws</span><span class="o">.</span><span class="n">addPeak</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">createPeakHKL</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>

<span class="n">TransformHKL</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">HKLTransform</span><span class="o">=</span><span class="s1">&#39;0,1,0,1,0,0,0,0,-1&#39;</span><span class="p">,</span> <span class="n">FindError</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;peak(0) = &#39;</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getPeak</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getHKL</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;peak(1) = &#39;</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">getPeak</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getHKL</span><span class="p">())</span>

<span class="n">ol</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span><span class="o">.</span><span class="n">getOrientedLattice</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;ea = &#39;</span><span class="p">,</span> <span class="n">ol</span><span class="o">.</span><span class="n">errora</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;eb = &#39;</span><span class="p">,</span> <span class="n">ol</span><span class="o">.</span><span class="n">errorb</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;ec = &#39;</span><span class="p">,</span> <span class="n">ol</span><span class="o">.</span><span class="n">errorc</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;ealpha = &#39;</span><span class="p">,</span> <span class="n">ol</span><span class="o">.</span><span class="n">erroralpha</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;ebeta = &#39;</span><span class="p">,</span> <span class="n">ol</span><span class="o">.</span><span class="n">errorbeta</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;egamma = &#39;</span><span class="p">,</span> <span class="n">ol</span><span class="o">.</span><span class="n">errorgamma</span><span class="p">())</span>
</pre></div>
</div>
<p>gives</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>peak(0) =  [2,1,0]
peak(1) =  [0,0,-3]
ea =  0.0
eb =  0.0
ec =  0.0
ealpha =  0.0
ebeta =  0.0
egamma =  0.0
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Crystal/Peaks.html">Crystal\Peaks</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id7">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/7cec3a047fd2864c82ac0280d76fe566152576ec/Framework/Crystal/inc/MantidCrystal/TransformHKL.h">TransformHKL.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/7cec3a047fd2864c82ac0280d76fe566152576ec/Framework/Crystal/src/TransformHKL.cpp">TransformHKL.cpp</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="TotScatCalculateSelfScattering-v1.html" title="Previous Chapter: TotScatCalculateSelfScattering v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; TotScatCalcul...</span>
    </a>
  </li>
  <li>
    <a href="TransformMD-v1.html" title="Next Chapter: TransformMD v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">TransformMD v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>