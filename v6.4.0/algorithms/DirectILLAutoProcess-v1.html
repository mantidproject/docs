<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>DirectILLAutoProcess v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DirectILLCollectData v1" href="DirectILLCollectData-v1.html" />
    <link rel="prev" title="DirectILLApplySelfShielding v1" href="DirectILLApplySelfShielding-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.4</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">DirectILLAutoProcess v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="directillautoprocess-v1">
<span id="algm-directillautoprocess"></span><span id="algm-directillautoprocess-v1"></span><h1>DirectILLAutoProcess v1<a class="headerlink" href="#directillautoprocess-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/DirectILLAutoProcess-v1_dlg.png"><img alt="../_images/DirectILLAutoProcess-v1_dlg.png" class="screenshot" src="../_images/DirectILLAutoProcess-v1_dlg.png" style="width: 349px;" /></a>
<p class="caption"><span class="caption-text"><strong>DirectILLAutoProcess</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a></li>
<li><a class="reference internal" href="#processas" id="id6">ProcessAs</a></li>
<li><a class="reference internal" href="#reductiontype" id="id7">ReductionType</a></li>
<li><a class="reference internal" href="#caching-with-ads" id="id8">Caching with ADS</a></li>
<li><a class="reference internal" href="#saving-output" id="id9">Saving output</a></li>
<li><a class="reference internal" href="#workflows" id="id10">Workflows</a><ul>
<li><a class="reference internal" href="#empty-container" id="id11">Empty container</a></li>
<li><a class="reference internal" href="#vanadium" id="id12">Vanadium</a></li>
<li><a class="reference internal" href="#sample-powder" id="id13">Sample, powder</a></li>
<li><a class="reference internal" href="#sample-single-crystal" id="id14">Sample, single crystal</a></li>
</ul>
</li>
<li><a class="reference internal" href="#source" id="id15">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Performs automatic data reduction for the direct geometry TOF spectrometers at ILL.</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="DirectILLReduction-v1.html#algm-directillreduction"><span class="std std-ref">DirectILLReduction</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="3%" />
<col width="8%" />
<col width="11%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>OutputWorkspace</td>
<td>Output</td>
<td>WorkspaceGroup</td>
<td><em>Mandatory</em></td>
<td>The output workspace group containing reduced data.</td>
</tr>
<tr class="row-odd"><td>Runs</td>
<td>Input</td>
<td>list of str lists</td>
<td><em>Mandatory</em></td>
<td>Run(s) to be processed. Allowed values: [‘nxs’]</td>
</tr>
<tr class="row-even"><td>ProcessAs</td>
<td>Input</td>
<td>string</td>
<td>Sample</td>
<td>Choose the process type. Allowed values: [‘Cadmium’, ‘Empty’, ‘Vanadium’, ‘Sample’]</td>
</tr>
<tr class="row-odd"><td>ReductionType</td>
<td>Input</td>
<td>string</td>
<td>Powder</td>
<td>Choose the appropriate reduction type for the data to process. Allowed values: [‘Powder’, ‘SingleCrystal’]</td>
</tr>
<tr class="row-even"><td>VanadiumWorkspace</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>File(s) or workspaces containing vanadium data.</td>
</tr>
<tr class="row-odd"><td>EmptyContainerWorkspace</td>
<td>Input</td>
<td>WorkspaceGroup</td>
<td>&#160;</td>
<td>Empty container workspace.</td>
</tr>
<tr class="row-even"><td>EmptyContainerScaling</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Scaling factor for the empty container.</td>
</tr>
<tr class="row-odd"><td>CadmiumWorkspace</td>
<td>Input</td>
<td>WorkspaceGroup</td>
<td>&#160;</td>
<td>Cadmium absorber workspace.</td>
</tr>
<tr class="row-even"><td>FlatBkg</td>
<td>Input</td>
<td>string</td>
<td>Flat Bkg AUTO</td>
<td>Control flat background subtraction. Allowed values: [‘Flat Bkg AUTO’, ‘Flat Bkg ON’, ‘Flat Bkg OFF’]</td>
</tr>
<tr class="row-odd"><td>FlatBkgAveragingWindow</td>
<td>Input</td>
<td>number</td>
<td>30</td>
<td>Running average window width (in bins) for flat background.</td>
</tr>
<tr class="row-even"><td>FlatBackgroundSource</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>File(s) or workspaces containing the source to calculate flat background.</td>
</tr>
<tr class="row-odd"><td>FlatBkgScaling</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Flat background multiplication factor.</td>
</tr>
<tr class="row-even"><td>AbsoluteUnitsNormalisation</td>
<td>Input</td>
<td>string</td>
<td>Absolute Units OFF</td>
<td>Enable or disable normalisation to absolute units. Allowed values: [‘Absolute Units OFF’, ‘Absolute Units ON’]</td>
</tr>
<tr class="row-odd"><td>IncidentEnergyCalibration</td>
<td>Input</td>
<td>string</td>
<td>Energy Calibration AUTO</td>
<td>Control the incident energy calibration. Allowed values: [‘Energy Calibration AUTO’, ‘Energy Calibration ON’, ‘Energy Calibration OFF’]</td>
</tr>
<tr class="row-even"><td>IncidentEnergy</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Value for the calibrated incident energy (meV).</td>
</tr>
<tr class="row-odd"><td>ElasticChannel</td>
<td>Input</td>
<td>string</td>
<td>Elastic Channel AUTO</td>
<td>How to acquire the nominal elastic channel. Allowed values: [‘Elastic Channel AUTO’, ‘Default Elastic Channel’, ‘Fit Elastic Channel’]</td>
</tr>
<tr class="row-even"><td>EPPCreationMethod</td>
<td>Input</td>
<td>string</td>
<td>EPP Method AUTO</td>
<td>Method to create the EPP table for detectors (monitor is awlays fitted). Allowed values: [‘EPP Method AUTO’, ‘Fit EPP’, ‘Calculate EPP’]</td>
</tr>
<tr class="row-odd"><td>ElasticChannelIndex</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Bin index value for the centre of the elastic peak. Can be a float.</td>
</tr>
<tr class="row-even"><td>SampleAngleOffset</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Value for the offset parameter in omega scan (degrees).</td>
</tr>
<tr class="row-odd"><td>MaskWorkspace</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>File(s) or workspaces containing the mask.</td>
</tr>
<tr class="row-even"><td>MaskedTubes</td>
<td>Input</td>
<td>long list</td>
<td>&#160;</td>
<td>List of tubes to be masked.</td>
</tr>
<tr class="row-odd"><td>MaskThresholdMin</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Threshold level below which bins will be masked to remove empty / background pixels.</td>
</tr>
<tr class="row-even"><td>MaskThresholdMax</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Threshold level above which bins will be masked to remove noisy pixels.</td>
</tr>
<tr class="row-odd"><td>MaskedAngles</td>
<td>Input</td>
<td>dbl list</td>
<td>&#160;</td>
<td>Mask detectors in the given angular range.</td>
</tr>
<tr class="row-even"><td>MaskWithVanadium</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether to mask using vanadium workspace.</td>
</tr>
<tr class="row-odd"><td>EnergyRebinning</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>Energy rebinning when mixing manual and automatic binning parameters.</td>
</tr>
<tr class="row-even"><td>EnergyRebinningParams</td>
<td>Input</td>
<td>dbl list</td>
<td>&#160;</td>
<td>Manual energy rebinning parameters.</td>
</tr>
<tr class="row-odd"><td>MomentumTransferBinning</td>
<td>Input</td>
<td>dbl list</td>
<td>&#160;</td>
<td>Momentum transfer binning parameters.</td>
</tr>
<tr class="row-even"><td>AbsorptionCorrection</td>
<td>Input</td>
<td>string</td>
<td>None</td>
<td>Choice of approach to absorption correction. Allowed values: [‘None’, ‘Fast’, ‘Full’]</td>
</tr>
<tr class="row-odd"><td>SelfAttenuationMethod</td>
<td>Input</td>
<td>string</td>
<td>MonteCarlo</td>
<td>Choice of calculation method for the attenuation calculation. Allowed values: [‘Numerical’, ‘MonteCarlo’]</td>
</tr>
<tr class="row-even"><td>SampleMaterial</td>
<td>Input</td>
<td>Dictionary</td>
<td>&#160;</td>
<td>Sample material definitions.</td>
</tr>
<tr class="row-odd"><td>SampleGeometry</td>
<td>Input</td>
<td>Dictionary</td>
<td>&#160;</td>
<td>Dictionary for the sample geometry.</td>
</tr>
<tr class="row-even"><td>ContainerMaterial</td>
<td>Input</td>
<td>Dictionary</td>
<td>&#160;</td>
<td>Container material definitions.</td>
</tr>
<tr class="row-odd"><td>ContainerGeometry</td>
<td>Input</td>
<td>Dictionary</td>
<td>&#160;</td>
<td>Dictionary for the container geometry.</td>
</tr>
<tr class="row-even"><td>DetectorGrouping</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>Grouping pattern to reduce the granularity of the output.</td>
</tr>
<tr class="row-odd"><td>GroupDetBy</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Step to use when grouping detectors to reduce the granularity of the output.</td>
</tr>
<tr class="row-even"><td>GroupDetHorizontallyBy</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Step to use when grouping detectors horizontally (between tubes) to increase the statistics for flat background calculation.</td>
</tr>
<tr class="row-odd"><td>GroupDetVerticallyBy</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Step to use when grouping detectors vertically (inside the same tube) to increase the statistics for flat background calculation.</td>
</tr>
<tr class="row-even"><td>ApplyGroupingBy</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether to apply the pixel grouping horizontally or vertically to the data, and not only to increase the statistics of the flat background calculation.</td>
</tr>
<tr class="row-odd"><td>GroupingAngleStep</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>A scattering angle step to which to group detectors, in degrees.</td>
</tr>
<tr class="row-even"><td>GroupingBehaviour</td>
<td>Input</td>
<td>string</td>
<td>Sum</td>
<td>Defines which behaviour should be used when grouping pixels. Allowed values: [‘Sum’, ‘Average’]</td>
</tr>
<tr class="row-odd"><td>SaveOutput</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Whether to save the output directly after processing.</td>
</tr>
<tr class="row-even"><td>ClearCache</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether to clear intermediate workspaces.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithms performs full treatment of <a class="reference internal" href="../techniques/DirectILL.html#directill"><span class="std std-ref">ILL’s time-of-flight</span></a> data recorded with the ILL instruments IN4, IN5, IN6, PANTHER, and SHARP.
This high level algorithm steers the reduction for each sample type and performs the full set of corrections for a given sample run, or set thereof;
measured at one initial energy and one or more temperatures (for powder) and one or more sample angles (for single crystal).</p>
<p>The sample measurement will be corrected for all the effects the user selects and the input is provided for, such as flat background, empty container subtraction, and vanadium normalisation.
The output is transformated to <span class="math">\(S(q,\omega)\)</span> space, and <span class="math">\(S(2\theta,\omega)\)</span>, and can be stored as .nxs and .nxspe files, if requested.</p>
<p>The algorithm is intended to be run multiple times, for each of the available processes (<cite>Cadmium</cite>, <cite>Empty</cite>, <cite>Vanadium</cite>, <cite>Sample</cite>) and each change of initial energy,
and sample geometry and material. Multiple temperatures can be reduced together.</p>
<p>After each execution, a report is printed at the notice level. It contains the numor that was reduced, or the first and last in case of a list, which input workspaces
(from <cite>Cadmium</cite>, <cite>Empty</cite>, <cite>Vanadium</cite>, <cite>MaskWorkspace</cite>) were used, if any, the incident energy, and the sample temperature(s).</p>
</div>
<div class="section" id="processas">
<h2><a class="toc-backref" href="#id6">ProcessAs</a><a class="headerlink" href="#processas" title="Permalink to this headline">¶</a></h2>
<p>Different input properties can be specified depending on the value of <strong>ProcessAs</strong>, as summarized in the table:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="38%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ProcessAs</th>
<th class="head">Input Workspace Properties</th>
<th class="head">Other Input Properties</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Cadmium</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>Empty</td>
<td>&#160;</td>
<td><ul class="first last simple">
<li>FlatBackgroundSource</li>
<li>FlatBackgroundScaling</li>
<li>FlatBkgAveragingWindow</li>
<li>GroupDetHorizontallyBy</li>
<li>GroupDetVerticallyBy</li>
<li>DetectorGrouping</li>
<li>GroupDetBy</li>
<li>IncidentEnergyCalibration</li>
<li>ElasticChannel</li>
<li>IncidentEnergy</li>
<li>ElasticChannel</li>
<li>EPPCreationMethod</li>
<li>ElasticChannelIndex</li>
</ul>
</td>
</tr>
<tr class="row-even"><td>Vanadium</td>
<td><ul class="first last simple">
<li>CadmiumWorkspace</li>
<li>EmptyContainerWorkspace</li>
<li>MaskWorkspace</li>
</ul>
</td>
<td><ul class="first last simple">
<li>all from Empty, and:</li>
<li>AbsorptionCorrection</li>
<li>SelfAttenuationMethod</li>
<li>SampleMaterial</li>
<li>SampleGeometry</li>
<li>ContainerMaterial</li>
<li>ContainerGeometry</li>
<li>EnergyExchangeBinning</li>
<li>MomentumTransferBinning</li>
<li>GroupingAngleStep</li>
<li>GroupingBehaviour</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>Sample</td>
<td><ul class="first last simple">
<li>CadmiumWorkspace</li>
<li>EmptyContainerWorkspace</li>
<li>VanadiumWorkspace</li>
<li>MaskWorkspace</li>
</ul>
</td>
<td><ul class="first last simple">
<li>all from Vanadium, and</li>
<li>SampleAngleOffset</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>All the input workspace properties above are optional, unless bolded.
For example, if processing as sample, if an empty container and cadmium absorber inputs are specified, subtraction of these workspaces will be performed,
while if not, this step will be skipped.</p>
<p>On top of the input properties, there are also switches that control the workflow and which corrections are to be performed. For example, the sample
is going to be normalised to absolute units with vanadium if <cite>AbsoluteUnitsNormalisation</cite> is set to “Absolute Units ON”. There is also a number of parameters
that allow creating bespoke masking, these include:</p>
<ul class="simple">
<li><cite>MaskWorkspace</cite> - custom mask workspace</li>
<li><cite>MaskedTubes</cite> - list of tubes to be masked</li>
<li><cite>MaskThresholdMin</cite>, <cite>MaskThresholdMax</cite> - minimum and maximum threshold values of normalised counts to be masked</li>
<li><cite>MaskedAngles</cite> - range of 2theta angles to be masked</li>
<li><cite>MaskWithVanadium</cite> - whether to use Vanadium-derived diagnostics to mask data</li>
</ul>
</div>
<div class="section" id="reductiontype">
<h2><a class="toc-backref" href="#id7">ReductionType</a><a class="headerlink" href="#reductiontype" title="Permalink to this headline">¶</a></h2>
<p>There are two supported reduction types available: <cite>Powder</cite> and <cite>SingleCrystal</cite>. The choice impacts the reduction workflow of the <cite>Sample</cite> process, as can
be seen in the diagrams below. The <cite>SingleCrystal</cite> reduction exits the reduction earlier and saves the output to be processed externally to Mantid, while
<cite>Powder</cite> continues to the call to <a class="reference internal" href="DirectILLReduction-v1.html#algm-directillreduction"><span class="std std-ref">DirectILLReduction</span></a>, and then saves its output.</p>
</div>
<div class="section" id="caching-with-ads">
<h2><a class="toc-backref" href="#id8">Caching with ADS</a><a class="headerlink" href="#caching-with-ads" title="Permalink to this headline">¶</a></h2>
<p>This algorithm cleans-up the intermediate workspaces after execution if <cite>ClearCache</cite> property is checked (<cite>True</cite> by default). It is recommended to keep it checked due
to large memory consumption coming from keeping rawdata.</p>
<p>Default naming schemes are imposed to ensure smooth communication of workspace contents. While user can specify the name for the output <a class="reference internal" href="../concepts/WorkspaceGroup.html#workspacegroup"><span class="std std-ref">WorkspaceGroup</span></a>,
the names of contents will consist of the name of the group as a prefix, the numor of the rawdata (or first rawdata in case of merging), initial energy, and temperature (when
<cite>ReductionType</cite> is <cite>Powder</cite>).</p>
</div>
<div class="section" id="saving-output">
<h2><a class="toc-backref" href="#id9">Saving output</a><a class="headerlink" href="#saving-output" title="Permalink to this headline">¶</a></h2>
<p>When <cite>SaveOutput</cite> property is checked, the output workspaces are saved in the default save directory. Depending on the <cite>ReductionType</cite>, and contents of the workspace saved,
the output is either a .nxs or a .nxspe file. For <cite>SingleCrystal</cite> reduction type, the output of the rebinning is saved as .nxspe files with the <cite>Psi</cite> parameter coming from
a sum of the relevant sample log and user-defined <cite>SampleAngleOffset</cite> property. For <cite>Powder</cite>, <span class="math">\(S (2\theta, \omega)\)</span> output is saved as .nxspe while the rest is saved
as regular .nxs.</p>
</div>
<div class="section" id="workflows">
<h2><a class="toc-backref" href="#id10">Workflows</a><a class="headerlink" href="#workflows" title="Permalink to this headline">¶</a></h2>
<div class="section" id="empty-container">
<h3><a class="toc-backref" href="#id11">Empty container</a><a class="headerlink" href="#empty-container" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/DirectILLAutoProcess-v1_empty_wkflw.svg" src="../_images/DirectILLAutoProcess-v1_empty_wkflw.svg" /></div>
<div class="section" id="vanadium">
<h3><a class="toc-backref" href="#id12">Vanadium</a><a class="headerlink" href="#vanadium" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/DirectILLAutoProcess-v1_vanadium_wkflw.svg" src="../_images/DirectILLAutoProcess-v1_vanadium_wkflw.svg" /></div>
<div class="section" id="sample-powder">
<h3><a class="toc-backref" href="#id13">Sample, powder</a><a class="headerlink" href="#sample-powder" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/DirectILLAutoProcess-v1_sample_powder_wkflw.svg" src="../_images/DirectILLAutoProcess-v1_sample_powder_wkflw.svg" /></div>
<div class="section" id="sample-single-crystal">
<h3><a class="toc-backref" href="#id14">Sample, single crystal</a><a class="headerlink" href="#sample-single-crystal" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/DirectILLAutoProcess-v1_sample_sx_wkflw.svg" src="../_images/DirectILLAutoProcess-v1_sample_sx_wkflw.svg" /><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path. In Mantid this is done using <a class="reference external" href="http://www.mantidproject.org/ManageUserDirectories">Manage User Directories</a>.</p>
</div>
<p><strong>Example - full treatment of a sample at 2 different temperatures in IN4</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vanadium_runs</span> <span class="o">=</span> <span class="s1">&#39;ILL/IN4/085801-085802&#39;</span>
<span class="n">sample_runs</span> <span class="o">=</span> <span class="s1">&#39;ILL/IN4/087294+087295.nxs,ILL/IN4/087283-087290.nxs&#39;</span>
<span class="n">container_runs</span> <span class="o">=</span> <span class="s1">&#39;ILL/IN4/087306-087309.nxs,ILL/IN4/087311-087314.nxs&#39;</span>

<span class="n">vanadium_ws</span> <span class="o">=</span> <span class="s1">&#39;vanadium_auto&#39;</span>
<span class="n">container_ws</span> <span class="o">=</span> <span class="s1">&#39;container&#39;</span>
<span class="n">sample_ws</span> <span class="o">=</span> <span class="s1">&#39;sample&#39;</span>

<span class="c1"># Sample self-shielding and container subtraction.</span>
<span class="n">geometry</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Shape&#39;</span><span class="p">:</span> <span class="s1">&#39;HollowCylinder&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Height&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
    <span class="s1">&#39;InnerRadius&#39;</span><span class="p">:</span> <span class="mf">1.9</span><span class="p">,</span>
    <span class="s1">&#39;OuterRadius&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="s1">&#39;Center&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">material</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;ChemicalFormula&#39;</span><span class="p">:</span> <span class="s1">&#39;Cd S&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SampleNumberDensity&#39;</span><span class="p">:</span> <span class="mf">0.01</span>
<span class="p">}</span>
<span class="n">Ei</span> <span class="o">=</span> <span class="mf">8.804337831263577</span>

<span class="n">DirectILLAutoProcess</span><span class="p">(</span>
    <span class="n">Runs</span><span class="o">=</span><span class="n">vanadium_runs</span><span class="p">,</span>
    <span class="n">OutputWorkspace</span><span class="o">=</span><span class="n">vanadium_ws</span><span class="p">,</span>
    <span class="n">ProcessAs</span><span class="o">=</span><span class="s1">&#39;Vanadium&#39;</span><span class="p">,</span>
    <span class="n">ReductionType</span><span class="o">=</span><span class="s1">&#39;Powder&#39;</span><span class="p">,</span>
    <span class="n">FlatBkg</span> <span class="o">=</span> <span class="s1">&#39;Flat Bkg ON&#39;</span><span class="p">,</span>
    <span class="n">ElasticChannel</span><span class="o">=</span><span class="s1">&#39;Elastic Channel AUTO&#39;</span><span class="p">,</span>
    <span class="n">EPPCreationMethod</span><span class="o">=</span><span class="s1">&#39;Fit EPP&#39;</span>
<span class="p">)</span>

<span class="n">DirectILLAutoProcess</span><span class="p">(</span>
    <span class="n">Runs</span><span class="o">=</span><span class="n">container_runs</span><span class="p">,</span>
    <span class="n">OutputWorkspace</span><span class="o">=</span><span class="n">container_ws</span><span class="p">,</span>
    <span class="n">ProcessAs</span><span class="o">=</span><span class="s1">&#39;Empty&#39;</span><span class="p">,</span>
    <span class="n">ReductionType</span><span class="o">=</span><span class="s1">&#39;Powder&#39;</span><span class="p">,</span>
    <span class="n">IncidentEnergyCalibration</span><span class="o">=</span><span class="s2">&quot;Energy Calibration ON&quot;</span><span class="p">,</span>
    <span class="n">IncidentEnergy</span><span class="o">=</span><span class="n">Ei</span>
<span class="p">)</span>

<span class="c1"># Need to interpolate container to 50K</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">T1</span> <span class="o">=</span> <span class="mf">100.0</span>
<span class="n">DT</span> <span class="o">=</span> <span class="n">T1</span> <span class="o">-</span> <span class="n">T0</span>
<span class="n">Ts</span> <span class="o">=</span> <span class="mf">50.0</span> <span class="c1"># Target T</span>
<span class="n">RebinToWorkspace</span><span class="p">(</span>
    <span class="n">WorkspaceToRebin</span><span class="o">=</span><span class="s1">&#39;container_087311_Ei9meV_T100.0K&#39;</span><span class="p">,</span>
    <span class="n">WorkspaceToMatch</span><span class="o">=</span><span class="s1">&#39;container_087306_Ei9meV_T1.5K&#39;</span><span class="p">,</span>
    <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;container_087311_Ei9meV_T100.0K&#39;</span>
<span class="p">)</span>
<span class="n">container_Ei9meV_50K</span> <span class="o">=</span> <span class="p">(</span><span class="n">T1</span> <span class="o">-</span> <span class="n">Ts</span><span class="p">)</span> <span class="o">/</span> <span class="n">DT</span> <span class="o">*</span> <span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;container_087306_Ei9meV_T1.5K&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">Ts</span> <span class="o">-</span> <span class="n">T0</span><span class="p">)</span> <span class="o">/</span> <span class="n">DT</span> <span class="o">*</span> <span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;container_087311_Ei9meV_T100.0K&#39;</span><span class="p">]</span>
<span class="n">mtd</span><span class="p">[</span><span class="n">container_ws</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;container_Ei9meV_50K&#39;</span><span class="p">)</span>

<span class="n">DirectILLAutoProcess</span><span class="p">(</span>
    <span class="n">Runs</span><span class="o">=</span><span class="n">sample_runs</span><span class="p">,</span>
    <span class="n">OutputWorkspace</span><span class="o">=</span><span class="n">sample_ws</span><span class="p">,</span>
    <span class="n">ProcessAs</span><span class="o">=</span><span class="s1">&#39;Sample&#39;</span><span class="p">,</span>
    <span class="n">ReductionType</span><span class="o">=</span><span class="s1">&#39;Powder&#39;</span><span class="p">,</span>
    <span class="n">VanadiumWorkspace</span><span class="o">=</span><span class="n">vanadium_ws</span><span class="p">,</span>
    <span class="n">EmptyContainerWorkspace</span><span class="o">=</span><span class="n">container_ws</span><span class="p">,</span>
    <span class="n">IncidentEnergyCalibration</span><span class="o">=</span><span class="s2">&quot;Energy Calibration ON&quot;</span><span class="p">,</span>
    <span class="n">IncidentEnergy</span><span class="o">=</span><span class="n">Ei</span><span class="p">,</span>
    <span class="n">SampleMaterial</span><span class="o">=</span><span class="n">material</span><span class="p">,</span>
    <span class="n">SampleGeometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span>
    <span class="n">SaveOutput</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">ClearCache</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sample_SofQW_087294_Ei9meV_T1.5K&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_SofQW_087283_Ei9meV_T50.0K&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">outputs</span><span class="p">:</span>
    <span class="n">SofQW</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="n">output</span><span class="p">]</span>
    <span class="n">qAxis</span> <span class="o">=</span> <span class="n">SofQW</span><span class="o">.</span><span class="n">readX</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Vertical axis</span>
    <span class="n">eAxis</span> <span class="o">=</span> <span class="n">SofQW</span><span class="o">.</span><span class="n">getAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Horizontal axis</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: Q range: </span><span class="si">{:.3}</span><span class="s1">...</span><span class="si">{:.3}</span><span class="s1">A; W range </span><span class="si">{:.3}</span><span class="s1">...</span><span class="si">{:.3}</span><span class="s1">meV&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">output</span><span class="p">,</span> <span class="n">qAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qAxis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">eAxis</span><span class="o">.</span><span class="n">getMin</span><span class="p">(),</span> <span class="n">eAxis</span><span class="o">.</span><span class="n">getMax</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>sample_SofQW_087294_Ei9meV_T1.5K: Q range: 0.0...9.21A; W range -97.0...7.62meV
sample_SofQW_087283_Ei9meV_T50.0K: Q range: 0.0...9.19A; W range -96.6...7.62meV
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/ILL/Direct.html">ILL\Direct</a> | <a class="reference external" href="categories/Inelastic/Reduction.html">Inelastic\Reduction</a> | <a class="reference external" href="categories/Workflow/Inelastic.html">Workflow\Inelastic</a> | <a class="reference external" href="categories/ILL/Auto.html">ILL\Auto</a></p>
</div>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id15">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/7cec3a047fd2864c82ac0280d76fe566152576ec/Framework/PythonInterface/plugins/algorithms/WorkflowAlgorithms/DirectILLAutoProcess.py">DirectILLAutoProcess.py</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="DirectILLApplySelfShielding-v1.html" title="Previous Chapter: DirectILLApplySelfShielding v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; DirectILLAppl...</span>
    </a>
  </li>
  <li>
    <a href="DirectILLCollectData-v1.html" title="Next Chapter: DirectILLCollectData v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">DirectILLColl... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>