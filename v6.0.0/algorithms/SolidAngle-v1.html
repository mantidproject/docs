<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>SolidAngle v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SortByQVectors v1" href="SortByQVectors-v1.html" />
    <link rel="prev" title="SofTwoThetaTOF v1" href="SofTwoThetaTOF-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.0</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="solidangle-v1">
<span id="algm-solidangle"></span><span id="algm-solidangle-v1"></span><h1>SolidAngle v1<a class="headerlink" href="#solidangle-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/SolidAngle-v1_dlg.png"><img alt="../_images/SolidAngle-v1_dlg.png" class="screenshot" src="../_images/SolidAngle-v1_dlg.png" style="width: 349px;" /></a>
<p class="caption"><span class="caption-text"><strong>SolidAngle</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a></li>
<li><a class="reference internal" href="#method-property" id="id6"><code class="docutils literal"><span class="pre">Method</span></code> Property</a></li>
<li><a class="reference internal" href="#usage" id="id7">Usage</a></li>
<li><a class="reference internal" href="#references" id="id8">References</a></li>
<li><a class="reference internal" href="#source" id="id9">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>The SolidAngle algorithm calculates the solid angle in steradians for each of the detectors in an instrument and outputs the data in a workspace.  This can then be used to normalize a data workspace using the divide algorithm should you wish.</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="Divide-v1.html#algm-divide"><span class="std std-ref">Divide</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="2%" />
<col width="13%" />
<col width="4%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>This workspace is used to identify the instrument to use and also which spectra to create a solid angle for. If the Max and Min spectra values are not provided one solid angle will be created for each spectra in the input workspace</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><span class="std std-ref">MatrixWorkspace</span></a></td>
<td><em>Mandatory</em></td>
<td>The name of the workspace to be created as the output of the algorithm.  A workspace of this name will be created and stored in the Analysis Data Service.</td>
</tr>
<tr class="row-even"><td>StartWorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>The index number of the first spectrum for which to find the solid angle (default: 0)</td>
</tr>
<tr class="row-odd"><td>EndWorkspaceIndex</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>The index of the last spectrum whose solid angle is to be found (default: the last spectrum in the workspace)</td>
</tr>
<tr class="row-even"><td>Method</td>
<td>Input</td>
<td>string</td>
<td>GenericShape</td>
<td>Select the method to calculate the Solid Angle. Allowed values: [‘GenericShape’, ‘Rectangle’, ‘VerticalTube’, ‘HorizontalTube’, ‘VerticalWing’, ‘HorizontalWing’]</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The algorithm calculates solid angles from the sample position of the
input workspace for all of the spectra selected. If several detectors
have been mapped to the same spectrum then the solid angles of this
detectors will be summed to provide the solid angle for the spectrum.
The solid angle of a detector that has been masked or marked as dead is
considered to be 0 steradians. For grouped detectors, the solid angles will be summed.</p>
<p>This algorithms can happily accept <a class="reference internal" href="../concepts/Ragged_Workspace.html#ragged-workspace"><span class="std std-ref">ragged workspace</span></a>
as an input workspace. The result would
be a ragged output workspace whose X axis values match the lowest and
highest of each the input spectra.</p>
<p>Note: The Solid angle calculation assumes that the path between the
sample and detector is unobstructed by another other instrument
components.</p>
</div>
<div class="section" id="method-property">
<h2><a class="toc-backref" href="#id6"><code class="docutils literal"><span class="pre">Method</span></code> Property</a><a class="headerlink" href="#method-property" title="Permalink to this headline">¶</a></h2>
<p>The method property changes how the solid angle calculation is
perfomed.
<code class="docutils literal"><span class="pre">GenericShape</span></code> uses the ray-tracing methods of <a class="reference internal" href="../concepts/Instrument.html#instrument"><span class="std std-ref">Instrument</span></a>.</p>
<p>All of the others have special analytical forms taken from small angle scattering literature.
Those are fast analytical approximations that are valid in large detector distance and small pixel area limit.
For those equations <span class="math">\(2\theta\)</span> is the scattering angle (from direct beam rather than in-plane), <span class="math">\(\alpha\)</span> is the scattering angle constrained in either the x (horizontal) or y (vertical) plane.
The methods below also assume that the instrument has properties <code class="docutils literal"><span class="pre">x-pixel-size</span></code> and <code class="docutils literal"><span class="pre">y-pixel-size</span></code> which define the size of the pixels in millimetres.
A difference between this implementation and what is in literature, is that rather than using the detector elements distance as <span class="math">\(L_{2i} = \frac{D}{\cos(2\theta_i)}\)</span>, this uses the actual <span class="math">\(L_{2i}\)</span> and in the equation after proper substitution.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Rectangular</span></code>: <span class="math">\(d\Omega_i = p_x p_y cos(2\theta_i) / L_{2i}^2\)</span></li>
<li><code class="docutils literal"><span class="pre">VerticalTube</span></code> and <code class="docutils literal"><span class="pre">HorizontalTube</span></code>: <span class="math">\(d\Omega_i = p_x p_y \cos(\alpha_i) / L_2^2\)</span></li>
<li><code class="docutils literal"><span class="pre">VerticalWing</span></code> and <code class="docutils literal"><span class="pre">HorizontalWing</span></code>: <span class="math">\(d\Omega_i = p_x p_y \cos^3(\alpha_i) / (L_2 \cos(2\theta_i))^2\)</span></li>
</ul>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id7">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example:</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">CreateSampleWorkspace</span><span class="p">()</span>
<span class="n">wsOut</span> <span class="o">=</span> <span class="n">SolidAngle</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solid angle of Spectra 1 in Bank 1: </span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solid angle of Spectra 101 in Bank 2: </span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">wsOut</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">100</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Solid angle of Spectra 1 in Bank 1: 6.40e-08
Solid angle of Spectra 101 in Bank 2: 1.60e-08
</pre></div>
</div>
<p><strong>Example: BIOSANS</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">LoadEmptyInstrument</span><span class="p">(</span><span class="n">InstrumentName</span><span class="o">=</span><span class="s1">&#39;BIOSANS&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;BIOSANS&#39;</span><span class="p">)</span>
<span class="n">mainDet</span> <span class="o">=</span> <span class="n">SolidAngle</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;BIOSANS&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;main_detector&#39;</span><span class="p">,</span>
                     <span class="n">Method</span><span class="o">=</span><span class="s1">&#39;VerticalTube&#39;</span><span class="p">,</span> <span class="n">StartWorkspaceIndex</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">EndWorkspaceIndex</span><span class="o">=</span><span class="mi">49153</span><span class="p">)</span>
<span class="n">wingDet</span> <span class="o">=</span> <span class="n">SolidAngle</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;BIOSANS&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;wing_detector&#39;</span><span class="p">,</span>
                     <span class="n">Method</span><span class="o">=</span><span class="s1">&#39;VerticalWing&#39;</span><span class="p">,</span> <span class="n">StartWorkspaceIndex</span><span class="o">=</span><span class="mi">49154</span><span class="p">,</span> <span class="n">EndWorkspaceIndex</span><span class="o">=</span><span class="mi">90113</span><span class="p">)</span>
<span class="c1"># both are zero where nothing was calculated</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solid angle where main was not calculated: </span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mainDet</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solid angle where wing was not calculated: </span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">wingDet</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># both have values where they were calculated</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solid angle where main was calculated: </span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mainDet</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solid angle where wing was calculated: </span><span class="si">%.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">wingDet</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">49155</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Solid angle where main was not calculated: 0.00e+00
Solid angle where wing was not calculated: 0.00e+00
Solid angle where main was calculated: 2.82e-05
Solid angle where wing was calculated: 1.30e-05
</pre></div>
</div>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id8">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>The specialzed <code class="docutils literal"><span class="pre">Method</span></code> calculations are based on work summarized in:</p>
<ol class="arabic simple">
<li><ol class="first upperroman">
<li>Grillo, <em>Small-angle neutron scattering and applications in soft condensed matter.</em> Soft matter characterization (2008): 723-782.</li>
</ol>
</li>
<li>Annie Brûlet, <em>Improvement of data treatment in small-angle neutron scattering.</em> J. of Appl. Cryst. 40.1 (2007): 165-177 <a class="reference external" href="https://doi.org/10.1107/S0021889806051442">doi: 10.1107/S0021889806051442</a></li>
</ol>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/CorrectionFunctions/InstrumentCorrections.html">CorrectionFunctions\InstrumentCorrections</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id9">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/be3e0b0ee38557d9593e311f5a2f06503b508191/Framework/Algorithms/inc/MantidAlgorithms/SolidAngle.h">SolidAngle.h</a> <em>(last modified: 2020-03-20)</em></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/be3e0b0ee38557d9593e311f5a2f06503b508191/Framework/Algorithms/src/SolidAngle.cpp">SolidAngle.cpp</a> <em>(last modified: 2020-04-07)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="SofTwoThetaTOF-v1.html" title="Previous Chapter: SofTwoThetaTOF v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SofTwoThetaTOF v1</span>
    </a>
  </li>
  <li>
    <a href="SortByQVectors-v1.html" title="Next Chapter: SortByQVectors v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SortByQVectors v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2021-02-09.<br/>
    </p>
  </div>
</footer>
  </body>
</html>