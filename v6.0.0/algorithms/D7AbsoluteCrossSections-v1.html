<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>D7AbsoluteCrossSections v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="D7YIGPositionCalibration v1" href="D7YIGPositionCalibration-v1.html" />
    <link rel="prev" title="CylinderPaalmanPingsCorrection v2" href="CylinderPaalmanPingsCorrection-v2.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.0</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="d7absolutecrosssections-v1">
<span id="algm-d7absolutecrosssections"></span><span id="algm-d7absolutecrosssections-v1"></span><h1>D7AbsoluteCrossSections v1<a class="headerlink" href="#d7absolutecrosssections-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/D7AbsoluteCrossSections-v1_dlg.png"><img alt="../_images/D7AbsoluteCrossSections-v1_dlg.png" class="screenshot" src="../_images/D7AbsoluteCrossSections-v1_dlg.png" style="width: 349px;" /></a>
<p class="caption"><span class="caption-text"><strong>D7AbsoluteCrossSections</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a><ul>
<li><a class="reference internal" href="#sampleandenvironmentproperties" id="id6">SampleAndEnvironmentProperties</a></li>
<li><a class="reference internal" href="#cross-section-separation-method" id="id7">Cross-section separation method</a></li>
<li><a class="reference internal" href="#sample-data-normalisation" id="id8">Sample data normalisation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id9">Usage</a></li>
<li><a class="reference internal" href="#references" id="id10">References</a></li>
<li><a class="reference internal" href="#source" id="id11">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Separates magnetic, nuclear coherent, and incoherent components for diffraction and spectroscopy data,and corrects the sample data for detector efficiency and normalises it to the chosen standard.</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="D7YIGPositionCalibration-v1.html#algm-d7yigpositioncalibration"><span class="std std-ref">D7YIGPositionCalibration</span></a>, <a class="reference internal" href="PolDiffILLReduction-v1.html#algm-poldiffillreduction"><span class="std std-ref">PolDiffILLReduction</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="3%" />
<col width="7%" />
<col width="6%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>InputWorkspace</td>
<td>Input</td>
<td>WorkspaceGroup</td>
<td><em>Mandatory</em></td>
<td>The input workspace with spin-flip and non-spin-flip data.</td>
</tr>
<tr class="row-odd"><td>RotatedXYZWorkspace</td>
<td>Input</td>
<td>WorkspaceGroup</td>
<td>&#160;</td>
<td>The workspace used in 10p method when data is taken as two XYZ measurements rotated by 45 degress.</td>
</tr>
<tr class="row-even"><td>OutputWorkspace</td>
<td>Output</td>
<td>WorkspaceGroup</td>
<td>&#160;</td>
<td>The output workspace.</td>
</tr>
<tr class="row-odd"><td>CrossSectionSeparationMethod</td>
<td>Input</td>
<td>string</td>
<td>None</td>
<td>What type of cross-section separation to perform. Allowed values: [‘None’, ‘Uniaxial’, ‘XYZ’, ‘10p’]</td>
</tr>
<tr class="row-even"><td>OutputUnits</td>
<td>Input</td>
<td>string</td>
<td>TwoTheta</td>
<td>The choice to display the output either as a function of detector twoTheta, or the momentum exchange. Allowed values: [‘TwoTheta’, ‘Q’]</td>
</tr>
<tr class="row-odd"><td>NormalisationMethod</td>
<td>Input</td>
<td>string</td>
<td>None</td>
<td>Method to correct detector efficiency and normalise data. Allowed values: [‘None’, ‘Vanadium’, ‘Incoherent’, ‘Paramagnetic’]</td>
</tr>
<tr class="row-even"><td>OutputTreatment</td>
<td>Input</td>
<td>string</td>
<td>Individual</td>
<td>Which treatment of the provided scan should be used to create output. Allowed values: [‘Individual’, ‘Sum’]</td>
</tr>
<tr class="row-odd"><td>SampleAndEnvironmentProperties</td>
<td>Input</td>
<td>Dictionary</td>
<td>dict()</td>
<td>Dictionary for the information about sample and its environment.</td>
</tr>
<tr class="row-even"><td>ScatteringAngleBinSize</td>
<td>Input</td>
<td>number</td>
<td>0.5</td>
<td>Scattering angle bin size in degrees used for expressing scan data on a single TwoTheta axis.</td>
</tr>
<tr class="row-odd"><td>VanadiumInputWorkspace</td>
<td>Input</td>
<td>WorkspaceGroup</td>
<td>&#160;</td>
<td>The name of the vanadium workspace.</td>
</tr>
<tr class="row-even"><td>AbsoluteUnitsNormalisation</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Whether or not express the output in absolute units.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This is the algorithm that performs cross-section separation and allows for sample data normalisation to absolute scale.
The cross-section separation provides information about magnetic, nuclear coherent, and spin-incoherent contributions to the measured cross-section.
The absolute scale normalisation uses either the output from cross-section separation or a vanadium reference sample for polarised diffraction and spectroscopy data measured
by D7 instrument at the ILL.</p>
<p>Three types of cross-section separation are supported: <cite>Uniaxial</cite>, <cite>XYZ</cite>, and <cite>10p</cite>, for which 2, 6, and 10 distributions with spin-flip and non-spin-flip cross-sections
are required. The expected input is a workspace group containing spin-flip and non-spin-flip cross-sections, with the following order of axis directions:
Z, Y, X, X-Y, X+Y. This step can be skipped by setting <cite>CrossSectionSeparationMethod</cite> parameter to <cite>‘None’</cite>.</p>
<p>Three ways of sample data normalisation are supported: <cite>Vanadium</cite>, <cite>Paramagnetic</cite>, and <cite>Incoherent</cite>, for which either the output from vanadium data reduction,
or from the cross-section separation (magnetic and spin-incoherent respectively) is used. This step can also be skipped by setting <cite>NormalisationMethod</cite> parameter
to <cite>‘None’</cite>.</p>
<p>This algorithm is indended to be invoked on sample data that is fully corrected and needs to be normalised to the absolute scale.</p>
<div class="section" id="sampleandenvironmentproperties">
<h3><a class="toc-backref" href="#id6">SampleAndEnvironmentProperties</a><a class="headerlink" href="#sampleandenvironmentproperties" title="Permalink to this headline">¶</a></h3>
<p>This property is a dictionary containing all of the information about the sample and its environment, in the same fashion as in <a class="reference internal" href="PolDiffILLReduction-v1.html#algm-poldiffillreduction"><span class="std std-ref">PolDiffILLReduction</span></a>.
This information is used for proper normalisation of the given sample.</p>
<p>The following keys need to be defined:</p>
<ul class="simple">
<li><em>SampleMass</em></li>
<li><em>FormulaUnits</em></li>
<li><em>FormulaUnitMass</em></li>
<li><em>SampleSpin</em> if the <cite>NormalisationMethod</cite> is set to <cite>Paramagnetic</cite></li>
<li><em>IncoherentCrossSection</em> if the <cite>NormalisationMethod</cite> is set to <cite>Incoherent</cite> and <cite>AbsoluteUnitsNormalisation</cite> is <em>True</em></li>
</ul>
</div>
<div class="section" id="cross-section-separation-method">
<h3><a class="toc-backref" href="#id7">Cross-section separation method</a><a class="headerlink" href="#cross-section-separation-method" title="Permalink to this headline">¶</a></h3>
<p>Below are presented formulae used to separate magnetic (M), nuclear coherent (N), and spin-incoherent (I) cross-sections using
spin-flip <span class="math">\(\left(\frac{d\sigma}{d\Omega}\right)_{\text{sf}}\)</span> and non-spin-flip <span class="math">\(\left(\frac{d\sigma}{d\Omega}\right)_{\text{nsf}}\)</span>
cross-sections from the provided input <a class="reference internal" href="../concepts/WorkspaceGroup.html#workspacegroup"><span class="std std-ref">WorkspaceGroup</span></a>.</p>
<ol class="arabic simple">
<li>Uniaxial</li>
</ol>
<p>At least two separate measurements along the same axis with opposite spin orientations are needed for this method to work. Usually, the measured axis is the ‘Z’ axis that is colinear with the beam axis, thus the spin-flip and non-spin-flip cross-sections are measured along the longitudinal axis. This method does not allow for separation of magnetic cross-section.</p>
<div class="math">
\[ \begin{align}\begin{aligned}N = 2 \cdot \left(\frac{\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{nsf}} - \left(\frac{\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{sf}}\\I = 2 \cdot \left(\frac{\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{sf}} - \left(\frac{\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{nsf}}\end{aligned}\end{align} \]</div>
<p>In this case, the magnetic cross-section cannot be separated from data.</p>
<ol class="arabic simple" start="2">
<li>XYZ</li>
</ol>
<p>This method is an expansion of the Uniaxial method, that requires measurements of spin-flip and non-spin-flip cross-sections along three orthogonal axes. This method allows for separation of magnetic cross-section from nuclear coherent and spin-incoherent.</p>
<div class="math">
\[ \begin{align}\begin{aligned}M = 2 \cdot \left(2 \cdot \left(\frac{\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{nsf}} - \left(\frac{d\sigma_{x}}{\text{d}\Omega}\right)_{\text{nsf}} - \left(\frac{\text{d}\sigma_{y}}{\text{d}\Omega}\right)_{\text{nsf}} \right)\\N = \frac{1}{6} \cdot \left(2 \cdot \left( \left(\frac{\text{d}\sigma_{x}}{\text{d}\Omega}\right)_{\text{nsf}} + \left(\frac{\text{d}\sigma_{y}}{\text{d}\Omega}\right)_{\text{nsf}} + \left(\frac{d\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{nsf}} \right)\\- \left( \left( \frac{\text{d}\sigma_{x}}{\text{d}\Omega}\right)_{\text{sf}} + \left( \frac{\text{d}\sigma_{y}}{\text{d}\Omega}\right)_{\text{sf}} + \left( \frac{\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{sf}} \right) \right)\\I = \frac{1}{2} \cdot \left(\left(\frac{\text{d}\sigma_{x}}{\text{d}\Omega}\right)_{\text{sf}} + \left(\frac{\text{d}\sigma_{y}}{\text{d}\Omega}\right)_{\text{sf}} + \left(\frac{\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{sf}} - M \right)\end{aligned}\end{align} \]</div>
<ol class="arabic simple" start="3">
<li>10-point</li>
</ol>
<p>The 10-point method is an expansion of the XYZ method, that requires measurements of spin-flip and non-spin-flip cross-sections along three orthogonal axes as in the XYZ and two additional axes that are rotated by 45 degrees around the Z axis, labelled <cite>‘x-y’</cite> and <cite>‘x+y’</cite>. Similarly to the XYZ method, it is possible to separate magnetic cross-section from nuclear coherent and spin-incoherent ones, and additionally the method offers a possibility to separate the magnetic cross-section and the term dependent on azimuthal angle.</p>
<div class="math">
\[\alpha = \theta - \theta_{0} - \frac{\pi}{2},\]</div>
<p>where <span class="math">\(\alpha\)</span> is the Sharpf angle, which for elastic scattering is equal to half of the (signed) in-plane scattering angle and <span class="math">\(\theta_{0}\)</span> is an experimentally fixed offset (see more in Ref. [3]).</p>
<div class="math">
\[M_{1} = (2 c_{0} - 4) \cdot \left(\frac{\text{d}\sigma_{x}}{\text{d}\Omega}\right)_{\text{nsf}} + (2c_{0} + 2) \cdot \left(\frac{\text{d}\sigma_{y}}{\text{d}\Omega}\right)_{\text{nsf}} + (2-4c_{0}) \cdot \left(\frac{\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{nsf}}\]</div>
<div class="math">
\[M_{2} = (2 c_{4} - 4) \cdot \left(\frac{\text{d}\sigma_{x+y}}{\text{d}\Omega}\right)_{\text{nsf}} + (2c_{4} + 2) \cdot \left(\frac{\text{d}\sigma_{x-y}}{\text{d}\Omega}\right)_{\text{nsf}} + (2-4c_{4}) \cdot \left(\frac{\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{nsf}}\]</div>
<div class="math">
\[M = M_{1} \cdot \text{cos}(2\alpha) + M_{2} \cdot \text{sin}(2\alpha),\]</div>
<p>where <span class="math">\(c_{0} = \text{cos}^{2} \alpha\)</span> and <span class="math">\(c_{4} = \text{cos}^{2} (\alpha - \frac{\pi}{4})\)</span></p>
<div class="math">
\[ \begin{align}\begin{aligned}N = \frac{1}{12} \cdot \left(2 \cdot \left( \left(\frac{\text{d}\sigma_{x}}{\text{d}\Omega}\right)_{\text{nsf}} + \left(\frac{\text{d}\sigma_{y}}{\text{d}\Omega}\right)_{\text{nsf}} + 2 \cdot \left(\frac{\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{nsf}} + \left(\frac{\text{d}\sigma_{x+y}}{\text{d}\Omega}\right)_{\text{nsf}} + \left(\frac{\text{d}\sigma_{x-y}}{\text{d}\Omega}\right)_{\text{nsf}} \right)\\- \left( \left(\frac{\text{d}\sigma_{x}}{\text{d}\Omega}\right)_{\text{sf}} + \left(\frac{\text{d}\sigma_{y}}{\text{d}\Omega}\right)_{\text{sf}} + \left(\frac{\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{sf}} + \left(\frac{\text{d}\sigma_{x+y}}{\text{d}d\Omega}\right)_{\text{sf}} + \left(\frac{\text{d}\sigma_{x-y}}{\text{d}\Omega}\right)_{\text{sf}} \right) \right)\end{aligned}\end{align} \]</div>
<div class="math">
\[I = \frac{1}{4} \cdot \left(\left(\frac{\text{d}\sigma_{x}}{\text{d}\Omega}\right)_{\text{sf}} + \left(\frac{\text{d}\sigma_{y}}{\text{d}d\Omega}\right)_{\text{sf}} + 2 \cdot \left(\frac{\text{d}\sigma_{z}}{\text{d}\Omega}\right)_{\text{sf}} + \left(\frac{\text{d}\sigma_{x+y}}{\text{d}\Omega}\right)_{\text{sf}} + \left(\frac{\text{d}\sigma_{x-y}}{\text{d}\Omega}\right)_{\text{sf}} - M \right)\]</div>
</div>
<div class="section" id="sample-data-normalisation">
<h3><a class="toc-backref" href="#id8">Sample data normalisation</a><a class="headerlink" href="#sample-data-normalisation" title="Permalink to this headline">¶</a></h3>
<p>The sample data normalisation is the final step of data reduction of D7 sample, and allows to simultaneously correct for detector efficiency and set the output to the absolute scale.</p>
<p>There are three options for the normalisation; it uses either the input from a reference sample with a well-known cross-section, namely vanadium, or the output from the cross-section separation, either magnetic or spin-incoherent cross-sections. A relative normalisation of the sample workspace to the detector with the highest counts is always performed.</p>
<div class="math">
\[S \text{(#,} \pm \text{, chn/t/meV)} = I \text{(#,} \pm \text{, chn/t/meV)} \cdot D \text{(#,} \pm \text{, chn/t/meV)},\]</div>
<p>where <cite>I</cite> is the sample intensity distribution corrected for all effects, and <cite>D</cite> is the normalisation factor.</p>
<ol class="arabic simple">
<li>Vanadium</li>
</ol>
<p>If the data is to be expressed in absolute units, the normalisation factor is the reduced vanadium data, normalised by the number of formula units in the sample <span class="math">\(N_{S}\)</span>:</p>
<div class="math">
\[D \text{(#,} \pm \text{, chn/t/meV)} = \frac{1}{N_{S}} \cdot V \text{(#,} \pm \text{, chn/t/meV)}\]</div>
<p>If data is not to be expressed in absolute units, the normalisation factor depends only on the vanadium input:</p>
<div class="math">
\[D \text{(#,} \pm \text{, chn/t/meV)} = \frac{V \text{(#,} \pm \text{, chn/t/meV)}}{\text{max}(V \text{(#,} \pm \text{, chn/t/meV)})}\]</div>
<ol class="arabic simple" start="2">
<li>Paramagnetic</li>
</ol>
<p>This normalisation is not valid for TOF data, and requires input from XYZ or 10-point cross-section separation. The paramagnetic measurement does not need to have background subtracted, as the background is self-subtracted in an XYZ measurement.</p>
<div class="math">
\[D \text{(#)} = \frac{2}{3} \frac{(\gamma r_{0})^{2} S(S+1)}{P \text{(#)}},\]</div>
<p>where <span class="math">\(\gamma\)</span> is the neutron gyromagnetic ratio, <span class="math">\(r_{0}\)</span> is the electron’s classical radius, and S is the spin of the sample.</p>
<ol class="arabic simple" start="3">
<li>Spin-incoherent</li>
</ol>
<p>Similarly to the paramagnetic normalisation, it is also not valid for TOF data, and requires input from XYZ or 10-point cross-section separation. This normalisation assumes that the spin-incoherent contribution is isotropic and flat in <span class="math">\(Q\)</span>.</p>
<p>The data can be put on absolute scale if the nuclear-spin-incoherent (NSI) cross-section for the sample is known, then:</p>
<div class="math">
\[D \text{(#)} = \frac{\text{d} \sigma_{NSI}}{\text{d} \Omega} \frac{1}{NSI \text{(#)}}.\]</div>
<p>If only the detector efficiency is to be corrected, then it is sufficient to use only the nuclear-spin-incoherent cross-section input:</p>
<div class="math">
\[D \text{(#)} = \frac{\text{max}(NSI \text{(#)})}{NSI \text{(#)}}.\]</div>
</div>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id9">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To run these usage examples please first download the
<a class="reference external" href="https://sourceforge.net/projects/mantid/files/Sample%20Data/UsageData.zip/download">usage data</a>,
and add these to your path. In Mantid this is done using <a class="reference external" href="http://www.mantidproject.org/ManageUserDirectories">Manage User Directories</a>.</p>
</div>
<p><strong>Example - D7AbsoluteCrossSections - XYZ cross-section separation of vanadium data</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sampleProperties</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;FormulaUnits&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;SampleMass&#39;</span><span class="p">:</span> <span class="mf">2.932</span><span class="p">,</span> <span class="s1">&#39;FormulaUnitMass&#39;</span><span class="p">:</span> <span class="mf">182.54</span><span class="p">}</span>

<span class="n">Load</span><span class="p">(</span><span class="s1">&#39;ILL/D7/vanadium_xyz.nxs&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;vanadium_xyz&#39;</span><span class="p">)</span> <span class="c1"># loads already reduced data</span>
<span class="n">D7AbsoluteCrossSections</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;vanadium_xyz&#39;</span><span class="p">,</span> <span class="n">CrossSectionSeparationMethod</span><span class="o">=</span><span class="s1">&#39;XYZ&#39;</span><span class="p">,</span>
                        <span class="n">SampleAndEnvironmentProperties</span><span class="o">=</span><span class="n">sampleProperties</span><span class="p">,</span>
                        <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of separated cross-sections: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;xyz&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getNumberOfEntries</span><span class="p">()))</span>
<span class="n">Integration</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;xyz&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;sum_coherent&#39;</span><span class="p">)</span>
<span class="n">Integration</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;xyz&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;sum_incoherent&#39;</span><span class="p">)</span>
<span class="n">Divide</span><span class="p">(</span><span class="n">LHSWorkspace</span><span class="o">=</span><span class="s1">&#39;sum_incoherent&#39;</span><span class="p">,</span> <span class="n">RHSWorkspace</span><span class="o">=</span><span class="s1">&#39;sum_coherent&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ratio of spin-incoherent to nuclear coherent cross-sections measured for vanadium is equal to: </span><span class="si">{0:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Number of separated cross-sections: 6
Ratio of spin-incoherent to nuclear coherent cross-sections measured for vanadium is equal to: 105.8
</pre></div>
</div>
<p><strong>Example - D7AbsoluteCrossSections - Sample normalisation to vanadium data</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sampleProperties</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;FormulaUnits&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;SampleMass&#39;</span><span class="p">:</span> <span class="mf">2.932</span><span class="p">,</span> <span class="s1">&#39;FormulaUnitMass&#39;</span><span class="p">:</span> <span class="mf">182.54</span><span class="p">}</span>

<span class="n">Load</span><span class="p">(</span><span class="s1">&#39;ILL/D7/396993_reduced.nxs&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;vanadium_input&#39;</span><span class="p">)</span>
<span class="n">GroupWorkspaces</span><span class="p">(</span><span class="n">InputWorkspaces</span><span class="o">=</span><span class="s1">&#39;vanadium_input&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;vanadium_data&#39;</span><span class="p">)</span>
<span class="n">Load</span><span class="p">(</span><span class="s1">&#39;ILL/D7/397004_reduced.nxs&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;sample_data&#39;</span><span class="p">)</span>
<span class="n">D7AbsoluteCrossSections</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;sample_data&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;normalised_sample_vanadium&#39;</span><span class="p">,</span>
                        <span class="n">CrossSectionSeparationMethod</span><span class="o">=</span><span class="s1">&#39;XYZ&#39;</span><span class="p">,</span> <span class="n">NormalisationMethod</span><span class="o">=</span><span class="s1">&#39;Vanadium&#39;</span><span class="p">,</span>
                        <span class="n">SampleAndEnvironmentProperties</span><span class="o">=</span><span class="n">sampleProperties</span><span class="p">,</span>
                        <span class="n">VanadiumInputWorkspace</span><span class="o">=</span><span class="s1">&#39;vanadium_data&#39;</span><span class="p">,</span> <span class="n">AbsoluteUnitsNormalisation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The number of entries in the normalised data is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;normalised_sample_vanadium&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getNumberOfEntries</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>The number of entries in the normalised data is: 6
</pre></div>
</div>
<p><strong>Example - D7D7AbsoluteCrossSections - Sample normalisation to paramagnetic cross-section</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sampleProperties</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;FormulaUnits&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;SampleMass&#39;</span><span class="p">:</span> <span class="mf">2.932</span><span class="p">,</span> <span class="s1">&#39;FormulaUnitMass&#39;</span><span class="p">:</span> <span class="mf">182.54</span><span class="p">,</span> <span class="s1">&#39;SampleSpin&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">}</span>

<span class="n">Load</span><span class="p">(</span><span class="s1">&#39;ILL/D7/397004_reduced.nxs&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;sample_data&#39;</span><span class="p">)</span>
<span class="n">D7AbsoluteCrossSections</span><span class="p">(</span><span class="n">InputWorkspace</span><span class="o">=</span><span class="s1">&#39;sample_data&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s1">&#39;normalised_sample_magnetic&#39;</span><span class="p">,</span>
                        <span class="n">CrossSectionSeparationMethod</span><span class="o">=</span><span class="s1">&#39;XYZ&#39;</span><span class="p">,</span> <span class="n">NormalisationMethod</span><span class="o">=</span><span class="s1">&#39;Paramagnetic&#39;</span><span class="p">,</span>
                        <span class="n">SampleAndEnvironmentProperties</span><span class="o">=</span><span class="n">sampleProperties</span><span class="p">,</span> <span class="n">AbsoluteUnitsNormalisation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The number of entries in the normalised data is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mtd</span><span class="p">[</span><span class="s1">&#39;normalised_sample_magnetic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getNumberOfEntries</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>The number of entries in the normalised data is: 6
</pre></div>
</div>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id10">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Scharpf, O. and Capellmann, H.
<em>The XYZ‐Difference Method with Polarized Neutrons and the Separation of Coherent, Spin Incoherent, and Magnetic Scattering Cross Sections in a Multidetector</em>
Physica Status Solidi (A) <strong>135</strong> (1993) 359-379
<a class="reference external" href="https://doi.org/10.1002/pssa.2211350204">doi: 10.1002/pssa.2211350204</a></li>
<li>Stewart, J. R. and Deen, P. P. and Andersen, K. H. and Schober, H. and Barthelemy, J.-F. and Hillier, J. M. and Murani, A. P. and Hayes, T. and Lindenau, B.
<em>Disordered materials studied using neutron polarization analysis on the multi-detector spectrometer, D7</em>
Journal of Applied Crystallography <strong>42</strong> (2009) 69-84
<a class="reference external" href="https://doi.org/10.1107/S0021889808039162">doi: 10.1107/S0021889808039162</a></li>
<li>G. Ehlers, J. R. Stewart, A. R. Wildes, P. P. Deen, and K. H. Andersen
<em>Generalization of the classical xyz-polarization analysis technique to out-of-plane and inelastic scattering</em>
Review of Scientific Instruments <strong>84</strong> (2013), 093901
<a class="reference external" href="https://doi.org/10.1063/1.4819739">doi: 10.1063/1.4819739</a></li>
</ol>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/ILL/Diffraction.html">ILL\Diffraction</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id11">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/be3e0b0ee38557d9593e311f5a2f06503b508191/Framework/PythonInterface/plugins/algorithms/WorkflowAlgorithms/D7AbsoluteCrossSections.py">D7AbsoluteCrossSections.py</a> <em>(last modified: 2021-01-11)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="CylinderPaalmanPingsCorrection-v2.html" title="Previous Chapter: CylinderPaalmanPingsCorrection v2"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; CylinderPaalm...</span>
    </a>
  </li>
  <li>
    <a href="D7YIGPositionCalibration-v1.html" title="Next Chapter: D7YIGPositionCalibration v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">D7YIGPosition... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2021-02-09.<br/>
    </p>
  </div>
</footer>
  </body>
</html>