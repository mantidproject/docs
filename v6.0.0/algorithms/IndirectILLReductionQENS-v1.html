<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>IndirectILLReductionQENS v1</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="IndirectQuickRun v1" href="IndirectQuickRun-v1.html" />
    <link rel="prev" title="IndirectILLReductionFWS v1" href="IndirectILLReductionFWS-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.0</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="indirectillreductionqens-v1">
<span id="algm-indirectillreductionqens"></span><span id="algm-indirectillreductionqens-v1"></span><h1>IndirectILLReductionQENS v1<a class="headerlink" href="#indirectillreductionqens-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="id1">
<span id="index-0"></span><a class="screenshot reference internal image-reference" href="../_images/IndirectILLReductionQENS-v1_dlg.png"><img alt="../_images/IndirectILLReductionQENS-v1_dlg.png" class="screenshot" src="../_images/IndirectILLReductionQENS-v1_dlg.png" style="width: 349px;" /></a>
<p class="caption"><span class="caption-text"><strong>IndirectILLReductionQENS</strong> dialog.</span></p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id2">Summary</a><ul>
<li><a class="reference internal" href="#see-also" id="id3">See Also</a></li>
</ul>
</li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a><ul>
<li><a class="reference internal" href="#multiple-file-reduction" id="id6">Multiple File Reduction</a></li>
<li><a class="reference internal" href="#unmirror-options" id="id7">Unmirror Options</a></li>
<li><a class="reference internal" href="#vanadium-calibration" id="id8">Vanadium Calibration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#output" id="id9">Output</a></li>
<li><a class="reference internal" href="#workflow" id="id10">Workflow</a></li>
<li><a class="reference internal" href="#usage" id="id11">Usage</a></li>
<li><a class="reference internal" href="#source" id="id12">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Performs quasi-elastic neutron scattering (QENS) multiple file reduction for ILL indirect geometry data, instrument IN16B.</p>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id3">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="IndirectILLReductionFWS-v1.html#algm-indirectillreductionfws"><span class="std std-ref">IndirectILLReductionFWS</span></a>, <a class="reference internal" href="IndirectILLEnergyTransfer-v1.html#algm-indirectillenergytransfer"><span class="std std-ref">IndirectILLEnergyTransfer</span></a></p>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="2%" />
<col width="5%" />
<col width="4%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Run</td>
<td>Input</td>
<td>list of str lists</td>
<td><em>Mandatory</em></td>
<td>Run number(s) of sample run(s). Allowed values: [‘nxs’]</td>
</tr>
<tr class="row-odd"><td>BackgroundRun</td>
<td>Input</td>
<td>list of str lists</td>
<td>&#160;</td>
<td>Run number(s) of background (empty can) run(s). Allowed values: [‘nxs’]</td>
</tr>
<tr class="row-even"><td>CalibrationRun</td>
<td>Input</td>
<td>list of str lists</td>
<td>&#160;</td>
<td>Run number(s) of vanadium calibration run(s). Allowed values: [‘nxs’]</td>
</tr>
<tr class="row-odd"><td>CalibrationBackgroundRun</td>
<td>Input</td>
<td>list of str lists</td>
<td>&#160;</td>
<td>Run number(s) of background (empty can) run(s) for vanadium run. Allowed values: [‘nxs’]</td>
</tr>
<tr class="row-even"><td>AlignmentRun</td>
<td>Input</td>
<td>list of str lists</td>
<td>&#160;</td>
<td>Run number(s) of vanadium run(s) used for peak alignment for UnmirrorOption=[5, 7]. Allowed values: [‘nxs’]</td>
</tr>
<tr class="row-odd"><td>SumRuns</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether to sum all the input runs.</td>
</tr>
<tr class="row-even"><td>CropDeadMonitorChannels</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether or not to exclude the first and last few channels with 0 monitor count in the energy transfer formula.</td>
</tr>
<tr class="row-odd"><td>UnmirrorOption</td>
<td>Input</td>
<td>number</td>
<td>6</td>
<td>Unmirroring options :  0 no unmirroring 1 sum of left and right 2 left 3 right 4 shift right according to left and sum 5 like 4, but use alignment run for peak positions 6 center both left and right at zero and sum 7 like 6, but use alignment run for peak positions</td>
</tr>
<tr class="row-even"><td>BackgroundScalingFactor</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Scaling factor for background subtraction</td>
</tr>
<tr class="row-odd"><td>CalibrationBackgroundScalingFactor</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Scaling factor for background subtraction for vanadium calibration</td>
</tr>
<tr class="row-even"><td>CalibrationPeakRange</td>
<td>Input</td>
<td>dbl list</td>
<td>-0.003,0.003</td>
<td>Peak range for integration over calibration file peak (in mev)</td>
</tr>
<tr class="row-odd"><td>MapFile</td>
<td>Input</td>
<td>string</td>
<td>&#160;</td>
<td>Filename of the detector grouping map file to use.  By default all the pixels will be summed per each tube.  Use .map or .xml file (see GroupDetectors documentation) only if different range is needed for each tube. Allowed values: [‘map’, ‘xml’]</td>
</tr>
<tr class="row-even"><td>ManualPSDIntegrationRange</td>
<td>Input</td>
<td>long list</td>
<td>1,128</td>
<td>Integration range of vertical pixels in each PSD tube.  By default all the pixels will be summed per each tube.  Use this option if the same range (other than default) is needed for all the tubes.</td>
</tr>
<tr class="row-odd"><td>Analyser</td>
<td>Input</td>
<td>string</td>
<td>silicon</td>
<td>Analyser crystal. Allowed values: [‘silicon’]</td>
</tr>
<tr class="row-even"><td>Reflection</td>
<td>Input</td>
<td>string</td>
<td>111</td>
<td>Analyser reflection. Allowed values: [‘111’, ‘311’]</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td>WorkspaceGroup</td>
<td><em>Mandatory</em></td>
<td>Group name for the reduced workspace(s).</td>
</tr>
<tr class="row-even"><td>SpectrumAxis</td>
<td>Input</td>
<td>string</td>
<td>SpectrumNumber</td>
<td>The spectrum axis conversion target. Allowed values: [‘SpectrumNumber’, ‘2Theta’, ‘Q’, ‘Q2’]</td>
</tr>
<tr class="row-odd"><td>DiscardSingleDetectors</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Whether to discard the spectra of single detectors.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Performs a multiple-file QENS (Quasi-Elastic Neutron Scattering) data reduction for indirect geometry <strong>ILL</strong> instrument <strong>IN16B</strong>.
It uses internally the <a class="reference internal" href="IndirectILLEnergyTransfer-v1.html#algm-indirectillenergytransfer"><span class="std std-ref">IndirectILLEnergyTransfer</span></a> algorithm.</p>
<div class="section" id="multiple-file-reduction">
<h3><a class="toc-backref" href="#id6">Multiple File Reduction</a><a class="headerlink" href="#multiple-file-reduction" title="Permalink to this headline">¶</a></h3>
<p>The algorithm is capable of running over multiple files.  Run property
needs to be specified following the syntax in <a class="reference internal" href="../api/python/mantid/api/MultipleFileProperty.html#mantid.api.MultipleFileProperty" title="mantid.api.MultipleFileProperty"><code class="xref py py-obj docutils literal"><span class="pre">MultipleFileProperty</span></code></a>.
When <code class="docutils literal"><span class="pre">SumRuns=True</span></code>, all the runs will be merged while loading.
Note, for <strong>Range</strong> and <strong>Stepped Range</strong>, <code class="docutils literal"><span class="pre">SumRuns</span></code> will be
ignored.  Use <strong>Added Range</strong> and <strong>Added Stepped Range</strong> instead (see
<a class="reference internal" href="../api/python/mantid/api/MultipleFileProperty.html#mantid.api.MultipleFileProperty" title="mantid.api.MultipleFileProperty"><code class="xref py py-obj docutils literal"><span class="pre">MultipleFileProperty</span></code></a>).  For <code class="docutils literal"><span class="pre">BackgroundRun</span></code>,
<code class="docutils literal"><span class="pre">CalibrationRun</span></code>, <code class="docutils literal"><span class="pre">CalibrationBackgroundRun</span></code> and <code class="docutils literal"><span class="pre">AlignmentRun</span></code> all the runs will be automatically summed.</p>
</div>
<div class="section" id="unmirror-options">
<h3><a class="toc-backref" href="#id7">Unmirror Options</a><a class="headerlink" href="#unmirror-options" title="Permalink to this headline">¶</a></h3>
<p><strong>IN16B</strong> can record data with mirror sense, where the spectra for the acceleration and
deceleration phase of the Doppler drive are recorded separately, or without.
Technically this is defined in the <code class="docutils literal"><span class="pre">Doppler.mirror_sense</span></code> entry in the sample logs.
For the data without mirror sense (i.e. mirror_sense = 16) only three unmirror options are valid:</p>
<p>0: No x-axis shift. (Options 0-5 will fall back to 0).</p>
<p>6: Centering the peaks at the zero energy transfer.</p>
<p>7: Centering the peaks using the corresponding vanadium alignment run.</p>
<p>For the data with mirror sense (i.e. mirror_sense = 14) there are 8 options available:</p>
<p>0: Left and right wings are returned separately.</p>
<p>1: Left and right wings will summed.</p>
<p>2: Left wing will be returned.</p>
<p>3: Right wing will be returned.</p>
<p>4: Peaks in the right wing will be positioned at peak positions in the left wing, and then they will be summed.</p>
<p>5: Right wing will be shifted according with the offsets of the peak positions in left and right wings in vanadium alignment run.</p>
<p>6: Peaks in both, left and right wings will be centered at zero energy transfer and then they will be summed.</p>
<p>7: Left and right wings will be shifted according to offsets of peak positions of left and right wings in corresponding vanadium alignment run.</p>
<p>Options 5 and 7 require the <code class="docutils literal"><span class="pre">AlignmentRun</span></code> (vanadium) to determine the peak positions to align with.</p>
<p><a class="reference internal" href="MatchPeaks-v1.html#algm-matchpeaks"><span class="std std-ref">MatchPeaks</span></a> algorithm is invoked for aligning the peaks with different options.</p>
<p>Note, that both detector calibration and background subtraction are performed wing-by-wing, i.e. unmirroring is the very final step.</p>
</div>
<div class="section" id="vanadium-calibration">
<h3><a class="toc-backref" href="#id8">Vanadium Calibration</a><a class="headerlink" href="#vanadium-calibration" title="Permalink to this headline">¶</a></h3>
<p>Integration range can be specified to integrate over spectra in <code class="docutils literal"><span class="pre">CalibrationRun</span></code>. Note, that before integration, the spectra will be
centered at 0-energy transfer (see Unmirror Option 6 above) for the calibration run.</p>
</div>
</div>
<div class="section" id="output">
<h2><a class="toc-backref" href="#id9">Output</a><a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference internal" href="../concepts/WorkspaceGroup.html#workspacegroup"><span class="std std-ref">WorkspaceGroup</span></a> will be returned, containing workspaces for each individual (unsummed) run.</p>
</div>
<div class="section" id="workflow">
<h2><a class="toc-backref" href="#id10">Workflow</a><a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/IndirectILLReductionQENS-v1_wkflw.png" src="../_images/IndirectILLReductionQENS-v1_wkflw.png" />
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id11">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - IndirectILLReduction : default options</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">IndirectILLReductionQENS</span><span class="p">(</span><span class="n">Run</span><span class="o">=</span><span class="s1">&#39;ILL/IN16B/136553:136555.nxs&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result is a WorkspaceGroup, that contains </span><span class="si">{:d}</span><span class="s2"> workspaces&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getNumberOfEntries</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the name of the first one is </span><span class="si">{}</span><span class="s2"> corresponding to run 136553&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;it has </span><span class="si">{:d}</span><span class="s2"> spectra and </span><span class="si">{:d}</span><span class="s2"> bins&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">(),</span><span class="n">ws</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">blocksize</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Result is a WorkspaceGroup, that contains 3 workspaces
the name of the first one is 136553_ws_red corresponding to run 136553
it has 18 spectra and 1024 bins
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/Workflow/MIDAS.html">Workflow\MIDAS</a> | <a class="reference external" href="categories/Workflow/Inelastic.html">Workflow\Inelastic</a> | <a class="reference external" href="categories/Inelastic/Indirect.html">Inelastic\Indirect</a> | <a class="reference external" href="categories/Inelastic/Reduction.html">Inelastic\Reduction</a> | <a class="reference external" href="categories/ILL/Indirect.html">ILL\Indirect</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id12">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/be3e0b0ee38557d9593e311f5a2f06503b508191/Framework/PythonInterface/plugins/algorithms/WorkflowAlgorithms/IndirectILLReductionQENS.py">IndirectILLReductionQENS.py</a> <em>(last modified: 2020-03-27)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="IndirectILLReductionFWS-v1.html" title="Previous Chapter: IndirectILLReductionFWS v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; IndirectILLRe...</span>
    </a>
  </li>
  <li>
    <a href="IndirectQuickRun-v1.html" title="Next Chapter: IndirectQuickRun v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">IndirectQuickRun v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2021-02-09.<br/>
    </p>
  </div>
</footer>
  </body>
</html>