<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Engineering Diffraction</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Filter Events Interface" href="Filter Events.html" />
    <link rel="prev" title="Dynamic PDF" href="Dynamic PDF Background Remover.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.0</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <p><span class="math">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<div class="section" id="engineering-diffraction">
<span id="engineering-diffraction-ref"></span><h1>Engineering Diffraction<a class="headerlink" href="#engineering-diffraction" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#interface-overview" id="id3">Interface Overview</a><ul>
<li><a class="reference internal" href="#general-options" id="id4">General Options</a></li>
<li><a class="reference internal" href="#other-information" id="id5">Other Information</a></li>
</ul>
</li>
<li><a class="reference internal" href="#calibration" id="id6">Calibration</a><ul>
<li><a class="reference internal" href="#cropping" id="id7">Cropping</a></li>
<li><a class="reference internal" href="#parameters" id="id8">Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#focus" id="id9">Focus</a><ul>
<li><a class="reference internal" href="#id1" id="id10">Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fitting" id="id11">Fitting</a><ul>
<li><a class="reference internal" href="#id2" id="id12">Parameters</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="interface-overview">
<h2><a class="toc-backref" href="#id3">Interface Overview</a><a class="headerlink" href="#interface-overview" title="Permalink to this headline">¶</a></h2>
<p>This custom interface will integrate several tasks related to engineering
diffraction. In its current state it provides functionality for creating
and loading calibration files and focusing ENGINX run files.</p>
<p>Functionality for performing single peak fitting on focused run files is currently in progress.</p>
<p>This interface is under active development.</p>
<div class="section" id="general-options">
<h3><a class="toc-backref" href="#id4">General Options</a><a class="headerlink" href="#general-options" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>RB Number</dt>
<dd>The reference number for the output paths (usually an experiment reference
number at ISIS). Leaving this field empty will result in no user directories
being created, and only the general directory will be used for file storage.</dd>
<dt>Instrument</dt>
<dd>Select the instrument (ENGINX or IMAT). Currently only ENGINX is fully
supported.</dd>
</dl>
<dl class="docutils">
<dt>?</dt>
<dd>Show this documentation page.</dd>
<dt>Settings</dt>
<dd>Provides a range of options that apply across the entire interface, currently
providing the option to change the default output directory and force the
recalculation of the vanadium correction files. The user can also select the
log values from a list which are loaded with data in the fitting tab and select
a log by which to sort the runs in a sequential fit.</dd>
<dt>Close</dt>
<dd>Close the interface.</dd>
</dl>
</div>
<div class="section" id="other-information">
<h3><a class="toc-backref" href="#id5">Other Information</a><a class="headerlink" href="#other-information" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Red Stars</dt>
<dd>Red stars next to browse boxes and other fields indicate that the file
could not be found. Hover over the star to see more information.</dd>
<dt>Status Bar</dt>
<dd>The status bar shows the calibration run numbers the GUI is currently using.
It also displays the save directory (which can be changed in the settings).</dd>
<dt>Saved File Outputs</dt>
<dd><p class="first">The location of files saved by the GUI during processing will be shown in the mantid
messages log.</p>
<p class="last"><em>Note</em>: The locations are shown at “Notice” level, so may not appear if the messages log
is on the incorrect setting.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="calibration">
<span id="ui-engineering-calibration"></span><h2><a class="toc-backref" href="#id6">Calibration</a><a class="headerlink" href="#calibration" title="Permalink to this headline">¶</a></h2>
<p>This tab currently provides a graphical interface to create new calibrations, using the
<a class="reference internal" href="../algorithms/EnggCalibrate-v1.html#algm-enggcalibrate"><span class="std std-ref">EnggCalibrate</span></a> algorithm, and visualise them.
It also allows for the loading of GSAS parameter files created by the calibration process
to load a previously created calibration into the interface.</p>
<p>When loading an existing calibration, the fields for creating a new calibration will be
automatically filled, allowing the recreation of the workspaces and plots generated by
creating a new calibration.</p>
<p>The “Plot Output” check-box will plot vanadium curves and ceria peaks for new calibrations.
Four plots will be generated (for ENGINX), one of each plot for each of the detector banks.</p>
<p>Creating a new calibration file generates 3 GSAS instrument parameter files,
one covering all banks and separate ones for each individual bank. All 3 files are written
to the same directory:</p>
<p><cite>&lt;CHOSEN_OUTPUT_DIRECTORY&gt;/Calibration/</cite></p>
<p>If an RB number has been specified the files will also be saved to a user directory
in the base directory:</p>
<p><cite>&lt;CHOSEN_OUTPUT_DIRECTORY&gt;/User/&lt;RB_NUMBER&gt;/Calibration/</cite></p>
<div class="section" id="cropping">
<h3><a class="toc-backref" href="#id7">Cropping</a><a class="headerlink" href="#cropping" title="Permalink to this headline">¶</a></h3>
<p>The interface also provides the ability to restrict a new calibration to one of the two banks
or to a custom list of spectra.</p>
</div>
<div class="section" id="parameters">
<h3><a class="toc-backref" href="#id8">Parameters</a><a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Vanadium Number</dt>
<dd>The run number or file path used to correct the calibration and experiment runs.</dd>
<dt>Calibration Sample Number</dt>
<dd>The run number for the calibration sample run (such as ceria) used to calibrate
experiment runs.</dd>
<dt>Path</dt>
<dd>The path to the GSAS parameter file to be loaded.</dd>
<dt>Bank/Spectra</dt>
<dd>Select a bank to crop to or specify a custom spectra will be entered.</dd>
<dt>Custom Spectra</dt>
<dd>A comma separated list of spectra to restrict the calibration to. Can be provided as single spectrum numbers
or ranges using hyphens (e.g. 14-150, 405, 500-600).</dd>
</dl>
</div>
</div>
<div class="section" id="focus">
<h2><a class="toc-backref" href="#id9">Focus</a><a class="headerlink" href="#focus" title="Permalink to this headline">¶</a></h2>
<p>This tab allows for the focusing of data files by making use of the <a class="reference internal" href="../algorithms/EnggFocus-v1.html#algm-enggfocus"><span class="std std-ref">EnggFocus</span></a> algorithm.</p>
<p>Files can be selected by providing run numbers or selecting the files manually using the browse button.</p>
<p>In order to use the tab, a new or existing calibration must be created or loaded (see above).</p>
<p>The interface allows for two kinds of focusing:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><strong>Normal Focusing:</strong></dt>
<dd>Run numbers can be entered and both banks will be focused for each workspace.
The output workspaces will have a prefix for the run they are for and a suffix denoting which bank they are for.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>Cropped Focusing:</strong></dt>
<dd>The entered workspace can be cropped to one of the two banks or to a user defined set of spectra.
Workspaces cropped using custom spectra lists will have the suffix “cropped”.</dd>
</dl>
</li>
</ul>
<p>Ticking the “Plot Focused Workspace” checkbox will create a plot of the focused workspace when the algorithm is
complete. The number of plots that are generated is dependent on the type of focusing done. Normal focusing generates
a plot for each bank and cropped focusing generates a plot for the single bank or one for the chosen spectra.</p>
<p>Clicking the focus button will begin the focusing algorithm for the selected run files. The button and plotting checkbox
will be disabled until the fitting algorithm is complete.</p>
<p>The focused output files are saved in NeXus, GSS, and TOPAS format. The process will also output a CSV file containing
all numerical sample logs. All of these files are saved to:</p>
<p><cite>&lt;CHOSEN_OUTPUT_DIRECTORY&gt;/Focus/</cite></p>
<p>If an RB number has been specified the files will also be saved to a user directory:</p>
<p><cite>&lt;CHOSEN_OUTPUT_DIRECTORY&gt;/User/&lt;RB_NUMBER&gt;/Focus/</cite></p>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id10">Parameters</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Sample Run Number</dt>
<dd>The run numbers of or file paths to the data files to be focused.</dd>
<dt>Bank/Spectra</dt>
<dd>Select which bank to restrict the focusing to or allow for the entry of custom spectra.</dd>
<dt>Custom Spectra</dt>
<dd>A comma separated list of spectra to restrict the calibration to. Can be provided as single spectrum numbers
or ranges using hyphens (e.g. 14-150, 405, 500-600).</dd>
</dl>
</div>
</div>
<div class="section" id="fitting">
<h2><a class="toc-backref" href="#id11">Fitting</a><a class="headerlink" href="#fitting" title="Permalink to this headline">¶</a></h2>
<p>This tab will allow for single peak fitting of focused run files.</p>
<p>Focused run files can be loaded from the file system into mantid from the interface and converted to units TOF or d-sapcing. The interface will keep track of all the
workspaces that it has created from these files. When a focussed run is loaded, the proton charge weighted average (and standard deviation) of the log values set in the
settings options are calculated and stored in a grouped workspace accessible in the main mantid window.</p>
<p>Loaded workspaces can be plotted in the interface and the mantid fitting capability can be accessed from the ‘Fit’ button on the plot toolbar.
This allows for the user to select peaks of any supported type (e.g. <a class="reference internal" href="../fitting/fitfunctions/PseudoVoigt.html#func-pseudovoigt"><span class="std std-ref">Pseudo-Voigt</span></a> and
<a class="reference internal" href="../fitting/fitfunctions/BackToBackExponential.html#func-backtobackexponential"><span class="std std-ref">BackToBackExponential</span></a>) by right-clicking on the plot. The inital parameters can be varied interactively by dragging sliders (vertical lines on the plot).
After a successful fit the best-fit model is stored as a setup in the fit browser (Setup &gt; Custom Setup) with the name of the workspace fitted.
Selecting this loads the function and the parameters and the curve can be inspected by doing Display &gt; Plot Guess.</p>
<p>The output from the fit is stored in a group of workspaces that contains a matrix workspace of the fit value and error for each parameter in the model. If there is more than one of the same function, the parameters are stored in the same workspace with different x-values. For example, if there were two Gaussian peaks then there would be a workspace for each parameter of the Gaussian (i.e. Height, PeakCentre, Sigma) each of which will have two columns corresponding to each peak. Each workspace has a spectra per run loaded (each row in the table of the UI fitting tab). In general different models/functions could be fitted to each run, so when there is a parameter that does not exist for a run (or that run has not yet been fitted), the Y and E fields in the relevant row are filled with NaNs. The group of fit workspaces also contains a table workspace that stores the model string that can be copied into the fit browser (Setup &gt; Manage Setup &gt; Load From String).</p>
<p>The workspaces can be fit sequentially (sorted by the average of a chosen log in the settings). If a valid model is present in the fit browser then the Sequential Fit button (below the table in the UI) will be enabled - it is not necessary to run an initial fit. The user may want to fix or constrain certain model parameters, which can be done in the usual way in the fit browser. The sequential fit will popoulate the fit tables as above and store the model in the Custom Setups.</p>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id12">Parameters</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Focused Run Files</dt>
<dd>A comma separated list of files to load. Selecting files from the file system using the browse button will do this
for you.</dd>
<dt>Peak Positions</dt>
<dd>A comma separated list of peak positions to be used when performing the fit.</dd>
</dl>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Interfaces.html">Interfaces</a> | <a class="reference external" href="../algorithms/categories/Diffraction.html">Diffraction</a></p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="Dynamic PDF Background Remover.html" title="Previous Chapter: Dynamic PDF"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Dynamic PDF</span>
    </a>
  </li>
  <li>
    <a href="Filter Events.html" title="Next Chapter: Filter Events Interface"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Filter Events... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2021-02-09.<br/>
    </p>
  </div>
</footer>
  </body>
</html>