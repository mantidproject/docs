<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>AlignAndFocusPowderFromFiles v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.11.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="AlignComponents v1" href="AlignComponents-v1.html" />
    <link rel="prev" title="AlignAndFocusPowder v1" href="AlignAndFocusPowder-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.11</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://www.mantidproject.org/Documentation">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="alignandfocuspowderfromfiles-v1">
<span id="algm-alignandfocuspowderfromfiles"></span><span id="algm-alignandfocuspowderfromfiles-v1"></span><h1>AlignAndFocusPowderFromFiles v1<a class="headerlink" href="#alignandfocuspowderfromfiles-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/AlignAndFocusPowderFromFiles-v1_dlg.png"><img alt="../_images/AlignAndFocusPowderFromFiles-v1_dlg.png" class="screenshot" src="../_images/AlignAndFocusPowderFromFiles-v1_dlg.png" style="width: 244px;" /></a>
<p class="caption"><strong>AlignAndFocusPowderFromFiles</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#source" id="id4">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>The algorithm used for reduction of powder diffraction data</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="1%" />
<col width="8%" />
<col width="8%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Filename</td>
<td>Input</td>
<td>list of str lists</td>
<td><em>Mandatory</em></td>
<td>Files to combine in reduction. Allowed extensions: [&#8216;_event.nxs&#8217;, &#8216;.nxs.h5&#8217;]</td>
</tr>
<tr class="row-odd"><td>MaxChunkSize</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Specify maximum Gbytes of file to read in one chunk.  Default is whole file.</td>
</tr>
<tr class="row-even"><td>FilterBadPulses</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Filter out events measured while proton charge is more than 5% below average</td>
</tr>
<tr class="row-odd"><td>AbsorptionWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td>&nbsp;</td>
<td>Divide data by this Pixel-by-pixel workspace</td>
</tr>
<tr class="row-even"><td>CacheDir</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>the directory in which the cache file will be created</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Combined output workspace</td>
</tr>
<tr class="row-even"><td>Characterizations</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><em>TableWorkspace</em></a></td>
<td>&nbsp;</td>
<td>Characterizations table</td>
</tr>
<tr class="row-odd"><td>CalFileName</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>The name of the calibration file with offset, masking, and grouping data. Allowed extensions: [&#8216;.h5&#8217;, &#8216;.hd5&#8217;, &#8216;.hdf&#8217;, &#8216;.cal&#8217;]</td>
</tr>
<tr class="row-even"><td>GroupFilename</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Overrides grouping from CalFileName. Allowed extensions: [&#8216;.xml&#8217;, &#8216;.cal&#8217;]</td>
</tr>
<tr class="row-odd"><td>GroupingWorkspace</td>
<td>InOut</td>
<td>GroupingWorkspace</td>
<td>&nbsp;</td>
<td>Optional: A GroupingWorkspace giving the grouping info.</td>
</tr>
<tr class="row-even"><td>CalibrationWorkspace</td>
<td>InOut</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><em>TableWorkspace</em></a></td>
<td>&nbsp;</td>
<td>Optional: A Workspace containing the calibration information. Either this or CalibrationFile needs to be specified.</td>
</tr>
<tr class="row-odd"><td>OffsetsWorkspace</td>
<td>Input</td>
<td>OffsetsWorkspace</td>
<td>&nbsp;</td>
<td>Optional: An OffsetsWorkspace giving the detector calibration values.</td>
</tr>
<tr class="row-even"><td>MaskWorkspace</td>
<td>InOut</td>
<td>MaskWorkspace</td>
<td>&nbsp;</td>
<td>Optional: A workspace giving which detectors are masked.</td>
</tr>
<tr class="row-odd"><td>MaskBinTable</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><em>TableWorkspace</em></a></td>
<td>&nbsp;</td>
<td>Optional: A workspace giving pixels and bins to mask.</td>
</tr>
<tr class="row-even"><td>Params</td>
<td>Input</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>A comma separated list of first bin boundary, width, last bin boundary. Optionally this can be followed by a comma and more widths and last boundary pairs. Negative width values indicate logarithmic binning.</td>
</tr>
<tr class="row-odd"><td>ResampleX</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Number of bins in x-axis. Non-zero value overrides &#8220;Params&#8221; property. Negative value means logarithmic binning.</td>
</tr>
<tr class="row-even"><td>Dspacing</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Bin in Dspace. (True is Dspace; False is TOF)</td>
</tr>
<tr class="row-odd"><td>DMin</td>
<td>Input</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>Minimum for Dspace axis. (Default 0.)</td>
</tr>
<tr class="row-even"><td>DMax</td>
<td>Input</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>Maximum for Dspace axis. (Default 0.)</td>
</tr>
<tr class="row-odd"><td>TMin</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>Minimum for TOF axis. Defaults to 0.</td>
</tr>
<tr class="row-even"><td>TMax</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>Maximum for TOF or dspace axis. Defaults to 0.</td>
</tr>
<tr class="row-odd"><td>PreserveEvents</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>If the InputWorkspace is an EventWorkspace, this will preserve the full event list (warning: this will use much more memory!).</td>
</tr>
<tr class="row-even"><td>RemovePromptPulseWidth</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Width of events (in microseconds) near the prompt pulse to remove. 0 disables</td>
</tr>
<tr class="row-odd"><td>CompressTolerance</td>
<td>Input</td>
<td>number</td>
<td>0.01</td>
<td>Compress events (in microseconds) within this tolerance. (Default 0.01)</td>
</tr>
<tr class="row-even"><td>UnwrapRef</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Reference total flight path for frame unwrapping. Zero skips the correction</td>
</tr>
<tr class="row-odd"><td>LowResRef</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Reference DIFC for resolution removal. Zero skips the correction</td>
</tr>
<tr class="row-even"><td>CropWavelengthMin</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Crop the data at this minimum wavelength. Overrides LowResRef.</td>
</tr>
<tr class="row-odd"><td>CropWavelengthMax</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>Crop the data at this maximum wavelength. Forces use of CropWavelengthMin.</td>
</tr>
<tr class="row-even"><td>LowResSpectrumOffset</td>
<td>Input</td>
<td>number</td>
<td>-1</td>
<td>Offset on spectrum No of low resolution spectra from high resolution one. If negative, then all the low resolution TOF will not be processed.  Otherwise, low resolution TOF will be stored in an additional set of spectra. If offset is equal to 0, then the low resolution will have same spectrum Nos as the normal ones.  Otherwise, the low resolution spectra will have spectrum IDs offset from normal ones.</td>
</tr>
<tr class="row-odd"><td>ReductionProperties</td>
<td>Input</td>
<td>string</td>
<td>__powdereduction</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>PrimaryFlightPath</td>
<td>Input</td>
<td>number</td>
<td>-1</td>
<td>If positive, focus positions are changed.  (Default -1)</td>
</tr>
<tr class="row-odd"><td>SpectrumIDs</td>
<td>Input</td>
<td>int list</td>
<td>&nbsp;</td>
<td>Optional: Spectrum Nos (note that it is not detector ID or workspace indices).</td>
</tr>
<tr class="row-even"><td>L2</td>
<td>Input</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>Optional: Secondary flight (L2) paths for each detector</td>
</tr>
<tr class="row-odd"><td>Polar</td>
<td>Input</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>Optional: Polar angles (two thetas) for detectors</td>
</tr>
<tr class="row-even"><td>Azimuthal</td>
<td>Input</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>Azimuthal angles (out-of-plain) for detectors</td>
</tr>
<tr class="row-odd"><td>FrequencyLogNames</td>
<td>Input</td>
<td>str list</td>
<td>SpeedRequest1,Speed1,frequency,skf1.speed</td>
<td>Candidate log names for frequency</td>
</tr>
<tr class="row-even"><td>WaveLengthLogNames</td>
<td>Input</td>
<td>str list</td>
<td>LambdaRequest,lambda,skf12.lambda</td>
<td>Candidate log names for wave length</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This is a workflow algorithm that wraps
<a class="reference internal" href="AlignAndFocusPowder-v1.html#algm-alignandfocuspowder"><em>AlignAndFocusPowder</em></a> to perform a double loop over files
with chunks, accumulating the result. The additional properties from
what is allowed in <a class="reference internal" href="AlignAndFocusPowder-v1.html#algm-alignandfocuspowder"><em>AlignAndFocusPowder</em></a> is for how the file
is loaded (e.g. <tt class="docutils literal"><span class="pre">MaxChunkSize</span></tt> and <tt class="docutils literal"><span class="pre">FilterBadPulses</span></tt>), an optional
<tt class="docutils literal"><span class="pre">Characterizations</span></tt> <a class="reference internal" href="../api/python/mantid/api/ITableWorkspace.html#mantid.api.ITableWorkspace" title="mantid.api.ITableWorkspace"><tt class="xref py py-class docutils literal"><span class="pre">table</span></tt></a>, and
an optional <tt class="docutils literal"><span class="pre">AbsorptionWorkspace</span></tt>. The <tt class="docutils literal"><span class="pre">AbsorptionWorkspace</span></tt>
should be in units of <tt class="docutils literal"><span class="pre">Wavelength</span></tt> for every detector pixel and is
divided from the chunk after loaded. For all other information, see
<a class="reference internal" href="AlignAndFocusPowder-v1.html#algm-alignandfocuspowder"><em>AlignAndFocusPowder</em></a>.</p>
<p>In broad terms, this algorithm is the pseudo-code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
    <span class="n">cachefile</span> <span class="o">=</span> <span class="n">CreateCacheFilename</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cachefile</span> <span class="n">exists</span><span class="p">:</span>
        <span class="n">wksp_single</span> <span class="o">=</span> <span class="n">LoadNexusProcessed</span><span class="p">(</span><span class="n">cachefile</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">DetermineChunking</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">wksp_single_chunk</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
            <span class="n">wksp_single_chunk</span> <span class="o">=</span> <span class="n">AlignAndFocusPowder</span><span class="p">(</span><span class="n">wksp_single_chunk</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
        <span class="c"># accumulate chunks into wksp_single</span>
        <span class="n">SaveNexusProcess</span><span class="p">(</span><span class="n">wksp_single</span><span class="p">,</span> <span class="n">cachefile</span><span class="p">)</span>
    <span class="c"># accumulate data from files into OutputWorkspace</span>
</pre></div>
</div>
<p>Algorithms used by this are:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="AlignAndFocusPowder-v1.html#algm-alignandfocuspowder-v1"><em>AlignAndFocusPowder v1</em></a></li>
<li><a class="reference internal" href="CompressEvents-v1.html#algm-compressevents-v1"><em>CompressEvents v1</em></a></li>
<li><a class="reference internal" href="ConvertUnits-v1.html#algm-convertunits-v1"><em>ConvertUnits v1</em></a></li>
<li><a class="reference internal" href="CreateCacheFilename-v1.html#algm-createcachefilename-v1"><em>CreateCacheFilename v1</em></a></li>
<li><a class="reference internal" href="DeleteWorkspace-v1.html#algm-deleteworkspace-v1"><em>DeleteWorkspace v1</em></a></li>
<li><a class="reference internal" href="DetermineChunking-v1.html#algm-determinechunking-v1"><em>DetermineChunking v1</em></a></li>
<li><a class="reference internal" href="Divide-v1.html#algm-divide-v1"><em>Divide v1</em></a></li>
<li><a class="reference internal" href="EditInstrumentGeometry-v1.html#algm-editinstrumentgeometry-v1"><em>EditInstrumentGeometry v1</em></a></li>
<li><a class="reference internal" href="FilterBadPulses-v1.html#algm-filterbadpulses-v1"><em>FilterBadPulses v1</em></a></li>
<li><a class="reference internal" href="Load-v1.html#algm-load-v1"><em>Load v1</em></a></li>
<li><a class="reference internal" href="LoadNexusProcessed-v1.html#algm-loadnexusprocessed-v1"><em>LoadNexusProcessed v1</em></a></li>
<li><a class="reference internal" href="PDDetermineCharacterizations-v1.html#algm-pddeterminecharacterizations-v1"><em>PDDetermineCharacterizations v1</em></a></li>
<li><a class="reference internal" href="Plus-v1.html#algm-plus-v1"><em>Plus v1</em></a></li>
<li><a class="reference internal" href="RenameWorkspace-v1.html#algm-renameworkspace-v1"><em>RenameWorkspace v1</em></a></li>
<li><a class="reference internal" href="SaveNexusProcessed-v1.html#algm-savenexusprocessed-v1"><em>SaveNexusProcessed v1</em></a></li>
</ol>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Diffraction/Reduction.html">Diffraction\Reduction</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id4">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/2f15ec50de5065d8b6a032a915ac44d99f4a8835/Framework/PythonInterface/plugins/algorithms/AlignAndFocusPowderFromFiles.py">AlignAndFocusPowderFromFiles.py</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="AlignAndFocusPowder-v1.html" title="Previous Chapter: AlignAndFocusPowder v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; AlignAndFocusPow...</span>
    </a>
  </li>
  <li>
    <a href="AlignComponents-v1.html" title="Next Chapter: AlignComponents v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">AlignComponents ... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>