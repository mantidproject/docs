<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SNSPowderReduction v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="SassenaFFT v1" href="SassenaFFT-v1.html" />
    <link rel="prev" title="SNAPReduce v1" href="SNAPReduce-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.12</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="snspowderreduction-v1">
<span id="algm-snspowderreduction"></span><span id="algm-snspowderreduction-v1"></span><h1>SNSPowderReduction v1<a class="headerlink" href="#snspowderreduction-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/SNSPowderReduction-v1_dlg.png"><img alt="../_images/SNSPowderReduction-v1_dlg.png" class="screenshot" src="../_images/SNSPowderReduction-v1_dlg.png" style="width: 276px;" /></a>
<p class="caption"><strong>SNSPowderReduction</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a><ul>
<li><a class="reference internal" href="#about-filter-wall" id="id4">About Filter Wall</a></li>
<li><a class="reference internal" href="#calibration-grouping-and-masking" id="id5">Calibration, grouping, and masking</a></li>
<li><a class="reference internal" href="#characterization-runs" id="id6">Characterization runs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#workflow" id="id7">Workflow</a></li>
<li><a class="reference internal" href="#usage" id="id8">Usage</a></li>
<li><a class="reference internal" href="#source" id="id9">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>The algorithm used for reduction of powder diffraction data obtained on SNS instruments (e.g. PG3)</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="2%" />
<col width="13%" />
<col width="13%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Filename</td>
<td>Input</td>
<td>list of str lists</td>
<td><em>Mandatory</em></td>
<td>Files to combine in reduction. Allowed extensions: [&#8216;_event.nxs&#8217;, &#8216;.nxs.h5&#8217;]</td>
</tr>
<tr class="row-odd"><td>PreserveEvents</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>If the InputWorkspace is an EventWorkspace, this will preserve the full event list (warning: this will use much more memory!).</td>
</tr>
<tr class="row-even"><td>Sum</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Sum the runs. Does nothing for characterization runs</td>
</tr>
<tr class="row-odd"><td>PushDataPositive</td>
<td>Input</td>
<td>string</td>
<td>None</td>
<td>Add a constant to the data that makes it positive over the whole range. Allowed values: [&#8216;None&#8217;, &#8216;ResetToZero&#8217;, &#8216;AddMinimum&#8217;]</td>
</tr>
<tr class="row-even"><td>ReloadIfWorkspaceExists</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Load the event file again if a workspace with default name exists in ADS. if this is specified as True.  Otherwise, skip loading to save time. User should be cautious to use this option as False.</td>
</tr>
<tr class="row-odd"><td>BackgroundNumber</td>
<td>Input</td>
<td>int list</td>
<td>0</td>
<td>If specified overrides value in CharacterizationRunsFile If -1 turns off correction.</td>
</tr>
<tr class="row-even"><td>VanadiumNumber</td>
<td>Input</td>
<td>int list</td>
<td>0</td>
<td>If specified overrides value in CharacterizationRunsFile. If -1 turns off correction.</td>
</tr>
<tr class="row-odd"><td>VanadiumBackgroundNumber</td>
<td>Input</td>
<td>int list</td>
<td>0</td>
<td>If specified overrides value in CharacterizationRunsFile. If -1 turns off correction.</td>
</tr>
<tr class="row-even"><td>CalibrationFile</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Allowed extensions: [&#8216;.h5&#8217;, &#8216;.hd5&#8217;, &#8216;.hdf&#8217;, &#8216;.cal&#8217;]</td>
</tr>
<tr class="row-odd"><td>GroupingFile</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Overrides grouping from CalibrationFile. Allowed extensions: [&#8216;.xml&#8217;]</td>
</tr>
<tr class="row-even"><td>CharacterizationRunsFile</td>
<td>Input</td>
<td>list of str lists</td>
<td>&nbsp;</td>
<td>File with characterization runs denoted. Allowed values: [&#8216;txt&#8217;]</td>
</tr>
<tr class="row-odd"><td>ExpIniFilename</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Allowed extensions: [&#8216;.ini&#8217;]</td>
</tr>
<tr class="row-even"><td>UnwrapRef</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Reference total flight path for frame unwrapping. Zero skips the correction</td>
</tr>
<tr class="row-odd"><td>LowResRef</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Reference DIFC for resolution removal. Zero skips the correction</td>
</tr>
<tr class="row-even"><td>CropWavelengthMin</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Crop the data at this minimum wavelength. Overrides LowResRef.</td>
</tr>
<tr class="row-odd"><td>CropWavelengthMax</td>
<td>Input</td>
<td>number</td>
<td><em>Optional</em></td>
<td>Crop the data at this maximum wavelength. Forces use of CropWavelengthMin.</td>
</tr>
<tr class="row-even"><td>RemovePromptPulseWidth</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Width of events (in microseconds) near the prompt pulse to remove. 0 disables</td>
</tr>
<tr class="row-odd"><td>MaxChunkSize</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Specify maximum Gbytes of file to read in one chunk.  Default is whole file.</td>
</tr>
<tr class="row-even"><td>Binning</td>
<td>Input</td>
<td>dbl list</td>
<td>0,0,0</td>
<td>Positive is linear bins, negative is logorithmic</td>
</tr>
<tr class="row-odd"><td>ResampleX</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>Number of bins in x-axis. Non-zero value overrides &#8220;Params&#8221; property. Negative value means logarithmic binning.</td>
</tr>
<tr class="row-even"><td>BinInDspace</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>If all three bin parameters a specified, whether they are in dspace (true) or time-of-flight (false)</td>
</tr>
<tr class="row-odd"><td>StripVanadiumPeaks</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Subtract fitted vanadium peaks from the known positions.</td>
</tr>
<tr class="row-even"><td>VanadiumFWHM</td>
<td>Input</td>
<td>number</td>
<td>7</td>
<td>Default=7</td>
</tr>
<tr class="row-odd"><td>VanadiumPeakTol</td>
<td>Input</td>
<td>number</td>
<td>0.05</td>
<td>How far from the ideal position a vanadium peak can be during StripVanadiumPeaks. Default=0.05, negative turns off</td>
</tr>
<tr class="row-even"><td>VanadiumSmoothParams</td>
<td>Input</td>
<td>string</td>
<td>20,2</td>
<td>Default=20,2</td>
</tr>
<tr class="row-odd"><td>VanadiumRadius</td>
<td>Input</td>
<td>number</td>
<td>0.3175</td>
<td>Radius for MultipleScatteringCylinderAbsorption</td>
</tr>
<tr class="row-even"><td>BackgroundSmoothParams</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Default=off, suggested 20,2</td>
</tr>
<tr class="row-odd"><td>FilterBadPulses</td>
<td>Input</td>
<td>number</td>
<td>95</td>
<td>Filter out events measured while proton charge is more than 5% below average</td>
</tr>
<tr class="row-even"><td>ScaleData</td>
<td>Input</td>
<td>number</td>
<td>1</td>
<td>Constant to multiply the data before writing out. This does not apply to PDFgetN files.</td>
</tr>
<tr class="row-odd"><td>SaveAs</td>
<td>Input</td>
<td>string</td>
<td>gsas</td>
<td>List of all output file types. Allowed values are &#8216;fullprof&#8217;, &#8216;gsas&#8217;, &#8216;nexus&#8217;, &#8216;pdfgetn&#8217;, and &#8216;topas&#8217;</td>
</tr>
<tr class="row-even"><td>OutputFilePrefix</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Overrides the default filename for the output file (Optional).</td>
</tr>
<tr class="row-odd"><td>OutputDirectory</td>
<td>Input</td>
<td>string</td>
<td><em>Mandatory</em></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>CacheDir</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>the directory in which the cache file will be created</td>
</tr>
<tr class="row-odd"><td>FinalDataUnits</td>
<td>Input</td>
<td>string</td>
<td>dSpacing</td>
<td>Allowed values: [&#8216;dSpacing&#8217;, &#8216;MomentumTransfer&#8217;]</td>
</tr>
<tr class="row-even"><td>SplittersWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><em>Workspace</em></a></td>
<td>&nbsp;</td>
<td>Splitters workspace for split event workspace.</td>
</tr>
<tr class="row-odd"><td>SplitInformationWorkspace</td>
<td>Input</td>
<td><a class="reference internal" href="../concepts/TableWorkspaces.html#table-workspaces"><em>TableWorkspace</em></a></td>
<td>&nbsp;</td>
<td>Name of table workspace containing information for splitters.</td>
</tr>
<tr class="row-even"><td>LowResolutionSpectraOffset</td>
<td>Input</td>
<td>number</td>
<td>-1</td>
<td>If larger and equal to 0, then process low resolution TOF and offset is the spectra number. Otherwise, ignored.</td>
</tr>
<tr class="row-odd"><td>NormalizeByCurrent</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>Normalize by current</td>
</tr>
<tr class="row-even"><td>CompressTOFTolerance</td>
<td>Input</td>
<td>number</td>
<td>0.01</td>
<td>Tolerance to compress events in TOF.</td>
</tr>
<tr class="row-odd"><td>FrequencyLogNames</td>
<td>Input</td>
<td>str list</td>
<td>SpeedRequest1,Speed1,frequency,skf1.speed</td>
<td>Candidate log names for frequency</td>
</tr>
<tr class="row-even"><td>WaveLengthLogNames</td>
<td>Input</td>
<td>str list</td>
<td>LambdaRequest,lambda,skf12.lambda</td>
<td>Candidate log names for wave length</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<div class="section" id="about-filter-wall">
<h3><a class="toc-backref" href="#id4">About Filter Wall</a><a class="headerlink" href="#about-filter-wall" title="Permalink to this headline">¶</a></h3>
<p>Filter wall is enabled by setting <tt class="docutils literal"><span class="pre">FilterCharacterizations</span></tt> property
to true.  Then the <tt class="docutils literal"><span class="pre">_getTimeFilterWall</span></tt> routine is used to build the
filter wall from the data defined by <tt class="docutils literal"><span class="pre">SplitInformationWorkspace</span></tt> and
<tt class="docutils literal"><span class="pre">SplittersWorkspace</span></tt> properties.  Time filter wall is used in
<tt class="docutils literal"><span class="pre">_loadData</span></tt> to load data in a certain range of time. Here is how the
filter is used:</p>
<ol class="arabic simple">
<li>There is NO filter if filter wall is <tt class="docutils literal"><span class="pre">NONE</span></tt></li>
<li>There is NO lower boundary of the filter wall if <tt class="docutils literal"><span class="pre">wall[0]</span></tt> is
<tt class="docutils literal"><span class="pre">ZERO</span></tt></li>
<li>There is NO upper boundary of the filter wall if <tt class="docutils literal"><span class="pre">wall[1]</span></tt> is
<tt class="docutils literal"><span class="pre">ZERO</span></tt></li>
</ol>
<p>More information is found in <a class="reference internal" href="../concepts/EventFiltering.html#eventfiltering"><em>Event Filtering</em></a>.</p>
</div>
<div class="section" id="calibration-grouping-and-masking">
<h3><a class="toc-backref" href="#id5">Calibration, grouping, and masking</a><a class="headerlink" href="#calibration-grouping-and-masking" title="Permalink to this headline">¶</a></h3>
<p>There are two properties related to calibration (<tt class="docutils literal"><span class="pre">CalibrationFile</span></tt>
and <tt class="docutils literal"><span class="pre">GroupingFile</span></tt>) and three implicit workspace dependencies
(<tt class="docutils literal"><span class="pre">&lt;instrument&gt;_mask</span></tt>, <tt class="docutils literal"><span class="pre">&lt;instrument&gt;_group</span></tt>, and
<tt class="docutils literal"><span class="pre">&lt;instrument&gt;_cal</span></tt>). If the workspaces do not exist, they will be
created during the algorithm&#8217;s execution.</p>
<p>If specified, the <tt class="docutils literal"><span class="pre">CalibrationFile</span></tt> is loaded using
<a class="reference internal" href="LoadDiffCal-v1.html#algm-loaddiffcal"><em>LoadDiffCal v1</em></a>. If the <tt class="docutils literal"><span class="pre">GroupingFile</span></tt> is specified, the
grouping it specifies takes precidence over the one that is in the
<tt class="docutils literal"><span class="pre">CalibrationFile</span></tt>. <a class="reference internal" href="LoadDetectorsGroupingFile-v1.html#algm-loaddetectorsgroupingfile"><em>LoadDetectorsGroupingFile v1</em></a> performs
the loading. The order of preference in which to use is (first found wins):</p>
<ul class="simple">
<li>Calibration: <tt class="docutils literal"><span class="pre">&lt;instrument&gt;_cal</span></tt>, then <tt class="docutils literal"><span class="pre">CalibrationFile</span></tt></li>
<li>Grouping: <tt class="docutils literal"><span class="pre">&lt;instrument&gt;_group</span></tt> workspace, then <tt class="docutils literal"><span class="pre">GroupingFile</span></tt>,
then <tt class="docutils literal"><span class="pre">CalibrationFile</span></tt></li>
<li>Masking: <tt class="docutils literal"><span class="pre">&lt;instrument&gt;_mask</span></tt>, then <tt class="docutils literal"><span class="pre">CalibrationFile</span></tt></li>
</ul>
<p><a class="reference internal" href="AlignAndFocusPowder-v1.html#algm-alignandfocuspowder"><em>AlignAndFocusPowder v1</em></a> does the actual resolution of which information to use.</p>
</div>
<div class="section" id="characterization-runs">
<h3><a class="toc-backref" href="#id6">Characterization runs</a><a class="headerlink" href="#characterization-runs" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">CharacterizationRunsFile</span></tt>, <tt class="docutils literal"><span class="pre">ExpIniFilename</span></tt>,
<tt class="docutils literal"><span class="pre">BackgroundNumber</span></tt>, <tt class="docutils literal"><span class="pre">VanadiumNumber</span></tt>, <tt class="docutils literal"><span class="pre">VanadiumBackgroundNumber</span></tt>
all contribute to determine which runs to use for background
subtraction and normalization. Specifying the various <tt class="docutils literal"><span class="pre">*Number</span></tt>
properties as <tt class="docutils literal"><span class="pre">0</span></tt>, indicates using the values found in the
files. Specifying <tt class="docutils literal"><span class="pre">-1</span></tt> indicates to not do the corrections at
all. The files are loaded using <a class="reference internal" href="PDLoadCharacterizations-v1.html#algm-pdloadcharacterizations"><em>PDLoadCharacterizations v1</em></a>
which also contains the focus positions. Which runs to used are
determined by <a class="reference internal" href="PDDetermineCharacterizations-v1.html#algm-pddeterminecharacterizations"><em>PDDetermineCharacterizations v1</em></a>.</p>
</div>
</div>
<div class="section" id="workflow">
<h2><a class="toc-backref" href="#id7">Workflow</a><a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/SNSPowderReduction-v1_workflow.png" src="../_images/SNSPowderReduction-v1_workflow.png" />
<img alt="../_images/SNSPowderReduction-v1_vanadium.png" src="../_images/SNSPowderReduction-v1_vanadium.png" />
<img alt="../_images/SNSPowderReduction-v1_process_container.png" src="../_images/SNSPowderReduction-v1_process_container.png" />
<img alt="../_images/SNSPowderReduction-v1_focusandsum.png" src="../_images/SNSPowderReduction-v1_focusandsum.png" />
<img alt="../_images/SNSPowderReduction-v1_focuschunks_workflow.png" src="../_images/SNSPowderReduction-v1_focuschunks_workflow.png" />
<img alt="../_images/SNSPowderReduction-v1_loadandsum.png" src="../_images/SNSPowderReduction-v1_loadandsum.png" />
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id8">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>This is a worksflow algorithm used to process and the results of
powder diffraction scattering experimens on SNS
instruments. Processing data from instruments not at SNS is
unsupported. Sample usage can be found in the <a class="reference external" href="https://github.com/mantidproject/mantid/blob/master/Testing/SystemTests/tests/analysis/SNSPowderRedux.py">system tests</a>.</p>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/Diffraction/Reduction.html">Diffraction\Reduction</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id9">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/e07b2bf50bc7eaeb32967b712b3665c1ffc8a2c4/Framework/PythonInterface/plugins/algorithms/SNSPowderReduction.py">SNSPowderReduction.py</a> <em>(last modified: 2018-02-22)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="SNAPReduce-v1.html" title="Previous Chapter: SNAPReduce v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; SNAPReduce v1</span>
    </a>
  </li>
  <li>
    <a href="SassenaFFT-v1.html" title="Next Chapter: SassenaFFT v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SassenaFFT v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2018-03-19.<br/>
    </p>
  </div>
</footer>
  </body>
</html>