<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PowderDiffILLDetEffCorr v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="PowderDiffILLDetScanReduction v1" href="PowderDiffILLDetScanReduction-v1.html" />
    <link rel="prev" title="PolynomialCorrection v1" href="PolynomialCorrection-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.12</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="powderdiffilldeteffcorr-v1">
<span id="algm-powderdiffilldeteffcorr"></span><span id="algm-powderdiffilldeteffcorr-v1"></span><h1>PowderDiffILLDetEffCorr v1<a class="headerlink" href="#powderdiffilldeteffcorr-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/PowderDiffILLDetEffCorr-v1_dlg.png"><img alt="../_images/PowderDiffILLDetEffCorr-v1_dlg.png" class="screenshot" src="../_images/PowderDiffILLDetEffCorr-v1_dlg.png" style="width: 322px;" /></a>
<p class="caption"><strong>PowderDiffILLDetEffCorr</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id2">Properties</a></li>
<li><a class="reference internal" href="#description" id="id3">Description</a></li>
<li><a class="reference internal" href="#input" id="id4">Input</a></li>
<li><a class="reference internal" href="#method" id="id5">Method</a></li>
<li><a class="reference internal" href="#excluded-range" id="id6">Excluded range</a></li>
<li><a class="reference internal" href="#pixel-range" id="id7">Pixel range</a></li>
<li><a class="reference internal" href="#output" id="id8">Output</a></li>
<li><a class="reference internal" href="#workflow" id="id9">Workflow</a></li>
<li><a class="reference internal" href="#related-algorithms" id="id10">Related Algorithms</a></li>
<li><a class="reference internal" href="#usage" id="id11">Usage</a></li>
<li><a class="reference internal" href="#source" id="id12">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id1">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Performs detector efficiency correction calculation for powder diffraction instrument D20 at ILL.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id2">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="3%" />
<col width="17%" />
<col width="5%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CalibrationRun</td>
<td>Input</td>
<td>string</td>
<td><em>Mandatory</em></td>
<td>File path of calibration run. Must be a detector scan. Allowed values: [&#8216;nxs&#8217;]</td>
</tr>
<tr class="row-odd"><td>CalibrationFile</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>Optional file containing previous calibration constants. Allowed values: [&#8216;nxs&#8217;]</td>
</tr>
<tr class="row-even"><td>CalibrationMethod</td>
<td>Input</td>
<td>string</td>
<td>Median</td>
<td>The method of how the calibration constant of a pixel relative to the neighbouring one is derived. Allowed values: [&#8216;Median&#8217;, &#8216;Mean&#8217;, &#8216;MostLikelyMean&#8217;]</td>
</tr>
<tr class="row-odd"><td>InterpolateOverlappingAngles</td>
<td>Input</td>
<td>boolean</td>
<td>False</td>
<td>Wheter to interpolate 2theta values for overlapping regions between neighbouring cells.</td>
</tr>
<tr class="row-even"><td>NormaliseTo</td>
<td>Input</td>
<td>string</td>
<td>None</td>
<td>Normalise to time, monitor or ROI counts before deriving the calibration. Allowed values: [&#8216;None&#8217;, &#8216;Monitor&#8217;, &#8216;ROI&#8217;]</td>
</tr>
<tr class="row-odd"><td>ROI</td>
<td>Input</td>
<td>dbl list</td>
<td>0,100</td>
<td>Regions of interest for normalisation [in scattering angle in degrees].</td>
</tr>
<tr class="row-even"><td>ExcludedRange</td>
<td>Input</td>
<td>dbl list</td>
<td>&nbsp;</td>
<td>2theta regions to exclude from the computation of relative calibration constants [in scattering angle in degrees].</td>
</tr>
<tr class="row-odd"><td>PixelRange</td>
<td>Input</td>
<td>int list</td>
<td>1,3072</td>
<td>Range of the pixel numbers to compute the calibration factors for. For the other pixels outside the range, the factor will be set to 1.</td>
</tr>
<tr class="row-even"><td>OutputResponseWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td>&nbsp;</td>
<td>Output workspace containing the summed diffraction patterns of all the pixels.</td>
</tr>
<tr class="row-odd"><td>OutputWorkspace</td>
<td>Output</td>
<td><a class="reference internal" href="../concepts/MatrixWorkspace.html#matrixworkspace"><em>MatrixWorkspace</em></a></td>
<td><em>Mandatory</em></td>
<td>Output workspace containing the detector efficiencies for each pixel.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id3">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This algorithm calculates the detector efficiency corrections for the instrument D20 at the ILL.</p>
<p>It performs as follows:</p>
<ol class="arabic simple">
<li>Takes the first cell response as a function of scattering angle as a reference</li>
<li>Takes the second cell, and divides the reference to the second cell response in the overlapping region in terms of scattering angle. This results in the array of relative response ratios.</li>
<li>Uses one of the 3 suggested options to compute the relative calibration factor from the array of relative response ratios. This factor is saved in the output as the calibration factor for the second cell.</li>
<li>The response of the second cell is scaled up with that factor, and then merged (in the overlapping region) with the reference using <a class="reference internal" href="WeightedMean-v1.html#algm-weightedmean"><em>WeightedMean</em></a>.</li>
<li>Repeat from Step 2 for the next cell and so on until the last cell.</li>
</ol>
<p>For the zero-counting cells, the calibration factor cannot be computed, and it will be set to 1. Cells are treated as zero-counting, if they count zero more than 80% of time.</p>
<p>After the calibration factors are computed for all the cells, they are divided by the median of all the factors (excluding the zero counting cells),
in order to absolutely normalise the calibration curve.</p>
</div>
<div class="section" id="input">
<h2><a class="toc-backref" href="#id4">Input</a><a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h2>
<p>The input must be a single <strong>detector-scan</strong> run in <cite>.nxs</cite> format produced for vanadium.</p>
<p>Optionally the previously derived calibration file can be seeded, and the algorithm will then compute the residual calibration factors on top of that.</p>
</div>
<div class="section" id="method">
<h2><a class="toc-backref" href="#id5">Method</a><a class="headerlink" href="#method" title="Permalink to this headline">¶</a></h2>
<p>You can choose the method of how the relative calibration factor is extracted from the relative response ratios (Step 3).
It can be the Median (default), Mean or <a class="reference internal" href="MostLikelyMean-v1.html#algm-mostlikelymean"><em>MostLikelyMean</em></a>.</p>
</div>
<div class="section" id="excluded-range">
<h2><a class="toc-backref" href="#id6">Excluded range</a><a class="headerlink" href="#excluded-range" title="Permalink to this headline">¶</a></h2>
<p>Provide ranges in scattering angle in degrees, to exclude non-desired regions, e.g. the beam stop.
Multiple regions can be set, <strong>-20,0,10,20</strong> will exclude <strong>[-20,0]</strong> and <strong>[10,20]</strong>.
This exclusion will happen at Step 3.</p>
</div>
<div class="section" id="pixel-range">
<h2><a class="toc-backref" href="#id7">Pixel range</a><a class="headerlink" href="#pixel-range" title="Permalink to this headline">¶</a></h2>
<p>Provide the range of detector cells to compute the calibration factors for.
For the rest of the cells, the factor will be set to 1.</p>
</div>
<div class="section" id="output">
<h2><a class="toc-backref" href="#id8">Output</a><a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>Output will be a single-column workspace containing the calibration factors for each cell. This should be normally saved with
<a class="reference internal" href="SaveNexusProcessed-v1.html#algm-savenexusprocessed"><em>SaveNexusProcessed</em></a> to be later used in <a class="reference internal" href="PowderDiffILLReduction-v1.html#algm-powderdiffillreduction"><em>PowderDiffILLReduction</em></a>.</p>
<p>Optionally, the full absolute response resulted from the combination of the data for all the cells (see Step 4 above) can also be output.</p>
</div>
<div class="section" id="workflow">
<h2><a class="toc-backref" href="#id9">Workflow</a><a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/PowderDiffILLDetEffCorr-v1_wkflw.png" src="../_images/PowderDiffILLDetEffCorr-v1_wkflw.png" />
</div>
<div class="section" id="related-algorithms">
<h2><a class="toc-backref" href="#id10">Related Algorithms</a><a class="headerlink" href="#related-algorithms" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="PowderDiffILLReduction-v1.html#algm-powderdiffillreduction"><em>PowderDiffILLReduction</em></a> performs the data reduction.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id11">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>Example - PowderDiffILLDetEffCorr</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">calib</span> <span class="o">=</span> <span class="n">PowderDiffILLDetEffCorr</span><span class="p">(</span><span class="n">CalibrationRun</span><span class="o">=</span><span class="s">&#39;967076&#39;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s">&#39;constants&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Reduced workspace contains {0} constants, one for each cell.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">calib</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Reduced</span> <span class="n">workspace</span> <span class="n">contains</span> <span class="mi">3072</span> <span class="n">constants</span><span class="p">,</span> <span class="n">one</span> <span class="k">for</span> <span class="n">each</span> <span class="n">cell</span><span class="o">.</span>
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/ILL/Diffraction.html">ILL\Diffraction</a> | <a class="reference external" href="categories/Diffraction/Reduction.html">Diffraction\Reduction</a> | <a class="reference external" href="categories/Diffraction/Calibration.html">Diffraction\Calibration</a></p>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id12">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>Python: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/e07b2bf50bc7eaeb32967b712b3665c1ffc8a2c4/Framework/PythonInterface/plugins/algorithms/WorkflowAlgorithms/PowderDiffILLDetEffCorr.py">PowderDiffILLDetEffCorr.py</a> <em>(last modified: 2018-02-16)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="PolynomialCorrection-v1.html" title="Previous Chapter: PolynomialCorrection v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; PolynomialCorrec...</span>
    </a>
  </li>
  <li>
    <a href="PowderDiffILLDetScanReduction-v1.html" title="Next Chapter: PowderDiffILLDetScanReduction v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">PowderDiffILLDet... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2018-03-19.<br/>
    </p>
  </div>
</footer>
  </body>
</html>