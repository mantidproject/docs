<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>RotateInstrumentComponent v1</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="" href="../index.html" />
    <link rel="next" title="RotateSource v1" href="RotateSource-v1.html" />
    <link rel="prev" title="RingProfile v1" href="RingProfile-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org"><img src="../_static/Mantid_Logo_Transparent.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>3.12</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://www.mantidproject.org">Home</a></li>
                <li><a href="http://download.mantidproject.org">Download</a></li>
                <li><a href="http://docs.mantidproject.org/nightly/">Documentation</a></li>
                <li><a href="http://www.mantidproject.org/Contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="rotateinstrumentcomponent-v1">
<span id="algm-rotateinstrumentcomponent"></span><span id="algm-rotateinstrumentcomponent-v1"></span><h1>RotateInstrumentComponent v1<a class="headerlink" href="#rotateinstrumentcomponent-v1" title="Permalink to this headline">¶</a></h1>
<div class="figure align-right" id="index-0">
<a class="screenshot reference internal image-reference" href="../_images/RotateInstrumentComponent-v1_dlg.png"><img alt="../_images/RotateInstrumentComponent-v1_dlg.png" class="screenshot" src="../_images/RotateInstrumentComponent-v1_dlg.png" style="width: 232px;" /></a>
<p class="caption"><strong>RotateInstrumentComponent</strong> dialog.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id3">Summary</a></li>
<li><a class="reference internal" href="#properties" id="id4">Properties</a></li>
<li><a class="reference internal" href="#description" id="id5">Description</a></li>
<li><a class="reference internal" href="#usage" id="id6">Usage</a><ul>
<li><a class="reference internal" href="#example-1-rotating-a-bank-around-the-y-axis" id="id7">Example 1: Rotating a bank around the Y Axis</a><ul>
<li><a class="reference internal" href="#output" id="id8">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-2-rotating-a-bank-around-the-z-axis" id="id9">Example 2: Rotating a bank around the Z Axis</a><ul>
<li><a class="reference internal" href="#id1" id="id10">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-3-rotating-a-single-detector" id="id11">Example 3: Rotating a single detector</a><ul>
<li><a class="reference internal" href="#id2" id="id12">Output</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#source" id="id13">Source</a></li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id3">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Rotates an instrument component.</p>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id4">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="3%" />
<col width="13%" />
<col width="5%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Direction</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Workspace</td>
<td>InOut</td>
<td><a class="reference internal" href="../concepts/Workspace.html#workspace"><em>Workspace</em></a></td>
<td><em>Mandatory</em></td>
<td>The name of the workspace for which the new instrument configuration will have an effect. Any other workspaces stored in the analysis data service will be unaffected.</td>
</tr>
<tr class="row-odd"><td>ComponentName</td>
<td>Input</td>
<td>string</td>
<td>&nbsp;</td>
<td>The name of the component to rotate. Component names are defined in the instrument definition files.</td>
</tr>
<tr class="row-even"><td>DetectorID</td>
<td>Input</td>
<td>number</td>
<td>-1</td>
<td>The ID of the detector to rotate. If both the component name and the detector ID are set the latter will be used.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>The x-part of the rotation axis.</td>
</tr>
<tr class="row-even"><td>Y</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>The y-part of the rotation axis.</td>
</tr>
<tr class="row-odd"><td>Z</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>The z-part of the rotation axis.</td>
</tr>
<tr class="row-even"><td>Angle</td>
<td>Input</td>
<td>number</td>
<td>0</td>
<td>The angle of rotation in degrees.</td>
</tr>
<tr class="row-odd"><td>RelativeRotation</td>
<td>Input</td>
<td>boolean</td>
<td>True</td>
<td>The property defining how the rotation should be interpreted. If true it is a relative rotation. Otherwise it is an absolute rotation.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id5">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>RotateInstrumentComponent rotates a component around an axis of rotation
by an angle given in degrees. Rotation by 0 degrees does not change the
component&#8217;s orientation. The rotation axis (X,Y,Z) must be given in the
co-ordinate system attached to the component and rotates with it.
The centre of rotation is the centre of the component to be rotated,
and any children of that component (such as detectors in a bank, or pixels in a tube)
are moved and rotated along with the component.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id6">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-1-rotating-a-bank-around-the-y-axis">
<h3><a class="toc-backref" href="#id7">Example 1: Rotating a bank around the Y Axis</a><a class="headerlink" href="#example-1-rotating-a-bank-around-the-y-axis" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<img alt="RotateBank90.png‎" src="../_images/RotateBank90.png" />
<p class="caption">Rotating a bank around the 90° round Y Axis.  The centre of rotation is the centre of the component to be rotated, and any children of that component (such as each detector in this instance) are moved and rotated along with the bank.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Load a MUSR file</span>
<span class="n">musr</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s">&#39;MUSR00015189&#39;</span><span class="p">)</span>
<span class="c"># and use the first workspace in the workspace group</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s">&#39;musr_1&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">pos3D_as_str</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot; Produces a string with a V3D position (x, y, z) from a V3D object,</span>
<span class="sd">       using a fixed limited number of digits (for robust string comparisons).</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">def</span> <span class="nf">nz</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot; Handles potential issues with +-0 (for 6 digits text output) &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-7</span> <span class="k">else</span> <span class="n">value</span>

   <span class="n">precision</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
   <span class="n">format_str</span> <span class="o">=</span> <span class="s">&#39;[{0:.&#39;</span><span class="o">+</span><span class="n">precision</span><span class="o">+</span><span class="s">&#39;f}, {1:.&#39;</span><span class="o">+</span><span class="n">precision</span><span class="o">+</span><span class="s">&#39;f}, {2:.&#39;</span><span class="o">+</span><span class="n">precision</span><span class="o">+</span><span class="s">&#39;f}]&#39;</span>
   <span class="n">result</span> <span class="o">=</span> <span class="n">format_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nz</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">getX</span><span class="p">()),</span> <span class="n">nz</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">getY</span><span class="p">()),</span> <span class="n">nz</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">getZ</span><span class="p">()))</span>
   <span class="k">return</span> <span class="n">result</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;Original positions of detectors 1 and 2&#39;</span><span class="p">)</span>
<span class="n">opos1</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="n">opos2</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Det 1: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">opos1</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Det 2: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">opos2</span><span class="p">)))</span>

<span class="c"># Rotate bank &#39;back&#39; around the Z axis by 90</span>
<span class="n">RotateInstrumentComponent</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">ComponentName</span><span class="o">=</span><span class="s">&#39;back&#39;</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Angle</span><span class="o">=</span><span class="mf">90.0</span> <span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;Positions of detectors 1 and 2 after rotation&#39;</span><span class="p">)</span>
<span class="n">pos1</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="n">pos2</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Det 1: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">pos1</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Det 2: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">pos2</span><span class="p">)))</span>
</pre></div>
</div>
<div class="section" id="output">
<h4><a class="toc-backref" href="#id8">Output</a><a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h4>
<div class="highlight-none"><div class="highlight"><pre>Original positions of detectors 1 and 2
Det 1: [-0.088815, -0.108221, 0.145000]
Det 2: [-0.065996, -0.123469, 0.145000]
Positions of detectors 1 and 2 after rotation
Det 1: [0.000000, -0.108221, 0.233815]
Det 2: [0.000000, -0.123469, 0.210996]
</pre></div>
</div>
</div>
</div>
<div class="section" id="example-2-rotating-a-bank-around-the-z-axis">
<h3><a class="toc-backref" href="#id9">Example 2: Rotating a bank around the Z Axis</a><a class="headerlink" href="#example-2-rotating-a-bank-around-the-z-axis" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<img alt="RotateBank3Dets.png‎" src="../_images/RotateBank3Dets.png" />
<p class="caption">Rotating the bank around the Z Axis.  The centre of rotation is the centre of the bank, so the detectors are translated and rotated to match.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Load a MUSR file</span>
<span class="n">musr</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s">&#39;MUSR00015189&#39;</span><span class="p">)</span>
<span class="c"># and use the first workspace in the workspace group</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s">&#39;musr_1&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">pos3D_as_str</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot; Produces a string with a V3D position (x, y, z) from a V3D object,</span>
<span class="sd">       using a fixed limited number of digits (for robust string comparisons).</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">def</span> <span class="nf">nz</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot; Handles potential issues with +-0 (for 6 digits text output) &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-7</span> <span class="k">else</span> <span class="n">value</span>

   <span class="n">precision</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
   <span class="n">format_str</span> <span class="o">=</span> <span class="s">&#39;[{0:.&#39;</span><span class="o">+</span><span class="n">precision</span><span class="o">+</span><span class="s">&#39;f}, {1:.&#39;</span><span class="o">+</span><span class="n">precision</span><span class="o">+</span><span class="s">&#39;f}, {2:.&#39;</span><span class="o">+</span><span class="n">precision</span><span class="o">+</span><span class="s">&#39;f}]&#39;</span>
   <span class="n">result</span> <span class="o">=</span> <span class="n">format_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nz</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">getX</span><span class="p">()),</span> <span class="n">nz</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">getY</span><span class="p">()),</span> <span class="n">nz</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">getZ</span><span class="p">()))</span>
   <span class="k">return</span> <span class="n">result</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;Original positions of detectors 1 and 4&#39;</span><span class="p">)</span>
<span class="n">opos1</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="n">opos4</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Det 1: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">opos1</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Det 4: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">opos4</span><span class="p">)))</span>

<span class="c"># Rotate bank &#39;back&#39; around the Z axis by 3 detectors.</span>
<span class="n">RotateInstrumentComponent</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">ComponentName</span><span class="o">=</span><span class="s">&#39;back&#39;</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Angle</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="mf">360.0</span> <span class="o">/</span> <span class="mi">32</span> <span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;Positions of detector 1 after rotation&#39;</span><span class="p">)</span>
<span class="n">pos1</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Det 1: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos3D_as_str</span><span class="p">(</span><span class="n">pos1</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Detector 1 took place of detector 4&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id1">
<h4><a class="toc-backref" href="#id10">Output</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-none"><div class="highlight"><pre>Original positions of detectors 1 and 4
Det 1: [-0.088815, -0.108221, 0.145000]
Det 4: [-0.013722, -0.139326, 0.145000]
Positions of detector 1 after rotation
Det 1: [-0.013722, -0.139326, 0.145000]
Detector 1 took place of detector 4
</pre></div>
</div>
</div>
</div>
<div class="section" id="example-3-rotating-a-single-detector">
<h3><a class="toc-backref" href="#id11">Example 3: Rotating a single detector</a><a class="headerlink" href="#example-3-rotating-a-single-detector" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<img alt="RotateDetector.png‎" src="../_images/RotateDetector.png" />
<p class="caption">Rotating the detector around the Z Axis by 90 degrees.  The centre of rotation is the centre of the detector.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c"># Load a MUSR file</span>
<span class="n">musr</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="s">&#39;MUSR00015189&#39;</span><span class="p">)</span>
<span class="c"># and use the first workspace in the workspace group</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">mtd</span><span class="p">[</span><span class="s">&#39;musr_1&#39;</span><span class="p">]</span>

<span class="c"># Rotating a detector doesn&#39;t change its position, just its orientation</span>

<span class="c"># Original position of detector 33</span>
<span class="k">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">())</span>

<span class="c"># Caclulate the solid angles for all detectors in the instrument</span>
<span class="c"># The result is a single-bin workspace with solid angles for all spectra in ws</span>
<span class="n">saws</span> <span class="o">=</span> <span class="n">SolidAngle</span><span class="p">(</span> <span class="n">ws</span> <span class="p">)</span>
<span class="c"># Collect the solid angles from the first bin in saws and save them in numpy array.</span>
<span class="c"># Numpy module makes it easy to manipulate arrays</span>
<span class="n">sa1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span> <span class="n">saws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">saws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span> <span class="p">]</span> <span class="p">)</span>

<span class="c"># Rotate detector 33 around the Z axis by 90 degrees.</span>
<span class="n">RotateInstrumentComponent</span><span class="p">(</span> <span class="n">ws</span><span class="p">,</span> <span class="n">DetectorID</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Angle</span><span class="o">=</span><span class="mi">90</span> <span class="p">)</span>

<span class="c"># Check the position of detector 33 stays unchanged</span>
<span class="k">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">getInstrument</span><span class="p">()</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">getPos</span><span class="p">())</span>

<span class="c"># Calculate the solid angles after rotation</span>
<span class="n">saws</span> <span class="o">=</span> <span class="n">SolidAngle</span><span class="p">(</span> <span class="n">ws</span> <span class="p">)</span>
<span class="n">sa2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span> <span class="n">saws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">saws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">())</span> <span class="p">]</span> <span class="p">)</span>

<span class="c"># Take element by element difference of the solid angles</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">sa2</span> <span class="o">-</span> <span class="n">sa1</span>
<span class="k">print</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;The non-zero difference {:.13f} is due to detector {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">diff</span><span class="p">[</span><span class="mi">32</span><span class="p">],</span> <span class="n">ws</span><span class="o">.</span><span class="n">getDetector</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">getID</span><span class="p">()))</span>
</pre></div>
</div>
<div class="section" id="id2">
<h4><a class="toc-backref" href="#id12">Output</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-none"><div class="highlight"><pre>[0.0888151,-0.108221,-0.145]
[0.0888151,-0.108221,-0.145]
[ 0.          0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.         -0.04645313  0.          0.
  0.          0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.          0.
  0.        ]
The non-zero difference -0.0464531276188 is due to detector 33
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/Algorithms.html">Algorithms</a> | <a class="reference external" href="categories/DataHandling/Instrument.html">DataHandling\Instrument</a></p>
</div>
</div>
</div>
<div class="section" id="source">
<h2><a class="toc-backref" href="#id13">Source</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/e07b2bf50bc7eaeb32967b712b3665c1ffc8a2c4/Framework/DataHandling/src/RotateInstrumentComponent.cpp">RotateInstrumentComponent.cpp</a> <em>(last modified: 2017-06-30)</em></p>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/e07b2bf50bc7eaeb32967b712b3665c1ffc8a2c4/Framework/DataHandling/inc/MantidDataHandling/RotateInstrumentComponent.h">RotateInstrumentComponent.h</a> <em>(last modified: 2017-12-11)</em></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="RingProfile-v1.html" title="Previous Chapter: RingProfile v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; RingProfile v1</span>
    </a>
  </li>
  <li>
    <a href="RotateSource-v1.html" title="Next Chapter: RotateSource v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">RotateSource v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
      Last updated on 2018-03-19.<br/>
    </p>
  </div>
</footer>
  </body>
</html>